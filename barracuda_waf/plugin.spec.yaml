plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: barracuda_waf
title: Barracuda Web Application Firewall
description: The Barracuda WAF plugin automates administrative tasks as well as rule creation and modification
version: 1.0.2
vendor: rapid7
support: community
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/barracuda_waf
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.barracuda.com/
tags:
- barracuda
- waf
- web
- application
- firewall
hub_tags:
  use_cases: [soar, network_containment, soc_automation, threat_detection_and_response]
  keywords: [barracuda, waf, web, application, firewall]
  features: []
types:
  vsite:
    id:
      type: string
      description: ID
      required: true
    service_group:
      type: array
      description: Group of service
      required: true
    name:
      type: string
      description: Name of virtual site
      required: true
    active_on:
      type: integer
      description: Is virtual site activated
      required: true
    comments:
      type: array
      description: Comments about virtual site
      required: false
  request_limits:
    enable:
      type: string
      description: Enforce size limit checks on request headers or not
      required: true
      enum:
      - 'yes'
      - 'no'
    maxNumberOfHeaders:
      type: integer
      description: The maximum number of headers to be allowed in a request
      required: false
    maxHeaderNameLength:
      type: integer
      description: The maximum allowable length for a header name
      required: false
    maxCookieNameLength:
      type: integer
      description: The maximum allowable length for a cookie name
      required: false
    maxQueryLength:
      type: integer
      description: The maximum allowable length for the query string portion of the
        URL
      required: false
    maxCookieValueLength:
      type: integer
      description: The maximum allowable length for a cookie value
      required: false
    maxRequestLength:
      type: integer
      description: The maximum allowable request length. This includes the Request
        Line and all HTTP request headers
      required: false
    maxHeaderValueLength:
      type: integer
      description: The maximum allowable length for header value in a request
      required: false
    maxURLLength:
      type: integer
      description: The maximum allowable URL length including the query string portion
        of the URL
      required: false
    maxRequestLineLength:
      type: integer
      description: The maximum allowable length for the request line. The request
        line consists of the method, the URL
      required: false
    maxNumberOfCookies:
      type: integer
      description: The maximum number of cookies to be allowed
      required: false
  parameter_protection:
    enable:
      type: string
      description: Determines whether to enforce parameter protection or not
      enum:
      - 'yes'
      - 'no'
      required: false
    deniedMetaCharacters:
      type: string
      description: The meta-characters to be denied in the parameter value. Meta-characters
        must be URL encoded. Non-printable characters such as 'backspace' and web
        interface reserved characters like '?' should be URL encoded
      required: false
    fileUpload_extensions:
      type: '[]string'
      description: The extensions to be allowed as uploaded files
      required: false
    maximumUploadFileSize:
      type: integer
      description: The maximum size (in KB) for an individual file that can be uploaded
        in a request
      required: false
    blockedAttackTypes:
      type: array
      description: The Attack Types to be matched in a request
      required: false
    base64DecodeParameterValue:
      type: string
      description: Determines whether to apply base64 decoding to the parameter values
        or not
      required: false
    ignoreParameters:
      type: '[]string'
      description: The parameters to be exempted from all validations
      required: false
    customBlockedAttackTypes:
      type: array
      description: The custom attack types defined on the ADVANCED > Libraries page
        (if any)
      required: false
    allowedFileUploadType:
      type: string
      description: The allowed file upload types
      required: false
    maximumParameterValueLength:
      type: integer
      description: The maximum allowed length of any parameter value, including no-name
        parameters
      required: false
    maximumInstances:
      type: integer
      description: The maximum number of times a parameter needs to be allowed in
        a request
      required: false
    fileUploadMimeTypes:
      type: '[]string'
      description: The Mime types to be allowed as uploaded files
      required: false
    exceptionPatterns:
      type: array
      description: 'The patterns to be allowed despite matching a malicious pattern
        group. Note: Configure the exact ''Pattern Name'' displayed on the ADVANCED
        > View Internal Patterns page, or as defined when creating a ''New Group''
        on the ADVANCED > Libraries page'
      required: false
  url_protection:
    enable:
      type: string
      description: Determines whether to enforce URL protection or not
      enum:
      - 'yes'
      - 'no'
      required: false
    maximumParameterNameLength:
      type: integer
      description: The maximum length of a parameter name in a request
      required: false
    maxContentLength:
      type: integer
      description: The maximum content length to be allowed for POST request body
      required: false
    maxParameters:
      type: integer
      description: The maximum number of parameters to be allowed in a request
      required: false
    allowedContentTypes:
      type: '[]string'
      description: The list of content types to be allowed in the POST body of a request
      required: false
    maximumUploadFiles:
      type: integer
      description: The maximum number of files that can be of file-upload type in
        a request
      required: false
    blockedAttackTypes:
      type: array
      description: The Attack Types to be matched in a request
      required: false
    custom_blockedAttackTypes:
      type: array
      description: The custom attack types defined on the ADVANCED > Libraries page
        (if any)
      required: false
    csrfPrevention:
      type: string
      description: The Cross-Site Request Forgery (CSRF) prevention for the forms
        and URLs
      required: false
    allowedMethods:
      type: '[]string'
      description: The list of allowable methods in a request
      required: false
    exceptionPatterns:
      type: array
      description: 'The patterns to be allowed despite matching a malicious pattern
        group. Note: Configure the exact ''Pattern Name'' displayed on the ADVANCED
        > View Internal Patterns page, or as defined when creating a ''New Group''
        on the ADVANCED > Libraries page'
      required: false
  cookie_security:
    secureCookie:
      type: integer
      description: Determines whether to allow or not the cookies if the client makes
        secure HTTPS connection
      required: false
    cookies_exempted:
      type: '[]string'
      description: The names of the cookies that needs to be exempted from the cookie
        security policy
      required: false
    cookieMaxAge:
      type: integer
      description: The maximum age for session cookies
      required: false
    cookieReplayProtectionType:
      type: string
      description: The type of protection to be used to prevent the cookie replay
        attacks. The enumerated values include
      required: false
    http_only:
      type: string
      description: Determines whether or not the cookie security feature will be enabled
        for HTTP cookies
      required: false
      enum:
      - 'no'
      - 'yes'
    daysAllowed:
      type: integer
      description: The number of days the Barracuda Web Application Firewall to not
        reject unrecognized cookies
      required: false
    tamperProofMode:
      type: string
      description: The tamper proof mode for cookies
      required: false
    customHeaders:
      type: array
      description: The custom headers to be used in the cookie if the parameter 'Cookie
        Replay Protection Type' is set to Custom Headers or IP and Custom Headers
      required: false
    allowUnrecognizedCookies:
      type: string
      description: Determines whether unrecognized cookies should be allowed
      required: false
  url_normalization:
    parameter_separators:
      type: string
      description: The url-decoded parameter separator to be used
      required: false
    defaultCharset:
      type: string
      description: The character set decoding type to be used for incoming requests
      required: false
    double_decoding:
      type: string
      description: Determines whether or not to apply double-decoding of the character
        set
      required: false
    detectResponseCharset:
      type: string
      description: Determines whether or not the Barracuda Web Application Firewall
        will detect the character set decoding from the response
      required: false
  action_policy:
    action:
      type: string
      description: The action to be taken for an invalid request
      enum:
      - none
      - protect_and_log
      - allow_and_log
      - protect_with_no_log
      required: false
    deny_response:
      type: string
      description: The response to be sent to the client if the request is denied
      enum:
      - close_connection
      - send_response
      - temporary_redirect
      - permanent_redirect
      required: false
    redirect_url:
      type: string
      description: The URL to be used to redirect the request
      required: false
    response_page:
      type: string
      description: The response page to be sent to the client
      enum:
      - default
      - default-virus
      - default-error-resp
      - default-captcha-tries-error-page
      - default-captcha-sessions-error-page
      - default-suspected-activity-error-page
      - default-captcha-response-page
      required: false
    follow_up_action:
      type: string
      description: The follow up action to be taken if the request is denied
      enum:
      - none
      - block_client_ip
      - challenge_with_captcha
      required: false
    follow_up_action_time:
      type: integer
      description: The time in seconds to block the client IP
      required: false
  r_action_policy:
    action:
      type: string
      description: The action to be taken for an invalid request
      required: false
    denyResponse:
      type: string
      description: The response to be sent to the client if the request is denied
      required: false
    redirectUrl:
      type: string
      description: The URL to be used to redirect the request
      required: false
    followUpAction:
      type: string
      description: The follow up action to be taken if the request is denied
      required: false
    followUpActionTime:
      type: integer
      description: The time in seconds to block the client IP
      required: false
    numeric_id:
      type: string
      title: Numeric ID
      description: Numeric ID
      required: false
    id:
      type: string
      title: ID
      description: ID of attack action
      required: false
    name:
      type: string
      title: Name
      description: Name of attack action
      required: false
    attack_group:
      type: string
      title: Attack group name
      description: Name of attack group
      required: false
    response_page:
      type: string
      title: Response name
      description: The response page to be sent to the client
      enum:
      - default
      - default-virus
      - default-error-resp
      - default-captcha-tries-error-page
      - default-captcha-sessions-error-page
      - default-suspected-activity-error-page
      - default-captcha-response-page
      required: false
  global_acl:
    name:
      type: string
      description: A name for the URL ACL rule
      required: true
    url_match:
      type: string
      description: The URL to be matched to the URL in the request.  The URL should
        start with a / and can have at most one  * anywhere in the URL. A value of
        '/*' means that the access control rule (ACL) applies for all URLs in that
        domain
      required: true
    extended_match:
      type: string
      description: An expression that consists of a combination of HTTP headers and/or
        query string parameters. Updating extended match parameters value is shown
        in the example below
      required: true
    extended_match_sequence:
      type: integer
      description: A number to indicate the order in which the extended match rule
        must be evaluated in the requests
      required: false
    action:
      type: string
      description: The action to be taken on the request matching this URL
      required: false
    deny_response:
      type: string
      description: The response to be sent to the client if the request is denied
      required: false
    response_page:
      type: string
      description: The response page to be sent to the client
      required: false
    redirect_url:
      type: string
      description: A URL to which a user should be redirected
      required: false
    comments:
      type: string
      description: Description about the global ACL rule
      required: false
  security_policy:
    id:
      type: string
      description: ID of security policies
      required: true
    character:
      type: string
      description: Default character set
      required: true
    cloaking:
      type: array
      description: Cloaking
      required: true
    apply_double_decoding:
      type: string
      description: Apply double decoding
      required: true
    data_theft_protection:
      type: array
      description: Data theft protection
      required: true
    url_protection_status:
      type: integer
      description: URL protection status
      required: true
    allowed_acls:
      type: integer
      description: Allowed ACLs
      required: true
    request_limits:
      type: request_limits
      description: Request limits
      required: true
    parameter_protection:
      type: parameter_protection
      description: Parameter protection
      required: true
    url_protection:
      type: url_protection
      description: URL protection configuration
      required: true
    cookie_security:
      type: cookie_security
      description: Cookie security
      required: true
    url_normalization:
      type: url_normalization
      description: URL normalization
      required: true
    cookie_protection:
      type: string
      description: Cookie protection
      required: true
    limit_checks:
      type: boolean
      description: Limit checks
      required: true
    name:
      type: string
      description: Name of security policies
      required: true
    parameter_protection_status:
      type: string
      description: Parameter protection status
      required: true
    disallowed_acls:
      type: integer
      description: Disallowed ACLs
      required: true
    double_decoding:
      type: string
      title: Double Decoding
      description: Determines whether or not to apply double-decoding of the character
        set
      required: false
    default_character_set:
      type: string
      title: Default character set
      description: Default character set
      required: false
connection:
  address:
    title: Address
    type: string
    description: Enter address to barracuda WAF
    required: true
  credentials:
    type: credential_username_password
    title: Credentials
    description: Username and password
    required: true
actions:
  vsites:
    title: All Vsites
    description: Lists all vsites
    input:
      id:
        title: ID
        type: string
        description: Vsite ID
        required: false
    output:
      vsites:
        title: Vsites
        description: All info about vsite
        type: '[]vsite'
        required: true
  delete_vsite:
    title: Delete Vsite
    description: Deletes the given vsite
    input:
      id:
        title: ID
        type: string
        description: Vsite ID
        required: true
    output:
      status:
        title: Status
        description: Is delete was success
        type: boolean
        required: true
  create_virtual_service:
    title: Create Virtual Service
    description: Creates a virtual service with the given values
    input:
      name:
        title: Name
        type: string
        description: The name of the new service
        required: true
      address:
        title: Address
        type: string
        description: The virtual IP address that will be used for accessing this application
        required: true
      port:
        title: Port
        type: integer
        description: The port number on which your web server responds
        required: true
      type:
        title: Type
        type: string
        description: The type of the service you want to create
        required: true
        enum:
        - http
        - https
        - ftp
        - ftpssl
        - custom
        - customssl
        - instantssl
        - redirect
      address_version:
        title: Address Version
        type: string
        description: The internet protocol version of the service
        required: true
        enum:
        - ipv4
        - ipv6
      vsite:
        title: Vsite
        type: string
        description: The name of the vsite under which the service needs to be created
        required: false
      group:
        title: Group
        type: string
        description: The name of the service group under which the service needs to
          be created
        required: true
      certificate:
        title: Certificate
        type: string
        description: The certificate that needs to be presented to the browser when
          accessing this Service
        required: false
      service_hostname:
        title: Service Hostname
        type: string
        description: The domain name to identify and rewrite HTTP requests to HTTPS
        required: false
    output:
      id:
        title: ID
        description: The name of the service that got created
        type: string
        required: true
  retrieve_virtual_service:
    title: Retrieve Virtual Service
    description: Lists all virtual services
    input:
      id:
        title: ID
        type: string
        description: Virtual service ID
        required: false
    output:
      id:
        title: ID
        type: string
        description: Virtual service ID
        required: true
      load_balance:
        title: Load Balance
        type: array
        description: Load balance
        required: true
      comments:
        title: Comments
        type: array
        description: Comments
        required: true
      group:
        title: Group
        type: string
        description: Virtual service group
        required: true
      address:
        title: Address
        type: string
        description: Ipv4 or Ipv6 address
        required: true
      ssl_off_loading:
        title: SSL Offloading
        type: array
        description: SSL offloading
        required: true
      name:
        title: Name
        type: string
        description: Name of virtual service
        required: true
      enable_access_log:
        title: Enable Access Log
        type: boolean
        description: Is access log enabled
        required: true
      port:
        title: Port
        type: integer
        description: The port number on which your web server responds
        required: true
      address_version:
        title: Address Version
        type: string
        description: The internet protocol version of the service
        required: true
      security:
        title: Security
        type: array
        description: Information about security
        required: true
      servers:
        title: Servers
        type: array
        description: List of servers
        required: true
      content_rules:
        title: Content Rules
        type: array
        description: List of content rules
        required: true
  delete_virtual_service:
    title: Delete Virtual Service
    description: Delete virtual service with service ID
    input:
      id:
        title: ID
        type: string
        description: Virtual service ID
        required: true
    output:
      msg:
        title: Message
        type: string
        description: Message of deleted
        required: true
  create_security_policy:
    title: Create Security Policy
    description: Creates a security policy with the default values
    input:
      name:
        title: Name
        type: string
        description: The name of the security policy that needs to be created
        required: true
    output:
      id:
        title: ID
        type: string
        description: ID of the new policy
        required: true
  retrieve_security_policies:
    title: Retrieve Security Policies
    description: Lists all security policies
    input:
      id:
        title: ID
        type: string
        description: ID of the security policies
        required: false
    output:
      policies:
        title: Policies
        type: '[]security_policy'
        description: Array of security policy object
        required: true
  update_security_policy:
    title: Update Security Policy
    description: Updates a security policy with the given values
    input:
      policy_id:
        type: string
        title: Policy ID
        description: ID of policy
        required: false
      request_limits:
        type: request_limits
        required: false
        description: Configuration of requests
      cookie_security:
        type: cookie_security
        description: Configuration of cookies security
        required: false
      url_protection:
        type: url_protection
        description: Configuration of url protection
        required: false
      parameter_protection:
        type: parameter_protection
        description: Configuration of protection
        required: false
      cloaking:
        type: array
        description: Configuration of cloaking
        required: false
      url_normalization:
        type: url_normalization
        description: URL normalization
        required: false
    output:
      msg:
        type: string
        description: Message of update
        required: true
  delete_security_policy:
    title: Delete Security Policy
    description: Deletes the given security policy
    input:
      id:
        type: string
        description: ID of security policy
        required: true
    output:
      msg:
        type: string
        description: Message of update
        required: true
  create_data_theft:
    title: Create Data Theft Element
    description: Adds a data theft element with the given values
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      name:
        type: string
        description: A name for this data theft element
        required: true
      enabled:
        type: string
        description: Use this data theft element to be matched in the server response
          pages
        required: true
        enum:
        - 'yes'
        - 'no'
      identity_theft_type:
        type: string
        description: The identity theft pattern to which the element mentioned in
          'name' belongs to. The enumerated values include
        required: true
        enum:
        - directory_indexing
        - credit_cards
        - social_security_numbers
        - custom
      custom_identity_theft_type:
        type: string
        description: The identity theft pattern defined on the ADVANCED > Libraries
          page (if any)
        required: false
      action:
        type: string
        description: The action to be enforced on any page sent by the server containing
          this data type
        required: false
        enum:
        - cloak
        - block
      initial_characters_to_keep:
        type: integer
        title: Initial Characters To Keep
        description: The number of initial characters to be displayed to the user
        required: false
      trailing_characters_to_keep:
        type: integer
        title: Trailing Characters To Keep
        description: The number of trailing characters to be displayed to the user
        required: false
    output:
      id:
        type: string
        description: Data theft element ID
        required: true
  retrieve_data_theft:
    title: Retrieve Data Theft Element
    description: Lists data theft element
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      id:
        type: string
        description: ID of security policy
        required: false
    output:
      action:
        type: string
        description: The action to be enforced on any page sent by the server containing
          this data type
        required: true
      custom_identity_theft_type:
        type: string
        description: The identity theft pattern defined on the ADVANCED > Libraries
          page (if any)
        required: true
      enabled:
        type: string
        description: Use this data theft element to be matched in the server response
          pages
        required: true
      identity_theft_type:
        type: string
        description: The identity theft pattern to which the element mentioned in
          'name' belongs to
        required: true
      initial_characters_to_keep:
        type: string
        description: The number of initial characters to be displayed to the user
        required: true
      trailing_characters_to_keep:
        type: string
        description: The number of trailing characters to be displayed to the user
        required: true
  update_data_theft:
    title: Update Data Theft Element
    description: Updates the values of given parameters in the given data theft element
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      id:
        type: string
        description: ID of a Data Theft Element
        required: false
      enabled:
        type: string
        description: Use this data theft element to be matched in the server response
          pages
        required: false
        enum:
        - 'no'
        - 'yes'
      identity_theft_type:
        type: string
        description: The identity theft pattern to which the element mentioned in
          'name' belongs to
        required: false
        enum:
        - directory_indexing
        - credit_cards
        - social_security_numbers
        - custom
      custom_identity_theft_type:
        type: string
        description: The identity theft pattern defined on the ADVANCED > Libraries
          page (if any)
        required: false
      action:
        type: string
        description: The action to be enforced on any page sent by the server containing
          this data type
        required: false
        enum:
        - cloak
        - block
      initial_characters_to_keep:
        type: integer
        description: The number of initial characters to be displayed to the user
        required: false
      trailing_characters_to_keep:
        type: string
        description: The number of trailing characters to be displayed to the user
        required: false
    output:
      id:
        type: string
        description: ID of a Data Theft Element
        required: true
  delete_data_theft:
    title: Delete Data Theft Element
    description: Deletes the given data theft element
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      id:
        type: string
        description: ID of a Data Theft Element
        required: false
    output:
      msg:
        type: string
        description: Message of delete
        required: true
  retrieve_attack_groups:
    title: Retrieve Attack Groups
    description: Lists all attack groups with attack group ID
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      attack_group_ID:
        type: string
        description: Attack group ID
        required: false
    output:
      action_policy:
        type: '[]action_policy'
        description: Attack groups information
        required: true
  retrieve_attack_actions:
    title: Retrieve Attack Actions
    description: Lists all attack actions for the given attack group with actionID
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      attack_group_id:
        type: string
        description: Attack group ID
        required: true
      action_id:
        type: string
        description: Attack group ID
        required: true
    output:
      action_policy:
        type: r_action_policy
        description: Attack groups information
        required: true
  update_action_policy:
    title: Update an Action Policy
    description: Updates the values of given parameters in the given action policy
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      attack_group_id:
        type: string
        description: Attack group ID
        required: true
      action_id:
        type: string
        description: Attack group ID
        required: true
      action_policy:
        type: action_policy
        description: Attack groups information
        required: true
    output:
      msg:
        type: string
        description: Message of update
        required: true
  create_global_acl_rule:
    title: Create Global ACL Rule
    description: Adds a global ACL rule with the given values
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      global_acl:
        type: global_acl
        description: Global ACL object
        required: true
    output:
      id:
        type: string
        description: ACL rule ID
        required: true
  retrieve_global_acl_rules:
    title: Retrieve Global ACL Rules
    description: Lists all global ACL rules with global ACL ID
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      global_acl_id:
        type: string
        description: Global ACL ID
        required: true
    output:
      extended_match_sequence:
        type: integer
        description: A number to indicate the order in which the extended match rule
          must be evaluated in the requests
        required: true
      name:
        type: string
        description: Global ACL name
        required: true
      comments:
        type: array
        description: Description about the global ACL rule
        required: true
      extended_match:
        type: string
        description: An expression that consists of a combination of HTTP headers
          and/or query string parameters
        required: true
      url_match:
        type: string
        description: The URL to be matched to the URL in the request. The URL should
          start with a '/' and can have at most one ' * ' anywhere in the URL
        required: true
      action:
        type: string
        description: The action to be taken on the request matching this URL
        required: true
      redirect_url:
        type: string
        description: A URL to which a user should be redirected if action is temporary_redirect
          or permanent_redirect
        required: true
      id:
        type: string
        description: ID of global ACL
        required: true
  update_global_acl_rule:
    title: Update Global ACL Rule
    description: Updates the values of given parameters in the given global ACL rule
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      global_acl_id:
        type: string
        description: Global ACL ID
        required: true
      enable_url_acl:
        type: string
        description: Enforce this URL ACL rule for all the Services configured on
          the Barracuda Web Application Firewall or not
        required: false
        enum:
        - 'yes'
        - 'no'
      url_match:
        type: string
        description: The URL to be matched to the URL in the request.  The URL should
          start with a '/' and can have at most one ' * ' anywhere in the URL. A value
          of '/*' means that the access control rule (ACL) applies for all URLs in
          that domain
        required: false
      extended_match:
        type: string
        description: An expression that consists of a combination of HTTP headers
          and/or query string parameters. Updating extended match parameters value
          is shown in the example below
        required: false
      extended_match_sequence:
        type: integer
        description: A number to indicate the order in which the extended match rule
          must be evaluated in the requests
        required: false
      action:
        type: string
        description: The action to be taken on the request matching this URL
        required: false
        enum:
        - process
        - allow
        - deny_and_log
        - deny_with_no_log
        - temporary_redirect
        - permanent_redirect
      deny_response:
        type: string
        description: The response to be sent to the client if the request is denied
        required: false
        enum:
        - reset
        - response_page
        - temporary_redirect
        - permanent_redirect
      response_page:
        type: string
        description: The response page to be sent to the client
        required: false
        enum:
        - default
        - default-virus
        - default-error-resp
        - default-captcha-tries-error-page
        - default-captcha-sessions-error-page
        - default-suspected-activity-error-page
        - default-captcha-response-page
      redirect_url:
        type: string
        description: A URL to which a user should be redirected if action is temporary_redirect
          or permanent_redirect
        required: false
      comments:
        type: string
        description: Description about the global ACL rule
        required: false
  delete_global_acl_rule:
    title: Delete Global ACL Rule
    description: Deletes the given global ACL rule
    input:
      policy_id:
        type: string
        description: ID of security policy
        required: true
      global_acl_id:
        type: string
        description: Global ACL ID
        required: true
    output:
      msg:
        type: string
        description: Message of deleted
        required: true
  create_trusted_host_group:
    title: Create Host Group
    description: Creates a trusted host group with the given name
    input:
      name:
        type: string
        description: A name for the trusted host group that needs to be created
        required: true
    output:
      id:
        type: string
        description: Name of trusted host group
        required: true
  delete_trusted_host_group:
    title: Delete Host Group
    description: Deletes the given service group
    input:
      name:
        type: string
        description: A name of trusted host group
        required: true
    output:
      msg:
        type: string
        description: Message of deleted
        required: true
  create_trusted_host:
    title: Create Host in Group
    description: Create a trusted host in group
    input:
      group_name:
        title: Group Name
        type: string
        description: Name for the trusted host group
        required: true
      name:
        title: Name
        type: string
        description: Name for the trusted host
        required: true
      address_version:
        title: Address Version
        type: string
        description: Internet protocol version for the trusted host
        required: true
        enum:
        - ipv4
        - ipv6
      address:
        title: Address
        type: string
        description: IP address of the trusted host
        required: true
      mask:
        title: Mask
        type: string
        description: Associated subnet mask
        required: true
      comments:
        title: Comments
        type: string
        description: Description about the trusted host
        required: false
    output:
      id:
        title: ID
        type: string
        description: ID of created trusted host group
        required: true
  update_trusted_host:
    title: Update Trusted Host
    description: Updates the values of given parameters
    input:
      group_name:
        title: Group Name
        type: string
        description: Name for the trusted host group
        required: true
      name:
        title: Name
        type: string
        description: Name for the trusted host
        required: true
      address:
        title: Address
        type: string
        description: IP address of the trusted host
        required: true
      mask:
        title: Mask
        type: string
        description: Associated subnet mask
        required: true
      comments:
        title: Comments
        type: string
        description: Description about the trusted host
        required: false
    output:
      id:
        title: ID
        type: string
        description: ID of created trusted host group
        required: true
  delete_trusted_host:
    title: Delete Trusted Host
    description: Deletes the given trusted host
    input:
      group_name:
        title: Group Name
        type: string
        description: Name for the trusted host group
        required: true
      name:
        title: Name
        type: string
        description: Name for the trusted host
        required: true
    output:
      msg:
        title: Message
        type: string
        description: Message of deleted
        required: true
  create_content_rule:
    title: Create Content Rule
    description: Creates a content rule for the given service
    input:
      virtual_service_id:
        title: Virtual Service ID
        type: string
        description: Virtual Service ID
        required: true
      name:
        title: Name
        type: string
        description: A name for the content rule
        required: true
      status:
        title: Status
        type: string
        description: The status of the content rule
        required: true
        enum:
        - 'on'
        - 'off'
      web_firewall_policy:
        title: Web Firewall Policy
        type: string
        description: A web firewall policy to be associated with the content rule
        required: true
      host_match:
        title: Host Match
        type: string
        description: A host name to be matched against the host in the request header
        required: true
      url_match:
        title: URL Match
        type: string
        description: A URL to be matched to the URL in the request header
        required: true
      extended_match:
        title: Extended Match
        type: string
        description: An expression that consists of a combination of HTTP headers
          and/or query string parameters
        required: true
      extended_match_sequence:
        title: Extended Match Sequence
        type: integer
        description: A number to indicate the order in which the extended match rule
          must be evaluated in the requests
        required: true
    output:
      id:
        title: ID
        type: string
        description: ID of content rule
        required: true
  retrieve_content_rules:
    title: Retrieve Content Rules
    description: Lists all content rules with rule ID
    input:
      virtual_service_id:
        title: Virtual Service ID
        type: string
        description: Virtual Service ID
        required: true
      id:
        title: ID
        type: string
        description: Content rule ID
        required: true
    output:
      lb_algorithm:
        title: Load Balancing Algorithm
        type: string
        description: The algorithm to be used for load balancing
        required: true
      extended_match_sequence:
        title: Extended Match Sequence
        type: integer
        description: The number to indicate the order in which the extended match
          rule must be evaluated in the requests
        required: true
      name:
        title: Name
        type: string
        description: Name of content rule
        required: true
      host_match:
        title: Host Match
        type: string
        description: The host name to be matched against the host in the request header
        required: true
      comments:
        title: Comments
        type: string
        description: Description about the content rule
        required: true
      extended_match:
        title: Extended Match
        type: string
        description: The expression that consists of a combination of HTTP headers
          and/or query string parameters
        required: true
      service_name:
        title: Service Name
        type: string
        description: Service name
        required: true
      url_match:
        title: URL Match
        type: string
        description: The URL to be matched to the URL in the request header
        required: true
      id:
        title: ID
        type: string
        description: ID content rule
        required: true
      servers:
        title: Servers
        type: array
        description: Servers info
        required: true
      persistence_method:
        title: Persistance Method
        type: string
        description: The Persistence Method to be used to maintain the connection
          between a client and the first server that it connects to, even when the
          system is load balancing traffic
        required: true
  delete_content_rule:
    title: Delete Content Rule
    description: Deletes the given content rule
    input:
      virtual_service_id:
        title: Virtual Service ID
        type: string
        description: Virtual Service ID
        required: true
      id:
        title: ID
        type: string
        description: Content rule ID
        required: true
    output:
      msg:
        title: Message
        type: string
        description: Message of deleted
        required: true
  update_content_rule:
    title: Update Content Rule
    description: Updates the values of given parameters in the given content rule
    input:
      virtual_service_id:
        title: Virtual Service ID
        type: string
        description: Virtual Service ID
        required: true
      id:
        title: ID
        type: string
        description: Content rule ID
        required: true
      lb_algorithm:
        title: Load Balancing Algorithm
        type: string
        description: The algorithm to be used for load balancing
        required: true
        enum:
        - round_robin
        - weighted_round_robin
        - least_requests
      status:
        title: Status
        type: string
        description: The status of the content rule
        required: false
        enum:
        - 'on'
        - 'off'
      web_firewall_policy:
        title: Web Firewall Policy
        type: string
        description: A web firewall policy to be associated with the content rule
        required: false
        enum:
        - default
        - sharepoint
        - sharepoint2013
        - owa
        - owa2010
        - owa2013
        - oracle
      host_match:
        title: Host Match
        type: string
        description: A host name to be matched against the host in the request header
        required: false
      url_match:
        title: URL Match
        type: string
        description: A URL to be matched to the URL in the request header
        required: false
      extended_match:
        title: Extended Match
        type: string
        description: An expression that consists of a combination of HTTP headers
          and/or query string parameters
        required: false
      extended_match_sequence:
        title: Extended Match Sequence
        type: integer
        description: A number to indicate the order in which the extended match rule
          must be evaluated in the requests
        required: false
      persistence_method:
        title: Persistence Method
        type: string
        description: The Persistence Method to be used to maintain the connection
          between a client and the first server that it connects to, even when the
          system is load balancing traffic
        required: false
      failover_method:
        title: Failover Method
        type: string
        description: The failover method to be used when responding to a request which
          is persistent, but the server that must serve the request is failed or set
          to 'Out-of-Service'
        required: false
      persistence_idle_timeout:
        title: Persistence Idle Timeout
        type: integer
        description: The maximum idle time (in seconds) for a persistent connection.
          A client is directed to the same Real Server unless the connection is inactive
          for more than the specified number of seconds
        required: false
      source_ip_netmask:
        title: Source IP Netmask
        type: integer
        description: A subnet mask to make subsequent connections from clients, from
          the same subnet go to the same Real Server
        required: false
      persistence_cookie_name:
        title: Persistence Cookie Name
        type: string
        description: The name of the cookie that will be used for persistence
        required: false
      persistence_cookie_path:
        title: Persistence Cookie Path
        type: string
        description: The path property of the persistency cookie
        required: false
      persistence_cookie_domain:
        title: Persistence Cookie Domain
        type: string
        description: The domain name of the server of a persistency cookie
        required: false
      cookie_age:
        title: Cookie Age
        type: integer
        description: The expiry age of the persistence cookie in minutes
        required: false
      header_name:
        title: Header Name
        type: string
        description: The name of the header for which the value needs to be checked
          in the HTTP requests
        required: false
      parameter_name:
        title: Parameter Name
        type: string
        description: The name of the parameter for which the value needs to be checked
          in the URL
        required: false
      comments:
        title: Comments
        type: string
        description: Description about the content rule
        required: false
    output:
      id:
        title: ID
        type: string
        description: Content rule ID
        required: true
