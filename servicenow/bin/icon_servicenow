#!/usr/bin/env python
# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
from icon_servicenow import connection, actions, triggers


Name = 'ServiceNow'
Vendor = 'rapid7'
Version = '3.1.1'
Description = 'ServiceNow is a tool for managing incidents and configuration management. Using the ServiceNow plugin for Rapid7 InsightConnect, users can manage all aspects of incidents including creation, search, updates, as well as monitor them for changes'


class ICONServicenow(komand.Plugin):
    def __init__(self):
        super(self.__class__, self).__init__(
                name=Name, 
                vendor=Vendor, 
                version=Version,
                description=Description,
                connection=connection.Connection()
                )
        self.add_trigger(triggers.IncidentChanged())

        self.add_action(actions.CreateCi())

        self.add_action(actions.CreateIncident())

        self.add_action(actions.DeleteIncident())

        self.add_action(actions.DeleteIncidentAttachment())

        self.add_action(actions.GetCi())

        self.add_action(actions.GetIncidentAttachment())

        self.add_action(actions.GetIncidentCommentsWorknotes())

        self.add_action(actions.PutIncidentAttachment())

        self.add_action(actions.ReadIncident())

        self.add_action(actions.SearchCi())

        self.add_action(actions.SearchIncident())

        self.add_action(actions.SearchIncidentAttachment())

        self.add_action(actions.UpdateCi())

        self.add_action(actions.UpdateIncident())


def main():
    """Run plugin"""
    cli = komand.CLI(ICONServicenow())
    cli.run()


if __name__ == "__main__":
    main()
