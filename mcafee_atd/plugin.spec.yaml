plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: mcafee_atd
title: McAfee Advanced Threat Defense
description: McAfee Advanced Threat Defense provides an API framework for external applications to access core McAfeeATD functions through the REST protocol
version: 1.5.0
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/mcafee_atd
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.mcafee.com
tags:
  - mcafee
  - atd
  - advanced
  - threat
  - defense
hub_tags:
  use_cases: [threat_detection_and_response, reporting_and_analytics]
  keywords: [mcafee, atd, advanced, threat, defense]
  features: []
types:
  output:
    userid:
      title: User ID
      type: integer
      description: User ID
      required: false
    taskid:
      title: Task ID
      type: integer
      description: Task ID
      required: false
    istate:
      title: Istate
      type: integer
      description: Istate
      required: false
    status:
      title: Status
      type: string
      description: Status
      required: false
    filename:
      title: Filename
      type: string
      description: Filename
      required: false
    md5:
      title: MD5
      type: string
      description: MD5
      required: false
    vmProfile:
      title: VM Profile
      type: string
      description: VM profile
      required: false
    jobid:
      title: Job ID
      type: integer
      description: Job ID
      required: false
    submitTime:
      title: Submit Time
      type: string
      description: Submit time
      required: false
    summaryFiles:
      title: Summary Files
      type: string
      description: Summary files
      required: false
    useLogs:
      title: Use Logs
      type: string
      description: Use logs
      required: false
    asmListing:
      title: Asm Listing
      type: string
      description: Asm listing
      required: false
    PEInfo:
      title: PE info
      type: string
      description: PE info
      required: false
    family:
      title: Family
      type: string
      description: Family
      required: false
    vmName:
      title: VM Name
      type: string
      description: VM name
      required: false
    vmDesc:
      title: VM Desc
      type: string
      description: VM desc
      required: false
  job:
    status:
      title: Status
      type: integer
      description: Status
      required: false
    allEngineState:
      title: All Engine State
      type: integer
      description: All engine state
      required: false
    severity:
      title: Severity
      type: integer
      description: Severity
      required: false
  results:
    cache:
      title: Cache
      type: integer
      description: Cache
      required: false
    destIp:
      title: Destination IP
      type: string
      description: Destination IP
      required: false
    file:
      title: File
      type: string
      description: File
      required: false
    md5:
      title: MD5
      type: string
      description: MD5
      required: false
    messageId:
      title: Message ID
      type: string
      description: Message ID
      required: false
    sha1:
      title: SHA1
      type: string
      description: SHA1
      required: false
    sha256:
      title: SHA256
      type: string
      description: SHA256
      required: false
    size:
      title: Size
      type: string
      description: Size
      required: false
    srcIp:
      title: Source IP
      type: string
      description: Source IP
      required: false
    submitType:
      title: Submit Type
      type: string
      description: Submit type
      required: false
    taskId:
      title: Task ID
      type: integer
      description: Task ID
      required: false
    url:
      title: URL
      type: string
      description: URL
      required: false
  submit_info:
    estimatedTime:
      title: Estimated Time
      type: integer
      description: Estimated time
      required: false
    fileId:
      title: File ID
      type: string
      description: File ID
      required: false
    filesWait:
      title: Files Wait
      type: integer
      description: Files wait
      required: false
    mimeType:
      title: MIME Type
      type: string
      description: MIME type
      required: false
    results:
      title: Results
      type: "[]results"
      description: Results
      required: false
    subId:
      title: Sub ID
      type: integer
      description: Sub ID
      required: false
    success:
      title: Success
      type: boolean
      description: Success
      required: false
  profiler_results:
    artimas:
      title: Artimas
      type: integer
      description: Artimas
      required: false
    asm:
      title: Asm
      type: integer
      description: Asm
      required: false
    aviraAV:
      title: Avira AV
      type: integer
      description: Avira AV
      required: false
    consoleLog:
      title: Console Log
      type: integer
      description: Console log
      required: false
    createTime:
      title: Create Time
      type: string
      description: Create time
      required: false
    customrules:
      title: Customrules
      type: integer
      description: Customrules
      required: false
    default32OSName:
      title: Default 32OS Name
      type: string
      description: Default 32OS name
      required: false
    default64OSName:
      title: Default 64OS Name
      type: string
      description: Default 64OS name
      required: false
    defaultVM:
      title: Default VM
      type: integer
      description: Default VM
      required: false
    dnnEnable:
      title: DNN Enable
      type: integer
      description: DNN enable
      required: false
    dropZip:
      title: Drop ZIP
      type: integer
      description: Drop ZIP
      required: false
    dumpZip:
      title: Dump ZIP
      type: integer
      description: Dump ZIP
      required: false
    family:
      title: Family
      type: integer
      description: Family
      required: false
    filePassword:
      title: File Password
      type: string
      description: File password
      required: false
    filePassword1:
      title: File Password 1
      type: string
      description: File password 1
      required: false
    flp:
      title: FLP
      type: integer
      description: FLP
      required: false
    gam:
      title: GAM
      type: integer
      description: GAM
      required: false
    gml:
      title: GML
      type: integer
      description: GML
      required: false
    gtiTS:
      title: GTI TS
      type: integer
      description: GTI TS
      required: false
    gtiURLRep:
      title: GTI URL REP
      type: integer
      description: GTI URL REP
      required: false
    heuristic:
      title: Heuristic
      type: integer
      description: Heuristic
      required: false
    imageid:
      title: Image ID
      type: integer
      description: Image ID
      required: false
    internet:
      title: Internet
      type: integer
      description: Internet
      required: false
    lastChange:
      title: Last Change
      type: string
      description: Last change
      required: false
    locBlackList:
      title: Loc Blacklist
      type: integer
      description: Loc blacklist
      required: false
    locWhiteList:
      title: Loc Whitelist
      type: integer
      description: Loc whitelist
      required: false
    logZip:
      title: Log ZIP
      type: integer
      description: Log ZIP
      required: false
    maxExecTime:
      title: Max Exec Time
      type: integer
      description: Max exec time
      required: false
    memorydump:
      title: Memory Dump
      type: integer
      description: Memory dump
      required: false
    mfeAV:
      title: MFE AV
      type: integer
      description: MFE AV
      required: false
    minExecTime:
      title: Min Exec Time
      type: integer
      description: Min exec time
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    netLog:
      title: Net Log
      type: integer
      description: Net log
      required: false
    netdriveZip:
      title: Net Drive ZIP
      type: integer
      description: Net drive ZIP
      required: false
    noPDF:
      title: No PDF
      type: integer
      description: No PDF
      required: false
    ntvLog:
      title: Ntv Log
      type: integer
      description: Ntv log
      required: false
    openarchive:
      title: Openarchive
      type: integer
      description: Openarchive
      required: false
    overrideOS:
      title: Override OS
      type: integer
      description: Override OS
      required: false
    pe32:
      title: PE32
      type: integer
      description: PE32
      required: false
    reAnalysis:
      title: Re Analysis
      type: integer
      description: Re analysis
      required: false
    recusiveAnalysis:
      title: Recusive Analysis
      type: integer
      description: Recusive analysis
      required: false
    runtimeArgument:
      title: Runtime Argument
      type: string
      description: Runtime argument
      required: false
    sandbox:
      title: Sandbox
      type: integer
      description: Sandbox
      required: false
    selectedOSName:
      title: Selected OS Name
      type: string
      description: Selected OS name
      required: false
    sophosAV:
      title: Sophos AV
      type: integer
      description: Sophos AV
      required: false
    ssAPIid:
      title: SS API ID
      type: integer
      description: SS API ID
      required: false
    ssKeyid:
      title: SS Key ID
      type: integer
      description: SS key ID
      required: false
    ssLevelid:
      title: SS Level ID
      type: integer
      description: SS level ID
      required: false
    summary:
      title: Summary
      type: integer
      description: Summary
      required: false
    userLog:
      title: User Log
      type: integer
      description: User log
      required: false
    userid:
      title: User ID
      type: integer
      description: User ID
      required: false
    vmDesc:
      title: VM Desc
      type: string
      description: VM desc
      required: false
    vmProfileid:
      title: VM Profileid
      type: integer
      description: VM profileid
      required: false
    xMode:
      title: X Mode
      type: integer
      description: X mode
      required: false
    yaraScan:
      title: Yara Scan
      type: integer
      description: Yara scan
      required: false
    yararules:
      title: Yara Rules
      type: integer
      description: Yara rules
      required: false
connection:
  url:
    title: URL
    description: Base URL for the McAfee Advanced Threat Defense server
    type: string
    required: true
    example: https://www.example.com
  credentials:
    title: Credentials
    description: Username and password
    type: credential_username_password
    required: true
    example: '{"username":"user1", "password":"mypassword"}'
  verify_ssl:
    title: Verify TLS/SSL
    type: boolean
    description: Verify the server's TLS/SSL certificate
    default: true
    required: false
    example: true
  port:
    title: Port
    description: The port number for provided host
    type: integer
    default: 443
    required: false
    example: 443
actions:
  submit_hash:
    title: Check Hash Status
    description: Check if a MD5 hash is blacklisted or whitelisted
    input:
      hash:
        title: MD5 Hash
        description: MD5 Hash to submit
        type: string
        required: true
        example: 9de5069c5afe602b2ea0a04b66beb2c0
    output:
      success:
        title: Success
        description: Success status of submit Hash request
        type: boolean
        required: true
      results:
        title: Results
        description: Return information about given MD5 Hash
        type: object
        required: true
  check_analysis_status:
    title: Check Analysis Status
    description: Checks the analysis status
    input:
      analysis_id:
        title: Analysis ID
        description: Task ID or job ID value which is returned in submission step
        type: integer
        required: true
        example: 13
      type:
        title: Type
        description: Type of ID, default value is task
        type: string
        required: false
        default: task
        enum:
          - task
          - job
    output:
      success:
        title: Success
        description: Success status of analysis ID
        type: boolean
        required: false
      results:
        title: Results
        description: Return information about given Task ID
        type: output
        required: false
      job_results:
        title: Job Results
        description: Return information about given Job ID
        type: job
        required: false
  submit_url:
    title: Submit URL
    description: Upload URL for dynamic analysis
    input:
      url:
        title: URL
        description: URL for analysis
        type: string
        required: true
        example: https://www.example.com
      submit_type:
        title: Submit Type
        description: URL to submit for analysis (https://www.example.com) or file to analyze from a URL (e.g. https://www.example.com/PDF/14274les19.pdf)
        type: string
        required: false
        default: URL submission
        enum:
          - URL submission
          - File from URL
    output:
      submit_url_info:
        title: Submit URL Info
        description: Information about submitted URL
        type: submit_info
        required: false
  submit_file:
    title: Submit File
    description: Upload file for dynamic analysis
    input:
      file:
        title: File
        description: File for analysis
        type: file
        required: true
        example: '{"filename": "setup.exe", "content": "UmFwaWQ3IEluc2lnaHRDb25uZWN0Cg=="}'
      url_for_file:
        title: File URL
        description: You can also submit the URL from which the file is downloaded. In this case, a McAfee GTI URL look up is done on the submitted URL in addition to file analysis
        type: string
        required: false
        example: https://www.example.com/download/latest
    output:
      submit_file_info:
        title: Submit File Info
        description: Information about submitted file
        type: submit_info
        required: false
  list_analyzer_profiles:
    title: List Analyzer Profiles
    description: Display the analyzer profiles to which the user has access
    output:
      profiler_results:
        title: Profiler Results
        description: Displays the analyzer profiles, which the user can access
        type: "[]profiler_results"
        required: true
      success:
        title: Success
        description: Returns true if found information about analyzer profiles
        type: boolean
        required: true
  get_report:
    title: Get Report
    description: Download the report of an analysis
    input:
      id:
        title: ID
        description: The Task ID, job ID, or MD5 value for the prepared analysis report
        type: string
        required: true
        example: 13
      type_id:
        title: Type ID
        description: Type of given ID parameter, the type must match the value of the ID field. The default value is MD5
        type: string
        required: false
        default: MD5
        example: TASK ID
        enum:
          - MD5
          - TASK ID
          - JOB ID
      report_type:
        title: Report Type
        description: The file type of the report to return in the file output
        type: string
        required: false
        default: HTML
        example: HTML
        enum:
          - HTML
          - TXT
          - ZIP
          - XML
          - IOC
          - STIX
          - PDF
          - SAMPLE
    output:
      file:
        title: File
        description: Prepared analysis report
        type: bytes
        required: true
      report:
        title: Report
        description: Return report in JSON
        type: object
        required: false
