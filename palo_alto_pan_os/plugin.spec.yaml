plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: palo_alto_pan_os
title: Palo Alto Firewall
description: Manage Palo Alto Networks firewall devices
version: 6.0.4
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/palo_alto_pan_os
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.paloaltonetworks.com/
tags:
- pan os
- firewall
- palo alto
hub_tags:
  use_cases: [asset_inventory, threat_detection_and_response]
  keywords: [pan os, firewall, palo alto]
  features: []
types:
  config:
    data:
      type: object
  log:
    data:
      type: object
connection:
  server:
    title: Server
    type: string
    description: URL pointing to instance of Panorama or an individual Palo Alto firewall
    required: true
    example: http://www.example.com
  credentials:
    title: Credentials
    description: Username and password
    type: credential_username_password
    required: true
    example: '{"username":"username", "password":"password"}'
  verify_cert:
    title: Verify Cert
    type: boolean
    description: If true, validate the server's TLS certificate when contacting the firewall
      over HTTPS
    required: true
    example: true
actions:
  set_security_policy_rule:
    title: Set Security Policy Rule
    description: Creates a new Security Policy Rule
    input:
      rule_name:
        title: Rule Name
        description: Name of the rule
        example: InsightConnect Block Rule
        type: string
        required: true
      source:
        title: Source
        description: Sources for which this rule will be applied e.g. 10.0.0.1, computername,
          any
        type: string
        required: true
        example: any
      destination:
        title: Destination
        description: Destinations for which this rule will be applied e.g. 10.0.0.1,
          computername, any
        type: string
        required: true
        example: any
      service:
        title: Service
        description: Service type for which this rule will be applied e.g. HTTP, HTTPS,
          any
        type: string
        required: true
        example: any
      application:
        title: Application
        description: Applications for which this rule will be applied e.g. adobe-cloud,
          dropbox,  any
        type: string
        required: true
        example: any
      action:
        title: Action
        description: Action that will occur if an event meets the rule definitions
        type: string
        required: true
        example: drop
      source_user:
        title: Source User
        description: User that the network traffic originated from e.g. Joe Smith,
          any
        type: string
        required: true
        example: any
      disable_server_response_inspection:
        title: Disable Server Response Inspection
        description: If true, the firewall will not inspect this traffic
        type: boolean
        required: true
        example: false
      negate_source:
        title: Negate Source
        description: Negate source
        type: boolean
        required: true
        example: false
      negate_destination:
        title: Negate Destination
        description: Negate destination
        type: boolean
        required: true
        example: false
      disabled:
        title: Disabled
        description: If true, rule is disabled
        type: boolean
        required: true
        example: false
      log_start:
        title: Log Start
        description: Generates a traffic log entry for the start of a session
        type: boolean
        required: true
        example: false
      log_end:
        title: Log End
        description: Generates a traffic log entry for the end of a session
        type: boolean
        required: true
        example: false
      description:
        title: Description
        description: Description of the rule and what it does
        type: string
        required: true
        example: Block Rule
      src_zone:
        title: SRC Zone
        description: Zone in which the traffic originated e.g. server zone, any
        type: string
        required: true
        example: any
      dst_zone:
        title: DST Zone
        description: Zone which the traffic is going to e.g. server zone, any
        type: string
        required: true
        example: any
    output:
      response:
        title: Response
        description: Response from the firewall
        type: config
        required: false
  show:
    title: Show
    description: Gets active configuration
    input:
      xpath:
        title: Xpath
        type: string
        description: Xpath targeting the requested portion of the configuration
        required: true
        example: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']
    output:
      response:
        title: Response
        description: Response from the firewall
        type: config
        required: false
  get:
    title: Get
    description: Get candidate configuration
    input:
      xpath:
        title: Xpath
        type: string
        description: Xpath targeting the requested portion of the configuration
        required: true
        example: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/address-group/entry[@name='test_group']
    output:
      response:
        title: Response
        description: Response from the firewall
        type: config
        required: false
  delete:
    title: Delete
    description: Delete an object
    input:
      xpath:
        title: Xpath
        type: string
        description: Xpath targeting the object to delete
        required: true
        example: /config/devices/entry[@name='localhost.localdomain']/vsys/entry[@name='vsys1']/address-group/entry[@name='test_group']
    output:
      response:
        title: Response
        description: Response from the firewall
        type: config
        required: false
  set:
    title: Set
    description: Create a new object
    input:
      xpath:
        title: Xpath
        type: string
        description: Xpath location to create the new object
        required: true
        example: /config/devices/entry/vsys/entry/rulebase/security/rules/entry[@name='test rule']
      element:
        title: Element
        type: string
        description: XML representation of the object to be created
        required: true
        example: "<application><member>8x8</member></application>"
    output:
      response:
        title: Response
        description: Response from the firewall
        type: object
        required: false
  edit:
    title: Edit
    description: Edit an existing object
    input:
      xpath:
        title: Xpath
        type: string
        description: Xpath location of the object to edit
        required: true
        example: /config/devices/entry/vsys/entry/rulebase/security/rules/entry[@name='test rule']/application
      element:
        title: Element
        type: string
        description: XML representation of the updated object. This replaces the previous
          object entirely, any unchanged attributes must be restated
        required: true
        example: "<application><member>8x8</member></application>"
    output:
      response:
        title: Response
        description: Response from the firewall
        type: object
        required: false
  commit:
    title: Commit
    description: Commits the candidate configuration
    input:
      cmd:
        title: CMD
        type: string
        description: XML specifying any commit arguments
        required: true
        example: "<commit></commit>"
      action:
        title: Action
        type: string
        description: 'Commit action (Default: ''all'')'
        default: all
        required: false
        example: all
    output:
      response:
        title: Response
        description: Response from the firewall
        type: object
        required: false
  op:
    title: Op
    description: Runs operational command
    input:
      cmd:
        title: CMD
        type: string
        description: XML specifying operation to be completed
        required: false
        example: "<show><commit-locks/></show>"
    output:
      response:
        title: Response
        description: Response from the firewall
        type: object
        required: false
  retrieve_logs:
    title: Retrieve Logs
    description: Queries firewall logs
    input:
      log_type:
        title: Log Type
        type: string
        description: Type of log to retrieve
        enum:
        - config
        - hipmatch
        - system
        - threat
        - traffic
        - url
        - wildfire
        required: false
        example: config
      count:
        title: Count
        type: integer
        description: 'Number of logs to retrieve (Max: 500, Default: 20)'
        default: 20
        required: false
        example: 20
      skip:
        title: Skip
        type: integer
        description: 'Log retrieval offset, number of entries to skip, (Default: 0)'
        default: 0
        required: false
        example: 0
      filter:
        title: Filter
        type: string
        description: Search query. Format as a log filter expression
        required: false
        example:
      interval:
        title: Interval
        type: float
        description: 'Time interval in seconds to wait between queries for commit
          job completion (Default: 0.5)'
        default: 0.5
        required: false
        example: 0.5
      max_tries:
        title: Max Tries
        type: integer
        description: 'Maximum number of times to poll for job completion before timing
          out (Default: 25)'
        default: 25
        required: false
        example: 25
      direction:
        title: Direction
        type: string
        description: Order in which to return the logs
        enum:
        - backward
        - forward
        required: false
        example: backward
    output:
      response:
        title: Response
        description: Response from the firewall
        type: log
        required: false
  add_to_policy:
    title: Add to Policy
    description: Add a rule to a firewall security policy
    input:
      rule_name:
        title: Rule Name
        description: Name of the rule
        type: string
        required: true
        example: InsightConnect Block Rule
      update_active_or_candidate_configuration:
        title: Update Active or Candidate Configuration
        description: Will apply the update to the active or candidate configuration.
          If active is chosen any uncommitted candidate configuration will be lost
        type: string
        required: true
        enum:
        - active
        - candidate
        example: active
      source:
        title: Source
        description: A source for which this rule will be applied e.g. 10.0.0.1, computername,
          or any
        type: string
        required: false
        example: any
      destination:
        title: Destination
        description: A destination for which this rule will be applied e.g. 10.0.0.1,
          computername, or any
        type: string
        required: false
        example: any
      service:
        title: Service
        description: Service type for which this rule will be applied e.g. HTTP, HTTPS,
          or any
        type: string
        required: false
        example: any
      application:
        title: Application
        description: Application for which this rule will be applied e.g. adobe-cloud,
          dropbox, or  any
        type: string
        required: false
        example: any
      source_user:
        title: Source User
        description: User that the network traffic originated from e.g. Joe Smith,
          or any
        type: string
        required: false
        example: Joe Smith
      src_zone:
        title: SRC Zone
        description: Zone in which the traffic originated e.g. server zone, or any
        type: string
        required: false
        example: any
      dst_zone:
        title: DST Zone
        description: Zone which the traffic is going to e.g. server zone, or any
        type: string
        required: false
        example: any
      url_category:
        title: URL Category
        description: The URL category e.g. adult
        type: string
        required: false
        example: adult
      hip_profiles:
        title: HIP Profiles
        description: Host information profile
        type: string
        required: false
        example: any
      action:
        title: Action
        description: Action that will occur if an event meets the rule definitions
        type: string
        required: false
        example: drop
    output:
      status:
        title: Status
        description: Status of the requested operation e.g. success, error, etc
        type: string
        required: false
      code:
        title: Code
        description: Response code from firewall
        type: string
        required: false
      message:
        title: Message
        description: A message with more detail about the status
        type: string
        required: false
  remove_from_policy:
    title: Remove from Policy
    description: Remove a rule from a firewall security policy
    input:
      rule_name:
        title: Rule Name
        description: Name of the rule
        type: string
        required: true
        example: InsightConnect Block Rule
      update_active_or_candidate_configuration:
        title: Update Active or Candidate Configuration
        description: Will apply the update to the active or candidate configuration.
          If active is chosen any uncommitted candidate configuration will be lost
        type: string
        required: true
        enum:
        - active
        - candidate
        example: active
      source:
        title: Source
        description: A source for which this rule will be applied e.g. 10.0.0.1, computername,
          or any
        type: string
        required: false
        example: any
      destination:
        title: Destination
        description: A Destination for which this rule will be applied e.g. 10.0.0.1,
          computername, or any
        type: string
        required: false
        example: any
      service:
        title: Service
        description: Service type for which this rule will be applied e.g. HTTP, HTTPS,
          any
        type: string
        required: false
        example: any
      application:
        title: Application
        description: Application for which this rule will be applied e.g. adobe-cloud,
          dropbox, or any
        type: string
        required: false
        example: any
      source_user:
        title: Source User
        description: User that the network traffic originated from e.g. Joe Smith,
          or any
        type: string
        required: false
        example: any
      src_zone:
        title: SRC Zone
        description: Zone in which the traffic originated e.g. server zone, or any
        type: string
        required: false
        example: any
      dst_zone:
        title: DST Zone
        description: Zone which the traffic is going to e.g. server zone, or any
        type: string
        required: false
        example: any
      url_category:
        title: URL Category
        description: The URL category e.g. adult
        type: string
        required: false
        example: adult
      hip_profiles:
        title: HIP Profiles
        description: Host information profile
        type: string
        required: false
        example: any
      action:
        title: Action
        description: The action that will occur if an event meets the rule definitions
        type: string
        required: false
        example: drop
    output:
      status:
        title: Status
        description: Status of the requested operation e.g. success, error, etc
        type: string
        required: false
      code:
        title: Code
        description: Response code from the firewall
        type: string
        required: false
      message:
        title: Message
        description: A message with more detail about the status
        type: string
        required: false
  add_external_dynamic_list:
    title: Add External Dynamic List
    description: Add an external dynamic list
    input:
      name:
        title: The Name of the List
        description: An arbitrary name for the list. This name will be used to identify
          the list in the firewall
        type: string
        required: true
        example: IP List
      list_type:
        title: List Type
        description: The type of list
        type: string
        required: true
        enum:
        - IP List
        - Domain List
        - URL List
        example: IP List
      description:
        title: Description
        description: A description of the list
        type: string
        required: true
        example: List of IP's
      source:
        title: Source
        description: The web site you will pull the list from e.g. https://www.example.com/test.txt
        type: string
        required: true
        example: https://www.example.com/test.txt
      repeat:
        title: Repeat
        description: The interval at which to retrieve updates from the list
        type: string
        required: true
        enum:
        - Five Minute
        - Hourly
        - Daily
        - Weekly
        example: Five Minute
      time:
        title: Time
        description: 'If repeat is daily or weekly, choose an hour on a 24 hour clock
          to update (Default: '''')'
        type: string
        required: true
        enum:
        - ''
        - '00'
        - '01'
        - '02'
        - '03'
        - '04'
        - '05'
        - '06'
        - '07'
        - '08'
        - '09'
        - '10'
        - '11'
        - '12'
        - '13'
        - '14'
        - '15'
        - '16'
        - '17'
        - '18'
        - '19'
        - '20'
        - '21'
        - '22'
        - '23'
        default: ''
        example: '00'
      day:
        title: Day
        description: If repeat is weekly, choose a day to update
        type: string
        required: true
        enum:
        - ''
        - Monday
        - Tuesday
        - Wednesday
        - Thursday
        - Friday
        - Saturday
        - Sunday
        default: ''
        example: Monday
    output:
      status:
        title: Status
        description: The status of the requested operation e.g. success, error, etc
        type: string
        required: false
      code:
        title: Code
        description: Response code from the firewall
        type: string
        required: false
      message:
        title: Message
        description: A message with more detail about the status
        type: string
        required: false
  set_address_object:
    title: Create Address Object
    description: Create a new address object. Supports IPv6
    input:
      address:
        title: Address
        description: The IP address, network CIDR, or FQDN e.g. 192.168.1.1, 192.168.1.0/24, google.com
          google.com
        type: string
        example: 1.1.1.1
        required: true
      address_object:
        title: Address Object
        description: The name of the address object
        type: string
        example: Blocked host
        required: true
      description:
        title: Description
        description: A description for the address object
        type: string
        example: Blocked host from Insight Connect
        required: false
      tags:
        title: Tags
        description: Tags for the address object. Use commas to separate multiple
          tags
        type: string
        example: malware
        required: false
      skip_rfc1918:
        title: Skip RFC 1918 (Private) IP Addresses
        description: Skip private IP addresses as defined in RFC 1918
        type: boolean
        example: true
        required: true
        default: false
      whitelist:
        title: Whitelist
        description: This list contains a set of network objects that should not be blocked. This can include IPs, CIDR notation, or domains. It can not include an IP range (such as 10.0.0.0-10.0.0.10)
        type: "[]string"
        example: ["198.51.100.100", "192.0.2.0/24", "example.com"]
        required: false
    output:
      status:
        title: Status
        description: The status of the requested operation e.g. success, error, etc
        type: string
        required: false
      code:
        title: Code
        description: Response code from the firewall
        type: string
        required: false
      message:
        title: Message
        description: A message with more detail about the status
        type: string
        required: false
  get_policy:
    title: Get Policy
    description: Get a policy by name
    input:
      policy_name:
        title: Policy Name
        description: Policy name
        type: string
        required: true
        order: 1
        example: InsightConnect Block Policy
      device_name:
        title: Device Name
        description: Device name
        type: string
        default: "localhost.localdomain"
        required: true
        example: "localhost.localdomain"
        order: 2
      virtual_system:
        title: Virtual System Name
        description: Virtual system name
        type: string
        default: vsys1
        example: vsys1
        required: true
        order: 3
    output:
      to:
        title: To
        description: To
        type: "[]string"
        required: false
      from:
        title: From
        description: From
        type: "[]string"
        required: false
      source:
        title: Source
        description: Source
        type: "[]string"
        required: false
      destination:
        title: Destination
        description: Destination
        type: "[]string"
        required: false
      source_user:
        title: Source User
        description: Source user
        type: "[]string"
        required: false
      category:
        title: Category
        description: Category
        type: "[]string"
        required: false
      application:
        title: Application
        description: Application
        type: "[]string"
        required: false
      service:
        title: Service
        description: Service
        type: "[]string"
        required: false
      hip_profiles:
        title: HIP Profiles
        description: Host Information in Policy Enforcement profile
        type: "[]string"
        required: false
      action:
        title: Action
        description: Action
        type: "string"
        required: false
  check_if_address_object_in_group:
    title: Check if Address in Group
    description: Checks to see if an IP address, CIDR IP address, or domain is in an Address Group. Supports IPv6
    input:
      group:
        title: Group
        description: Group name
        type: string
        example: InsightConnect Block List
        required: true
        order: 1
      address:
        title: Address
        description: The Address Object name to check. If Enable Search is set to true then we search the addresses (IP, CIDR, domain) within the address object instead of matching the name
        type: string
        example: 198.51.100.100
        required: true
        order: 2
      enable_search:
        title: Enable Search
        description: When enabled, the Address input will accept a IP, CIDR, or domain name to search across the available Address Objects in the system. This is useful when you don’t know the Address Object by its name
        type: boolean
        example: false
        default: false
        required: true
        order: 3
      device_name:
        title: Device Name
        description: Device name
        type: string
        default: localhost.localdomain
        example: localhost.localdomain
        required: true
        order: 4
      virtual_system:
        title: Virtual System Name
        description: Virtual system name
        type: string
        default: vsys1
        example: vsys1
        required: true
        order: 5
    output:
      found:
        title: Found
        description: Was address found in group
        type: boolean
        required: true
      address_objects:
        title: Address Objects
        description: The names of the address objects that match or contain address
        type: "[]string"
        required: false
  remove_address_object_from_group:
    title: Remove Address Object from Group
    description: Removes an address object from an address group. Supports IPv6
    input:
      address_object:
        title: Address Object
        description: The name of the address object to remove
        type: string
        example: Malicious Host
        required: true
        order: 1
      group:
        title: Group
        description: Group name
        type: string
        example: InsightConnect Block List
        required: true
        order: 2
      device_name:
        title: Device Name
        description: Device name
        type: string
        default: localhost.localdomain
        example: localhost.localdomain
        required: true
        order: 3
      virtual_system:
        title: Virtual System Name
        description: Virtual system name
        type: string
        default: vsys1
        example: vsys1
        required: true
        order: 4
    output:
      success:
        title: Success
        description: Was operation successful
        type: boolean
        required: true
  add_address_object_to_group:
    title: Add Address Object to Group
    description: Adds an address object to an address group. Supports IPv6
    input:
      address_object:
        title: Address Object
        description: The name of the address object to add
        type: string
        example: 198.51.100.100
        required: true
        order: 1
      group:
        title: Group
        description: Group name
        type: string
        example: InsightConnect Block List
        required: true
        order: 2
      device_name:
        title: Device Name
        description: Device name
        type: string
        default: localhost.localdomain
        example: localhost.localdomain
        required: true
        order: 3
      virtual_system:
        title: Virtual System Name
        description: Virtual system name
        type: string
        default: vsys1
        example: vsys1
        required: true
        order: 4
    output:
      success:
        title: Success
        description: Was operation successful
        type: boolean
        required: true
      address_objects:
        title: Address Objects
        description: Address objects currently in group
        type: "[]string"
        required: true
