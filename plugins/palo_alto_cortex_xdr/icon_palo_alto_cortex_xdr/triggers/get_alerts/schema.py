# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Get alerts"


class Input:
    FREQUENCY = "frequency"


class Output:
    ALERT = "alert"


class GetAlertsInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "frequency": {
      "type": "integer",
      "description": "Poll frequency in seconds",
      "default": 5,
      "order": 1
    }
  },
  "definitions": {}
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class GetAlertsOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "alert": {
      "$ref": "#/definitions/alert",
      "title": "Alert",
      "description": "Alert",
      "order": 1
    }
  },
  "definitions": {
    "alert": {
      "type": "object",
      "title": "alert",
      "properties": {
        "agent_os_sub_type": {
          "type": "string",
          "title": "Agent OS Sub Type",
          "description": "The subtype of the operating system running on the agent.",
          "order": 1
        },
        "category": {
          "type": "string",
          "title": "Category",
          "description": "The general category of the event.",
          "order": 2
        },
        "causality_actor_process_command_line": {
          "type": "array",
          "title": "Causality Actor Process Command Line",
          "description": "The command line arguments of the causality actor process.",
          "items": {
            "type": "string"
          },
          "order": 3
        },
        "causality_actor_process_image_md5": {
          "type": "array",
          "title": "Causality Actor Process Image MD5",
          "description": "The MD5 hash of the causality actor process image.",
          "items": {
            "type": "string"
          },
          "order": 4
        },
        "causality_actor_process_image_name": {
          "type": "array",
          "title": "Causality Actor Process Image Name",
          "description": "The name of the causality actor process image.",
          "items": {
            "type": "string"
          },
          "order": 5
        },
        "causality_actor_process_image_path": {
          "type": "array",
          "title": "Causality Actor Process Image Path",
          "description": "The path to the causality actor process image.",
          "items": {
            "type": "string"
          },
          "order": 6
        },
        "causality_actor_process_image_sha256": {
          "type": "array",
          "title": "Causality Actor Process Image SHA256",
          "description": "The SHA256 hash of the causality actor process image.",
          "items": {
            "type": "string"
          },
          "order": 7
        },
        "causality_actor_process_signature_status": {
          "type": "array",
          "title": "Causality Actor Process Signature Status",
          "description": "The status of the signature associated with the causality actor process.",
          "items": {
            "type": "string"
          },
          "order": 8
        },
        "causality_actor_process_signature_vendor": {
          "type": "array",
          "title": "Causality Actor Process Signature Vendor",
          "description": "The vendor of the signature associated with the causality actor process.",
          "items": {
            "type": "string"
          },
          "order": 9
        },
        "causality_actor_causality_id": {
          "type": "array",
          "title": "Causality Actor Causality ID",
          "description": "The causality ID of the causality actor.",
          "items": {
            "type": "string"
          },
          "order": 10
        },
        "contains_featured_host": {
          "type": "array",
          "title": "Contains Featured Host",
          "description": "Indicates if the event contains a featured host.",
          "items": {
            "type": "string"
          },
          "order": 11
        },
        "contains_featured_ip": {
          "type": "array",
          "title": "Contains Featured IP",
          "description": "Indicates if the event contains a featured IP address.",
          "items": {
            "type": "string"
          },
          "order": 12
        },
        "contains_featured_user": {
          "type": "array",
          "title": "Contains Featured User",
          "description": "Indicates if the event contains a featured user.",
          "items": {
            "type": "string"
          },
          "order": 13
        },
        "action_country": {
          "type": "array",
          "title": "Action Country",
          "description": "The country where the action took place.",
          "items": {
            "type": "string"
          },
          "order": 14
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "A textual description of the event.",
          "order": 15
        },
        "event_type": {
          "type": "array",
          "title": "Event Type",
          "description": "The type of the event.",
          "items": {
            "type": "string"
          },
          "order": 16
        },
        "is_whitelisted": {
          "type": "boolean",
          "title": "Is Whitelisted",
          "description": "Indicates if the event is whitelisted.",
          "order": 17
        },
        "action_file_macro_sha256": {
          "type": "string",
          "title": "Action File Macro SHA256",
          "description": "The SHA256 hash of the macro file involved in the action.",
          "order": 18
        },
        "action_file_md5": {
          "type": "string",
          "title": "Action File MD5",
          "description": "The MD5 hash of the file involved in the action.",
          "order": 19
        },
        "action_file_name": {
          "type": "string",
          "title": "Action File Name",
          "description": "The name of the file involved in the action.",
          "order": 20
        },
        "action_file_path": {
          "type": "string",
          "title": "Action File Path",
          "description": "The path to the file involved in the action.",
          "order": 21
        },
        "action_file_sha256": {
          "type": "string",
          "title": "Action File SHA256",
          "description": "The SHA256 hash of the file involved in the action.",
          "order": 22
        },
        "fw_device_name": {
          "type": "string",
          "title": "Firewall Device Name",
          "description": "The name of the firewall device.",
          "order": 23
        },
        "agent_fqdn": {
          "type": "string",
          "title": "Agent Fully Qualified Domain Name",
          "description": "The fully qualified domain name of the agent.",
          "order": 24
        },
        "agent_os_type": {
          "type": "string",
          "title": "Agent Operating System Type",
          "description": "The type of the operating system running on the agent.",
          "order": 25
        },
        "image_name": {
          "type": "string",
          "title": "Image Name",
          "description": "The name of the image.",
          "order": 26
        },
        "actor_process_image_name": {
          "type": "array",
          "title": "Actor Process Image Name",
          "description": "The name of the actor process image.",
          "items": {
            "type": "string"
          },
          "order": 27
        },
        "actor_process_command_line": {
          "type": "array",
          "title": "Actor Process Command Line",
          "description": "The command line arguments of the actor process.",
          "items": {
            "type": "string"
          },
          "order": 28
        },
        "actor_process_image_md5": {
          "type": "array",
          "title": "Actor Process Image MD5",
          "description": "The MD5 hash of the actor process image.",
          "items": {
            "type": "string"
          },
          "order": 29
        },
        "actor_process_image_path": {
          "type": "array",
          "title": "Actor Process Image Path",
          "description": "The path to the actor process image.",
          "items": {
            "type": "string"
          },
          "order": 30
        },
        "actor_process_os_pid": {
          "type": "array",
          "title": "Actor Process Operating System PID",
          "description": "The process ID of the actor process on the operating system.",
          "items": {
            "type": "integer"
          },
          "order": 31
        },
        "actor_process_image_sha256": {
          "type": "array",
          "title": "Actor Process Image SHA256",
          "description": "The SHA256 hash of the actor process image.",
          "items": {
            "type": "string"
          },
          "order": 32
        },
        "actor_process_signature_status": {
          "type": "array",
          "title": "Actor Process Signature Status",
          "description": "The status of the signature associated with the actor process.",
          "items": {
            "type": "string"
          },
          "order": 33
        },
        "actor_process_signature_vendor": {
          "type": "array",
          "title": "Actor Process Signature Vendor",
          "description": "The vendor of the signature associated with the actor process.",
          "items": {
            "type": "string"
          },
          "order": 34
        },
        "actor_thread_thread_id": {
          "type": "array",
          "title": "Actor Thread Thread ID",
          "description": "The thread ID of the actor thread.",
          "items": {
            "type": "integer"
          },
          "order": 35
        },
        "fw_is_phishing": {
          "type": "array",
          "title": "Firewall Is Phishing",
          "description": "Indicates if the event is related to phishing.",
          "items": {
            "type": "string"
          },
          "order": 36
        },
        "mitre_tactic_id_and_name": {
          "type": "array",
          "title": "MITRE Tactic ID and Name",
          "description": "The ID and name of the MITRE tactic.",
          "items": {
            "type": "string"
          },
          "order": 37
        },
        "mitre_technique_id_and_name": {
          "type": "array",
          "title": "MITRE Technique ID and Name",
          "description": "The ID and name of the MITRE technique.",
          "items": {
            "type": "string"
          },
          "order": 38
        },
        "module_id": {
          "type": "array",
          "title": "Module ID",
          "description": "The ID of the module.",
          "items": {
            "type": "string"
          },
          "order": 39
        },
        "os_actor_process_command_line": {
          "type": "array",
          "title": "OS Actor Process Command Line",
          "description": "The command line arguments of the OS actor process.",
          "items": {
            "type": "string"
          },
          "order": 40
        },
        "os_actor_thread_thread_id": {
          "type": "array",
          "title": "OS Actor Thread Thread ID",
          "description": "The thread ID of the OS actor thread.",
          "items": {
            "type": "integer"
          },
          "order": 41
        },
        "os_actor_process_image_name": {
          "type": "array",
          "title": "OS Actor Process Image Name",
          "description": "The name of the OS actor process image.",
          "items": {
            "type": "string"
          },
          "order": 42
        },
        "os_actor_process_os_pid": {
          "type": "array",
          "title": "OS Actor Process Operating System PID",
          "description": "The process ID of the OS actor process on the operating system.",
          "items": {
            "type": "integer"
          },
          "order": 43
        },
        "os_actor_process_image_sha256": {
          "type": "array",
          "title": "OS Actor Process Image SHA256",
          "description": "The SHA256 hash of the OS actor process image.",
          "items": {
            "type": "string"
          },
          "order": 44
        },
        "os_actor_process_signature_status": {
          "type": "array",
          "title": "OS Actor Process Signature Status",
          "description": "The status of the signature associated with the OS actor process.",
          "items": {
            "type": "string"
          },
          "order": 45
        },
        "os_actor_process_signature_vendor": {
          "type": "array",
          "title": "OS Actor Process Signature Vendor",
          "description": "The vendor of the signature associated with the OS actor process.",
          "items": {
            "type": "string"
          },
          "order": 46
        },
        "action_process_signature_status": {
          "type": "array",
          "title": "Action Process Signature Status",
          "description": "The status of the signature associated with the action process.",
          "items": {
            "type": "string"
          },
          "order": 47
        },
        "matching_service_rule_id": {
          "type": "string",
          "title": "Matching Service Rule ID",
          "description": "The ID of the service rule matched.",
          "order": 48
        },
        "starred": {
          "type": "boolean",
          "title": "Starred",
          "description": "Indicates if the alert is starred.",
          "order": 49
        },
        "external_id": {
          "type": "string",
          "title": "External ID",
          "description": "An external identifier for the alert.",
          "order": 50
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "The severity level of the alert.",
          "order": 51
        },
        "matching_status": {
          "type": "string",
          "title": "Matching Status",
          "description": "The status of the matching process.",
          "order": 52
        },
        "local_insert_ts": {
          "type": "integer",
          "title": "Local Insert Timestamp",
          "description": "The timestamp when the alert was inserted locally.",
          "order": 53
        },
        "attempt_counter": {
          "type": "integer",
          "title": "Attempt Counter",
          "description": "The counter for attempts made.",
          "order": 54
        },
        "case_id": {
          "type": "integer",
          "title": "Case ID",
          "description": "The case ID associated with the alert.",
          "order": 55
        },
        "agent_version": {
          "type": "string",
          "title": "Agent Version",
          "description": "The version of the agent.",
          "order": 56
        },
        "agent_data_collection_status": {
          "type": "boolean",
          "title": "Agent Data Collection Status",
          "description": "The status of data collection by the agent.",
          "order": 57
        },
        "agent_is_vdi": {
          "type": "boolean",
          "title": "Agent Is VDI",
          "description": "Indicates if the agent is running on a VDI.",
          "order": 58
        },
        "agent_install_type": {
          "type": "string",
          "title": "Agent Install Type",
          "description": "The install type of the agent.",
          "order": 59
        },
        "agent_host_boot_time": {
          "type": "array",
          "title": "Agent Host Boot Time",
          "description": "The boot time of the host.",
          "items": {
            "type": "integer"
          },
          "order": 60
        },
        "event_sub_type": {
          "type": "array",
          "title": "Event Sub Type",
          "description": "The subtype of the event.",
          "items": {
            "type": "integer"
          },
          "order": 61
        },
        "association_strength": {
          "type": "array",
          "title": "Association Strength",
          "description": "The strength of association between entities.",
          "items": {
            "type": "integer"
          },
          "order": 62
        },
        "event_timestamp": {
          "type": "array",
          "title": "Event Timestamp",
          "description": "The timestamp of the event.",
          "items": {
            "type": "integer"
          },
          "order": 63
        },
        "actor_process_instance_id": {
          "type": "array",
          "title": "Actor Process Instance ID",
          "description": "The instance ID of the actor process.",
          "items": {
            "type": "string"
          },
          "order": 64
        },
        "causality_actor_process_execution_time": {
          "type": "array",
          "title": "Causality Actor Process Execution Time",
          "description": "The execution time of the causality actor process.",
          "items": {
            "type": "integer"
          },
          "order": 65
        },
        "os_actor_process_image_path": {
          "type": "array",
          "title": "OS Actor Process Image Path",
          "description": "The path to the OS actor process image.",
          "items": {
            "type": "string"
          },
          "order": 66
        },
        "is_pcap": {
          "type": "boolean",
          "title": "Is PCAP",
          "description": "Indicates if the alert involves PCAP data.",
          "order": 67
        },
        "alert_type": {
          "type": "string",
          "title": "Alert Type",
          "description": "The type of the alert.",
          "order": 68
        },
        "resolution_status": {
          "type": "string",
          "title": "Resolution Status",
          "description": "The resolution status of the alert.",
          "order": 69
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "Tags associated with the alert.",
          "items": {
            "type": "string"
          },
          "order": 70
        },
        "alert_id": {
          "type": "string",
          "title": "Alert ID",
          "description": "The unique ID of the alert.",
          "order": 71
        },
        "detection_timestamp": {
          "type": "integer",
          "title": "Detection Timestamp",
          "description": "The timestamp when the detection occurred.",
          "order": 72
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The name of the alert.",
          "order": 73
        },
        "endpoint_id": {
          "type": "string",
          "title": "Endpoint ID",
          "description": "The ID of the endpoint.",
          "order": 74
        },
        "host_ip": {
          "type": "array",
          "title": "Host IP",
          "description": "The IP address of the host.",
          "items": {
            "type": "string"
          },
          "order": 75
        },
        "host_name": {
          "type": "string",
          "title": "Host Name",
          "description": "The name of the host.",
          "order": 76
        },
        "action": {
          "type": "string",
          "title": "Action",
          "description": "The action taken.",
          "order": 77
        },
        "original_tags": {
          "type": "array",
          "title": "Original Tags",
          "description": "The original tags associated with the alert.",
          "items": {
            "type": "string"
          },
          "order": 78
        },
        "user_name": {
          "type": "array",
          "title": "User Name",
          "description": "The name of the user.",
          "items": {
            "type": "string"
          },
          "order": 79
        },
        "mac_addresses": {
          "type": "array",
          "title": "MAC Addresses",
          "description": "The MAC addresses associated with the alert.",
          "items": {
            "type": "string"
          },
          "order": 80
        },
        "source": {
          "type": "string",
          "title": "Source",
          "description": "The source of the alert.",
          "order": 81
        },
        "action_pretty": {
          "type": "string",
          "title": "Action Pretty",
          "description": "A pretty-printed representation of the action.",
          "order": 82
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
