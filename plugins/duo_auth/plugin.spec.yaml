plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: duo_auth
title: Duo Auth API
vendor: rapid7
support: rapid7
supported_versions: ["Duo Client 5.3.0"]
status: []
description: "[Duo](https://duo.com/)'s Trusted Access platform verifies the identity of your users with two-factor authentication and security health of their devices before they connect to the apps they use. The Duo Auth InsightConnect plugin enables users to create and send push notifications from within automation workflows"
version: 1.0.4
connection_version: 1
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/duo_auth
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://duo.com
tags:
  - duo
  - auth
hub_tags:
  use_cases: [devops]
  keywords: [duo, auth]
  features: []
sdk:
  type: slim
  version: 6.2.3
  user: nobody
key_features:
  - Send push notifications for two-factor authentication
requirements:
  - Requires a Duo integration key
  - Requires a Duo secret key
  - Requires a Duo hostname
version_history:
  - "1.0.4 - Updated dependencies and SDK to the latest version"
  - "1.0.3 - Upgraded `duo_client` in requirements.txt to version `4.0.0` | Upgraded `duo_client` in vendor folder to version `4.0.0` | Use input and output constants |  Change docker image from `komand/python-3-plugin:2` to `komand/python-3-37-slim-plugin:3` to reduce plugin image size"
  - "1.0.2 - New spec and help.md format for the Extension Library"
  - "1.0.1 - Support `type` parameter as `push_type` in the `options` input of the Auth action"
  - "1.0.0 - Update to v2 Python plugin architecture | Support web server mode | Update to new credential types | Add example output"
  - "0.1.1 - SSL bug fix in SDK"
  - "0.1.0 - Initial plugin"
links:
  - "[Duo](https://duo.com/)"
references:
  - "[Duo](https://duo.com/)"
  - "[Duo Auth API V2](https://duo.com/docs/authapi)"
connection:
  integration_key:
    type: credential_secret_key
    description: API integration key
    required: true
    example: '{"secretKey": "9de5069c5afe602b2ea0a04b66beb2c0"}'
  secret_key:
    type: credential_secret_key
    description: API secret key
    required: true
    example: '{"secretKey": "9de5069c5afe602b2ea0a04b66beb2c0"}'
  hostname:
    title: API Hostname
    description: Enter the Duo API hostname and secret key
    type: string
    required: true
    example: ExampleHostname
actions:
  auth:
    title: Auth
    description: Perform second-factor authentication
    input:
      user_id:
        title: User ID
        description: Permanent, unique identifier for the user as generated by Duo upon user creation. Exactly one of user_id or username must be specified
        type: string
        required: false
        example: "DUYHV6TJBC3O4RITS1WC"
      username:
        title: Username
        description: Unique identifier for the user that is commonly specified by your application during user creation. This value may also represent a username alias assigned to a user. Exactly one of user_id or username must be specified
        type: string
        required: false
        example: user@example.com
      factor:
        type: string
        description: Factor to use for authentication
        enum:
          - auto
          - push
          - passcode
          - sms
          - phone
        required: false
        default: auto
        example: auto
      ipaddr:
        type: string
        description: The IP address of the user to be authenticated, in dotted quad format. This will cause an 'allow' response to be sent if appropriate for requests from a trusted network
        required: false
        example: 192.168.0.1
      async:
        title: Async
        description: Set to true for an async response
        type: bool
        required: false
        example: false
      device:
        title: Device
        description: Device ID to use for auth
        type: string
        required: false
        default: auto
        example: auto
      options:
        title: Options
        description: Additional options required by the API. This field is used to specify additional parameters that may be necessary depending on the authentication factor selected. Accepts the following parameters in JSON format `username`, `passcode`, `pushinfo`, `type`
        type: object
        required: false
        example: '{"type":"Transfer","pushinfo":{"hello":"world","host":"suspicious-host"}}'
    output:
      result:
        title: Result
        description: Either "allow" or "deny". If "allow" was returned, your application should grant access to the user. If "deny", it should not
        type: string
        required: false
        example: allow
      status:
        title: Status
        description: String detailing the progress or outcome of the authentication attempt
        type: string
        required: false
        example: allow
      status_msg:
        title: Status Message
        description: The message describing the status of the authentication attempt. If the authentication attempt was denied, it may identify a reason
        type: string
        required: false
        example: Success. Logging you in...
      trusted_device_token:
        title: Trusted Device Token
        description: A string containing a token for that trusted device
        type: string
        required: false
        example: REkxS00Ld4ddEVTRZOUlYMEldJ05HwUldRRThJR1VTNE0=|35|835c28ca9b042e05e
      txid:
        title: TX ID
        description: A transaction ID
        type: string
        required: false
        example: 45f7c92b-f45f-4862-8545-e0f58e78075a
