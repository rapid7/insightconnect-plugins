#!/usr/bin/env python
# GENERATED BY KOMAND SDK - DO NOT EDIT
import os
import json
from sys import argv

Name = "Cisco ISE"
Vendor = "rapid7"
Version = "2.2.2"
Description = "This plugin utilizes Cisco Identity Services Engine to retrieve ANC details, endpoint details and manage Quarantine Cisco Identity Services Engine allows users to gain awareness of everything hitting their networks"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import komand
    from komand_cisco_ise import connection, actions, triggers

    class ICONCiscoIse(komand.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_action(actions.GetAncEndpoint())

            self.add_action(actions.Quarantine())

            self.add_action(actions.QueryEndpoint())

            self.add_action(actions.RemoveFromQuarantine())


    """Run plugin"""
    cli = komand.CLI(ICONCiscoIse())
    cli.run()


if __name__ == "__main__":
    main()
