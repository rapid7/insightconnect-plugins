# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Get Indicators of Compromise by Filter"


class Input:
    ENTERPRISE_TACTICS = "enterprise_tactics"
    FIRST_SEEN_FROM = "first_seen_from"
    FIRST_SEEN_TO = "first_seen_to"
    KILL_CHAIN_PHASES = "kill_chain_phases"
    LAST_SEEN_FROM = "last_seen_from"
    LAST_SEEN_TO = "last_seen_to"
    LAST_UPDATED_FROM = "last_updated_from"
    LAST_UPDATED_TO = "last_updated_to"
    LIMIT = "limit"
    OFFSET = "offset"
    SEVERITY = "severity"
    SOURCE_IDS = "source_ids"
    STATUS = "status"
    TYPE = "type"
    

class Output:
    CONTENT = "content"
    NEXTOFFSET = "nextOffset"
    

class GetIocsByFilterInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "enterprise_tactics": {
      "type": "array",
      "title": "Enterprise Tactics",
      "description": "Filter by MITRE ATT\\u0026CK Enterprise tactic. Allowed values 'Reconnaissance', 'Resource Development', 'Initial Access', 'Execution', 'Persistence', 'Privilege Escalation', 'Defense Evasion', 'Credential Access', 'Discovery', 'Lateral Movement', 'Collection', 'Command and Control', 'Exfiltration', 'Impact'",
      "items": {
        "type": "string"
      },
      "order": 14
    },
    "first_seen_from": {
      "type": "string",
      "title": "First Seen From",
      "displayType": "date",
      "description": "Filter by first seen date (IOC first-seen date is greater than)",
      "format": "date-time",
      "order": 5
    },
    "first_seen_to": {
      "type": "string",
      "title": "First Seen To",
      "displayType": "date",
      "description": "Filter by first seen date (IOC first-seen date is less than)",
      "format": "date-time",
      "order": 6
    },
    "kill_chain_phases": {
      "type": "array",
      "title": "Kill Chain Phases",
      "description": "Filter by phase of Lockheed-Martin intrusion kill chain (Allowed values: Reconnaissance, Weaponization, Delivery, Exploitation, Installation, Command and Control, Actions on Objective)",
      "items": {
        "type": "string"
      },
      "order": 11
    },
    "last_seen_from": {
      "type": "string",
      "title": "Last Seen From",
      "displayType": "date",
      "description": "Filter by last seen date (IOC last-seen date is greater than)",
      "format": "date-time",
      "order": 3
    },
    "last_seen_to": {
      "type": "string",
      "title": "Last Seen To",
      "displayType": "date",
      "description": "Filter by last seen date (IOC last-seen date is less than)",
      "format": "date-time",
      "order": 4
    },
    "last_updated_from": {
      "type": "string",
      "title": "Last Updated From",
      "displayType": "date",
      "description": "Filter by last update date (IOC update date is greater than)",
      "format": "date-time",
      "order": 1
    },
    "last_updated_to": {
      "type": "string",
      "title": "Last Updated To",
      "displayType": "date",
      "description": "Filter by last update date (IOC update date is less than)",
      "format": "date-time",
      "order": 2
    },
    "limit": {
      "type": "integer",
      "title": "Limit",
      "description": "Limit the results amount per page (1-1000)",
      "default": 1000,
      "order": 12
    },
    "offset": {
      "type": "string",
      "title": "Offset",
      "description": "Getting the next page of IOCs from offset",
      "order": 13
    },
    "severity": {
      "type": "array",
      "title": "Status",
      "description": "Filter by IOC severity (Allowed values: High, Medium, Low)",
      "items": {
        "type": "string"
      },
      "order": 9
    },
    "source_ids": {
      "type": "array",
      "title": "Source IDs",
      "description": "Filter by source IDs",
      "items": {
        "type": "string"
      },
      "order": 10
    },
    "status": {
      "type": "string",
      "title": "Status",
      "description": "Filter by IOC status",
      "enum": [
        "",
        "Active",
        "Retired"
      ],
      "order": 7
    },
    "type": {
      "type": "array",
      "title": "Type",
      "description": "Filter by IOC type (Allowed values: IpAddresses, Urls, Domains, Hashes, Emails)",
      "items": {
        "type": "string"
      },
      "order": 8
    }
  },
  "required": [
    "last_updated_from"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class GetIocsByFilterOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "content": {
      "type": "array",
      "title": "Content",
      "description": "List of IOCs that match filters",
      "items": {
        "$ref": "#/definitions/ioc_content"
      },
      "order": 1
    },
    "nextOffset": {
      "type": "string",
      "title": "Next Offset",
      "description": "The offset to the next page of IOCs",
      "order": 2
    }
  },
  "definitions": {
    "ioc_content": {
      "type": "object",
      "title": "ioc_content",
      "properties": {
        "firstSeen": {
          "type": "string",
          "title": "First Seen",
          "description": "First seen",
          "order": 6
        },
        "geolocation": {
          "type": "string",
          "title": "Geographic Location",
          "description": "Geographic location",
          "order": 9
        },
        "lastSeen": {
          "type": "string",
          "title": "Last Seen",
          "description": "Last seen",
          "order": 7
        },
        "lastUpdateDate": {
          "type": "string",
          "title": "Last Update Date",
          "description": "Last update date",
          "order": 8
        },
        "relatedCampaigns": {
          "type": "array",
          "title": "Related Campaigns",
          "description": "Related campaigns",
          "items": {
            "type": "string"
          },
          "order": 12
        },
        "relatedMalware": {
          "type": "array",
          "title": "Related Malware",
          "description": "Related malware",
          "items": {
            "type": "string"
          },
          "order": 11
        },
        "relatedThreatActors": {
          "type": "array",
          "title": "Related Threat Actors",
          "description": "Related threat actors",
          "items": {
            "type": "string"
          },
          "order": 13
        },
        "reportedFeeds": {
          "type": "array",
          "title": "Reported Feeds",
          "description": "Reported Feeds",
          "items": {
            "$ref": "#/definitions/reported_feed"
          },
          "order": 15
        },
        "score": {
          "type": "number",
          "title": "Score",
          "description": "Score",
          "order": 4
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "Severity",
          "order": 3
        },
        "status": {
          "type": "string",
          "title": "Status",
          "description": "Status",
          "order": 14
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "Tags",
          "items": {
            "type": "string"
          },
          "order": 10
        },
        "type": {
          "type": "string",
          "title": "Type",
          "description": "Type",
          "order": 2
        },
        "value": {
          "type": "string",
          "title": "Indicator Value",
          "description": "Indicator value",
          "order": 1
        },
        "whitelisted": {
          "type": "boolean",
          "title": "Whitelisted",
          "description": "Whitelisted",
          "order": 5
        }
      },
      "definitions": {
        "reported_feed": {
          "type": "object",
          "title": "reported_feed",
          "properties": {
            "confidenceLevel": {
              "type": "integer",
              "title": "Confidence Level",
              "description": "Level of confidence",
              "order": 3
            },
            "id": {
              "type": "string",
              "title": "ID",
              "description": "ID",
              "order": 1
            },
            "name": {
              "type": "string",
              "title": "Name",
              "description": "Name",
              "order": 2
            }
          }
        }
      }
    },
    "reported_feed": {
      "type": "object",
      "title": "reported_feed",
      "properties": {
        "confidenceLevel": {
          "type": "integer",
          "title": "Confidence Level",
          "description": "Level of confidence",
          "order": 3
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "ID",
          "order": 1
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "Name",
          "order": 2
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
