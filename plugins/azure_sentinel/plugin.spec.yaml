plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: azure_sentinel
title: Azure Sentinel Plugin
vendor: rapid7
support: community
supported_versions: [2021-04-01]
status: []
description: Microsoft Azure Sentinel is a cloud-native SIEM that provides intelligent security analytics for your entire enterprise, powered by AI
version: 2.1.0
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/azure_sentinel
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.microsoft.com/
tags:
  - Azure Sentinel
  - VM
  - Microsoft
  - automation
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [azure, incidents, microsoft]
  features: [create incident, delete incident, get incident, list incidents, list alerts, list bookmarks, list entities, get comment, list comments, delete comment, create or update comment, create indicator, get indicator, update indicator, delete indicator, query indicator, append tags, replace tags, create or update watchlist, get watchlist, delete watchlist, list watchlist, create or update watchlist items, get watchlist item, delete watchlist item, list watchlist items]
types:
  # Common types
  CreatedByType:
    # There is little information in the documentation on this type.
    Application:
      title: Application
      description: Application
      type: string
    Key:
      title: Key
      description: Description 
      type: string
    ManagedIdentity:
      title: Managed Indentity
      description: Managed identity
      type: string
    User:
      title: User 
      description: User
      type: string
  SystemData:
    createdAt:
      title: Created At
      description: The timestamp of resource creation (UTC)
      type: date
    createdBy:
      title: Created By
      description: The identity that created the resource
      type: string
    createdByType:
      title:  Created By Type
      description: The type of identity that created the resource
      type: string
      enum:
        - ""
        - Application
        - Key
        - ManagedIdentity
        - User
    lastModifiedAt:
      title: Last Modified At 
      description: The timestamp of resource last modification (UTC)
      type: date
    lastModifiedBy:
      title: Last Modified By
      description: The identity that last modified the resource
      type: string
    lastModifiedByType:
      title: Last Modified By Type
      description: The type of identity that last modified the resource
      type: string
      enum:
        - ""
        - Application
        - Key
        - ManagedIdentity
        - User
  UserInfo:
    email:
      title: Email
      description: The email of the user
      type: string
    name:
      title: Name 
      description: The name of the user
      type: string
    objectId:
      title: Object Identification 
      description: The object ID of the user
      type: string
  # Entity Related Types
  Entity:
    id:
      title: Azure resource ID
      description: Azure resource ID
      type: string
    kind:
      title: Kind
      description: The kind of the entity
      type: string
    name:
      title: Name
      description: Azure resource name
      type: string
    properties:
      title: Properties
      description: Entity properties
      type: object
  # Bookmark types
  HuntingBookmarkProperties:
    additionalData:
      title: Additional Data
      description: Custom fields that should be part of the entity and will
        be presented to the user
      type: object
    created:
      title: Created
      description: The time the bookmark was created
      type: date
    createdBy:
      title: Created By
      description: Describes a user that created the bookmark
      type: UserInfo
    displayName:
      title: Display Name
      description: The display name of the bookmark
      type: string
    eventTime:
      title: Event Time 
      description: The time of the event
      type: date
    friendlyName:
      title: Friendly Name
      description: The graph item display name which is a short human-readable description
        of the graph item instance
      type: string
    incidentInfo:
      title: Incident Info
      description: Describes an incident that relates to bookmark
      type: object
    labels:
      title: Labels
      description: List of labels relevant to this bookmark
      type: "[]string"
    notes:
      title: Notes
      description: The notes of the bookmark
      type: string
    query:
      title: Query 
      description: The query of the bookmark
      type: string
    queryResult:
      title: Query Result
      description: The query result of the bookmark
      type: string
    updated:
      title: Updated 
      description: The last time the bookmark was updated
      type: date
    updatedBy:
      title: Updated By
      description: Describes a user that updated the bookmark
      type: UserInfo
  HuntingBookmark:
    id:
      title: ID
      description: Resource ID
      required: false
      type: string
    kind:
      title: Kind
      description: The kind of the entity
      type: string
      required: false
    name:
      title: Name 
      description: Resource name
      type: string
      required: false
    systemData:
      title: System Data
      description: Azure Resource Manager metadata containing createdBy and modifiedBy information
      type: SystemData
      required: false
    type:
      title: Type 
      description: Azure resource type
      type: string
      required: false
    properties:
      title: Properties
      description: Hunting bookmark properties
      type: HuntingBookmarkProperties
      required: false
  ConfidenceReasons:
    reason:
      title: Reason 
      description: Reason's description
      type: string
    reasonType:
      title: Reason Type
      description: The reason's type (category)
      type: string 
  # Alert types
  AlertProperties:
    additionalData:
      title: Additional Data
      description: Custom fields that should be part of the entity and will
        be presented to the user
      type: object
    alertDisplayName:
      title: Alert Display Name
      description: The display name of the alert
      type: string
    alertLink:
      title: Alert Link 
      description: The URI link of the alert
      type: string
    alertType:
      title: Alert Type 
      description: The type name of the alert
      type: string
    compromisedEntity:
      title: Compromised Entity 
      description: Display name of the main entity being reported on
      type: string
    confidenceLevel:
      title: Confidence Level 
      description: The confidence level of this alert
      type: string
    confidenceReasons:
      title: Confidence Reasons
      description: The confidence reasons
      type: "[]ConfidenceReasons"
    confidenceScore:
      title: Confidence Score
      description: The confidence score of the alert
      type: integer 
    confidenceScoreStatus:
      title: Confidence Score Status
      description: The confidence score calculation status, i.e. indicating if score
        calculation is pending for this alert, not applicable or final
      type: string
      example: Final
    description:
      title: Description
      description: Alert description
      type: string
    endTimeUtc:
      title: End Time UTC
      description: The impact end time of the alert
      type: date
    friendlyName:
      title: Friendly Display Name
      description: The graph item display name which is a short humanly readable description
        of the graph item instance
      type: string
    intent:
      title: Intent
      description: Holds the alert intent stage(s) mapping for this alert
      type: string
      example: Collection
    processingEndTime:
      title: Processing End Time
      description: The time the alert was made available for consumption
      type: date
    productComponentName:
      title: Product Component Name 
      description: The name of a component inside the product which generated the alert
      type: string
    productName:
      title: Product Name 
      description: The name of the product which published this alert
      type: string
    productVersion:
      title: Product Version
      description: The version of the product generating the alert
      type: string
    providerAlertId:
      title: Provider Alert ID 
      description: The identifier of the alert inside the product which generated the
        alert
      type: string
    remediationSteps:
      title: Remediation Steps
      description: Manual action items to take to remediate the alert
      type: "[]string"
    resourceIdentifiers:
      title: Resource Identifiers
      description: The list of resource identifiers of the alert
      type: "[]object"
    severity:
      title: Severity 
      description: The severity of the alert
      type: string
      example: High 
    startTimeUtc:
      title: Start Time UTC 
      description: The impact start time of the alert (the time of the first event contributing
        to the alert)
      type: date
    status:
      title: Status
      description: The lifecycle status of the alert
      type: string
      example: New
    systemAlertId:
      title: System Alert ID
      description: Holds the product identifier of the alert for the product
      type: string
    systemData:
      title: System Data 
      description: Azure Resource Manager metadata containing createdBy and modifiedBy
        information
      type: SystemData
    tactics:
      title: Tactics
      description: The tactics of the alert
      type: "[]string"
    timeGenerated:
      title: Title 
      description: The time the alert was generated
      type: date
    type:
      title: Title 
      description: Azure resource type
      type: string
    vendorName:
      title: Vendor Name
      description: The name of the vendor that raised the alert
      type: string
  Alert:
    properties:
      title: Properties
      description: Alert's properties
      type: AlertProperties
  # Incident Types
  IncidentOwnerInfo:
    assignedTo:
      title: Assigned To
      description: The name of the user the incident is assigned to
      type: string
    email:
      title: Email
      description: The mail of the user the incident is assigned to
      type: string
    objectId:
      title: Object ID
      description: The object id of the user the incident is assigned to
      type: string
    userPrincipalName:
      title: User Principal Name
      description: The user principal name of the user the incident is assigned to
      type: string
  IncidentLabel:
    labelName:
      title: Label Name 
      description: The name of the label
      type: string
    labelType:
      title: The type of label
      description: Label Type 
      type: string
      example: System
  IncidentAdditionalData:
    alertProductNames:
      title: Alert Product Names 
      description: List of product names of alerts in the incident
      type: "[]string"
    alertsCount:
      title: Alert's Count 
      description: The number of alerts in the incident
      type: integer
    bookmarksCount:
      title: Bookmarks Count 
      description: The number of bookmarks in the incident
      type: integer
    commentsCount:
      title: Comments Count 
      description: The number of comments in the incident
      type: integer
    tactics:
      title: Tactics 
      description: The tactics associated with incident
      type: "[]string"
  IncidentProperties:
    additionalData:
      title: Additional Data 
      description: Additional data on the incident
      type: IncidentAdditionalData
    classification:
      title: Classification 
      description: The reason the incident was closed
      type: string
      example: BenignPositive
    classificationComment:
      title: Classification Comment
      description: Describes the reason the incident was closed
      type: string
    classificationReason:
      title: Classification Reason
      description: The classification reason the incident was closed with
      type: string
      example: InaccurateData 
    createdTimeUtc:
      title: Created Time UTC
      description: The time the incident was created
      type: date
    description:
      title: Description 
      description: The description of the incident
      type: string
    etag:
      title: Etag
      description: Etag of the azure resource
      type: string
    firstActivityTimeUtc:
      title: First Activity Time UTC 
      description: The time of the first activity in the incident
      type: date
    id:
      title: ID
      description: Azure resource ID
      type: string
    incidentNumber:
      title: Incident Number 
      description: A sequential number
      type: integer
    incidentUrl:
      title: Incident URL 
      description: The deep-link URL to the incident in Azure portal
      type: string
    labels:
      title: Labels
      description: List of labels relevant to this incident
      type: "[]IncidentLabel"
    lastActivityTimeUtc:
      title: Last Activity Time UTC 
      description: The time of the last activity in the incident
      type: date
    lastModifiedTimeUtc:
      title: Last Modified Time UTC 
      description: The last time the incident was updated
      type: date
    name:
      title: Name 
      description: Azure resource name
      type: string
    owner:
      title: Owner 
      description: Describes a user that the incident is assigned to
      type: IncidentOwnerInfo
    relatedAnalyticRuleIds:
      title: Related Analytic Rule IDs 
      description: List of resource ids of Analytic rules related to the incident
      type: "[]string"
    severity:
      title: Severity
      description: Incidents severity
      required: true
      type: string
      example: High
    status:
      title: Status 
      description: Incidents status
      required: true
      type: string
      example: Active
    systemData:
      title: System Data
      description: Azure Resource Manager metadata containing createdBy and modifiedBy
        information
      type: SystemData
    title:
      title: The title of the incident
      description: The title of the incident
      type: string
    type:
      title: Type
      description: Azure resource type
      type: string
  Incident:
    id:
      title: ID
      description: Full incident ID
      type: string
    name:
      title: Name
      description: Incident name - short ID
      type: string
    type:
      title: Type
      description: Incident type
      type: string
    etag:
      title: Etag
      description: Etag
      type: string
    properties:
      title: Incident Properties
      description: Incident properties object
      type: IncidentProperties
  ClientInfo:
    email:
      description: The email of the client
      title: Email
      type: string
    name:
      description: The name of the client
      title: Name
      type: string
    objectId:
      description: The object id of the client
      title: Object ID
      type: string
    userPrincipalName:
      description: The user principal name of the client
      title: User Principal Name
      type: string
  CommentProperties:
    author:
      description: Describes the client that created the comment
      title: Author
      type: ClientInfo
    createdTimeUtc:
      description: The time the comment was created
      title: Created Time UTC
      type: date
    lastModifiedTimeUtc:
      description: The time the comment was updated
      title: Last Modified Time UTC
      type: date
    message:
      description: The comment message
      title: Message
      type: string
    name:
      description: The name of the resource
      title: Name
      type: string
    systemData:
      description: Azure Resource Manager metadata containing createdBy and modifiedBy
        information
      title: System Data
      type: SystemData
  IncidentComment:
    etag:
      title: Etag
      description: Entity tag of the resource
      type: string
    id:
      title: ID
      description: Resource ID
      type: string
    name:
      title: Name
      description: The name of the resource
      type: string
    type:
      description: The type of the resource
      title: Type
      type: string
    properties:
      description: Comment properties
      title: Properties
      type: CommentProperties
  # ThreatInteligence Types
  ThreatIntelligenceKillChainPhase:
    killChainName:
      title: Chain Name
      description: Kill chain name
      type: string
    phaseName:
      title: Phase Name
      description: Kill chain phase name
      type: string
  ThreatIntelligenceParsedPatternTypeValue:
    value:
      title: Value
      description: Value
      type: string
    valueType:
      title: Value Type
      description: Type of the value
      type: string
  ThreatIntelligenceParsedPattern:
    patternTypeKey:
      title: Pattern Type Key
      description: Pattern Type Key
      type: string
    patternTypeValues:
      title: Pattern Type Values
      description: Pattern Type Values
      type: "[]ThreatIntelligenceParsedPatternTypeValue"
  ThreatIntelligenceGranularMarkingModel:
    language:
      title: Language
      description: Language granular marking model
      type: string
      required: false
    markingRef:
      title: Marking Reference
      description: Marking reference granular marking model
      type: string
      required: false
    selectors:
      title: Selectors
      description: Granular marking model selectors
      type: "[]string"
      required: false
  ThreatIntelligenceExternalReference:
    description:
      title: Description
      description: External reference description
      type: string
      required: false
    externalId:
      title: External ID
      description: External reference ID
      type: string
      required: false
    hashes:
      title: Hashes
      description: External reference hashes
      type: object
      required: false
    sourceName:
      title: Source name
      description: External reference source name
      type: string
      required: false
    url:
      title: URL
      description: External reference URL
      type: string
      required: false
  ThreatIntelligenceSortingCriteria:
    itemKey:
      title: Item Key
      description: Column name to sort by
      type: string
      required: false
    sortOrder:
      title: Sorting Order
      description: Sorting Order
      type: string
      required: false
      enum:
        - ascending
        - descending
        - unsorted
  ThreatIntelligenceIndicatorProperties:
    confidence:
      title: Confidence
      description: Confidence of threat intelligence entity
      type: integer
      required: false
    created:
        title: Created at
        description: Date of created
        type: string
        required: false
    createdByRef:
        title: Created by
        description: Created by reference of threat intelligence entity
        type: string
        required: false
    defanged:
        title: Defanged
        description: Is threat intelligence entity defanged
        type: boolean
        required: false
    description:
        title: Description
        description: Description of a threat intelligence entity
        type: string
        required: false
    displayName:
        title: Display Name
        description: Display name of a threat intelligence entity
        type: string
        required: true
    externalId:
        title: External ID
        description: External ID of threat intelligence entity
        type: string
        required: false
    externalReferences:
        title: External References
        description: Array of Threat Intelligence External Reference
        type: "[]ThreatIntelligenceExternalReference"
        required: false
    granularMarkings:
        title: Granular Markings
        description: Describes threat granular marking model entity
        type: "[]ThreatIntelligenceGranularMarkingModel"
        required: false
    indicatorTypes:
        title: Indicator Types
        description: Indicator types of threat intelligence entities
        type: "[]string"
        required: false
    killChainPhases:
        title: Kill Chain Phases
        description: Describes threat kill chain phase entity
        type: "[]ThreatIntelligenceKillChainPhase"
        required: false
    labels:
        title: Labels
        description: Labels of threat intelligence entity
        type: "[]string"
        required: false
    language:
        title: Language
        description: Language of threat intelligence entity
        type: string
        required: false
    modified:
        title: Modified by
        description: Modified by
        type: string
        required: false
    objectMarkingRefs:
        title: Marking References
        description: Threat intelligence entity object marking references
        type: "[]string"
        required: false
    parsedPattern:
        title: Parsed patterns
        description: Parsed patterns
        type: "[]ThreatIntelligenceParsedPattern"
        required: false
    pattern:
        title: Pattern
        description: Pattern of a threat intelligence entity
        type: string
        required: true
    patternType:
        title: Pattern Type
        description: Pattern type of a threat intelligence entity
        type: string
        required: true
    patternVersion:
        title: Pattern Version
        description: Pattern version of a threat intelligence entity
        type: string
        required: false
    revoked:
        title: Revoked
        description: Is threat intelligence entity revoked
        type: boolean
        required: false
    source:
        title: Source
        description: Source of a threat intelligence entity
        type: string
        required: true
    threatIntelligenceTags:
        title: Tags
        description: List of tags
        type: "[]string"
        required: false
    threatTypes:
        title: Threat Types
        description: Threat types
        type: "[]string"
        required: true
    validFrom:
        title: Valid From
        description: Valid from
        type: string
        required: false
    validUntil:
        title: Valid Until
        description: Valid until
        type: string
        required: false
  ThreatIntelligenceIndicators:
    id:
      title: ID
      description: Identifier created indicator
      type: string
      required: true
    name:
      title: Name
      description: Name of the entity
      type: string
      required: true
    etag:
      title: Etag
      description: Etag of the azure resource
      type: string
      required: true
    type:
      title: Type
      description: Type of the entity
      type: string
      required: true
    kind:
      title: Kind
      description: The kind of the entity
      type: string
      required: true
    properties:
      title: Properties
      description: Object containing all the necessary properties to conclude a query
      type: ThreatIntelligenceIndicatorProperties
      required: true
  ThreatIntelligenceIndicatorPropertiesUpdate:
    confidence:
      title: Confidence
      description: Confidence of threat intelligence entity
      type: integer
      required: false
    defanged:
      title: Defanged
      description: Is threat intelligence entity defanged
      type: boolean
      required: false
    displayName:
      title: Display Name
      description: Display name of a threat intelligence entity
      type: string
      required: false
    externalReferences:
      title: External References
      description: Array of Threat Intelligence External Reference
      type: "[]ThreatIntelligenceExternalReference"
      required: false
    granularMarkings:
      title: Granular Markings
      description: Describes threat granular marking model entity
      type: "[]ThreatIntelligenceGranularMarkingModel"
      required: false
    indicatorTypes:
      title: Indicator Types
      description: Indicator types of threat intelligence entities
      type: "[]string"
      required: false
    labels:
      title: Labels
      description: Labels of threat intelligence entity
      type: "[]string"
      required: false
    language:
      title: Language
      description: Language of threat intelligence entity
      type: string
      required: false
    modified:
      title: Modified by
      description: Modified by
      type: string
      required: false
    objectMarkingRefs:
      title: Marking References
      description: Threat intelligence entity object marking references
      type: "[]string"
      required: false
    parsedPattern:
      title: Parsed patterns
      description: Parsed patterns
      type: "[]ThreatIntelligenceParsedPattern"
      required: false
    pattern:
      title: Pattern
      description: Pattern of a threat intelligence entity
      type: string
      required: false
    patternType:
      title: Pattern Type
      description: Pattern type of a threat intelligence entity
      type: string
      required: false
    patternVersion:
      title: Pattern Version
      description: Pattern version of a threat intelligence entity
      type: string
      required: false
    revoked:
      title: Revoked
      description: Is threat intelligence entity revoked
      type: boolean
      required: false
    threatIntelligenceTags:
      title: Tags
      description: List of tags
      type: "[]string"
      required: false
    threatTypes:
      title: Threat Types
      description: Threat types
      type: "[]string"
      required: false
    validUntil:
      title: Valid Until
      description: Valid until
      type: string
      required: false
  ThreatIntelligenceIndicatorPropertiesReplaceTags:
    threatIntelligenceTags:
      title: Tags
      description: List of tags
      type: "[]string"
      required: false
  # Watchlist
  WatchlistProperties:
    contentType:
      title: Content Type
      description: The content type of the raw content
      type: string
      example: text/csv
    created:
      title: Created
      description: The time the watchlist was created
      type: date
    createdBy:
      title: Created By
      description: Describes a user that created the watchlist
      type: UserInfo
    defaultDuration:
      title: Default Duration
      description: The default duration of a watchlist (in ISO 8601 duration format)
      type: string
    description:
      title: Description
      description: A description of the watchlist
      type: string
    displayName:
      title: Display Name
      description: The display name of the watchlist
      type: string
      required: true
    isDeleted:
      title: Is Deleted
      description: A flag that indicates if the watchlist is deleted or not
      type: boolean
    itemsSearchKey:
      title: Items Search Key
      description: The search key is used to optimize query performance when using watchlists
        for joins with other data. For example, enable a column with IP addresses to
        be the designated SearchKey field, then use this field as the key field when
        joining to other event data by IP address
      example: header1
      required: true
      type: string
    labels:
      description: List of labels relevant to this watchlist
      title: List of labels relevant to this watchlist
      type: "[]string"
    numberOfLinesToSkip:
      description: The number of lines in a CSV content to skip before the header
      title: Number Of Lines To Skip
      type: integer
    provider:
      description: The provider of the watchlist
      title: Provider
      type: string
      required: true
    rawContent:
      description: The raw content that represents to watchlist items to create
      title: Raw Content
      type: string
    source:
      description: The source of the watchlist
      title: Source
      type: string
      required: true
      example: Local File
    tenantId:
      description: The tenantId where the watchlist belongs to
      title: Tenant ID
      type: string
    updated:
      description: The last time the watchlist was updated
      title: Updated
      type: string
    updatedBy:
      description: Describes a user that updated the watchlist
      title: Updated By
      type: UserInfo
    uploadStatus:
      description: The status of the watchlist
      title: Watchlist Upload Status
      type: string
    watchlistAlias:
      description: The alias of the watchlist
      title: Watchlist Alias
      type: string
    watchlistId:
      description: The id (a Guid) of the watchlist
      title: Watchlist ID
      type: string
    watchlistType:
      description: The type of the watchlist
      title: Watchlist Type
      type: string
  Watchlist:
    type:
      title: Type
      description: Resource type
      type: string
    id:
      title: ID
      description: Fully qualified resource ID for the resource
      type: string
    etag:
      title: Etag
      description: Entity tag of the resource
      type: string
    name:
      title: Name
      description: Resource name (short ID)
      type: string
    properties:
      title: Properties
      description: Watchlist properties
      type: WatchlistProperties
  # WatchlistItems
  WatchlistItemProperties:
    itemsKeyValue:
      title: Items Key Value
      description: Key-value pairs for a watchlist item
      type: object
      required: true
    created:
      title: Created at
      description: The time the watchlist item was created
      type: string
      reuiqred: false
    createdBy:
      title: Describes a user that created the watchlist item
      description: Created by
      type: UserInfo
      required: false
    entityMapping:
      title: Entity Mapping
      description: Key-value pairs for a watchlist item entity mapping
      type: object
      required: false
    isDeleted:
      title: A flag that indicates if the watchlist item is deleted or not
      description: Deleted Flag
      type: boolean
      default: false
      reuiqred: false
    tenantId:
      title: Tenant ID
      description: The tenant ID to which the watchlist item belongs to
      type: string
      required: false
    updated:
      title: Updated at
      description: The last time the watchlist item was updated
      type: string
      required: false
    updatedBy:
      title: Updated by
      description: Describes a user that updated the watchlist item
      type: UserInfo
      required: false
    watchlistItemId:
      title: Watchlist Item ID
      description: The id (a Guid) of the watchlist item
      type: string
      required: false
    watchlistItemType:
      title: Watchlist Item Type
      description: The type of the watchlist item
      type: string
      required: false
  WatchListItems:
    etag:
      title: Etag
      description: Etag of the azure resource
      type: string
      required: true
    id:
      title: ID
      description: Identifier created indicator
      type: string
      required: true
    name:
      title: Name
      description: Name of the entity
      type: string
      required: true
    type:
      title: Type
      description: Type of the entity
      type: string
      required: true
    properties:
      title: Properties
      description: Object containing all the necessary properties to conclude a query
      type: WatchlistItemProperties
      required: true
    systemData:
      title: System Data
      description: Azure Resource Manager metadata containing createdBy and modifiedBy information
      type: SystemData
      required: false
connection:
  client_id:
    title: Client ID
    description: The application ID that the application registration portal assigned
      to your app
    type: string
    required: true
    example: c163eff0-d1a1-4618-ee2a-453534f43cee
  client_secret:
    title: Client Secret
    type: credential_secret_key
    description: The application secret that you generated for your app in the app
      registration portal
    required: true
    example: ef50c6bx9umaik9agvoxtoqec2fg9f0y
  tenant_id:
    title: Tenant ID
    type: string
    description: The Azure Tenant ID is a Global Unique Identifier (GUID) for your Azure Active Directory Tenant
    required: true
    example: 5ceea899-ae8c-4ff1-fffe-353646eeeff0
actions:
  get_comment:
    title: Get Comment
    description: Gets a comment for a given incident
    input:
      incidentCommentId:
        title: Incident Comment ID
        required: true
        description: Incident Comment ID
        type: string
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: 73e01a99-5cd7-4139-a149-9f2736ff2ab5
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription. The name is case insensitive
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
    output:
      comment:
        title: Comment
        description: Requested comment
        type: IncidentComment
        required: true
  list_comments:
    title: List Comments
    description: List all the comment of the requested incident
    input:
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: 09b341e0-b2db-464e-9fef-c950b4eafa56
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 73e01a99-5cd7-4139-a149-9f2736ff2ab5
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
      filter:
        title: Filter
        required: false
        description: Filters the results, based on a Boolean condition
        type: string
        example: properties/author
      orderBy:
        title: Order By
        required: false
        description: Sorts the results
        type: string
        example: properties/createdTimeUtc
    output:
      comments:
        title: Comments
        description: List of comment objects
        type: "[]IncidentComment"
        required: true
  create_update_comment:
    title: Create Update Comment
    description: Creates or updates a comment for a given incident
    input:
      incidentCommentId:
        title: Incident Comment ID
        required: true
        description: Incident Comment ID
        type: string
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: 73e01a99-5cd7-4139-a149-9f2736ff2ab5
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
      etag:
        title: Etag
        description: Entity tag of the azure resource
        type: string
        example: "0300bf09-0000-0000-0000-5c37296e0000"
        required: false
      properties:
        title: Properties
        description: Comment properties
        required: true
        type: CommentProperties
        example: "{\"message\": \"some message\"}"
    output:
      comment:
        title: Comment
        description: Newly created incident comment
        type: IncidentComment
        required: true
  delete_comment:
    title: Delete Comment
    description: Deletes a comment for a given incident
    input:
      incidentCommentId:
        title: Incident Comment ID
        required: true
        description: Incident Comment ID
        type: string
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: 73e01a99-5cd7-4139-a149-9f2736ff2ab5
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
    output:
      status:
        title: Status
        description: Status code of the requested operation
        type: integer
        required: true
        example: 200
  create_update_incident:
    title: Create or Update Incident
    description: Creates a new incident or updates an existing incident 
    input:
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: incident-14071867
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: aaaef455-a780-44ca-9e51-aaafffeeea3a
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      properties:
        title: Properties
        description: Incident properties object
        required: true
        type: IncidentProperties
        example: "{'status': 'Closed'}"
    output:
      id:
        title: Full Incident ID
        description: Full incident ID
        type: string
        required: false
      name:
        title: Name
        description: Incident name - short ID
        type: string
        required: false
      type:
        title: Type
        description: Type
        type: string
        required: false
      etag:
        title: Etag
        type: string
        description: Etag
        required: false
      properties:
        title: Properties 
        description: Incident properties object
        type: IncidentProperties
        required: false
  list_incidents:
    title: List Incidents 
    description: List all the incidents matching specified criteria 
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID 
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      orderBy:
        title: Order By
        required: false
        description: Field to sort results by 
        type: string
        example: "properties/createdTimeUtc desc"
      top:
        title: Top
        description: Return top N elements from the collection 
        required: false
        type: integer
        example: 1867
    output:
      incidents:
        title: Incidents
        description: List of incidents objects 
        type: "[]Incident"
        required: false
  get_incident:
    title: Get Incident
    description: This action is used to get details for one specific incident
    input:
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: incident123
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID 
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
    output:
      id:
        title: Full Incident ID
        description: Full incident ID
        required: false
        type: string
      name:
        title: Incident ID
        description: Incident name - short ID
        required: false
        type: string
      type:
        title: Type
        description: Type of the incident
        required: false
        type: string
      jtag:
        title: Etag
        description: Etag of the incident
        required: false
        type: string
      properties:
        title: Properties
        description: Incident properties object
        required: false
        type: IncidentProperties
  delete_incident:
    title: Delete Incident
    description: Delete an incident from the system
    input:
      incidentId:
        title: Incident ID
        required: true
        description: ID of the incident to delete
        type: string
        example: incident123
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID 
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
    output:
      status:
        title: Deletion Status
        description: Deletion status, 200 - ok, 204 - no content
        type: integer
        required: false
  list_alerts:
    title: List Alerts
    description: This action is used to get all alerts for a given incident
    input:
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: incident123
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspacename12
    output:
      alerts:
        title: Alerts
        description: All the alerts assigned to the given incident
        type: "[]Alert"
        required: false
  list_bookmarks:
    title: List Bookmarks
    description: This action is used to get all bookmarks for a given incident
    input:
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: incident123
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
    output:
      bookmarks:
        title: Bookmark List
        description: All the bookmarks assigned to the given incident
        type: "[]HuntingBookmark"
        required: false
  list_entities:
    title: List Entities
    description: List all entities from a given incident
    input:
      incidentId:
        title: Incident ID
        required: true
        description: Incident ID
        type: string
        example: incident123
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
    output:
      entities:
        title: Entities
        description: All the entities assigned to the given incident
        type: "[]Entity"
        required: false
  create_indicator:
    title: Create Indicator
    description: Create a new threat intelligence indicator
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      kind:
        title: Kind
        description: The kind of the entity
        type: string
        required: true
        example: indicator
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorProperties
        required: true
        example: "{'source': 'Azure Sentinel',
          'threatIntelligenceTags': [
            'new schema'
          ],
          'displayName': 'new schema',
          'threatTypes': [
            'compromised'
          ],
          'pattern': '[url:value = 'https://example.com']',
          'patternType': 'url'}"
    output:
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      kind:
        title: Kind
        description: The kind of the entity
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorProperties
        required: true
  get_indicator:
    title: Get Indicator
    description: Get existing threat intelligence indicator
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      name:
        title: Name
        description: Threat intelligence indicator name field
        type: string
        required: true
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
    output:
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      kind:
        title: Kind
        description: The kind of the entity
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorProperties
        required: true
  update_indicator:
    title: Update Indicator
    description: Update existing threat intelligence indicator
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      name:
        title: Name
        description: Threat intelligence indicator name field
        type: string
        required: true
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorPropertiesUpdate
        required: true
        example: "{'source': 'Azure Sentinel',
          'threatIntelligenceTags': [
            'new schema'
          ],
          'displayName': 'new schema',
          'threatTypes': [
            'compromised'
          ],
          'pattern': '[url:value = 'https://example.com']',
          'patternType': 'url'}"
    output:
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      kind:
        title: Kind
        description: The kind of the entity
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorProperties
        required: true
  delete_indicator:
    title: Delete Indicator
    description: Delete existing threat intelligence indicator
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      name:
        title: Name
        description: Threat intelligence indicator name field
        type: string
        required: true
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
    output:
      message:
        title: Message
        description: Response message
        type: string
        required: true
  query_indicator:
    title: Query Threat Indicator
    description: Query threat intelligence indicators as per filtering criteria
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      names:
        title: Names
        description: Names of threat intelligence indicators
        type: "[]string"
        required: false
        example: "['4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014']"
      includeDisabled:
        title: Include Disabled Indicators
        description: Parameter to include/exclude disabled indicators
        type: boolean
        required: false
        example: true
      keywords:
        title: Keywords
        description: Keywords for searching threat intelligence indicators
        type: string
        required: false
        example: new schema
      maxConfidence:
        title: Maximum Confidence
        description: Filter by maximum confidence
        type: integer
        required: false
        example: 75
      minConfidence:
        title: Minimum Confidence
        description: Filter by minimum confidence
        type: integer
        required: false
        example: 0
      maxValidUntil:
        title: End Time
        description: End time for ValidUntil filter
        type: date
        required: false
        example: "2021-04-05T17:44:00.114052Z"
      minValidUntil:
        title: Start Time
        description: Start time for ValidUntil filter
        type: date
        required: false
        example: "2021-04-06T17:44:00.114052Z"
      pageSize:
        title: Page Size
        description: The number of items on the page
        type: integer
        required: false
        example: 100
      patternTypes:
        title: Pattern Types
        description: Filter by pattern types
        type: "[]string"
        required: false
        example: url
      sortBy:
        title: Sort By
        description: Columns to sort by and sorting order
        type: "[]ThreatIntelligenceSortingCriteria"
        required: false
        example: "[
          {
            'itemKey': 'created',
            'sortOrder': 'descending'
          }
        ]"
      sources:
        title: Sources
        description: Sources of threat intelligence indicators
        type: "[]string"
        required: false
        example: "['Azure Sentinel']"
      threatTypes:
        title: Threat Types
        description: Threat Types of Threat Inteligence Indicators
        type: "[]string"
        required: false
        example: "['compromised']"
    output:
      indicators:
        title: Threat Intelligence Indicators
        description: Filtred threat intelligence indicators
        type: "[]ThreatIntelligenceIndicators"
        required: true
  append_tags:
    title: Append Tags
    description: Append tags to a threat intelligence indicator
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      name:
        title: Name
        description: Threat intelligence indicator name field
        type: string
        required: true
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
      threatIntelligenceTags:
        title: Tags
        description: Array of tags to be appended to the threat intelligence indicator
        type: "[]string"
        required: true
        example: "['tag1', 'tag2']"
    output:
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      kind:
        title: Kind
        description: The kind of the entity
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorProperties
        required: true
  replace_tags:
    title: Replace Tags
    description: Replace tags to a threat intelligence indicator
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup12
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      name:
        title: Name
        description: Threat intelligence indicator name field
        type: string
        required: true
        example: 4bb36b7b-26ff-4d1c-9cbe-0d8ab3da0014
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorPropertiesReplaceTags
        required: true
        example: "{'threatIntelligenceTags': ['new_tag', 'another_tag]}"
    output:
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      kind:
        title: Kind
        description: The kind of the entity
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: ThreatIntelligenceIndicatorProperties
        required: true
  create_update_watchlist:
    title: Create or Update Watchlist
    description: Create or update a Watchlist and its Watchlist Items
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription. The name is case insensitive
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: somealias1
      properties:
        title: Watchlist Properties
        description: All the properties included in the body of the query
        type: WatchlistProperties
        required: true
        example: "{'displayName': 'High Value Assets Watchlist', 'source': 'Local File', 'provider': 'Microsoft', 'description': 'Watchlist from CSV content', 'itemsSearchKey': 'header1', 'contentType': 'text/csv'}"
    output:
      watchlist:
        title: Output Watchlist
        description: Output watchlist
        type: Watchlist
        required: false
  get_watchlist:
    title: Get Watchlist
    description: Get requested watchlist
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription. The name is case insensitive
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: examplealias1
    output:
      watchlist:
        title: Watchlist
        description: Requested watchlist
        type: Watchlist
        required: False
  delete_watchlist:
    title: Delete Watchlist
    description: Delete requested watchlist
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription. The name is case insensitive
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: examplealias1
    output:
      status:
        title: Deletion Status
        description: Deletion status, 200 - ok, 204 - no content
        type: integer
        required: false
  list_watchlists:
    title: List Watchlists
    description: List watchlists
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription. The name is case insensitive
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: d0cfe6b2-9ac0-4464-9919-dccaee2e48c0
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace1
    output:
      watchlists:
        title: Output Watchlists
        description: List of watchlists
        type: "[]Watchlist"
        required: False
  create_update_watchlist_items:
    title: Create or Update Watchlist Item
    description: Creates a new watchlist item or updates an existing watchlist item
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: aaaef455-a780-44ca-9e51-aaafffeeea3a
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: exampleAlias
      watchlistItemId:
        title: Watchlist Item ID
        description: Watchlist Item Id (GUID)
        type: string
        required: true
        example: 3395856c-e81f-2b73-82de-e72602f798b6
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: false
        example: 0300bf09-0000-0000-0000-5c37296e0000
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: WatchlistItemProperties
        required: true
        example: "{
            'Gateway subnet': 'https://example.com'
          }"
    output:
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: WatchlistItemProperties
        required: true
      systemData:
        title: System Data
        description: Azure Resource Manager metadata containing createdBy and modifiedBy information
        type: SystemData
        required: false
  get_watchlist_item:
    title: Get Watchlist Item
    description: Get existing Watchlist Item
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: aaaef455-a780-44ca-9e51-aaafffeeea3a
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: exampleAlias
      watchlistItemId:
        title: Watchlist Item ID
        description: Watchlist Item Id (GUID)
        type: string
        required: true
        example: 3395856c-e81f-2b73-82de-e72602f798b6
    output:
      etag:
        title: Etag
        description: Etag of the azure resource
        type: string
        required: true
      id:
        title: ID
        description: Identifier created indicator
        type: string
        required: true
      name:
        title: Name
        description: Name of the entity
        type: string
        required: true
      type:
        title: Type
        description: Type of the entity
        type: string
        required: true
      properties:
        title: Properties
        description: Object containing all the necessary properties to conclude a query
        type: WatchlistItemProperties
        required: true
      systemData:
        title: System Data
        description: Azure Resource Manager metadata containing createdBy and modifiedBy information
        type: SystemData
        required: false
  delete_watchlist_item:
    title: Delete Watchlist Item
    description: Delete existing Watchlist Item
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: aaaef455-a780-44ca-9e51-aaafffeeea3a
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: exampleAlias
      watchlistItemId:
        title: Watchlist Item ID
        description: Watchlist Item Id (GUID)
        type: string
        required: true
        example: 3395856c-e81f-2b73-82de-e72602f798b6
    output:
      message:
        title: Message
        description: Response message
        type: string
        required: true
  list_watchlist_items:
    title: List Watchlist Items
    description: List existing Watchlist Items
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID
        type: string
        example: aaaef455-a780-44ca-9e51-aaafffeeea3a
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      watchlistAlias:
        title: Watchlist Alias
        description: The watchlist alias
        type: string
        required: true
        example: exampleAlias
    output:
      watchlistItems:
        title: Watch List Items
        description: Gets all watchlist Items
        type: "[]WatchListItems"
        required: true
triggers:
  get_new_incidents:
    title: Get New Incidents
    description: Retrieves all new incidents with specific status within interval time
    input:
      resourceGroupName:
        title: Resource Group Name
        required: true
        description: The name of the resource group within the user's subscription
        type: string
        example: resourcegroup1
      subscriptionId:
        title: Subscription ID
        required: true
        description: Azure subscription ID 
        type: string
        example: 0caafeeb-aaa0-44ca-ffe1-aaaaeeeffffe
      workspaceName:
        title: Workspace Name
        required: true
        description: The name of the workspace
        type: string
        example: workspace23
      interval:
        title: Interval
        description: Integer value that represents interval time in seconds
        type: integer
        required: true
        example: 900
        default: 900
      status:
        title: Status
        description: Specifies the current status of incidents to show
        type: string
        enum:
          - "Active"
          - "Closed"
          - "New"
        required: true
        example: Active
        default: New
      last_update_time:
        title: Last Update Time
        description: Minimum time the incident was updated in ISO format
        type: date
        required: false
        example: 2022-05-06T12:20:18.364306
      assigned_to:
        title: Assigned To
        description: Filters incidents by who they were assigned to
        type: string
        required: false
        example: user@example.com
    output:
      incidents:
        title: Incidents
        description: List of all found incidents
        type: "[]Incident"
        required: true
