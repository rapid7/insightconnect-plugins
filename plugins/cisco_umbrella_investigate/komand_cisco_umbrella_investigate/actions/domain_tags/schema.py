# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Returns the date range when the domain being queried was a part of the Umbrella block list"


class Input:
    DOMAIN = "domain"
    

class Output:
    DOMAIN_TAGS = "domain_tags"
    

class DomainTagsInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "domain": {
      "type": "string",
      "title": "Domain Name",
      "description": "Domain name",
      "order": 1
    }
  },
  "required": [
    "domain"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class DomainTagsOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "domain_tags": {
      "type": "array",
      "title": "Domain Tags",
      "description": "Date range for which this domain has been in the block list, domain tag such as malware or phishing, identifying the security category of the domain, if available or possible, list the specific URL hosting the malicious content",
      "items": {
        "$ref": "#/definitions/tag_date"
      },
      "order": 1
    }
  },
  "required": [
    "domain_tags"
  ],
  "definitions": {
    "tag_date": {
      "type": "object",
      "title": "tag_date",
      "properties": {
        "begin": {
          "type": "string",
          "title": "Begin",
          "description": "The date of adding the domain to the block list. If the domain is currently in the block list, this date will be 'Current'",
          "order": 1
        },
        "category": {
          "type": "string",
          "title": "Category",
          "description": "The Umbrella security category or categories that match this domain",
          "order": 3
        },
        "end": {
          "type": "string",
          "title": "End",
          "description": "The date of removing the domain to the block list. If the domain is currently in the block list, this date will be 'Current'",
          "order": 2
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "The full URL containing the malicious code at the domain requested. Return is null if URL is not available",
          "order": 4
        }
      },
      "required": [
        "begin",
        "category",
        "end",
        "url"
      ]
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
