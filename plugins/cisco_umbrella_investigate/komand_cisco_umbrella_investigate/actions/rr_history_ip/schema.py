# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Return the history that Umbrella has seen for a given IP address"


class Input:
    IP = "ip"
    TYPE = "type"
    

class Output:
    FEATURES = "features"
    RRS = "rrs"
    

class RrHistoryIpInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "ip": {
      "type": "string",
      "title": "IP Address",
      "description": "IP address",
      "order": 2
    },
    "type": {
      "type": "string",
      "title": "DNS Record Type",
      "description": "DNS record query type (A, NS, MX, TXT and CNAME are supported)",
      "order": 1
    }
  },
  "required": [
    "ip"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class RrHistoryIpOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "features": {
      "type": "array",
      "title": "Features",
      "description": "Features",
      "items": {
        "$ref": "#/definitions/ip_feature"
      },
      "order": 2
    },
    "rrs": {
      "type": "array",
      "title": "Resource Records",
      "description": "RRS",
      "items": {
        "$ref": "#/definitions/ip_resource_record"
      },
      "order": 1
    }
  },
  "required": [
    "features",
    "rrs"
  ],
  "definitions": {
    "ip_feature": {
      "type": "object",
      "title": "ip_feature",
      "properties": {
        "div_ld2": {
          "type": "number",
          "title": "Div Ld2",
          "description": "ld2_count divided by the number of records",
          "order": 6
        },
        "div_ld2_1": {
          "type": "number",
          "title": "Div Ld2 1",
          "description": "ld2_1_count divided by the number of records",
          "order": 8
        },
        "div_ld2_2": {
          "type": "number",
          "title": "Div Ld2 2",
          "description": "ld2_2_count divided by the number of records",
          "order": 9
        },
        "div_ld3": {
          "type": "number",
          "title": "Div Ld3",
          "description": "ld3_count divided by the number of records",
          "order": 7
        },
        "ld2_1_count": {
          "type": "integer",
          "title": "Ld2 1 Count",
          "description": "Number of 2-level names, without the TLD, mapping to the given IP (for www.example.com, this considers example)",
          "order": 4
        },
        "ld2_2_count": {
          "type": "integer",
          "title": "Ld2 2 Count",
          "description": "Number of 3-level names, without the TLD, mapping to a given IP (for www.example.com, this considers www.example)",
          "order": 5
        },
        "ld2_count": {
          "type": "integer",
          "title": "Ld2 Count",
          "description": "Number of 2-level names mapping to the given IP (for www.example.com, this considers example.com)",
          "order": 2
        },
        "ld3_count": {
          "type": "integer",
          "title": "Ld3 Count",
          "description": "Number of 3-level names mapping to the given IP (for www.example.com, this considers www.example.com)",
          "order": 3
        },
        "rr_count": {
          "type": "integer",
          "title": "Rr Count",
          "description": "Number of records of that type mapping to the given IP",
          "order": 1
        }
      },
      "required": [
        "div_ld2",
        "div_ld2_1",
        "div_ld2_2",
        "div_ld3",
        "ld2_1_count",
        "ld2_2_count",
        "ld2_count",
        "ld3_count",
        "rr_count"
      ]
    },
    "ip_resource_record": {
      "type": "object",
      "title": "ip_resource_record",
      "properties": {
        "class": {
          "type": "string",
          "title": "Class",
          "description": "DNS class type",
          "order": 3
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The looked up IP address",
          "order": 5
        },
        "rr": {
          "type": "string",
          "title": "Rr",
          "description": "Resource record owner",
          "order": 1
        },
        "ttl": {
          "type": "integer",
          "title": "Ttl",
          "description": "Time to live for this record",
          "order": 2
        },
        "type": {
          "type": "string",
          "title": "Type",
          "description": "Query type",
          "order": 4
        }
      },
      "required": [
        "class",
        "name",
        "rr",
        "type"
      ]
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
