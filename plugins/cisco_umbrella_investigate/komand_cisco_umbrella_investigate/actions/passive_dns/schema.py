# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Provides historical data from our resolvers for domains, IPs, and other resource records"


class Input:
    NAME = "name"
    RECORDTYPE = "recordType"
    RESOURCE_RECORDS = "resource_records"
    

class Output:
    PAGEINFO = "pageInfo"
    RECORDINFO = "recordInfo"
    RECORDS = "records"
    TIMELINE_DATA = "timeline_data"
    

class PassiveDnsInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "name": {
      "type": "string",
      "title": "Name",
      "description": "Domain name, IP address or text",
      "order": 2
    },
    "recordType": {
      "type": "string",
      "title": "Record Type",
      "description": "The record types (A, NS, MX, TXT, CNAME) to return, use commas to separate multiple record types",
      "default": "A",
      "order": 3
    },
    "resource_records": {
      "type": "string",
      "title": "Resource Records",
      "description": "Resource records for which historical data is provided",
      "default": "Domain",
      "enum": [
        "Domain",
        "Name",
        "IP Address",
        "Raw Text",
        "Timeline"
      ],
      "order": 1
    }
  },
  "required": [
    "name",
    "resource_records"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class PassiveDnsOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "pageInfo": {
      "$ref": "#/definitions/page_info",
      "title": "Page Info",
      "description": "Information about page",
      "order": 2
    },
    "recordInfo": {
      "$ref": "#/definitions/record_info",
      "title": "Record Info",
      "description": "Information about record",
      "order": 3
    },
    "records": {
      "type": "array",
      "title": "Records",
      "description": "Provided records for a queried domain name, IP address or text",
      "items": {
        "$ref": "#/definitions/records"
      },
      "order": 1
    },
    "timeline_data": {
      "type": "array",
      "title": "Timeline Data",
      "description": "Snapshot of passive DNS and categorization history for a queried domain name",
      "items": {
        "$ref": "#/definitions/dns_timeline"
      },
      "order": 4
    }
  },
  "definitions": {
    "dnsData": {
      "type": "object",
      "title": "dnsData",
      "properties": {
        "ipData": {
          "$ref": "#/definitions/ipData",
          "title": "IP Data",
          "description": "Contains data that started/stopped being seen on the given date",
          "order": 1
        },
        "recordType": {
          "type": "string",
          "title": "Record Type",
          "description": "The DNS record type",
          "order": 2
        }
      },
      "definitions": {
        "ipData": {
          "type": "object",
          "title": "ipData",
          "properties": {
            "noLongerSeen": {
              "type": "array",
              "title": "No Longer Seen",
              "description": "Data that stopped being seen on the given date, may contain domains, IP addresses, and TXT records",
              "items": {
                "type": "string"
              },
              "order": 2
            },
            "startSeen": {
              "type": "array",
              "title": "Start Seen",
              "description": "Data that started being seen on the given date, may contain domains, IP addresses, and TXT records",
              "items": {
                "type": "string"
              },
              "order": 1
            }
          }
        }
      }
    },
    "dns_timeline": {
      "type": "object",
      "title": "dns_timeline",
      "properties": {
        "date": {
          "type": "string",
          "title": "Date",
          "displayType": "date",
          "description": "The date",
          "format": "date-time",
          "order": 1
        },
        "dnsData": {
          "type": "array",
          "title": "DNS Data",
          "description": "Contains the DNS record type and data that started/stopped being seen on the given date",
          "items": {
            "$ref": "#/definitions/dnsData"
          },
          "order": 2
        }
      },
      "definitions": {
        "dnsData": {
          "type": "object",
          "title": "dnsData",
          "properties": {
            "ipData": {
              "$ref": "#/definitions/ipData",
              "title": "IP Data",
              "description": "Contains data that started/stopped being seen on the given date",
              "order": 1
            },
            "recordType": {
              "type": "string",
              "title": "Record Type",
              "description": "The DNS record type",
              "order": 2
            }
          },
          "definitions": {
            "ipData": {
              "type": "object",
              "title": "ipData",
              "properties": {
                "noLongerSeen": {
                  "type": "array",
                  "title": "No Longer Seen",
                  "description": "Data that stopped being seen on the given date, may contain domains, IP addresses, and TXT records",
                  "items": {
                    "type": "string"
                  },
                  "order": 2
                },
                "startSeen": {
                  "type": "array",
                  "title": "Start Seen",
                  "description": "Data that started being seen on the given date, may contain domains, IP addresses, and TXT records",
                  "items": {
                    "type": "string"
                  },
                  "order": 1
                }
              }
            }
          }
        },
        "ipData": {
          "type": "object",
          "title": "ipData",
          "properties": {
            "noLongerSeen": {
              "type": "array",
              "title": "No Longer Seen",
              "description": "Data that stopped being seen on the given date, may contain domains, IP addresses, and TXT records",
              "items": {
                "type": "string"
              },
              "order": 2
            },
            "startSeen": {
              "type": "array",
              "title": "Start Seen",
              "description": "Data that started being seen on the given date, may contain domains, IP addresses, and TXT records",
              "items": {
                "type": "string"
              },
              "order": 1
            }
          }
        }
      }
    },
    "ipData": {
      "type": "object",
      "title": "ipData",
      "properties": {
        "noLongerSeen": {
          "type": "array",
          "title": "No Longer Seen",
          "description": "Data that stopped being seen on the given date, may contain domains, IP addresses, and TXT records",
          "items": {
            "type": "string"
          },
          "order": 2
        },
        "startSeen": {
          "type": "array",
          "title": "Start Seen",
          "description": "Data that started being seen on the given date, may contain domains, IP addresses, and TXT records",
          "items": {
            "type": "string"
          },
          "order": 1
        }
      }
    },
    "page_info": {
      "type": "object",
      "title": "page_info",
      "properties": {
        "hasMoreRecords": {
          "type": "boolean",
          "title": "Has More Records",
          "description": "Whether the query has more records",
          "order": 1
        },
        "limit": {
          "type": "integer",
          "title": "Limit",
          "description": "The maximum number of records to return",
          "order": 3
        },
        "offset": {
          "type": "integer",
          "title": "Offset",
          "description": "The amount by which to offset the records",
          "order": 2
        },
        "totalNumRecords": {
          "type": "integer",
          "title": "Total Number Of Records",
          "description": "Total number of records provided for a query",
          "order": 4
        }
      }
    },
    "record_info": {
      "type": "object",
      "title": "record_info",
      "properties": {
        "maxTtl": {
          "type": "integer",
          "title": "Maximum TTL",
          "description": "The maximum TTL for the record in seconds",
          "order": 2
        },
        "minTtl": {
          "type": "integer",
          "title": "Minimum TTL",
          "description": "The minimum TTL for the record in seconds",
          "order": 1
        },
        "totalMaliciousDomain": {
          "type": "integer",
          "title": "Total Malicious Domain",
          "description": "Total number of malicious domains for a query",
          "order": 3
        },
        "totalMaliciousIP": {
          "type": "integer",
          "title": "Total Malicious IP",
          "description": "Total number of malicious IPs for a query",
          "order": 4
        }
      }
    },
    "records": {
      "type": "object",
      "title": "records",
      "properties": {
        "contentCategories": {
          "type": "array",
          "title": "Content Categories",
          "description": "The Umbrella content categories",
          "items": {
            "type": "string"
          },
          "order": 1
        },
        "firstSeen": {
          "type": "integer",
          "title": "First Seen",
          "description": "The first time a query was seen by Umbrella for the domain, in epoch time",
          "order": 2
        },
        "firstSeenISO": {
          "type": "string",
          "title": "First Seen ISO",
          "description": "The first time a query was seen by Umbrella for the domain, in ISO date and time format",
          "order": 3
        },
        "lastSeen": {
          "type": "integer",
          "title": "Last Seen",
          "description": "The last time a query was seen by Umbrella for the domain, in epoch time",
          "order": 4
        },
        "lastSeenISO": {
          "type": "string",
          "title": "Last Seen ISO",
          "description": "The last time a query was seen by Umbrella for the domain, in ISO date and time format",
          "order": 5
        },
        "maxTtl": {
          "type": "integer",
          "title": "Maximum TTL",
          "description": "The maximum TTL for the record in seconds",
          "order": 6
        },
        "minTtl": {
          "type": "integer",
          "title": "Minimum TTL",
          "description": "The minimum TTL for the record in seconds",
          "order": 7
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The query",
          "order": 8
        },
        "rr": {
          "type": "string",
          "title": "RR",
          "description": "The DNS resource record (RR)",
          "order": 9
        },
        "securityCategories": {
          "type": "array",
          "title": "Security Categories",
          "description": "The Umbrella security categories",
          "items": {
            "type": "string"
          },
          "order": 10
        },
        "type": {
          "type": "string",
          "title": "Type",
          "description": "The DNS record type",
          "order": 11
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
