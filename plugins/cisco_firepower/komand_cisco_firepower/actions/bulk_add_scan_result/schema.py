# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Add scan results from a third-party vulnerability scanner"


class Input:
    OPERATION = "operation"
    SCAN_RESULTS = "scan_results"
    

class Output:
    COMMANDS_PROCESSED = "commands_processed"
    ERRORS = "errors"
    

class BulkAddScanResultInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "operation": {
      "type": "string",
      "title": "Operation",
      "description": "The operation to be performed when adding scan results. ScanFlush to remove existing scan results or ScanUpdate to keep existing scan results",
      "enum": [
        "ScanUpdate",
        "ScanFlush"
      ],
      "order": 2
    },
    "scan_results": {
      "type": "array",
      "title": "Scan Results",
      "description": "Scan results to add",
      "items": {
        "$ref": "#/definitions/scan_result"
      },
      "order": 1
    }
  },
  "required": [
    "operation"
  ],
  "definitions": {
    "host": {
      "type": "object",
      "title": "host",
      "properties": {
        "ip_address": {
          "type": "string",
          "title": "IP Address",
          "default": "",
          "order": 1
        },
        "operating_system": {
          "$ref": "#/definitions/os",
          "title": "Host Operating System",
          "order": 2
        }
      },
      "required": [
        "ip_address"
      ],
      "definitions": {
        "os": {
          "type": "object",
          "title": "os",
          "properties": {
            "name": {
              "type": "string",
              "title": "Name",
              "order": 2
            },
            "vendor": {
              "type": "string",
              "title": "Vendor",
              "order": 1
            },
            "version": {
              "type": "string",
              "title": "Version",
              "order": 3
            }
          }
        }
      }
    },
    "os": {
      "type": "object",
      "title": "os",
      "properties": {
        "name": {
          "type": "string",
          "title": "Name",
          "order": 2
        },
        "vendor": {
          "type": "string",
          "title": "Vendor",
          "order": 1
        },
        "version": {
          "type": "string",
          "title": "Version",
          "order": 3
        }
      }
    },
    "result_details": {
      "type": "object",
      "title": "result_details",
      "properties": {
        "bugtraq_ids": {
          "type": "array",
          "title": "Bugtraq IDs",
          "description": "The identification numbers associated with the vulnerability in the Bugtraq database (http://www.securityfocus.com/bid)",
          "items": {
            "type": "string"
          },
          "order": 9
        },
        "cve_ids": {
          "type": "array",
          "title": "CVE IDs",
          "description": "The identification number associated with the vulnerability in MITRE’s Common Vulnerabilities and Exposures (CVE) database (http://www.cve.mitre.org/)",
          "items": {
            "type": "string"
          },
          "order": 8
        },
        "description": {
          "type": "string",
          "title": "Description",
          "order": 7
        },
        "port": {
          "type": "string",
          "title": "Port",
          "order": 5
        },
        "protocol_id": {
          "type": "string",
          "title": "Protocol ID",
          "order": 6
        },
        "scanner_id": {
          "type": "string",
          "title": "Scanner ID",
          "description": "Scanner ID for the scanner that obtained the scan results",
          "order": 2
        },
        "source_id": {
          "type": "string",
          "title": "Source ID",
          "description": "Application or source ID",
          "order": 1
        },
        "vulnerability_id": {
          "type": "string",
          "title": "Vulnerability ID",
          "order": 3
        },
        "vulnerability_title": {
          "type": "string",
          "title": "Vulnerability Title",
          "description": "Title of the vulnerability",
          "order": 4
        }
      },
      "required": [
        "scanner_id",
        "source_id",
        "vulnerability_id",
        "vulnerability_title"
      ]
    },
    "scan_result": {
      "type": "object",
      "title": "scan_result",
      "properties": {
        "host": {
          "$ref": "#/definitions/host",
          "title": "Host",
          "description": "Add an untracked host to the network map",
          "order": 1
        },
        "scan_result_details": {
          "$ref": "#/definitions/result_details",
          "title": "Scan Result Details",
          "description": "Scan result for the host",
          "order": 2
        }
      },
      "definitions": {
        "host": {
          "type": "object",
          "title": "host",
          "properties": {
            "ip_address": {
              "type": "string",
              "title": "IP Address",
              "default": "",
              "order": 1
            },
            "operating_system": {
              "$ref": "#/definitions/os",
              "title": "Host Operating System",
              "order": 2
            }
          },
          "required": [
            "ip_address"
          ],
          "definitions": {
            "os": {
              "type": "object",
              "title": "os",
              "properties": {
                "name": {
                  "type": "string",
                  "title": "Name",
                  "order": 2
                },
                "vendor": {
                  "type": "string",
                  "title": "Vendor",
                  "order": 1
                },
                "version": {
                  "type": "string",
                  "title": "Version",
                  "order": 3
                }
              }
            }
          }
        },
        "os": {
          "type": "object",
          "title": "os",
          "properties": {
            "name": {
              "type": "string",
              "title": "Name",
              "order": 2
            },
            "vendor": {
              "type": "string",
              "title": "Vendor",
              "order": 1
            },
            "version": {
              "type": "string",
              "title": "Version",
              "order": 3
            }
          }
        },
        "result_details": {
          "type": "object",
          "title": "result_details",
          "properties": {
            "bugtraq_ids": {
              "type": "array",
              "title": "Bugtraq IDs",
              "description": "The identification numbers associated with the vulnerability in the Bugtraq database (http://www.securityfocus.com/bid)",
              "items": {
                "type": "string"
              },
              "order": 9
            },
            "cve_ids": {
              "type": "array",
              "title": "CVE IDs",
              "description": "The identification number associated with the vulnerability in MITRE’s Common Vulnerabilities and Exposures (CVE) database (http://www.cve.mitre.org/)",
              "items": {
                "type": "string"
              },
              "order": 8
            },
            "description": {
              "type": "string",
              "title": "Description",
              "order": 7
            },
            "port": {
              "type": "string",
              "title": "Port",
              "order": 5
            },
            "protocol_id": {
              "type": "string",
              "title": "Protocol ID",
              "order": 6
            },
            "scanner_id": {
              "type": "string",
              "title": "Scanner ID",
              "description": "Scanner ID for the scanner that obtained the scan results",
              "order": 2
            },
            "source_id": {
              "type": "string",
              "title": "Source ID",
              "description": "Application or source ID",
              "order": 1
            },
            "vulnerability_id": {
              "type": "string",
              "title": "Vulnerability ID",
              "order": 3
            },
            "vulnerability_title": {
              "type": "string",
              "title": "Vulnerability Title",
              "description": "Title of the vulnerability",
              "order": 4
            }
          },
          "required": [
            "scanner_id",
            "source_id",
            "vulnerability_id",
            "vulnerability_title"
          ]
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class BulkAddScanResultOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "commands_processed": {
      "type": "number",
      "title": "Commands Processed",
      "description": "Number of commands processed",
      "order": 2
    },
    "errors": {
      "type": "number",
      "title": "Errors",
      "description": "Number of errors",
      "order": 1
    }
  },
  "required": [
    "commands_processed",
    "errors"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
