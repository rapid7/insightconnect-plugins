# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Get alerts that match a given key to its value"


class Input:
    FREQUENCY = "frequency"
    KEY = "key"
    VALUE = "value"


class Output:
    ALERT = "alert"


class GetAlertMatchingKeyInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "frequency": {
      "type": "integer",
      "description": "Poll frequency in seconds",
      "default": 10,
      "order": 3
    },
    "key": {
      "type": "string",
      "description": "The key to look for in the alert. This key must match the case shown in the example output section in help",
      "order": 1
    },
    "value": {
      "type": "string",
      "description": "The value to look for in the alert. The value must match the case of the value returned",
      "order": 2
    }
  },
  "required": [
    "key",
    "value"
  ],
  "definitions": {}
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class GetAlertMatchingKeyOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "alert": {
      "$ref": "#/definitions/alert",
      "title": "Alert",
      "description": "An alert that contains the given key and matching value",
      "order": 1
    }
  },
  "required": [
    "alert"
  ],
  "definitions": {
    "alert": {
      "type": "object",
      "title": "alert",
      "properties": {
        "id": {
          "type": "string",
          "title": "ID",
          "description": "ID",
          "order": 1
        },
        "incidentId": {
          "type": "integer",
          "title": "Incident ID",
          "description": "Incident ID",
          "order": 2
        },
        "investigationId": {
          "type": "integer",
          "title": "Investigation ID",
          "description": "Investigation ID",
          "order": 3
        },
        "assignedTo": {
          "type": "string",
          "title": "Assigned To",
          "description": "Assigned To",
          "order": 4
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "Severity",
          "order": 5
        },
        "status": {
          "type": "string",
          "title": "Status",
          "description": "Status",
          "order": 6
        },
        "classification": {
          "type": "string",
          "title": "Classification",
          "description": "Classification",
          "order": 7
        },
        "determination": {
          "type": "string",
          "title": "Determination",
          "description": "Determination",
          "order": 8
        },
        "investigationState": {
          "type": "string",
          "title": "Investigation State",
          "description": "Investigation state",
          "order": 9
        },
        "detectionSource": {
          "type": "string",
          "title": "Detection Source",
          "description": "Detection source",
          "order": 10
        },
        "category": {
          "type": "string",
          "title": "Category",
          "description": "Category",
          "order": 11
        },
        "threatFamilyName": {
          "type": "string",
          "title": "Threat Family Name",
          "description": "Threat family name",
          "order": 12
        },
        "title": {
          "type": "string",
          "title": "Title",
          "description": "Title",
          "order": 13
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description",
          "order": 14
        },
        "alertCreationTime": {
          "type": "string",
          "title": "Alert Creation Time",
          "description": "Alert creation time",
          "order": 15
        },
        "firstEventTime": {
          "type": "string",
          "title": "First Event Time",
          "description": "First event time",
          "order": 16
        },
        "lastEventTime": {
          "type": "string",
          "title": "Last Event Time",
          "description": "Last event time",
          "order": 17
        },
        "lastUpdateTime": {
          "type": "string",
          "title": "Last Update Time",
          "description": "Last update time",
          "order": 18
        },
        "resolvedTime": {
          "type": "string",
          "title": "Resolved Time",
          "description": "Resolved time",
          "order": 19
        },
        "machineId": {
          "type": "string",
          "title": "Machine ID",
          "description": "Machine ID",
          "order": 20
        },
        "computerDnsName": {
          "type": "string",
          "title": "Computer DNS Name",
          "description": "Computer DNS name",
          "order": 21
        },
        "rbacGroupName": {
          "type": "string",
          "title": "RBAC Group Name",
          "description": "RBAC group name",
          "order": 22
        },
        "aadTenantId": {
          "type": "string",
          "title": "AAD Tenant ID",
          "description": "AAD tenant ID",
          "order": 23
        },
        "relatedUser": {
          "$ref": "#/definitions/related_user_object",
          "title": "Related User",
          "description": "Related user",
          "order": 24
        },
        "evidence": {
          "type": "array",
          "title": "Evidence",
          "description": "List of related alert evidence",
          "items": {
            "$ref": "#/definitions/evidence"
          },
          "order": 25
        }
      }
    },
    "related_user_object": {
      "type": "object",
      "title": "related_user_object",
      "properties": {
        "domainName": {
          "type": "string",
          "title": "Domain Name",
          "description": "Domain name",
          "order": 1
        },
        "userName": {
          "type": "string",
          "title": "User Name",
          "description": "User name",
          "order": 2
        }
      }
    },
    "evidence": {
      "type": "object",
      "title": "evidence",
      "properties": {
        "entityType": {
          "type": "string",
          "title": "Entity Type",
          "description": "Type of evidence",
          "order": 1
        },
        "evidenceCreationTime": {
          "type": "string",
          "title": "Evidence Creation Time",
          "description": "Creation time of evidence in ISO 8601 format",
          "order": 2
        },
        "sha1": {
          "type": "string",
          "title": "SHA1",
          "description": "SHA1 hash",
          "order": 3
        },
        "sha256": {
          "type": "string",
          "title": "SHA256",
          "description": "SHA256 hash",
          "order": 4
        },
        "filePath": {
          "type": "string",
          "title": "File Path",
          "description": "File Path",
          "order": 5
        },
        "fileName": {
          "type": "string",
          "title": "File Name",
          "description": "File Name",
          "order": 6
        },
        "processId": {
          "type": "integer",
          "title": "Process ID",
          "description": "Process ID",
          "order": 7
        },
        "processCommandLine": {
          "type": "string",
          "title": "Process Command Line",
          "description": "Process Command Line",
          "order": 8
        },
        "processCreationTime": {
          "type": "string",
          "title": "Process Creation Time",
          "description": "Process Creation Time in ISO 8601 format",
          "order": 9
        },
        "parentProcessID": {
          "type": "integer",
          "title": "Parent Process ID",
          "description": "Parent process ID",
          "order": 10
        },
        "parentProcessCreationTime": {
          "type": "string",
          "title": "Parent Process Creation Time",
          "description": "Parent Process Creation Time in ISO 8601 format",
          "order": 11
        },
        "parentProcessFileName": {
          "type": "string",
          "title": "Parent Process File Name",
          "description": "Parent Process File Name",
          "order": 12
        },
        "parentProcessFilePath": {
          "type": "string",
          "title": "Parent Process File Path",
          "description": "Parent Process File Path",
          "order": 13
        },
        "ipAddress": {
          "type": "string",
          "title": "IP Address",
          "description": "IP Address",
          "order": 14
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "URL",
          "order": 15
        },
        "registryKey": {
          "type": "string",
          "title": "Registry Key",
          "description": "A key-level node in the Windows registry",
          "order": 16
        },
        "registryHive": {
          "type": "string",
          "title": "Registry Hive",
          "description": "Registry Hive",
          "order": 17
        },
        "registryValueType": {
          "type": "string",
          "title": "Registry Value Type",
          "description": "Registry Value Type",
          "order": 18
        },
        "registryValue": {
          "type": "string",
          "title": "Registry Value",
          "description": "Registry Value",
          "order": 19
        },
        "accountName": {
          "type": "string",
          "title": "Account Name",
          "description": "Account Name",
          "order": 20
        },
        "domainName": {
          "type": "string",
          "title": "Domain Name",
          "description": "Domain Name",
          "order": 21
        },
        "userSid": {
          "type": "string",
          "title": "User SID",
          "description": "User Secrurity ID",
          "order": 22
        },
        "aadUserId": {
          "type": "string",
          "title": "AAD User ID",
          "description": "Azure Active Directory User ID",
          "order": 23
        },
        "userPrincipalName": {
          "type": "string",
          "title": "User Principal Name",
          "description": "User Principal Name",
          "order": 24
        },
        "detectionStatus": {
          "type": "string",
          "title": "Detection Status",
          "description": "Detection Status",
          "order": 25
        }
      }
    }
  }
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
