plugin_spec_version: v2
extension: plugin
products: ["insightconnect"]
name: microsoft_atp
title: Microsoft Windows Defender ATP
description: The Windows Defender Advanced Threat Protection plugin allows Rapid7 InsightConnect users to quickly take remediation actions across their organization. This plugin can isolate machines, run virus scans, and quarantine files
version: 5.0.0
connection_version: 5
supported_versions: ["2022-05-20"]
vendor: rapid7
support: community
cloud_ready: true
status: []
resources:
  vendor_url: https://www.microsoft.com/
  docs_url: https://docs.rapid7.com/insightconnect/microsoft-defender-ATP
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/microsoft_atp
tags:
- windows
- atp
- microsoft
- defender
hub_tags:
  use_cases: [threat_detection_and_response, user_management, alerting_and_notifications, devops]
  keywords: [windows, atp, microsoft, defender, cloud_enabled]
  features: []

types:
  manage_tags_response:
    "@odata.context":
      title: "@Odata.Context"
      type: string
      description: "@odata.context"
      required: false
    agentVersion:
      title: Agent Version
      type: string
      description: Agent version
      required: false
    computerDnsName:
      title: Computer DNS Name
      type: string
      description: Computer DNS name
      required: false
    deviceValue:
      title: Device Value
      type: string
      description: Device value
      required: false
    exposureLevel:
      title: Exposure Level
      type: string
      description: Exposure level
      required: false
    firstSeen:
      title: First Seen
      type: string
      description: First seen
      required: false
    healthStatus:
      title: Health Status
      type: string
      description: Health status
      required: false
    id:
      title: ID
      type: string
      description: ID
      required: false
    isAadJoined:
      title: Is AAD Joined
      type: boolean
      description: Is AAD joined
      required: false
    lastExternalIpAddress:
      title: Last External IP Address
      type: string
      description: Last external IP address
      required: false
    lastIpAddress:
      title: Last IP Address
      type: string
      description: Last IP address
      required: false
    lastSeen:
      title: Last Seen
      type: string
      description: Last seen
      required: false
    machineTags:
      title: Machine Tags
      type: "[]string"
      description: Machine tags
      required: false
    osBuild:
      title: OS Build
      type: integer
      description: OS build
      required: false
    osPlatform:
      title: OS Platform
      type: string
      description: OS platform
      required: false
    osProcessor:
      title: OS Processor
      type: string
      description: OS Processor
      required: false
    rbacGroupId:
      title: RBAC Group ID
      type: integer
      description: RBAC group ID
      required: false
    riskScore:
      title: Risk Score
      type: string
      description: Risk score
      required: false
    version:
      title: Version
      type: string
      description: Version
      required: false
  software:
    activeAlert:
      title: Active Alert
      type: boolean
      description: Active alert
      required: false
    exposedMachines:
      title: Exposed Machines
      type: integer
      description: Exposed machines
      required: false
    id:
      title: ID
      type: string
      description: ID
      required: false
    impactScore:
      title: Impact Score
      type: float
      description: Impact score
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    publicExploit:
      title: Public Exploit
      type: boolean
      description: Public exploit
      required: false
    vendor:
      title: Vendor
      type: string
      description: Vendor
      required: false
    weaknesses:
      title: Weaknesses
      type: integer
      description: Weaknesses
      required: false
  related_user_object:
    domainName:
      title: "Domain Name"
      description: "Domain name"
      required: false
      type: string
    userName:
      title: User Name
      description: User name
      required: false
      type: string
  evidence:
    entityType:
      title: Entity Type
      description: Type of evidence
      required: false
      type: string
    evidenceCreationTime:
      title: Evidence Creation Time
      description: Creation time of evidence in ISO 8601 format
      required: false
      type: string
    sha1:
      title: SHA1
      description: SHA1 hash
      required: false
      type: string
    sha256:
      title: SHA256
      description: SHA256 hash
      required: false
      type: string
    filePath:
      title: File Path
      description: File Path
      required: false
      type: string
    fileName:
      title: File Name
      description: File Name
      required: false
      type: string
    processId:
      title: Process ID
      description: Process ID
      required: false
      type: integer
    processCommandLine:
      title: Process Command Line
      description: Process Command Line
      required: false
      type: string
    processCreationTime:
      title: Process Creation Time
      description: Process Creation Time in ISO 8601 format
      required: false
      type: string
    parentProcessID:
      title: Parent Process ID
      description: Parent process ID
      required: false
      type: integer
    parentProcessCreationTime:
      title: Parent Process Creation Time
      description: Parent Process Creation Time in ISO 8601 format
      required: false
      type: string
    parentProcessFileName:
      title: Parent Process File Name
      description: Parent Process File Name
      required: false
      type: string
    parentProcessFilePath:
      title: Parent Process File Path
      description: Parent Process File Path
      required: false
      type: string
    ipAddress:
      title: IP Address
      description: IP Address
      required: false
      type: string
    url:
      title: URL
      description: URL
      required: false
      type: string
    registryKey:
      title: Registry Key
      description: A key-level node in the Windows registry
      required: false
      type: string
    registryHive:
      title: Registry Hive
      description: Registry Hive
      required: false
      type: string
    registryValueType:
      title: Registry Value Type
      description: Registry Value Type
      required: false
      type: string
    registryValue:
      title: Registry Value
      description: Registry Value
      required: false
      type: string
    accountName:
      title: Account Name
      description: Account Name
      required: false
      type: string
    domainName:
      title: Domain Name
      description: Domain Name
      required: false
      type: string
    userSid:
      title: User SID
      description: User Secrurity ID
      required: false
      type: string
    aadUserId:
      title: AAD User ID
      description: Azure Active Directory User ID
      required: false
      type: string
    userPrincipalName:
      title: User Principal Name
      description: User Principal Name
      required: false
      type: string
    detectionStatus:
      title: Detection Status
      description: Detection Status
      required: false
      type: string
  alert:
    id:
      title: "ID"
      type: string
      description: "ID"
      required: false
    incidentId:
      title: "Incident ID"
      type: integer
      description: "Incident ID"
      required: false
    investigationId:
      title: "Investigation ID"
      type: integer
      description: "Investigation ID"
      required: false
    assignedTo:
      title: "Assigned To"
      type: string
      description: "Assigned To"
      required: false
    severity:
      title: "Severity"
      type: string
      description: "Severity"
      required: false
    status:
      title: "Status"
      type: string
      description: "Status"
      required: false
    classification:
      title: "Classification"
      type: string
      description: "Classification"
      required: false
    determination:
      title: "Determination"
      type: string
      description: "Determination"
      required: false
    investigationState:
      title: "Investigation State"
      type: string
      description: "Investigation state"
      required: false
    detectionSource:
      title: "Detection Source"
      type: string
      description: "Detection source"
      required: false
    category:
      title: "Category"
      type: string
      description: "Category"
      required: false
    threatFamilyName:
      title: "Threat Family Name"
      type: string
      description: "Threat family name"
      required: false
    title:
      title: "Title"
      type: string
      description: "Title"
      required: false
    description:
      title: "Description"
      type: string
      description: "Description"
      required: false
    alertCreationTime:
      title: "Alert Creation Time"
      type: string
      description: "Alert creation time"
      required: false
    firstEventTime:
      title: "First Event Time"
      type: string
      description: "First event time"
      required: false
    lastEventTime:
      title: "Last Event Time"
      type: string
      description: "Last event time"
      required: false
    lastUpdateTime:
      title: "Last Update Time"
      type: string
      description: "Last update time"
      required: false
    resolvedTime:
      title: "Resolved Time"
      type: string
      description: "Resolved time"
      required: false
    machineId:
      title: "Machine ID"
      type: string
      description: "Machine ID"
      required: false
    computerDnsName:
      title: "Computer DNS Name"
      type: string
      description: "Computer DNS name"
      required: false
    rbacGroupName:
      title: "RBAC Group Name"
      type: string
      description: "RBAC group name"
      required: false
    aadTenantId:
      title: "AAD Tenant ID"
      type: string
      description: "AAD tenant ID"
      required: false
    relatedUser:
      title: "Related User"
      type: related_user_object
      description: "Related user"
      required: false
    evidence:
      title: "Evidence"
      type: "[]evidence"
      description: List of related alert evidence
      required: false
  file_type:
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false
    globalPrevalence:
      title: "Global Prevalence"
      type: integer
      description: "Global prevalence"
      required: false
    globalFirstObserved:
      title: "Global First Observed"
      type: string
      description: "Global first observed"
      required: false
    globalLastObserved:
      title: "Global Last Observed"
      type: string
      description: "Global last observed"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false
    fileType:
      title: "File Type"
      type: string
      description: "File type"
      required: false
    isPeFile:
      title: "Is PE File"
      type: boolean
      description: "Is PE File"
      required: false
    filePublisher:
      title: "File Publisher"
      type: string
      description: "File publisher"
      required: false
    fileProductName:
      title: "File Product Name"
      type: string
      description: "File product name"
      required: false
    signer:
      title: "Signer"
      type: string
      description: "Signer"
      required: false
    issuer:
      title: "Issuer"
      type: string
      description: "Issuer"
      required: false
    signerHash:
      title: "Signer Hash"
      type: string
      description: "Signer hash"
      required: false
    isValidCertificate:
      title: "Is Valid Certificate"
      type: boolean
      description: "Is valid certificate"
      required: false
    determinationType:
      title: "Determination Type"
      type: string
      description: "Determination type"
      required: false
    determinationValue:
      title: "Determination Value"
      type: string
      description: "Determination value"
      required: false
  machine_software:
     id:
       title: ID
       type: string
       description: ID
       required: false
     computerDnsName:
       title: Computer DNS Name
       type: string
       description: Computer DNS name
       required: false
     osPlatform:
       title: OS Platform
       type: string
       description: OS platform
       required: false
     rbacGroupName:
       title: RBAC Group Name
       type: string
       description: RBAC group name
       required: false
     rbacGroupId:
       title: RBAC Group ID
       type: number
       description: RBAC group ID
       required: false
  machine:
     agentVersion:
       title: "Agent Version"
       type: string
       description: "Agent version"
       required: false
     computerDnsName:
       title: "Computer DNS Name"
       type: string
       description: "Computer DNS name"
       required: false
     exposureLevel:
       title: "Exposure Level"
       type: string
       description: "Exposure level"
       required: false
     firstSeen:
       title: "First Seen"
       type: string
       description: "First seen"
       required: false
     healthStatus:
       title: "Health Status"
       type: string
       description: "Health status"
       required: false
     id:
       title: "ID"
       type: string
       description: "ID"
       required: false
     lastExternalIpAddress:
       title: "Last External IP Address"
       type: string
       description: "Last external IP address"
       required: false
     lastIpAddress:
       title: "Last IP Address"
       type: string
       description: "Last IP address"
       required: false
     lastSeen:
       title: "Last Seen"
       type: string
       description: "Last seen"
       required: false
     osBuild:
       title: "OS Build"
       type: integer
       description: "OS build"
       required: false
     osPlatform:
       title: "OS Platform"
       type: string
       description: "OS platform"
       required: false
     osProcessor:
       title: "OS Processor"
       type: string
       description: "OS processor"
       required: false
     rbacGroupId:
       title: "RBAC Group ID"
       type: integer
       description: "RBAC group ID"
       required: false
     riskScore:
       title: "Risk Score"
       type: string
       description: "Risk score"
       required: false
     version:
       title: "Version"
       type: string
       description: "Version"
       required: false
     machineTags:
       title: "Machine Tags"
       type: '[]string'
       description: "Machine Tags"
       required: false
  machine_action:
     creationDateTimeUtc:
       title: "Creation Date Time UTC"
       type: string
       description: "Creation date time UTC"
       required: false
     errorHResult:
       title: "Error HResult"
       type: integer
       description: "Error HResult"
       required: false
     id:
       title: "ID"
       type: string
       description: "ID"
       required: false
     lastUpdateDateTimeUtc:
       title: "Last Update Date Time UTC"
       type: string
       description: "Last update date time UTC"
       required: false
     machineId:
       title: "Machine ID"
       type: string
       description: "Machine ID"
       required: false
     requestor:
       title: "Requestor"
       type: string
       description: "Requestor"
       required: false
     requestorComment:
       title: "Requestor Comment"
       type: string
       description: "Requestor comment"
       required: false
     status:
       title: "Status"
       type: string
       description: "Status"
       required: false
  indicator_action:
    "@odata.context":
      title: "@Odata.Context"
      type: string
      description: "@odata.context"
      required: false
    id:
      title: Indicator ID
      type: string
      description: Identity of the indicator entity
      required: false
    indicatorValue:
      title: Indicator Value
      type: string
      description: "The potentially malicious indicator of one of the following types: IP addresses, URLs, domains, and SHA1 and SHA256 hashes"
      required: false
    indicatorType:
      type: string
      title: Indicator Type
      description: Type of the indicator
      example: Url
      required: false
    application:
      type: string
      title: Application
      description: The application associated with the indicator
      example: demo-test
      required: false
    action:
      type: string
      title: Action
      description: The action that will be taken if the indicator will be discovered in the organization
      example: AlertAndBlock
      required: false
    sourceType:
      type: string
      title: Source Type
      description: User in case the Indicator created by a user (e.g. from the portal), AadApp in case it submitted using automated application via the API.
      example: AadApp
      required: false
    source:
      type: string
      title: Source
      description: The name of the user/application that submitted the indicator
      example: test
      required: false
    createdBy:
      type: string
      title: Created By
      description: Unique identity of the user/application that submitted the indicator
      example: test
      required: false
    createdByDisplayName:
      title: Created By Display Name
      type: string
      description: Created by display name
      required: false
    createdBySource:
      title: Created By Source
      type: string
      description: Created by source
      required: false
    generateAlert:
      title: Generate Alert
      type: boolean
      description: Generate alert
      required: false
    historicalDetection:
      title: Historical Detection
      type: boolean
      description: Historical detection
      required: false
    lastUpdatedBy:
      type: string
      title: Last Updated By
      description: Identity of the user/application that last updated the indicator
      required: false
    mitreTechniques:
      title: MITRE Techniques
      type: '[]string'
      description: MITRE techniques
      required: false
    creationTimeDateTimeUtc:
      type: string
      title: Creation Time
      description: The date and time when the indicator was created
      required: false
    expirationTime:
      type: string
      title: Expiration Time
      description: The expiration time of the indicator
      required: false
    lastUpdateTime:
      type: string
      title: Last Update Time
      description: The last time the indicator was updated
      required: false
    severity:
      type: string
      title: Severity
      description: The severity of the indicator
      required: false
    title:
      type: string
      title: Title
      description: Indicator alert title
      required: false
    description:
      type: string
      title: Description
      description: Description of the indicator
      required: false
    recommendedActions:
      type: string
      title: Recommended Actions
      description: Recommended actions for the indicator
      required: false
    rbacGroupIds:
      title: RBAC Group IDs
      type: '[]string'
      description: RBAC group IDs
      required: false
    rbacGroupNames:
      type: '[]string'
      title: RBAC Group Names
      description: RBAC device group names where the indicator is exposed and active. Empty list in case it exposed to all devices
      required: false
  vulnerability:
    cvssV3:
      title: CVSS V3
      type: float
      description: CVSS v3
      required: false
    description:
      title: Description
      type: string
      description: Description
      required: false
    exploitInKit:
      title: Exploit In Kit
      type: boolean
      description: Exploit in kit
      required: false
    exploitTypes:
      title: Exploit Types
      type: '[]string'
      description: Exploit types
      required: false
    exploitUris:
      title: Exploit URIs
      type: '[]string'
      description: Exploit URIs
      required: false
    exploitVerified:
      title: Exploit Verified
      type: boolean
      description: Exploit verified
      required: false
    exposedMachines:
      title: Exposed Machines
      type: integer
      description: Exposed machines
      required: false
    id:
      title: ID
      type: string
      description: ID
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    publicExploit:
      title: Public Exploit
      type: boolean
      description: Public exploit
      required: false
    publishedOn:
      title: Published On
      type: string
      description: Published on
      required: false
    severity:
      title: Severity
      type: string
      description: Severity
      required: false
    updatedOn:
      title: Updated On
      type: string
      description: Updated on
      required: false
  recommendation:
    activeAlert:
      title: Active Alert
      description: Active alert
      type: boolean
      required: false
    associatedThreats:
      title: Associated Threats
      description: Associated threats
      type: '[]string'
      required: false
    configScoreImpact:
      title: Config Score Impact
      description: Config score impact
      type: float
      required: false
    exposedMachinesCount:
      title: Exposed Machines Count
      description: Exposed machines count
      type: integer
      required: false
    exposureImpact:
      title: Exposure Impact
      description: Exposure impact
      type: float
      required: false
    id:
      title: ID
      description: ID
      type: string
      required: false
    nonProductivityImpactedAssets:
      title: Non Productivity Impacted Assets
      description: Non productivity impacted assets
      type: integer
      required: false
    productName:
      title: Product Name
      description: Product name
      type: string
      required: false
    publicExploit:
      title: Public Exploit
      description: Public exploit
      type: boolean
      required: false
    recommendationCategory:
      title: Recommendation Category
      description: Recommendation category
      type: string
      required: false
    recommendationName:
      title: Recommendation Name
      description: Recommendation name
      type: string
      required: false
    relatedComponent:
      title: Related Component
      description: Related component
      type: string
      required: false
    remediationType:
      title: Remediation Type
      description: Remediation type
      type: string
      required: false
    severityScore:
      title: Severity Score
      description: Severity score
      type: float
      required: false
    status:
      title: Status
      description: Status
      type: string
      required: false
    totalMachineCount:
      title: Total Machine Count
      description: Total machine count
      type: integer
      required: false
    vendor:
      title: Vendor
      description: Vendor
      type: string
      required: false
    weaknesses:
      title: Weaknesses
      description: Weaknesses
      type: integer
      required: false
  update:
    id:
      title: ID
      description: Update ID
      type: string
      required: false
    name:
      title: Name
      description: Update name
      type: string
      required: false
    osBuild:
      title: OS Build
      description: Update OS build
      type: integer
      required: false
    productsNames:
      title: Products Names
      description: Update products names
      type: "[]string"
      required: false
    url:
      title: URL
      description: Update URL
      type: string
      required: false
    machineMissedOn:
      title: Machine Missed On
      description: Update machine missed on
      type: integer
      required: false
    cveAddressed:
      title: CVE Addressed
      description: Update CVE addressed
      type: integer
      required: false


connection:
  application_id:
    title: Application ID
    description: Application (client) ID
    type: string
    required: true
    example: a74dfb10-i33o-44e1-ba87-5fn2bb4e6b4d
    order: 1
  application_secret:
    title: Application Secret
    description: Application secret
    type: credential_secret_key
    required: true
    example: kQDFcZoJYmxJpiS1x7rdyleyNFwhvLgcOZCkYG+5=
    order: 2
  directory_id:
    title: Directory ID
    description: Directory (tenant) ID
    type: string
    required: true
    example: 3a522933-ae5e-2b63-96ab-3c004b4f7f10
    order: 3

actions:
  get_machine_information:
    title: Get Machine Information
    description: Get details about a machine with its ID
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname and machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
    output:
      machine:
        title: Machine
        description: Machine information
        type: machine
        required: true
  get_file_id_from_alert_id:
    title: Get Files from Alert
    description: Retrieve a list of file information objects related to an alert
    input:
      alert_id:
        type: string
        title: Alert ID
        description: Alert ID to get files from
        example: da637293198146839977_2089064327
        required: true
    output:
      file_list:
        title: File Information
        description: The file ID related to the given alert ID
        type: "[]file_type"
        required: true
  isolate_machine:
    title: Isolate Machine
    description: Isolate a machine from the network
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname and machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
      isolation_type:
        type: string
        description: Type of isolation to perform on target machine
        title: Isolation Type
        required: true
        example: Full
        enum:
        - Full
        - Selective
      comment:
        type: string
        title: Comment
        description: Comment to associate with the isolation action
        example: Isolated by InsightConnect
        required: true
    output:
      machine_isolation_response:
        type: machine_action
        title: Machine Action Response
        description: A response that includes the result of the action, and supplemental information about the action taken
        required: true
  unisolate_machine:
    title: Unisolate Machine
    description: Restore network connectivity to a machine
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname and machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
      comment:
        type: string
        title: Comment
        description: Comment to associate with the unisolate action
        example: Unisolated by InsightConnect
        required: true
    output:
      machine_isolation_response:
        type: machine_action
        title: Machine Action Response
        description: A response that includes the result of the action, and supplemental
          information about the action taken
        required: true
  stop_and_quarantine_file:
    title: Stop and Quarantine File
    description: Stop the execution of a file on a machine and delete it
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname and machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
      comment:
        type: string
        title: Comment
        description: Comment to associate with the stop and quarantine action
        example: InsightConnect has stopped a file.
        required: true
      sha1:
        type: string
        title: SHA1 Hash
        description: SHA1 hash of the file to stop and quarantine on the machine
        example: ad0c0f2fa80411788e81a4567d1d8758b83cd76e
        required: true
    output:
      stop_and_quarantine_response:
        type: machine_action
        title: Stop and Quarantine Response
        description: A response that includes the result of the action, and supplemental
          information about the action taken
        required: true
  run_antivirus_scan:
    title: Run Antivirus Scan
    description: Initiate a Windows Defender Antivirus scan on a machine
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname and machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
      comment:
        type: string
        title: Comment
        description: Comment to associate with the antivirus scan action
        example: InsightConnect has started an antivirus scan.
        required: true
      scan_type:
        type: string
        title: Scan Type
        description: The type of antivirus scan to run
        required: true
        example: Full
        enum:
        - Full
        - Quick
    output:
      machine_action_response:
        type: machine_action
        title: Machine Action Response
        description: A response that includes the result of the action, and supplemental
          information about the action taken
        required: true
  get_machine_action:
    title: Get Machine Action
    description: Retrieve details about an action taken on a machine
    input:
      action_id:
        type: string
        title: Action ID
        description: Action ID
        example: ffd1f0cb-68ad-44ea-bf90-d01061b965ec
        required: true
    output:
      machine_action_response:
        type: machine_action
        title: Machine Action Response
        description: A response that includes the result of the action, and supplemental
          information about the action taken
        required: true
  find_machines_with_installed_software:
    title: Find Machines with Installed Software
    description: Retrieve a list of device references that have specific software installed
    input:
      software:
        title: Software
        description: Name of the software to be searched
        type: string
        required: true
        example: microsoft-_-edge
    output:
      machines:
        title: Machines
        description: List of machines with provided software
        type: '[]machine_software'
        required: true
  blacklist:
    title: Blacklist
    description: Submit or update new indicator
    input:
      indicator:
        title: Indicator
        description: A supported indicator to blacklist or unblacklist. Supported indicators are IP addresses, URLs, domains, and SHA1 and SHA256 hashes
        type: string
        example: 220e7d15b011d7fac48f2bd61114db1022197f7f
        required: true
      action:
        title: Action
        description: The action that will be taken if the indicator will be discovered in the organization
        type: string
        example: AlertAndBlock
        default: AlertAndBlock
        required: false
        enum:
          - Alert
          - AlertAndBlock
          - Allowed
      application:
        title: Application
        description: The application associated with the indicator
        type: string
        example: demo-test
        required: false
      title:
        title: Title
        description: Indicator alert title
        type: string
        example: test
        required: false
      description:
        title: Description
        description: Description of the indicator
        type: string
        example: Indicator Blacklisted from InsightConnect
        default: Indicator Blacklisted from InsightConnect
        required: false
      expiration_time:
        title: Expiration Time
        description: The expiration time of the indicator, default value is one year from now
        type: string
        example: "2020-12-12T00:00:00Z"
        required: false
      severity:
        title: Severity
        description: The severity of the indicator
        type: string
        example: High
        default: High
        required: false
        enum:
          - Informational
          - Low
          - Medium
          - High
      recommended_actions:
        title: Recommended Actions
        description: TI indicator alert recommended actions
        type: string
        example: nothing
        required: false
      rbac_group_names:
        title: RBAC Group Names
        description: List of RBAC group names the indicator would be applied to
        type: '[]string'
        example: '["group1","group2"]'
        required: false
      indicator_state:
        title: Indicator State
        description: True to add indicator, false to remove it from the list
        type: boolean
        example: true
        default: false
        required: false
    output:
      indicator_action_response:
        title: Indicator Action Response
        description: A response that includes the result of the action, and supplemental information about the action taken
        type: indicator_action
        required: false
  get_machine_vulnerabilities:
    title: Get Machine Vulnerabilities
    description: Retrieves a collection of discovered vulnerabilities related to a given device
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname or machine ID
        type: string
        example: 9de5069c5afe602b2ea0a04b66beb2c0cef77fdf
        required: true
    output:
      vulnerabilities:
        type: '[]vulnerability'
        title: Vulnerabilities
        description: List of vulnerabilities of the machine
        required: true
  get_security_recommendations:
    title: Get Security Recommendations
    description: Retrieve a list of security recommendations
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname or machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
    output:
      recommendations:
        title: Recommendations
        description: List of security recommendations
        type: '[]recommendation'
        required: true
  get_missing_software_updates:
    title: Get Missing Software Updates
    description: Retrieve a list of software updates
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname or machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
    output:
      updates:
        title: Updates
        description: List of updates
        type: '[]update'
        required: true
  get_installed_software:
    title: Get Installed Software
    description: Retrieves a collection of installed software related to a given machine IP address, hostname, or machine ID
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname, or machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
    output:
      software:
        title: Software
        description: List of installed software on the machine
        type: '[]software'
        required: true
  manage_tags:
    title: Manage Tags
    description: Add or remove machine tags
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname, or machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
      tag:
        title: Tag
        description: The tag value
        type: string
        example: example tag
        required: true
      type:
        title: Type
        description: True to add tag, false to remove it
        type: boolean
        example: true
        default: true
        required: true
    output:
      manage_tags_response:
        title: Manage Tags Response
        description: A response that includes updated tags and supplemental information about the machine
        type: manage_tags_response
        required: true
  get_related_machines:
    title: Get Related Machines
    description: Get machines related to an file hash(SHA1), domain or username indicator
    input:
      indicator:
        title: Indicator
        description: File hash(SHA1), domain or username indicator
        type: string
        example: example.com
        required: true
    output:
      machines:
        title: Machines
        description: Machines related to an file hash(SHA1), domain or username indicator
        type: '[]machine'
        required: true
  collect_investigation_package:
    title: Collect Investigation Package
    description: Collects investigation package from a machine
    input:
      machine:
        title: Machine
        description: Machine IP address, hostname, or machine ID
        type: string
        example: 2df36d707c1ee5084cef77f3dbfc95db65bc4a73
        required: true
      comment:
        title: Comment
        description: Comment to associate with the action
        type: string
        example: Investigation package collected via InsightConnect
        default: Investigation package collected via InsightConnect
        required: false
    output:
      collect_investigation_package_response:
        title: Collect Investigation Package Response
        description: A response that includes information about the action taken
        type: machine_action
        required: true

triggers:
  get_alert_matching_key:
    title: Get Alerts Matching Key
    description: Get alerts that match a given key to its value
    input:
      key:
        type: string
        description: The key to look for in the alert. This key must match the case shown in the example output section in help
        example: assignedTo
        required: true
        order: 1
      value:
        type: string
        description: The value to look for in the alert. The value must match the case of the value returned
        example: user@example.com
        required: true
        order: 2
      frequency:
        type: integer
        description: Poll frequency in seconds
        default: 10
        example: 10
        required: false
        order: 3
    output:
      alert:
        title: Alert
        description: An alert that contains the given key and matching value
        type: 'alert'
        required: true
  get_alerts:
    title: Get Alerts
    description: Return all new alerts
    input:
      frequency:
        type: integer
        description: Poll frequency in seconds
        default: 10
        example: 10
        required: false
    output:
      alert:
        title: Alert
        description: Alert
        type: 'alert'
        required: true
