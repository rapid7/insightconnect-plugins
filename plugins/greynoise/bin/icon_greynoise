#!/usr/bin/env python
# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import os
import json
from sys import argv

Name = "GreyNoise"
Vendor = "greynoise"
Version = "2.0.0"
Description = "GreyNoise helps analysts recognize events not worth their attention. Indicators in GreyNoise are likely associated with opportunistic internet scanning or common business services, not targeted threats. This context helps analysts focus on what matters most"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import insightconnect_plugin_runtime
    from icon_greynoise import connection, actions, triggers, tasks

    class ICONGreynoise(insightconnect_plugin_runtime.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_action(actions.ContextLookup())
        
            self.add_action(actions.RiotLookup())
        
            self.add_action(actions.QuickLookup())
        
            self.add_action(actions.GetTagDetails())
        
            self.add_action(actions.GnqlQuery())
        
            self.add_action(actions.CommunityLookup())
        
            self.add_action(actions.VulnerabilityLookup())
        
            self.add_action(actions.TimelineLookup())
        
            self.add_action(actions.SimilarLookup())
        

    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONGreynoise())
    cli.run()


if __name__ == "__main__":
    main()
