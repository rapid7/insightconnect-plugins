plugin_spec_version: v2
extension: plugin
products: [ insightconnect ]
name: hybrid_analysis
title: Hybrid Analysis
vendor: rapid7
support: community
status: [ ]
description: "[Hybrid Analysis](https://www.hybrid-analysis.com/)\
  \ is a free malware analysis service powered by Payload Security\
  \ that detects and analyzes unknown threats using a unique Hybrid Analysis technology.\
  \ This plugin provides the ability to lookup file hashes to determine whether or not they are malicious"
version: 4.0.2
connection_version: 3
supported_versions:
  - Hybrid Analysis API v2
  - v2.35.0
sdk:
  type: slim
  version: 6.3.10
  user: nobody
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/hybrid_analysis
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.hybrid-analysis.com/
links:
  - "[Hybrid Analysis](https://www.hybrid-analysis.com/)"
references:
  - "[Hybrid Analysis](https://www.hybrid-analysis.com/)"
tags:
  - malware
  - sandbox
  - malware analysis
key_features:
  - "Lookup a file hash to identify known and unknown threats using Hybrid Analysis technology"
requirements:
  - "A HybridAnalysis API key and token"
version_history:
  - "4.0.2 - Corrected environment configuration for the Submit File action"
  - "4.0.1 - Adjusted the way the connection URL is passed to improve compatibility"
  - "4.0.0 - Adjusted actions to comply with the 2.35.0 API version | SDK bump to 6.3.10"
  - "3.0.1 - Bumping requirements.txt | SDK bump to 6.1.4"
  - "3.0.0 - Update to support version 2 API | Created new actions which was moved from plugin **vxstream_sandbox** such as: Submit File, Lookup by Hash, Search Database, Retrieve Report"
  - "2.0.2 - Fix threatscore KeyError"
  - "2.0.1 - New spec and help.md format for the Extension Library"
  - "2.0.0 - Update to new secret key credential type"
  - "1.0.0 - Update to v2 Python plugin architecture | Support web server mode | Update to new credential types"
  - "0.1.1 - SSL bug fix in SDK"
  - "0.1.0 - Initial plugin"
hub_tags:
  use_cases: [ threat_detection_and_response ]
  keywords: [ malware_analysis ]
  features: [ ]
types:
  certificates:
    issuer:
      title: Issuer
      type: string
      description: Issuer
      required: false
    md5:
      title: MD5
      type: string
      description: MD5
      required: false
    owner:
      title: Owner
      type: string
      description: Owner
      required: false
    serial_number:
      title: Serial Number
      type: string
      description: Serial number
      required: false
    sha1:
      title: SHA1
      type: string
      description: SHA1
      required: false
    valid_from:
      title: Valid From
      type: string
      description: Valid from
      required: false
    valid_until:
      title: Valid Until
      type: string
      description: Valid until
      required: false
  extracted_files:
    av_label:
      title: Available Label
      type: string
      description: Available label
      required: false
    av_matched:
      title: Available Matched
      type: integer
      description: Available matched
      required: false
    av_total:
      title: Available Total
      type: integer
      description: Available total
      required: false
    description:
      title: Description
      type: string
      description: Description
      required: false
    file_available_to_download:
      title: File Available To Download
      type: boolean
      description: File available to download
      required: false
    file_path:
      title: File Path
      type: string
      description: File path
      required: false
    file_size:
      title: File Size
      type: integer
      description: File size
      required: false
    md5:
      title: MD5
      type: string
      description: MD5
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    runtime_process:
      title: Runtime Process
      type: string
      description: Runtime process
      required: false
    sha1:
      title: SHA1
      type: string
      description: SHA1
      required: false
    sha256:
      title: SHA256
      type: string
      description: SHA256
      required: false
    threat_level:
      title: Threat Level
      type: integer
      description: Threat level
      required: false
    threat_level_readable:
      title: Threat Level Readable
      type: string
      description: Threat level readable
      required: false
    type_tags:
      title: Type Tags
      type: '[]string'
      description: Type tags
      required: false
  file_metadata:
    file_analysis:
      title: File Analysis
      type: '[]string'
      description: File analysis
      required: false
    file_compositions:
      title: File Compositions
      type: '[]string'
      description: File compositions
      required: false
    imported_objects:
      title: Imported Objects
      type: '[]string'
      description: Imported objects
      required: false
    total_file_compositions_imports:
      title: Total File Compositions Imports
      type: integer
      description: Total file compositions imports
      required: false
  created_files:
    file:
      title: File
      type: string
      description: File
      required: false
    null_byte:
      title: Null Byte
      type: boolean
      description: Null byte
      required: false
  file_accesses:
    mask:
      title: Mask
      type: string
      description: Mask
      required: false
    path:
      title: Path
      type: string
      description: Path
      required: false
    type:
      title: Type
      type: string
      description: Type
      required: false
  handles:
    id:
      title: ID
      type: integer
      description: ID
      required: false
    path:
      title: Path
      type: string
      description: Path
      required: false
    type:
      title: Type
      type: string
      description: Type
      required: false
  process_flags:
    data:
      title: Data
      type: string
      description: Data
      required: false
    image:
      title: Image
      type: string
      description: Image
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
  registry:
    key:
      title: Key
      type: string
      description: Key
      required: false
    operation:
      title: Operation
      type: string
      description: Operation
      required: false
    path:
      title: Path
      type: string
      description: Path
      required: false
    status:
      title: Status
      type: string
      description: Status
      required: false
    status_human_readable:
      title: Status Human Readable
      type: string
      description: Status human readable
      required: false
    value:
      title: Value
      type: string
      description: Value
      required: false
  parameters:
    argument_number:
      title: Argument Number
      type: integer
      description: Argument number
      required: false
    comment:
      title: Comment
      type: string
      description: Comment
      required: false
    meaning:
      title: Meaning
      type: string
      description: Meaning
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    value:
      title: Value
      type: string
      description: Value
      required: false
  script_calls:
    cls_id:
      title: Cls ID
      type: string
      description: Cls ID
      required: false
    dispatch_id:
      title: Dispatch ID
      type: string
      description: Dispatch ID
      required: false
    matched_malicious_signatures:
      title: Matched Malicious Signatures
      type: '[]string'
      description: Matched malicious signatures
      required: false
    parameters:
      title: Parameters
      type: '[]parameters'
      description: Parameters
      required: false
    result:
      title: Result
      type: string
      description: Result
      required: false
    status:
      title: Status
      type: string
      description: Status
      required: false
  matched_signatures:
    id:
      title: ID
      type: string
      description: ID
      required: false
    value:
      title: Value
      type: string
      description: Value
      required: false
  streams:
    executed:
      title: Executed
      type: boolean
      description: Executed
      required: false
    file_name:
      title: File Name
      type: string
      description: File name
      required: false
    human_keywords:
      title: Human Keywords
      type: string
      description: Human keywords
      required: false
    instructions:
      title: Instructions
      type: '[]string'
      description: Instructions
      required: false
    matched_signatures:
      title: Matched Signatures
      type: '[]matched_signatures'
      description: Matched signatures
      required: false
    uid:
      title: UID
      type: string
      description: UID
      required: false
  processes:
    av_label:
      title: Available Label
      type: string
      description: Available label
      required: false
    av_matched:
      title: Available Matched
      type: integer
      description: Available matched
      required: false
    av_total:
      title: Available Total
      type: integer
      description: Available total
      required: false
    command_line:
      title: Command Line
      type: string
      description: Command line
      required: false
    created_files:
      title: Created Files
      type: '[]created_files'
      description: Created files
      required: false
    file_accesses:
      title: File Accesses
      type: '[]file_accesses'
      description: File accesses
      required: false
    handles:
      title: Handles
      type: '[]handles'
      description: Handles
      required: false
    icon:
      title: Icon
      type: string
      description: Icon
      required: false
    mutants:
      title: Mutants
      type: '[]string'
      description: Mutants
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    normalized_path:
      title: Normalized Path
      type: string
      description: Normalized path
      required: false
    parentuid:
      title: Parent UID
      type: string
      description: Parent UID
      required: false
    pid:
      title: PID
      type: string
      description: PID
      required: false
    process_flags:
      title: Process Flags
      type: '[]process_flags'
      description: Process flags
      required: false
    registry:
      title: Registry
      type: '[]registry'
      description: Registry
      required: false
    script_calls:
      title: Script Calls
      type: '[]script_calls'
      description: Script calls
      required: false
    sha256:
      title: SHA256
      type: string
      description: SHA256
      required: false
    streams:
      title: Streams
      type: '[]streams'
      description: Streams
      required: false
    uid:
      title: UID
      type: string
      description: UID
      required: false
  mitre_attcks:
    attck_id:
      title: Attck ID
      type: string
      description: Attck ID
      required: false
    attck_id_wiki:
      title: Attck ID Wiki
      type: string
      description: Attck ID wiki
      required: false
    informative_identifiers:
      title: Informative Identifiers
      type: '[]string'
      description: Informative identifiers
      required: false
    informative_identifiers_count:
      title: Informative Identifiers Count
      type: integer
      description: Informative identifiers count
      required: false
    malicious_identifiers:
      title: Malicious Identifiers
      type: '[]string'
      description: Malicious identifiers
      required: false
    malicious_identifiers_count:
      title: Malicious Identifiers Count
      type: integer
      description: Malicious identifiers count
      required: false
    suspicious_identifiers:
      title: Suspicious Identifiers
      type: '[]string'
      description: Suspicious identifiers
      required: false
    suspicious_identifiers_count:
      title: Suspicious Identifiers Count
      type: integer
      description: Suspicious identifiers count
      required: false
    tactic:
      title: Tactic
      type: string
      description: Tactic
      required: false
    technique:
      title: Technique
      type: string
      description: Technique
      required: false
  submissions:
    created_at:
      title: Created At
      type: string
      description: Created at
      required: false
    filename:
      title: Filename
      type: string
      description: File name
      required: false
    submission_id:
      title: Submission ID
      type: string
      description: Submission ID
      required: false
    url:
      title: URL
      type: string
      description: URL
      required: false
  machine_learning_models:
    created_at:
      title: Created At
      type: string
      description: Created at
      required: false
    data:
      title: Data
      type: '[]matched_signatures'
      description: Data
      required: false
    name:
      title: Name
      type: string
      description: Name
      required: false
    status:
      title: Status
      type: string
      description: Status
      required: false
    version:
      title: Version
      type: string
      description: Version
      required: false
  report:
    id:
      title: ID
      type: string
      description: ID which is generated by server
      required: false
      example: 61dc148b0cad612f7371d2d3
    environment_id:
      title: Environment ID
      type: integer
      description: The environment that was used for analysis
      required: false
      example: 300
    environment_description:
      title: Environment Description
      type: string
      description: Environment description
      required: false
      example: Windows 10 64 bit
    state:
      title: State
      type: string
      description: State in which the analysis is in
      required: false
      example: ERROR
    error_type:
      title: Error Type
      description: Type of error that occurred
      type: string
      required: false
      example: FILE_TYPE_BAD_ERROR
    error_origin:
      title: Error Origin
      type: string
      description: Error origin
      required: false
      example: CLIENT
  search_term:
    id:
      title: ID
      description: Name of search term which was used
      type: string
      required: false
    value:
      title: Value
      description: Value of search term
      type: string
      required: false
  result:
    verdict:
      title: Verdict
      description: File verdict e.g. malicious
      type: string
      required: false
    av_detect:
      title: AV detect
      description: AV MultiScan Detection Percentage
      type: string
      required: false
    threat_score:
      title: Threat score
      description: Confidence value of VxStream Sandbox in the verdict; lies between
        0 and 100
      type: integer
      required: false
    vx_family:
      title: VX Family
      description: VX Family e.g. Trojan.Generic
      type: string
      required: false
    job_id:
      title: Job ID
      description: Job ID when file was submited
      type: string
      required: false
    sha256:
      title: SHA256
      description: SHA256 hash
      type: string
      required: false
    environment_id:
      title: Environment ID
      description: The environment that was used for analysis
      type: integer
      required: false
    analysis_start_time:
      title: Analysis Start Time
      description: The time at which the analysis began
      type: string
      required: false
    submit_name:
      title: Submit Name
      description: Submit name
      type: string
      required: false
    environment_description:
      title: Environment Description
      description: Description of the environment on which analysis was conducted
      type: string
      required: false
    size:
      title: File Size
      description: File size in bytes
      type: integer
      required: false
    type:
      title: Type
      description: Type
      type: string
      required: false
    type_short:
      title: File Extension
      type: string
      description: File type e.g. exe
      required: false
  related_reports:
    environment_id:
      title: Environment ID
      type: integer
      description: The environment that was used for analysis
      required: false
    error_origin:
      title: Error Origin
      type: string
      description: Error origin
      required: false
    error_type:
      title: Error Type
      description: Type of error that occurred
      type: string
      required: false
    job_id:
      title: Job ID
      type: string
      description: Job ID which is generated by server
      required: false
    sha256:
      title: SHA256
      type: string
      description: SHA256
      required: false
    state:
      title: State
      type: string
      description: State in which the analysis is in
      required: false
connection:
  url:
    title: URL
    type: string
    description: Hybrid Analysis API server URL
    required: true
    example: hybrid-analysis.com
    default: hybrid-analysis.com
  api_key:
    title: API Key
    type: credential_secret_key
    description: API key
    required: true
    example: 9de5069c5afe602b2ea0a04b66beb2c0
actions:
  lookup_hash:
    title: Lookup by Hash
    description: Get summary information for a given hash
    input:
      hash:
        title: Hash
        description: Hash to lookup. Must be MD5, SHA1, or SHA256
        type: string
        required: true
        example: 44d88612fea8a8f36de82e1278abb02f
    output:
      found:
        title: Found
        description: True if found
        type: boolean
        required: false
        example: true
      reports:
        title: Reports
        type: '[]report'
        description: Reports
        required: false
        example: '[{"environment_description": "Windows 10 64 bit", "environment_id": 160, "error_origin": "CLIENT", "error_type": "FILE_TYPE_BAD_ERROR", "id": "123b45678120398hasd", "state": "ERROR"}]'
  lookup_terms:
    title: Search Database
    description: Search the Hybrid Analysis database
    input:
      filename:
        title: File Name
        description: File name
        type: string
        required: false
        example: setup.exe
      filetype:
        title: File Type
        description: File type
        type: string
        required: false
        example: docx
      country:
        title: Country
        description: Country must be specified in the ISO 3166-1 standard
        type: string
        required: false
        example: AFG
      verdict:
        title: Verdict
        description: A decision on a submitted term
        type: string
        enum:
          - whitelisted
          - no verdict
          - no specific threat
          - suspicious
          - malicious
        required: false
        default: whitelisted
        example: whitelisted
      tag:
        title: Hashtag
        description: Hashtag by which the analysis will be performed
        type: string
        required: false
        example: ransomware
      port:
        title: Port
        description: Port number which is associated with an IP address
        type: integer
        required: false
        default: 8080
        example: 8080
      host:
        title: Host
        description: Information about the host which will be analyzed
        type: string
        required: false
        example: 198.51.100.1
      domain:
        title: Domain
        description: Domain which will be analyzed
        type: string
        required: false
        example: example.com
      url:
        title: URL
        description: URL to analyze
        type: string
        required: false
        example: https://example.com
      similar_to:
        title: Similar Samples
        description: SHA256 hash of the similar file
        type: string
        required: false
        example: 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
    output:
      search_terms:
        title: Search Terms
        description: List of key value pairs. Where the key is the parameter specified and its value
        type: '[]search_term'
        required: true
        example: '[ { "id": "filename", "value": "setup.exe" }, { "id": "verdict", "value": "1" } ]'
      count:
        title: Count
        description: Number of results returned
        type: integer
        required: true
        example: 1
      result:
        title: Results List
        description: List of results
        type: '[]result'
        required: false
        example: '[ { "analysis_start_time": "2021-09-02 18:58:23", "av_detect": "0", "environment_description": "Windows 7 64 bit", "environment_id": 120, "job_id": "61311eca7a48ee7a9e3041d7", "sha256": "82b43762a5bc9c0ab7b5d1f96dc47b34700924b598070a7ccb30c92eb5ee1599", "size": 18944, "submit_name": "ew_usbccgpfilter.sys", "type_short": "64-bit service", "verdict": "whitelisted" } ]'
  submit:
    title: Submit File
    description: Submit file for analysis
    input:
      file:
        title: File
        description: File to be analyzed
        type: file
        required: true
        example: '{"filename": "setup.exe", "content": "UmFwaWQ3IEluc2lnaHRDb25uZWN0Cg==" }'
      submit_name:
        title: Submit Name
        type: string
        description: Optional property which will be used for file type detection and analysis
        required: false
        example: testName
      document_password:
        title: Password
        description: Optional document password that will be used to fill-in Adobe/Office password prompts
        type: string
        required: false
        example: somepassword
      custom_cmd_line:
        title: Custom Command Line
        description: Optional command line that should be passed to the file analysis
        type: string
        required: false
        example: command
      environment_id:
        title: Environment ID
        description: Environment ID on which the analysis will be performed
        type: string
        enum:
          - Windows 10 64 bit
          - Windows 11 64 bit
          - Windows 7 32 bit
          - Windows 7 32 bit (HWP Support)
          - Windows 7 64 bit
          - Linux (Ubuntu 20.04, 64 bit)
          - Mac Catalina 64 bit (x86)
          - Android Static Analysis
        default: Linux (Ubuntu 20.04, 64 bit)
        required: false
        example: Linux (Ubuntu 20.04, 64 bit)
      script_logging:
        title: Enable Script Logging
        description: When set to true, will set the in-depth script logging engine of the Kernelmode Monitor
        type: boolean
        default: false
        required: false
        example: true
      hybrid_analysis:
        title: Enable Hybrid Analysis
        description: When set to false, no memory dumps or memory dump analysis will take place
        type: boolean
        default: true
        required: false
        example: true
      experimental_anti_evasion:
        title: Enable Experimental Anti-Evasion Techniques
        description: When set to true, will set all experimental anti-evasion options of the Kernelmode Monitor
        type: boolean
        default: true
        required: false
        example: true
    output:
      job_id:
        title: Job ID
        description: Job ID which will be generated by server
        type: string
        required: false
        example: 61dc148b0cad612f7371d2d3
      submission_id:
        title: Submission ID
        description: Submission ID which will be generated by server
        type: string
        required: false
        example: 61dc148b0cad612f7371d2d3
      environment_id:
        title: Enviroment ID
        description: The environment that was used for analysis
        type: integer
        required: false
        example: 300
      sha256:
        title: SHA256
        description: SHA256 hash for report retrieval
        type: string
        required: false
        example: 6617aa88a72e6b526b88cbceda388a7b52a0e856148a12d9b8...
  report:
    title: Retrieve Report
    description: Retrieve report by providing SHA256 generated by the Submit File action
    input:
      hash:
        title: Hash
        description: SHA256 hash
        type: string
        required: true
        example: 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
    output:
      state:
        title: State
        type: string
        description: State in which the analysis is in
        required: true
        example: ERROR
      error_type:
        title: Error Type
        type: string
        description: Type of error that occurred
        required: false
        example: FILE_TYPE_BAD_ERROR
      error_origin:
        title: Error Origin
        type: string
        description: Error origin
        required: false
        example: CLIENT
      error:
        title: Error
        type: string
        description: An error that occurred during the analysis
        required: false
        example: File \"testing.com.txt\" was detected as \"unknown\", this format is not supported on WINDOWS
      related_reports:
        title: Related Reports
        type: '[]related_reports'
        description: Related reports which contained analysis information on linked data
        required: false
        example: '[ { "job_id": "61dc148b0cad612f7371d2d3", "environment_id": 300, "state": "SUCCESS", "sha256": "275a021bbfb6489e54d411499f7db9d1663fc695ec2fe2a2c4538aabf651fd0f" } ]'
