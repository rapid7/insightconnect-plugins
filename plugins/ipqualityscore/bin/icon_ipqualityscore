#!/usr/bin/env python
# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import os
import json
from sys import argv

Name = "IPQS Fraud and Risk Scoring"
Vendor = "ipqualityscore"
Version = "1.0.0"
Description = "IPQS Fraud and Risk Scoring plugin provides enterprise grade fraud prevention, risk analysis, and threat detection Analyze IP Addresses, Email Addresses, Phones, URLs and Domains to identify sophisticated bad actors and high risk behavior"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import insightconnect_plugin_runtime
    from icon_ipqualityscore import connection, actions, triggers, tasks

    class ICONIpqualityscore(insightconnect_plugin_runtime.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_action(actions.IpLookup())
        
            self.add_action(actions.EmailLookup())
        
            self.add_action(actions.UrlLookup())
        
            self.add_action(actions.DomainLookup())
        
            self.add_action(actions.PhoneLookup())
        

    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONIpqualityscore())
    cli.run()


if __name__ == "__main__":
    main()
