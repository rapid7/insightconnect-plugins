plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: thehive
title: TheHive
description: "TheHive is a scalable, open source security incident response solution designed for
  SOCs & CERTs to collaborate, elaborate, analyze and get their job done. Handle your case management needs with TheHive
plugin for Rapid7 InsightConnect"
version: 2.0.5
vendor: rapid7
support: community
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/thehive
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://thehive-project.org
tags:
- thehive
- intel
- case
hub_tags:
  use_cases: [remediation_management]
  keywords: [thehive, intel, case]
  features: []
enable_cache: true
language: python
connection:
  host:
    type: string
    title: Host
    description: TheHive host e.g. thehive.company.com or 10.3.4.50
    required: true
  port:
    type: string
    title: Port
    description: TheHive API port e.g. 9000
    default: "9000"
    required: true
  protocol:
    type: string
    title: Protocol
    description: HTTP Protocol
    enum:
    - http
    - https
    required: true
  credentials:
    type: credential_username_password
    title: Credentials
    description: Username and password
    required: false
  api_key:
    title: API key
    description: An optional API key for authentication via bearer token
    type: credential_secret_key
    required: false
  proxy:
    type: object
    title: Proxy
    description: An optional dictionary containing proxy data, with HTTP or HTTPS
      as the key, and the proxy URL as the value
    required: false
  verify:
    type: boolean
    title: SSL Verify
    description: Verify the certificate
    default: true
    required: true
types:
  itask:
    title:
      title: Title
      description: Task title
      type: string
      required: true
    status:
      description: Task status
      type: string
      default: Waiting
      enum:
      - Waiting
      - InProgress
      - Completed
      - Cancel
    flag:
      description: Task flag, default is false
      default: false
      type: boolean
    description:
      description: Task description
      type: string
    owner:
      description: Task owner
      type: string
  iobservable:
    dataType:
      title: Data Type
      description: Observable data type e.g. domain, ip, url, fqdn, uri_path, user-agent,
        hash, email, mail, mail_subject, registry, regexp, other
      type: string
    message:
      description: Observable message
      type: string
    tlp:
      title: TLP
      description: Traffic Light Protocol level, default is 2
      default: 2
      type: integer
    tags:
      description: List of observable tags
      type: '[]string'
    ioc:
      title: IOC
      description: Indicator of Compromise, default is 2
      default: false
      type: boolean
    data:
      title: ID
      description: The observable's value e.g. badguy.com
      type: string
  case:
    id:
      title: ID
      description: ID
      type: string
      required: true
    _type:
      title: Type
      description: Case type
      type: string
      required: true
    _createdBy:
      title: Created By
      description: Who the case was created by
      type: string
      required: false
    _updatedBy:
      title: Updated By
      description: Who the case was updated by
      type: string
      required: false
    _createdAt:
      title: Created At
      description: Datetime in ms the case was created at
      type: integer
      required: false
    _updatedAt:
      title: Updated At
      description: Datetime in ms the case was updated at
      type: integer
      required: false
    number:
      title: Number
      description: An incremental number to reference the case
      type: integer
      required: false
    title:
      title: Case title
      description: Title of the case
      type: string
      required: false
    description:
      title: Description
      description: The description of the case
      type: string
      required: false
    severity:
      title: Severity
      description: Severity of the case
      type: integer
      required: false
    startDate:
      title: Start Date
      description: Case start date (datetime in ms)
      type: integer
      required: false
    endDate:
      title: End Date
      description: Case end date (datetime in ms)
      type: integer
      required: false
    tags:
      title: Tags
      description: Case tags
      type: '[]string'
      required: false
    flag:
      title: Flag
      description: Something here
      type: boolean
      required: false
    tlp:
      title: TLP
      description: Traffic Light Protocol level
      type: integer
      required: false
    pap:
      title: PAP
      description: Password Authenitcation Protocol
      type: integer
      required: false
    status:
      title: Status
      description: Status of the case
      type: string
      required: false
    stage:
      title: Stage
      description: The value of the stage depends on the status of the case
      type: string
      enum:
        - New
        - InProgress
        - Closed
      required: false
    summary:
      title: Summary
      description: Summary of the case
      type: string
      required: false
    impactStatus:
      title: Impact Status
      description: Dunno
      type: string
      required: false
    assignee:
      title: Assignee
      description: Dunno
      type: string
      required: false
    customFields:
      title: Custom Fields
      description: Case custom fields
      type: object
      required: false
    userPermissions:
      title: User Permissions
      description: A list of permissions the current user has access on the case
      type: "[]string"
      required: false
    extraData:
      title: Extra Data
      description: Dunno
      type: object
      required: false
    newDate:
      title: New Date
      description: Dunno (datetime in ms)
      type: integer
      required: false
    inProgressDate:
      title: In Progress Date
      description: Dunno (datetime in ms)
      type: integer
      required: false
    closedDate:
      title: Closed Date
      description: Case closed date (datetime in ms)
      type: integer
      required: false
    alertDate:
      title: Alert Date
      description: Case alert date (datetime in ms)
      type: integer
      required: false
    alertNewDate:
      title: Alert New Date
      description: Case alert new date (datetime in ms)
      type: integer
      required: false
    alertInProgressDate:
      title: Alert In Progress Date
      description: Case alert in progress data (datetime in ms)
      type: integer
      required: false
    alertImportedDate:
      title: Alert Imported Date
      description: Case alert imported date (datetime in ms)
      type: integer
      required: false
    timeToDetect:
      title: Time To Detect
      description: Case time to detect
      type: integer
      required: false
    timeToTriage:
      title: Time To Triage
      descirption: Case time to triage
      type: integer
      required: false
    timeToQualify:
      title: Time To Qualify
      description: Case time to qualify
      type: integer
      required: false
    timeToAcknowledge:
      title: Time To Acknowledge
      description: Case time to acknowledge
      type: integer
      required: false
    timeToResolve:
      title: Time To Resolve
      description: Case time to resolve
      type: integer
      required: false
    handlingDuration:
      title: Handling Duration
      description: Case handling duration
      type: integer
      required: false
  createCase:
    title:
      title: Title
      description: Case title
      type: string
      required: true
    description:
      title: Description
      description: Case description
      type: string
      required: true
    severity:
      title: Severity
      description: Case severity
      type: integer
      enum:
        - 1
        - 2
        - 3
        - 4
      default: 2
      required: false
    startDate:
      title: Start Date
      description: Case start date (datetime in ms)
      type: integer
      required: false
    endDate:
      title: End Date
      description: Case end date (datetime in ms)
      type: integer
      required: false
    tags:
      title: tags
      description: Case tags
      type: "[]string"
      required: false
    flag:
      title: Flag
      description: Case flags
      type: boolean
      default: false
      required: false
    tlp:
      title: Traffic Light Protocol
      description: Case traffic light protocol
      type: integer
      enum:
        - 0
        - 1
        - 2
        - 3
      default: 2
      required: false
    pap:
      title: Password Authentication Protocol
      description: Case password authentication protocol
      type: integer
      enum:
        - 0
        - 1
        - 2
        - 3
      default: 2
      required: false
    status:
      title: Status
      description: Case status
      type: string
      default: "New"
      required: false
    summary:
      title: Summary
      description: Case summary
      type: string
      required: false
    assignee:
      title: Assignee
      description: User to assign the case to
      type: string
      required: false
    customFields:
      title: Custom Fields
      description: Custom fields
      type: "[]string"
      required: false
    caseTemplate:
      title: Case Template
      description: Name or ID of the case template to use
      type: string
      required: false
    tasks:
      title: Tasks
      description: Tasks to create. If null, tasks from the case template will be used
      type: "[]string"
      required: false
    sharingParameters:
      title: Sharing Parameters
      description: Case sharing parameters
      type: "[]string"
      required: false
    taskRule:
      title: Task Rule
      description: Case task rule
      type: string
      required: false
    observableRule:
      title: Observable Rule
      description: Case observable rule
      type: string
      required: false
  OutputCustomField:
    _id:
      title: ID
      description: ID
      type: string
      required: true
    name:
      title: Name
      description: Name
      type: string
      required: true
    type:
      title: Type
      description: Type
      type: string
      required: true
    value:
      title: Value
      description: Value
      type: string
      required: true
    order:
      title: Order
      description: Order
      type: integer
      required: true
  task:
    status:
      type: string
      description: Task status
      required: false
      enum:
      - Waiting
      - InProgress
      - Completed
      - Cancel
    startDate:
      title: Start Date
      type: integer
      description: Task start date
    _type:
      title: Type
      description: Task type
      type: string
    description:
      type: string
      description: Task description
    title:
      type: string
      description: Task title
    id:
      title: ID
      type: string
      description: Task ID
    flag:
      type: boolean
      description: Task flag
    user:
      type: string
      description: Task user
    createdBy:
      title: Created By
      type: string
      description: Task created by
    owner:
      type: string
      description: Task owner
    order:
      type: integer
      description: Task order
    createdAt:
      title: Created At
      description: Task created at
      type: integer
  observable:
    status:
      type: string
      description: Observable status
    startDate:
      title: Start Date
      description: Observable start date
      type: integer
    _type:
      title: Type
      description: Observable type
      type: string
    tlp:
      description: Traffic Light Protocol level
      title: TLP
      type: integer
    tags:
      type: '[]string'
      description: Observable tags
    dataType:
      title: Data Type
      type: string
      description: Observable data type
    ioc:
      description: Indicators of Compromise
      title: IOC
      type: boolean
    reports:
      type: object
      description: Observable reports
    user:
      type: string
      description: Observable user
    createdBy:
      title: Created By
      description: Observable created by
      type: string
    message:
      type: string
      description: Observable message
    _id:
      title: ID
      type: string
      description: Observable _ID
    data:
      type: string
      description: Observable data
    id:
      title: ID
      type: string
      description: Observable ID
    createdAt:
      title: Created At
      description: Time the observable was created at in milliseconds or epoch, e.g.
        1496561862924
      type: integer
actions:
  get_user:
    title: Get User
    description: Get information about a user
    input:
      id:
        title: User ID
        description: User ID. If empty, the current user is used
        type: string
        required: false
    output:
      status:
        type: string
        description: Get user status
        required: false
      _type:
        title: Type
        description: User type
        type: string
        required: false
      hasKey:
        type: boolean
        description: User has a key
        required: false
      name:
        type: string
        description: Name
        required: false
      roles:
        type: '[]string'
        description: Roles
        required: false
      updatedAt:
        title: Updated At
        type: integer
        description: Time the user was updated in milliseconds or epoch, e.g. 1496561862924
        required: false
      user:
        type: string
        description: User
        required: false
      createdBy:
        title: Updated By
        description: Created by
        type: string
        required: false
      updatedBy:
        title: Updated By
        description: Updated by
        type: string
        required: false
      _id:
        title: _ID
        description: User _ID
        type: string
        required: false
      id:
        title: ID
        description: ID
        type: string
        required: false
      createdAt:
        title: Created At
        description: Time the user was created at in milliseconds or epoch, e.g. 1496561862924
        type: integer
        required: false
      preferences:
        type: object
        description: User preferences
        required: false
  create_case:
    title: Create Case
    description: Create a new case
    input:
      title:
        title: Case Title
        description: Name of the case
        type: string
        required: true
      description:
        title: Case Description
        description: Description of the case, supports markdown
        type: string
        required: true
      severity:
        title: Severity
        description: Case severity
        type: integer
        enum:
          - 1
          - 2
          - 3
          - 4
        default: 2
        required: false
      startDate:
        title: Start Date
        description: Case start date (datetime in ms)
        type: integer
        required: false
      endDate:
        title: End Date
        description: Case end date (datetime in ms)
        type: integer
        required: false
      tags:
        title: Tags
        description: List of tags
        type: '[]string'
        required: false
      flag:
        title: Flag
        description: Flag, default is false
        default: false
        type: boolean
        required: false
      tlp:
        title: TLP
        description: Traffic Light Protocol level
        type: integer
        enum:
          - 0
          - 1
          - 2
          - 3
        default: 2
        required: false
      pap:
        title: PAP
        description: Password Authentication Protocol
        type: integer
        enum:
          - 0
          - 1
          - 2
          - 3
        default: 2
        required: false
      status:
        title: Status
        description: Case status
        type: string
        default: "New"
        required: false
      summary:
        title: Summary
        description: Case summary
        type: string
        required: false
      assignee:
        title: Assignee
        description: User to assign the case to
        type: string
        required: false
      customFields:
        title: Custom Fields
        description: Case custom fields
        type: object
        required: false
      caseTemplate:
        title: Case Template
        description: Name or id of the case template to use
        type: string
        required: false
      tasks:
        title: Task
        description: Case task
        type: '[]itask'
        required: false
      taskRule:
        title: Task Rule
        description: Case task rule
        type: string
        required: false
      observableRule:
        title: Observable Rule
        description: Case observable rule
        type: string
        required: false
    output:
      case:
        type: createCase
        description: Create case output
        required: false
  create_case_task:
    title: Create Task
    description: Create a new case task
    input:
      id:
        title: Case ID
        description: Case ID e.g. AV_ajI_oYMfcbXhqb9tS
        type: string
        required: true
      task:
        type: itask
        title: Task
        description: Task name
        required: true
    output:
      case:
        type: task
        description: Create case task output
        required: false
  create_case_observable:
    title: Create Observable
    description: Create a new case observable
    input:
      id:
        title: Case ID
        description: Case ID e.g. AV_ajI_oYMfcbXhqb9tS
        type: string
        required: true
      observable:
        type: iobservable
        title: Observable
        required: true
        description: Observable
    output:
      case:
        type: observable
        description: Create case observable output
        required: false
  get_case:
    title: Get Case
    description: Retrieve a case by ID
    input:
      id:
        title: Case ID
        description: Case ID e.g. AV_ajI_oYMfcbXhqb9tS
        type: string
        required: true
    output:
      case:
        type: case
        description: Get case output
        required: true
  get_cases:
    title: Get Cases
    description: Retrieve list of cases
    output:
      list:
        type: '[]case'
        description: List of cases
        required: false
  close_case:
    title: Close Case
    description: Close a case by ID
    input:
      id:
        title: Case ID
        description: Case ID e.g. AV_ajI_oYMfcbXhqb9tS
        type: string
        required: true
      resolution_status:
        title: Resolution Status
        description: Case resolution status
        type: string
        required: false
        enum:
        - low
        - medium
        - high
      impact_status:
        title: Impact Status
        description: Case impact status
        type: string
        required: false
        enum:
        - low
        - medium
        - high
      summary:
        title: Summary
        description: Case Summary
        type: string
        required: false
    output:
      type:
        type: string
        required: true
        description: Closed case type
      message:
        type: string
        required: true
        description: Closed case message
