# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "List all incidents triggered by the CloudLock policy engine"


class Input:
    CREATED_AFTER = "created_after"
    CREATED_BEFORE = "created_before"
    LIMIT = "limit"
    OFFSET = "offset"
    SEVERITY = "severity"
    

class Output:
    INCIDENTS = "incidents"
    

class ListAllIncidentsInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "created_after": {
      "type": "string",
      "title": "Created After",
      "displayType": "date",
      "description": "Created on end date look up period. Example: 2014-02-01",
      "format": "date-time",
      "order": 3
    },
    "created_before": {
      "type": "string",
      "title": "Created Before",
      "displayType": "date",
      "description": "Created on start date look up period",
      "format": "date-time",
      "order": 2
    },
    "limit": {
      "type": "number",
      "title": "Limit",
      "description": "Number of paginated results to return. Max: 100",
      "default": 20,
      "order": 5
    },
    "offset": {
      "type": "number",
      "title": "Offset",
      "description": "Pagination offset",
      "default": 0,
      "order": 4
    },
    "severity": {
      "type": "string",
      "title": "Severity",
      "description": "Severity level to search on",
      "enum": [
        "INFO",
        "WARNING",
        "CRITICAL",
        "ALERT"
      ],
      "order": 1
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class ListAllIncidentsOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "incidents": {
      "type": "array",
      "title": "Incidents",
      "description": "Incidents",
      "items": {
        "$ref": "#/definitions/incident"
      },
      "order": 1
    }
  },
  "definitions": {
    "entity": {
      "type": "object",
      "title": "entity",
      "properties": {
        "asset_type": {
          "type": "string",
          "title": "Asset Type",
          "order": 5
        },
        "collaborators": {
          "type": "array",
          "title": "Collaborators",
          "description": "Permissions corresponding to the collaborators on an asset",
          "items": {
            "$ref": "#/definitions/permission"
          },
          "order": 15
        },
        "collaborators_count": {
          "type": "number",
          "title": "Collaborators Count",
          "description": "Total number of collaborators on an asset",
          "order": 9
        },
        "created_at": {
          "type": "string",
          "title": "Created At",
          "displayType": "date",
          "description": "The time at which the asset was created",
          "format": "date-time",
          "order": 13
        },
        "direct_url": {
          "type": "string",
          "title": "Direct Url",
          "description": "URL to the asset",
          "order": 14
        },
        "exposure": {
          "type": "string",
          "title": "Exposure",
          "description": "Exposure level of the document",
          "order": 8
        },
        "id": {
          "type": "string",
          "title": "Id",
          "description": "Unique internal identifier for the asset",
          "order": 1
        },
        "mime_type": {
          "type": "string",
          "title": "Mime Type",
          "order": 7
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "Title, name of the asset",
          "order": 10
        },
        "origin_id": {
          "type": "string",
          "title": "Origin Id",
          "description": "Unique identifier for the asset provided by the origin platform/vendor",
          "order": 3
        },
        "origin_type": {
          "type": "string",
          "title": "Origin Type",
          "description": "Equivalent to ‘vendor_type’",
          "order": 4
        },
        "owners": {
          "type": "array",
          "title": "Owners",
          "description": "Permissions corresponding to the owner(s) of the asset",
          "items": {
            "$ref": "#/definitions/permission"
          },
          "order": 6
        },
        "size": {
          "type": "string",
          "title": "Size",
          "description": "Size of the asset in bytes",
          "order": 11
        },
        "updated_at": {
          "type": "string",
          "title": "Updated At",
          "displayType": "date",
          "description": "The last time the asset has been modified",
          "format": "date-time",
          "order": 12
        },
        "vendor": {
          "$ref": "#/definitions/vendor",
          "title": "Vendor",
          "order": 2
        }
      },
      "definitions": {
        "permission": {
          "type": "object",
          "title": "permission",
          "properties": {
            "role": {
              "type": "string",
              "title": "Role",
              "description": "Role associated with the permission",
              "order": 2
            },
            "type": {
              "type": "string",
              "title": "Type",
              "description": "Type of permission",
              "order": 1
            },
            "value": {
              "type": "string",
              "title": "Value",
              "description": "Email address or domain address for the permission",
              "order": 3
            }
          }
        },
        "vendor": {
          "type": "object",
          "title": "vendor",
          "properties": {
            "name": {
              "type": "string",
              "title": "Name",
              "description": "The name of the vendor. For example, google",
              "order": 1
            }
          }
        }
      }
    },
    "incident": {
      "type": "object",
      "title": "incident",
      "properties": {
        "created_at": {
          "type": "string",
          "title": "Created At",
          "displayType": "date",
          "description": "Incident creation time",
          "format": "date-time",
          "order": 5
        },
        "customer_key": {
          "type": "string",
          "title": "Customer Key",
          "description": "An empty field to be used as a system ID",
          "order": 2
        },
        "entity": {
          "$ref": "#/definitions/entity",
          "title": "Entity",
          "description": "Information about the object relating to this incident",
          "order": 9
        },
        "extra": {
          "type": "array",
          "title": "Extra",
          "description": "Additional information related to the incident",
          "items": {
            "type": "string"
          },
          "order": 8
        },
        "id": {
          "type": "number",
          "title": "Id",
          "description": "The id is the internal CloudLock incident id, which can be used to call or update a specific incident",
          "order": 1
        },
        "incident_status": {
          "type": "string",
          "title": "Incident Status",
          "description": "Status of the incident",
          "order": 3
        },
        "match_count": {
          "type": "number",
          "title": "Match Count",
          "description": "Total number of matches",
          "order": 7
        },
        "matches": {
          "type": "array",
          "title": "Matches",
          "description": "List of matches for the incident",
          "items": {
            "$ref": "#/definitions/match"
          },
          "order": 11
        },
        "policy": {
          "$ref": "#/definitions/policy",
          "title": "Policy",
          "description": "The policy that triggered the incident",
          "order": 10
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "Severity of the incident",
          "order": 4
        },
        "updated_at": {
          "type": "string",
          "title": "Updated At",
          "displayType": "date",
          "description": "Incident last upate time",
          "format": "date-time",
          "order": 6
        }
      },
      "definitions": {
        "entity": {
          "type": "object",
          "title": "entity",
          "properties": {
            "asset_type": {
              "type": "string",
              "title": "Asset Type",
              "order": 5
            },
            "collaborators": {
              "type": "array",
              "title": "Collaborators",
              "description": "Permissions corresponding to the collaborators on an asset",
              "items": {
                "$ref": "#/definitions/permission"
              },
              "order": 15
            },
            "collaborators_count": {
              "type": "number",
              "title": "Collaborators Count",
              "description": "Total number of collaborators on an asset",
              "order": 9
            },
            "created_at": {
              "type": "string",
              "title": "Created At",
              "displayType": "date",
              "description": "The time at which the asset was created",
              "format": "date-time",
              "order": 13
            },
            "direct_url": {
              "type": "string",
              "title": "Direct Url",
              "description": "URL to the asset",
              "order": 14
            },
            "exposure": {
              "type": "string",
              "title": "Exposure",
              "description": "Exposure level of the document",
              "order": 8
            },
            "id": {
              "type": "string",
              "title": "Id",
              "description": "Unique internal identifier for the asset",
              "order": 1
            },
            "mime_type": {
              "type": "string",
              "title": "Mime Type",
              "order": 7
            },
            "name": {
              "type": "string",
              "title": "Name",
              "description": "Title, name of the asset",
              "order": 10
            },
            "origin_id": {
              "type": "string",
              "title": "Origin Id",
              "description": "Unique identifier for the asset provided by the origin platform/vendor",
              "order": 3
            },
            "origin_type": {
              "type": "string",
              "title": "Origin Type",
              "description": "Equivalent to ‘vendor_type’",
              "order": 4
            },
            "owners": {
              "type": "array",
              "title": "Owners",
              "description": "Permissions corresponding to the owner(s) of the asset",
              "items": {
                "$ref": "#/definitions/permission"
              },
              "order": 6
            },
            "size": {
              "type": "string",
              "title": "Size",
              "description": "Size of the asset in bytes",
              "order": 11
            },
            "updated_at": {
              "type": "string",
              "title": "Updated At",
              "displayType": "date",
              "description": "The last time the asset has been modified",
              "format": "date-time",
              "order": 12
            },
            "vendor": {
              "$ref": "#/definitions/vendor",
              "title": "Vendor",
              "order": 2
            }
          },
          "definitions": {
            "permission": {
              "type": "object",
              "title": "permission",
              "properties": {
                "role": {
                  "type": "string",
                  "title": "Role",
                  "description": "Role associated with the permission",
                  "order": 2
                },
                "type": {
                  "type": "string",
                  "title": "Type",
                  "description": "Type of permission",
                  "order": 1
                },
                "value": {
                  "type": "string",
                  "title": "Value",
                  "description": "Email address or domain address for the permission",
                  "order": 3
                }
              }
            },
            "vendor": {
              "type": "object",
              "title": "vendor",
              "properties": {
                "name": {
                  "type": "string",
                  "title": "Name",
                  "description": "The name of the vendor. For example, google",
                  "order": 1
                }
              }
            }
          }
        },
        "match": {
          "type": "object",
          "title": "match",
          "properties": {
            "created_at": {
              "type": "string",
              "title": "Created At",
              "displayType": "date",
              "description": "When this match was detected",
              "format": "date-time",
              "order": 1
            },
            "ctx_after": {
              "type": "string",
              "title": "Ctx After",
              "description": "Characters after the match",
              "order": 3
            },
            "ctx_before": {
              "type": "string",
              "title": "Ctx Before",
              "description": "Characters before the match",
              "order": 4
            },
            "field_name": {
              "type": "string",
              "title": "Field Name",
              "description": "Represents the field or object this match was found in",
              "order": 5
            },
            "text": {
              "type": "string",
              "title": "Text",
              "description": "Text to search for in an object. Relevant for content detection criteria",
              "order": 2
            }
          }
        },
        "permission": {
          "type": "object",
          "title": "permission",
          "properties": {
            "role": {
              "type": "string",
              "title": "Role",
              "description": "Role associated with the permission",
              "order": 2
            },
            "type": {
              "type": "string",
              "title": "Type",
              "description": "Type of permission",
              "order": 1
            },
            "value": {
              "type": "string",
              "title": "Value",
              "description": "Email address or domain address for the permission",
              "order": 3
            }
          }
        },
        "policy": {
          "type": "object",
          "title": "policy",
          "properties": {
            "created_at": {
              "type": "string",
              "title": "Created At",
              "displayType": "date",
              "description": "Policy creation time",
              "format": "date-time",
              "order": 5
            },
            "description": {
              "type": "string",
              "title": "Description",
              "description": "Policy description",
              "order": 3
            },
            "id": {
              "type": "string",
              "title": "Id",
              "description": "This is CloudLock Internal Identifier for a policy",
              "order": 1
            },
            "name": {
              "type": "string",
              "title": "Name",
              "description": "The name of the policy",
              "order": 2
            },
            "severity": {
              "type": "string",
              "title": "Severity",
              "description": "The severity assigned to incidents of this policy",
              "order": 7
            },
            "state": {
              "type": "string",
              "title": "State",
              "description": "Indicates if the policy is active or inactive",
              "order": 4
            },
            "updated_at": {
              "type": "string",
              "title": "Updated At",
              "displayType": "date",
              "description": "Policy updated time",
              "format": "date-time",
              "order": 6
            }
          }
        },
        "vendor": {
          "type": "object",
          "title": "vendor",
          "properties": {
            "name": {
              "type": "string",
              "title": "Name",
              "description": "The name of the vendor. For example, google",
              "order": 1
            }
          }
        }
      }
    },
    "match": {
      "type": "object",
      "title": "match",
      "properties": {
        "created_at": {
          "type": "string",
          "title": "Created At",
          "displayType": "date",
          "description": "When this match was detected",
          "format": "date-time",
          "order": 1
        },
        "ctx_after": {
          "type": "string",
          "title": "Ctx After",
          "description": "Characters after the match",
          "order": 3
        },
        "ctx_before": {
          "type": "string",
          "title": "Ctx Before",
          "description": "Characters before the match",
          "order": 4
        },
        "field_name": {
          "type": "string",
          "title": "Field Name",
          "description": "Represents the field or object this match was found in",
          "order": 5
        },
        "text": {
          "type": "string",
          "title": "Text",
          "description": "Text to search for in an object. Relevant for content detection criteria",
          "order": 2
        }
      }
    },
    "permission": {
      "type": "object",
      "title": "permission",
      "properties": {
        "role": {
          "type": "string",
          "title": "Role",
          "description": "Role associated with the permission",
          "order": 2
        },
        "type": {
          "type": "string",
          "title": "Type",
          "description": "Type of permission",
          "order": 1
        },
        "value": {
          "type": "string",
          "title": "Value",
          "description": "Email address or domain address for the permission",
          "order": 3
        }
      }
    },
    "policy": {
      "type": "object",
      "title": "policy",
      "properties": {
        "created_at": {
          "type": "string",
          "title": "Created At",
          "displayType": "date",
          "description": "Policy creation time",
          "format": "date-time",
          "order": 5
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Policy description",
          "order": 3
        },
        "id": {
          "type": "string",
          "title": "Id",
          "description": "This is CloudLock Internal Identifier for a policy",
          "order": 1
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The name of the policy",
          "order": 2
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "The severity assigned to incidents of this policy",
          "order": 7
        },
        "state": {
          "type": "string",
          "title": "State",
          "description": "Indicates if the policy is active or inactive",
          "order": 4
        },
        "updated_at": {
          "type": "string",
          "title": "Updated At",
          "displayType": "date",
          "description": "Policy updated time",
          "format": "date-time",
          "order": 6
        }
      }
    },
    "vendor": {
      "type": "object",
      "title": "vendor",
      "properties": {
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The name of the vendor. For example, google",
          "order": 1
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
