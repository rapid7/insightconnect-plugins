# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Look up a CIDR address in the database"


class Input:
    CIDR = "cidr"
    DAYS = "days"


class Output:
    ADDRESSSPACEDESC = "addressSpaceDesc"
    FOUND = "found"
    MAXADDRESS = "maxAddress"
    MINADDRESS = "minAddress"
    NETMASK = "netmask"
    NETWORKADDRESS = "networkAddress"
    NUMPOSSIBLEHOSTS = "numPossibleHosts"
    REPORTEDADDRESS = "reportedAddress"


class CheckCidrInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "cidr": {
      "type": "string",
      "title": "CIDR",
      "description": "IPv4 address block in CIDR notation e.g. 207.126.144.0/20",
      "order": 1
    },
    "days": {
      "type": "string",
      "title": "Days",
      "description": "Check for CIDR reports in the last x days",
      "default": "30",
      "order": 2
    }
  },
  "required": [
    "cidr",
    "days"
  ],
  "definitions": {}
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class CheckCidrOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "addressSpaceDesc": {
      "type": "string",
      "title": "Address Space Description",
      "description": "Description of address space",
      "order": 6
    },
    "found": {
      "type": "boolean",
      "title": "Found",
      "description": "Whether the CIDR was found in the database",
      "order": 8
    },
    "maxAddress": {
      "type": "string",
      "title": "Maximum Address",
      "description": "Last address in block",
      "order": 4
    },
    "minAddress": {
      "type": "string",
      "title": "Minimum Address",
      "description": "First address in block",
      "order": 3
    },
    "netmask": {
      "type": "string",
      "title": "Netmask",
      "description": "Netmask, ie. 24",
      "order": 2
    },
    "networkAddress": {
      "type": "string",
      "title": "Network Address",
      "description": "Network address in block",
      "order": 1
    },
    "numPossibleHosts": {
      "type": "integer",
      "title": "Number of Hosts",
      "description": "Number of possible hosts",
      "order": 5
    },
    "reportedAddress": {
      "type": "array",
      "title": "Reported IPs",
      "description": "List of reported IPs",
      "items": {
        "$ref": "#/definitions/reportedIPs"
      },
      "order": 7
    }
  },
  "required": [
    "found"
  ],
  "definitions": {
    "reportedIPs": {
      "type": "object",
      "title": "reportedIPs",
      "properties": {
        "ipAddress": {
          "type": "string",
          "title": "IP",
          "description": "IP Address of reported resource",
          "order": 1
        },
        "numReports": {
          "type": "integer",
          "title": "Number of Reports",
          "description": "Number of reports of this IP",
          "order": 2
        },
        "mostRecentReport": {
          "type": "string",
          "title": "Most Recent Report",
          "description": "Most recent report for this IP",
          "order": 3
        },
        "abuseConfidenceScore": {
          "type": "integer",
          "title": "Abuse Confidence Score",
          "description": "Confidence that this IP is abusive",
          "order": 4
        },
        "countryCode": {
          "type": "string",
          "title": "Country Code",
          "description": "Country code of IP",
          "order": 5
        }
      }
    }
  }
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
