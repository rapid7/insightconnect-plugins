plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: sentinelone
title: SentinelOne
version: 8.1.0
supported_versions: ["2.1.0"]
description: The SentinelOne plugin allows you to manage and mitigate all your security operations through SentinelOne
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/sentinelone
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.sentinelone.com/
tags:
- sentinelone
- endpoint
- detection
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [sentinelone, endpoint, detection]
  features: []
types:
  activities_types:
    id:
      title: Type ID
      description: Activity type ID
      type: float
      required: false
    descriptionTemplate:
      title: Description Template
      description: Activity description template as seen in activity page
      type: string
      required: false
    action:
      title: Action
      description: Action described in the activity
      type: string
      required: false
  activities_list:
    comments:
      title: Comments
      type: string
      description: Comments
      required: false
    userId:
      title: UserId
      type: string
      description: The user who invoked the activity (If applicable)
      required: false
    accountId:
      title: Account ID
      type: string
      description: Related account (If applicable)
      required: false
    createdAt:
      title: Created At
      type: string
      description: Activity creation time (UTC)
      required: false
    data:
      title: Data
      type: object
      description: Extra activity specific data
      required: false
    agentUpdatedVersion:
      title: Agent Updated Version
      type: string
      description: Agent's new version (If applicable)
      required: false
    siteId:
      title: Site ID
      type: string
      description: Related site (If applicable)
      required: false
    id:
      title: ID
      type: string
      description: Activity ID
      required: false
    updatedAt:
      title: Updated At
      type: string
      description: Activity last updated time (UTC)
      required: false
    description:
      title: Description
      type: string
      description: Extra activity information
      required: false
    primaryDescription:
      title: Primary Description
      type: string
      description: Primary description
      required: false
    agentId:
      title: Agent ID
      type: string
      description: Related agent (If applicable)
      required: false
    hash:
      title: Hash
      type: string
      description: Threat file hash (If applicable)
      required: false
    activityType:
      title: Activity Type
      type: integer
      description: Activity type
      required: false
    osFamily:
      title: OS Family
      type: string
      description: Agent's OS type (if applicable)
      required: false
    threatId:
      title: Threat ID
      type: string
      description: Related threat (If applicable)
      required: false
    groupId:
      title: Group ID
      type: string
      description: Related group (If applicable)
      required: false
    secondaryDescription:
      title: Secondary Description
      type: string
      description: Secondary description
      required: false
  agent_applications:
    installedDate:
      title: Installed Date
      description: Date when application installed
      type: string
      required: false
    version:
      title: Version
      description: Version of installed application
      type: string
      required: false
    publisher:
      title: Publisher
      description: Publisher of installed application
      type: string
      required: false
    size:
      title: Size
      description: Size of installed application
      type: integer
      required: false
    name:
      title: Name
      description: Name of installed application
      type: string
      required: false
  pagination:
    totalItems:
      title: Total Items
      type: integer
      description: Total items
      required: false
    nextCursor:
      title: Next Cursor
      type: string
      description: Next cursor
      required: false
  threat_data:
    username:
      title: Username
      type: string
      description: Username
      required: false
    classification:
      title: Classification
      type: string
      description: Classification
      required: false
    siteName:
      title: Site Name
      type: string
      description: Site name
      required: false
    fileObjectId:
      title: File Object ID
      type: string
      description: File object ID
      required: false
    mitigationActions:
      title: Mitigation Actions
      type: '[]string'
      description: Mitigation actions
      required: false
    fileCreatedDate:
      title: File Created Date
      type: string
      description: File created date
      required: false
    fileIsExecutable:
      title: File is Executable
      type: boolean
      description: File is executable
      required: false
    agentIp:
      title: Agent IP
      type: string
      description: Agent IP
      required: false
    agentNetworkStatus:
      title: Agent Network Status
      type: string
      description: Agent network status
      required: false
    isInteractiveSession:
      title: Is Interactive Session
      type: boolean
      description: Is interactive session
      required: false
    agentVersion:
      title: Agent Version
      type: string
      description: Agent version
      required: false
    mitigationReport:
      title: Mitigation Report
      type: object
      description: Mitigation report
      required: false
    id:
      title: ID
      type: string
      description: ID
      required: false
    fileData:
      title: File Data
      type: object
      description: File data
      required: false
    agentId:
      title: Agent ID
      type: string
      description: Agent ID
      required: false
    fileExtensionType:
      title: File Extension Type
      type: string
      description: File extension type
      required: false
    fileDisplayName:
      title: File Display Name
      type: string
      description: File display name
      required: false
    createdAt:
      title: Created At
      type: string
      description: Created At
      required: false
    whiteningOptions:
      title: Whitening Options
      type: '[]string'
      description: Whitening options
      required: false
    maliciousProcessArguments:
      title: Malicious Process Arguments
      type: string
      description: Malicious process arguments
      required: false
    certId:
      title: Cert ID
      type: string
      description: Cert ID
      required: false
    engines:
      title: Engines
      type: '[]string'
      description: Engines
      required: false
    collectionId:
      title: Collection ID
      type: string
      description: Collection ID
      required: false
    inQuarantine:
      title: In Quarantine
      type: boolean
      description: In quarantine
      required: false
    browserType:
      title: Browser Type
      type: string
      description: Browser type
      required: false
    fileIsSystem:
      title: File is System
      type: boolean
      description: File is system
      required: false
    markedAsBenign:
      title: Marked as Benign
      type: boolean
      description: Marked as Benign
      required: false
    cloudVerdict:
      title: Cloud Verdict
      type: string
      description: Cloud verdict
      required: false
    indicators:
      title: Indicators
      type: '[]integer'
      description: Indicators
      required: false
    classificationSource:
      title: Classification Source
      type: string
      description: Classification source
      required: false
    agentComputerName:
      title: Agent Computer Name
      type: string
      description: Agent computer name
      required: false
    mitigationStatus:
      title: Mitigation Status
      type: string
      description: Mitigation status
      required: false
    resolved:
      title: Resolved
      type: boolean
      description: Resolved
      required: false
    fileSha256:
      title: File SHA 256
      type: string
      description: File SHA 256
      required: false
    description:
      title: Description
      type: string
      description: Description
      required: false
    filePath:
      title: File Path
      type: string
      description: File path
      required: false
    fromScan:
      title: From Scan
      type: boolean
      description: From scan
      required: false
    classifierName:
      title: Classifiername
      type: string
      description: Classifiername
      required: false
    agentMachineType:
      title: Agent Machine Type
      type: string
      description: Agent machine type
      required: false
    isCertValid:
      title: Is Cert Valid
      type: boolean
      description: Is cert valid
      required: false
    fileIsDotNet:
      title: File is Dotnet
      type: boolean
      description: File is dotnet
      required: false
    fileContentHash:
      title: File Content Hash
      type: string
      description: File content hash
      required: false
    siteId:
      title: Site ID
      type: string
      description: Site ID
      required: false
    rank:
      title: Rank
      type: integer
      description: Rank
      required: false
    createdDate:
      title: Created Date
      type: string
      description: Created date
      required: false
    updatedAt:
      title: Updated At
      type: string
      description: Updated at
      required: false
    agentOsType:
      title: Agent OS Type
      type: string
      description: Agent OS type
      required: false
    agentIsDecommissioned:
      title: Agent is Decommissioned
      type: boolean
      description: Agent is Decommissioned
      required: false
    isPartialStory:
      title: Is Partial Story
      type: boolean
      description: Is partial story
      required: false
    annotation:
      title: Annotation
      type: string
      description: Annotation
      required: false
    fileVerificationType:
      title: File Verification Type
      type: string
      description: File verification type
      required: false
    publisher:
      title: Publisher
      type: string
      description: Publisher
      required: false
    threatName:
      title: Threat Name
      type: string
      description: Threat name
      required: false
    maliciousGroupId:
      title: Malicious Group ID
      type: string
      description: Malicious group ID
      required: false
    annotationUrl:
      title: Annotation URL
      type: string
      description: Annotation URL
      required: false
    agentIsActive:
      title: Agent is Active
      type: boolean
      description: Agent is Active
      required: false
    fromCloud:
      title: From Cloud
      type: boolean
      description: From cloud
      required: false
    mitigationMode:
      title: Mitigation Mode
      type: string
      description: Mitigation mode
      required: false
    agentDomain:
      title: Agent Domain
      type: string
      description: Agent domain
      required: false
    agentInfected:
      title: Agent Infected
      type: boolean
      description: Agent infected
      required: false
    threatAgentVersion:
      title: Threat Agent Version
      type: string
      description: Threat agent version
      required: false
    fileMaliciousContent:
      title: File Malicious Content
      type: boolean
      description: File malicious content
      required: false
  location:
    name:
      title: Name
      description: Location name
      type: string
      required: false
    scope:
      title: Scope
      description: Location scope
      type: string
      required: false
    id:
      title: ID
      description: Location ID
      type: string
      required: false
  active_directory:
    computerMemberOf:
      title: Computer Member Of
      description: Computer member of
      type: '[]string'
      required: false
    lastUserDistinguishedName:
      title: Last User Distinguished Name
      description: Last user distinguished name
      type: string
      required: false
    lastUserMemberOf:
      title: Last User Member Of
      description: Last user member of
      type: '[]string'
      required: false
    computerDistinguishedName:
      title: Computer Distinguished Name
      description: Computer distinguished name
      type: string
      required: false
  network_interfaces:
    gatewayMacAddress:
      title: Gateway MAC Address
      description: The default gateway MAC address
      type: string
      required: false
    inet6:
      title: IPv6 Addresses
      description: IPv6 addresses
      type: '[]string'
      required: false
    id:
      title: ID
      description: ID
      type: string
      required: false
    physical:
      title: Physical
      description: Interface's MAC address
      type: string
      required: false
    gatewayIp:
      title: Gateway IP
      description: The default gateway IP
      type: string
      required: false
    name:
      title: Name
      description: Name
      type: string
      required: false
    inet:
      title: IPv4 Addresses
      description: IPv4 addresses
      type: '[]string'
      required: false
  agent_data:
    scanFinishedAt:
      title: Scan Finished At
      description: Finish time of last scan
      type: string
      required: false
    inRemoteShellSession:
      title: In Remote Shell Session
      description: Is the Agent in a remote shell session
      type: boolean
      required: false
    externalIp:
      title: External IP
      description: External IPv4 address
      type: string
      required: false
    mitigationMode:
      title: Mitigation Mode
      description: Agent mitigation mode policy
      type: string
      required: false
    isUpToDate:
      title: Is Up to Date
      description: Indicates if the agent version is up to date
      type: boolean
      required: false
    scanAbortedAt:
      title: Scan Aborted At
      description: Abort time of last scan
      type: string
      required: false
    appsVulnerabilityStatus:
      title: Apps Vulnerability Status
      description: Apps vulnerability status
      type: string
      required: false
    rangerVersion:
      title: Ranger Version
      description: The version of Ranger
      type: string
      required: false
    createdAt:
      title: Created At
      description: Created at date
      type: string
      required: false
    userActionsNeeded:
      title: User Actions Needed
      description: A list of pending user actions
      type: "[]string"
      required: false
    groupId:
      title: Group ID
      description: A reference to the containing network group
      type: string
      required: false
    isPendingUninstall:
      title: Is Pending Uninstall
      description: Agent with a pending uninstall request
      type: boolean
      required: false
    accountName:
      title: Account Name
      description: Name of the containing account
      type: string
      required: false
    siteId:
      title: Site ID
      description: A reference to the containing site
      type: string
      required: false
    siteName:
      title: Site Name
      description: Name of the containing site
      type: string
      required: false
    osStartTime:
      title: OS Start Time
      description: Last boot time
      type: string
      required: false
    activeDirectory:
      title: Active Directory
      description: Active Directory data
      type: active_directory
      required: false
    networkInterfaces:
      title: Network Interfaces
      description: Device's network interfaces
      type: "[]network_interfaces"
      required: false
    rangerStatus:
      title: Ranger Status
      description: Is Agent disabled as a Ranger
      type: string
      required: false
    accountId:
      title: Account ID
      description: A reference to the containing account
      type: string
      required: false
    threatRebootRequired:
      title: Threat Reboot Required
      description: Has at least one threat with at least one mitigation action that is pending reboot to succeed
      type: boolean
      required: false
    osArch:
      title: OS Arch
      description: OS Arch
      type: string
      required: false
    activeThreats:
      title: Active Threats
      description: Current number of active threats
      type: integer
      required: false
    installerType:
      title: Installer Type
      description: Installer package type (file extension)
      type: string
      required: false
    scanStatus:
      title: Scan Status
      description: Last scan status
      type: string
      required: false
    groupName:
      title: Group Name
      description: Name of the containing network group
      type: string
      required: false
    consoleMigrationStatus:
      title: Console Migration Status
      description: What step the agent is at in the process of migrating to another console, if any
      type: string
      required: false
    infected:
      title: Infected
      description: Indicates if the Agent has active threats
      type: boolean
      required: false
    id:
      title: ID
      description: Agent ID
      type: string
      required: false
    updatedAt:
      title: Updated at
      description: Last updated date
      type: string
      required: false
    machineType:
      title: Machine Type
      description: Machine type
      type: string
      required: false
    isDecommissioned:
      title: Is Decommissioned
      description: Is Agent decommissioned
      type: boolean
      required: false
    osRevision:
      title: OS Revision
      description: OS revision
      type: string
      required: false
    scanStartedAt:
      title: Scan Started At
      description: Start time of last scan
      type: string
      required: false
    policyUpdatedAt:
      title: Policy Updated At
      description: Date of when the policy was last updated
      type: string
      required: false
    encryptedApplications:
      title: Encrypted Applications
      description: Disk encryption status
      type: boolean
      required: false
    locations:
      title: Locations
      description: A list of locations reported by the Agent
      type: "[]location"
      required: false
    domain:
      title: Domain
      description: Network domain
      type: string
      required: false
    locationType:
      title: Location Type
      description: Reported location type
      type: string
      required: false
    registeredAt:
      title: Registered At
      description: Time of first registration to management console (similar to createdAt)
      type: string
      required: false
    totalMemory:
      title: Total Memory
      description: Memory size (MB)
      type: integer
      required: false
    groupUpdatedAt:
      title: Group Updated At
      description: Date of when the group was last updated
      type: string
      required: false
    computerName:
      title: Computer Name
      description: Computer name
      type: string
      required: false
    isUninstalled:
      title: Is Uninstalled
      description: Indicates if Agent was removed from the device
      type: boolean
      required: false
    uuid:
      title: UUID
      description: Agent's universally unique identifier
      type: string
      required: false
    licenseKey:
      title: License Key
      description: License key
      type: string
      required: false
    isActive:
      title: Is Active
      description: Indicates if the agent was recently active
      type: boolean
      required: false
    cpuCount:
      title: CPU Count
      description: Number of CPUs
      type: integer
      required: false
    modelName:
      title: Model Name
      description: Model name
      type: string
      required: false
    externalId:
      title: External ID
      description: External id set by customer
      type: string
      required: false
    coreCount:
      title: Core Count
      description: Number of CPU cores
      type: integer
      required: false
    allowRemoteShell:
      title: Allow Remote Shell
      description: Agent is capable and policy enabled for remote shell
      type: boolean
      required: false
    agentVersion:
      title: Agent Version
      description: Agent version
      type: string
      required: false
    groupIp:
      title: Group IP
      description: IP Address subnet
      type: string
      required: false
    osName:
      title: OS Name
      description: Os name
      type: string
      required: false
    mitigationModeSuspicious:
      title: Mitigation Mode Suspicious
      description: Mitigation mode policy for suspicious activity
      type: string
      required: false
    osUsername:
      title: OS Username
      description: Os username
      type: string
      required: false
    lastLoggedInUserName:
      title: Last Logged In User Name
      description: Last logged in user name
      type: string
      required: false
    cpuId:
      title: CPU ID
      description: CPU model
      type: string
      required: false
    lastActiveDate:
      title: Last Active Date
      description: Last active date
      type: string
      required: false
    osType:
      title: OS Type
      description: OS type
      type: string
      required: false
    networkStatus:
      title: Network Status
      description: Agent's network connectivity status
      type: string
      required: false
    lastIpToMgmt:
      title: Last IP to Management Console
      description: The last IP used to connect to the Management console
      type: string
      required: false
    networkQuarantineEnabled:
      title: Network Quarantine Enabled
      description: Network quarantine enabled
      type: boolean
      required: false
    remoteProfilingState:
      title: Remote Profiling State
      description: Agent remote profiling state
      type: string
      required: false
    cloudProviders:
      title: Cloud Providers
      description: Cloud providers for this agent
      type: object
      required: false
    operationalState:
      title: Operational State
      description: Agent operational state
      type: string
      required: false
    remoteProfilingStateExpiration:
      title: Remote Profiling State Expiration
      description: Agent remote profiling state expiration in seconds
      type: string
      required: false
    operationalStateExpiration:
      title: Operational State Expiration
      description: Agent operational state expiration
      type: string
      required: false
    locationEnabled:
      title: Location Enabled
      description: Location enabled
      type: boolean
      required: false
    firewallEnabled:
      title: Firewall Enabled
      description: Firewall enabled
      type: boolean
      required: false
  quarantine_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    data:
      title: Data
      description: Response data
      type: object
      required: false
  query_id:
    queryID:
      title: Query ID
      description: Query ID
      type: string
      required: false
  create_query_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    data:
      title: Data
      description: Response data
      type: query_id
      required: false
  query_status:
    progressStatus:
      title: Progress Status
      description: Query loading status in percentage
      type: integer
      required: false
    responseState:
      title: Response State
      description: Response state
      type: string
      required: false
  get_query_status_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    data:
      title: Data
      description: Response data
      type: query_status
      required: false
  query_success:
    success:
      title: Success
      description: Request success status
      type: string
      required: false
  cancel_query_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    data:
      title: Data
      description: Response data
      type: query_success
      required: false
  query_data:
    objectType:
      title: Object Type
      description: Object type
      type: string
      required: false
    tid:
      title: TID
      description: TID
      type: string
      required: false
    registryPath:
      title: Registry Path
      description: Registry path
      type: string
      required: false
    processIsWow64:
      title: Process is WOW64
      description: Process is WOW64
      type: string
      required: false
    networkSource:
      title: Network Source
      description: Network source
      type: string
      required: false
    fileFullName:
      title: File Full Name
      description: File full name
      type: string
      required: false
    dnsResponse:
      title: DNS Response
      description: DNS response
      type: string
      required: false
    publisher:
      title: Publisher
      description: Publisher
      type: string
      required: false
    parentProcessGroupId:
      title: Parent Process Group ID
      description: Parent process group ID
      type: string
      required: false
    agentNetworkStatus:
      title: Agent Network Status
      description: Agent network status
      type: string
      required: false
    pid:
      title: PID
      description: PID
      type: string
      required: false
    trueContext:
      title: True Context
      description: True context
      type: string
      required: false
    parentProcessUniqueKey:
      title: Parent Process Unique Key
      description: Parent process unique key
      type: string
      required: false
    fileId:
      title: File ID
      description: File ID
      type: string
      required: false
    processStartTime:
      title: Process Start Time
      description: Process start time
      type: string
      required: false
    agentInfected:
      title: Agent Infected
      description: Agent infected
      type: boolean
      required: false
    indicatorCategory:
      title: Indicator Category
      description: Indicator category
      type: string
      required: false
    processDisplayName:
      title: Process Display Name
      description: Process display name
      type: string
      required: false
    oldFileSha256:
      title: Old File SHA256
      description: Old file SHA256
      type: string
      required: false
    agentOs:
      title: Agent OS
      description: Agent Operating System
      type: string
      required: false
    processIntegrityLevel:
      title: Process Integrity Level
      description: Process integrity level
      type: string
      required: false
    processCmd:
      title: Process CMD
      description: Process CMD
      type: string
      required: false
    agentIsActive:
      title: Agent is Active
      description: Agent is active
      type: boolean
      required: false
    processIsRedirectedCommandProcessor:
      title: Process is Redirected Command Processor
      description: Process is redirected command processor
      type: string
      required: false
    verifiedStatus:
      title: Verified Status
      description: Verified status
      type: string
      required: false
    processRoot:
      title: Process Root
      description: Process root
      type: string
      required: false
    signatureSignedInvalidReason:
      title: Signature Signed Invalid Reason
      description: Signature signed invalid reason
      type: string
      required: false
    registryId:
      title: Registry ID
      description: Registry ID
      type: string
      required: false
    processSessionId:
      title: Process Session ID
      description: Process session ID
      type: string
      required: false
    agentGroupId:
      title: Agent Group ID
      description: Agent group ID
      type: string
      required: false
    agentVersion:
      title: Agent Version
      description: Agent version
      type: string
      required: false
    parentProcessName:
      title: Parent Process Name
      description: Parent process name
      type: string
      required: false
    fileSha256:
      title: File SHA256
      description: File SHA256
      type: string
      required: false
    parentPid:
      title: Parent PID
      description: Parent PID
      type: string
      required: false
    agentId:
      title: Agent ID
      description: Agent ID
      type: string
      required: false
    agentIsDecommissioned:
      title: Agent is Decommissioned
      description: Agent is decommissioned
      type: boolean
      required: false
    networkUrl:
      title: Network URL
      description: Network URL
      type: string
      required: false
    processUserName:
      title: Process User Name
      description: Process user name
      type: string
      required: false
    processImageSha1Hash:
      title: Process Image SHA1 Hash
      description: Process image SHA1 hash
      type: string
      required: false
    taskPath:
      title: Task Path
      description: Task path
      type: string
      required: false
    id:
      title: ID
      description: ID
      type: string
      required: false
    srcPort:
      title: Source Port
      description: Source port
      type: integer
      required: false
    oldFileName:
      title: Old File Name
      description: Old file name
      type: string
      required: false
    sha256:
      title: SHA256
      description: SHA256
      type: string
      required: false
    processImagePath:
      title: Process Image Path
      description: Process image path
      type: string
      required: false
    siteName:
      title: Site Name
      description: Site name
      type: string
      required: false
    oldFileMd5:
      title: Old File MD5
      description: Old file MD5
      type: string
      required: false
    agentMachineType:
      title: Agent Machine Type
      description: Agent machine type
      type: string
      required: false
    taskName:
      title: Task Name
      description: Task name
      type: string
      required: false
    networkMethod:
      title: Network Method
      description: Network method
      type: string
      required: false
    parentProcessStartTime:
      title: Parent Process Start Time
      description: Parent process start time
      type: string
      required: false
    srcIp:
      title: Source IP
      description: Source IP
      type: string
      required: false
    fileSize:
      title: File Size
      description: File size
      type: string
      required: false
    fileMd5:
      title: File MD5
      description: File MD5
      type: string
      required: false
    createdAt:
      title: Created At
      description: Created at
      type: string
      required: false
    indicatorDescription:
      title: Indicator Description
      description: Indicator description
      type: string
      required: false
    processName:
      title: Process Name
      description: Process name
      type: string
      required: false
    oldFileSha1:
      title: Old File SHA1
      description: Old file SHA1
      type: string
      required: false
    parentProcessIsMalicious:
      title: Parent Process is Malicious
      description: Parent process is malicious
      type: boolean
      required: false
    indicatorMetadata:
      title: Indicator Metadata
      description: Indicator metadata
      type: string
      required: false
    rpid:
      title: RPID
      description: RPID
      type: string
      required: false
    sha1:
      title: SHA1
      description: SHA1
      type: string
      required: false
    relatedToThreat:
      title: Related to Threat
      description: Related to threat
      type: string
      required: false
    loginsBaseType:
      title: Logins Base Type
      description: Logins base type
      type: string
      required: false
    md5:
      title: MD5
      description: MD5
      type: string
      required: false
    agentDomain:
      title: Agent Domain
      description: Agent domain
      type: string
      required: false
    eventType:
      title: Event Type
      description: Event type
      type: string
      required: false
    fileSha1:
      title: File SHA1
      description: File SHA1
      type: string
      required: false
    user:
      title: User
      description: User
      type: string
      required: false
    processGroupId:
      title: Process Group ID
      description: Process group ID
      type: string
      required: false
    agentIp:
      title: Agent IP
      description: Agent IP
      type: string
      required: false
    fileType:
      title: File Type
      description: File type
      type: string
      required: false
    connectionStatus:
      title: Connection Status
      description: Connection status
      type: string
      required: false
    processSubSystem:
      title: Process Sub System
      description: Process sub system
      type: string
      required: false
    dstPort:
      title: Destination Port
      description: Object type
      type: integer
      required: false
    signedStatus:
      title: Signed Status
      description: Signed status
      type: string
      required: false
    processIsMalicious:
      title: Process is Malicious
      description: Process is malicious
      type: boolean
      required: false
    forensicUrl:
      title: Forensic URL
      description: Forensic URL
      type: string
      required: false
    dstIp:
      title: Destination IP
      description: Destination IP
      type: string
      required: false
    direction:
      title: Direction
      description: Direction
      type: string
      required: false
    agentUuid:
      title: Agent UUID
      description: Agent UUID
      type: string
      required: false
    agentName:
      title: Agent Name
      description: Agent name
      type: string
      required: false
    threatStatus:
      title: Threat Status
      description: Threat status
      type: string
      required: false
    processUniqueKey:
      title: Process Unique Key
      description: Process unique key
      type: string
      required: false
    indicatorName:
      title: Indicator Name
      description: Indicator name
      type: string
      required: false
    loginsUserName:
      title: Logins User Name
      description: Logins user name
      type: string
      required: false
    agentTimestamp:
      title: Agent Timestamp
      description: Agent timestamp
      type: string
      required: false
    attributes:
      title: Attributes
      description: Attributes
      type: "[]object"
      required: false
    childProcCount:
      title: Child Process Count
      description: Child process count
      type: string
      required: false
    endpointMachineType:
      title: Endpoint Machine Type
      description: Endpoint machine type
      type: string
      required: false
    endpointName:
      title: Endpoint Name
      description: Endpoint name
      type: string
      required: false
    endpointOs:
      title: Endpoint OS
      description: Endpoint OS
      type: string
      required: false
    eventTime:
      title: Event Time
      description: Event time
      type: string
      required: false
  get_events_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    pagination:
      title: Pagination
      description: Pagination
      type: pagination
      required: false
    data:
      title: Data
      description: Response data
      type: "[]query_data"
      required: false

connection:
  user_type:
    title: User Type
    description: Type of user
    type: string
    required: true
    enum:
      - Console user
      - Service user
    example: Console user
    default: Console user
  api_key:
    title: API Key
    description: Credential secret API key
    type: credential_secret_key
    required: true
    example: 9de5069c5afe602b2ea0a04b66beb2c0
  url:
    title: URL
    description: SentinelOne Console URL
    type: string
    required: true
    example: https://example.sentinelone.com
actions:
  get_threat_summary:
    title: Get Threat Summary
    description: Gets summary of all threats
    output:
      pagination:
        title: Pagination
        type: pagination
        description: Pagination
        required: false
        example: '{"totalItems": 1}'
      errors:
        title: Errors
        type: '[]object'
        description: Errors
        required: false
        example: '[{"type": "object"}]'
      data:
        title: Data
        type: '[]threat_data'
        description: Data
        required: false
        example: '[ { "agentOsType": "windows", "automaticallyResolved": false } ]'
  blacklist_by_content_hash:
    title: Blacklist by Content Hash
    description: Add hashed content to global blacklist. The input makes use of contentHash
      from the threat summary
    input:
      hash:
        title: Hash
        description: Content hash to add to blacklist
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
    output:
      affected:
        title: Affected
        type: integer
        description: Number of entities affected by the requested operation
        required: false
        example: 1
  create_ioc_threat:
    title: Create IOC Threat
    description: Create a threat from an IOC event
    input:
      hash:
        title: Hash
        description: SHA1 hash
        type: string
        required: true
        example: "A94A8FE5CCB19BA61C4C0873D391E987982FBBD3"
      agentId:
        title: Agent ID
        description: Agent ID for the slim threat
        type: string
        required: true
        example: "1000000000000000000"
      note:
        title: Note
        description: Note
        type: string
        required: false
        example: "Note"
      groupId:
        title: Group ID
        description: Group ID
        type: string
        required: false
        example: "1000000000000000001"
      path:
        title: Path
        description: Path
        type: string
        required: false
        example: "path"
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  mitigate_threat:
    title: Mitigate Threat
    description: Apply a mitigation action to a threat
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
        example: "1000000000000000000"
      action:
        title: Action
        description: Mitigation action
        type: string
        required: true
        enum:
        - rollback-remediation
        - quarantine
        - kill
        - remediate
        - un-quarantine
        example: quarantine
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  mark_as_benign:
    title: Mark as Benign
    description: Mark a threat as resolved and adds the IOC's to global allow list
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
        example: "1000000000000000000"
      target_scope:
        title: Target Scope
        description: Scope to be used for exclusions
        type: string
        required: true
        enum:
        - group
        - site
        - tenant
        example: site
      whitening_option:
        title: Whitening Option
        description: Selected whitening option
        type: string
        required: false
        enum:
        - ''
        - browser-type
        - certificate
        - file-type
        - file_hash
        - path
        example: path
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  mark_as_threat:
    title: Mark as Threat
    description: Mark a suspicious threat as a threat
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
        example: 1000000000000000000
      target_scope:
        title: Target Scope
        description: Scope to be used for exclusions
        type: string
        required: true
        enum:
        - group
        - site
        - tenant
        example: site
      whitening_option:
        title: Whitening Option
        description: Selected whitening option
        type: string
        required: false
        enum:
        - ''
        - browser-type
        - certificate
        - file-type
        - file_hash
        - path
        example: path
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  activities_list:
    title: Get Activities
    description: Get a list of activities
    input:
      group_ids:
        title: Group IDS
        description: List of Group IDs
        type: '[]string'
        required: false
        example: ["500000000000000000"]
      include_hidden:
        title: Include Hidden
        description: Include internal activities hidden from display
        type: boolean
        required: false
        example: true
      skip:
        title: Skip First N Items
        description: Skip first number of items (0-1000). Will return the number entries specified in the 'limit' input (default is 10)
        type: integer
        required: false
        example: 1
      site_ids:
        title: Site IDS
        description: List of Site IDs to filter by
        type: '[]string'
        required: false
        example: ["5000000000000001"]
      agent_ids:
        title: Agent IDS
        description: Return activities related to specified agent ids
        type: '[]string'
        required: false
        example: ["9000000000000000"]
      skip_count:
        title: Skip Count
        description: If true, total number of items will not be calculated, which speeds up execution time
        type: boolean
        required: false
        example: true
      ids:
        title: Activity IDS
        description: List of Activity IDs
        type: '[]string'
        required: false
        example: ["800000000000000008"]
      created_at_lt:
        title: Less than Date
        description: Return activities created before this date in ISO-8601
        type: string
        required: false
        example: "2020-12-20T18:49:26.257525Z"
      created_at_lte:
        title: Less or Equal Date
        description: Return activities created before or at this date in ISO-8601, example 2020-12-18T18:49:26.257525Z
        type: string
        required: false
        example: "2020-12-20T18:49:26.257525Z"
      created_at_gt:
        title: Greater than Date
        description: Return activities created after or at this date in ISO-8601, example 2020-12-18T18:49:26.257525Z
        type: string
        required: false
        example: "2020-12-18T18:49:26.257525Z"
      created_at_gte:
        title: Greater or Equal Date
        description: Return activities created after or at this date in ISO-8601, example 2020-12-18T18:49:26.257525Z
        type: string
        required: false
        example: "2020-12-20T18:49:26.257525Z"
      created_at_between:
        title: Between Dates
        description: Return activities created within this range (inclusive), example 1514978764288-1514978999999
        type: string
        required: false
        example: "1514978764288-1514978999999"
      count_only:
        title: Count Only
        description: If true, only total number of items will be returned, without any of the actual objects
        type: boolean
        required: false
        example: true
      account_ids:
        title: Account IDS
        description: List of Account IDs to filter by
        type: '[]string'
        required: false
        example: ["400000000000000000"]
      limit:
        title: Limit
        description: Limit number of returned items (1-1000)
        type: integer
        required: false
        example: 10
        default: 10
      sort_by:
        title: Sort By
        description: The column to sort the results by
        type: string
        required: false
        enum:
          - id
          - activityType
          - createdAt
        example: "createdAt"
        default: "createdAt"
      activity_types:
        title: Activity Types
        description: Return only these activity codes
        type: '[]string'
        required: false
        example: ["22", "23"]
      threat_ids:
        title: Threat IDS
        description: Return only these activity codes
        type: '[]string'
        required: false
        example: ["1"]
      sort_order:
        title: Sort Order
        description: Sort direction
        type: string
        enum:
          - asc
          - desc
        required: false
        default: "asc"
        example: asc
      user_emails:
        title: User Emails
        description: Email of the user who invoked the activity (If applicable)
        type: '[]string'
        required: false
        example: ["user@example.com"]
      user_ids:
        title: User IDS
        description: The user who invoked the activity (If applicable)
        type: '[]string'
        required: false
        example: ["500000000000000003"]
    output:
      data:
        title: Data
        description: Result of activities list
        type: '[]activities_list'
        required: true
        example: '[{ "agentUpdatedVersion": "2.5.1.1320", "id": "225494730938493804", "createdAt": "2018-02-27T04:49:26.257525Z", "groupId": "225494730938493804", "primaryDescription": "string", "accountName": "string", "description": "string", "osFamily": "windows_legacy", "hash": "string", "secondaryDescription": "string", "comments": "string", "siteId": "225494730938493804", "groupName": "string", "threatId": "225494730938493804", "agentId": "225494730938493804", "data": { "computer_name": "COMP_1234", "username": "my_user" }, "activityType": "integer", "accountId": "225494730938493804", "updatedAt": "2018-02-27T04:49:26.257525Z", "userId": "225494730938493804", "activityUuid": "string", "siteName": "string" }]'
  activities_types:
    title: Get Activity Types
    description: Get a list of activity types
    output:
      activity_types:
        title: Activity Types
        description: Result of activities types
        type: '[]activities_types'
        required: true
        example: '[{ "id": 0, "descriptionTemplate": "string", "action": "string" }]'
  apps_by_agent_ids:
    title: Agents Applications
    description: Retrieve running applications for a specific agent
    input:
      ids:
        title: Agent IDS
        description: Agent ID list
        type: '[]string'
        required: true
        example: ["1000000000000000000"]
    output:
      data:
        title: Agent Applications
        description: List of installed applications
        type: '[]agent_applications'
        required: true
        example: '[ { "publisher": "string", "installedDate": "2018-02-27T04:49:26.257525Z", "size": "integer", "name": "string", "version": "string" } ]'
  fetch_file_by_agent_id:
    title: Fetch File
    description: Fetch file for a specific agent id
    input:
      agent_id:
        title: Agent ID
        description: Agent ID
        type: 'string'
        required: true
        example: "1000000000000000000"
      file_path:
        title: File Path
        description: File path of file to fetch. If a file can be fetched, it will be uploaded to the SentinelOne console for download
        type: string
        required: true
        example: "C:/windows/system32/winevt/logs/application.evtx"
      password:
        title: Password
        description: File encryption password, min. length 10 characters and cannot contain whitespace
        type: 'string'
        required: true
        example: "MySecretPass123!"
    output:
      success:
        title: Success
        description: File fetch response status
        type: boolean
        required: true
        example: true
  agents_summary:
    title: Count Summary
    description: Summary of agents by numbers
    input:
      site_ids:
        title: Site IDS
        description: List of Site IDs to filter by
        type: '[]string'
        required: false
        example: ["500000000000000000"]
      account_ids:
        title: Account IDS
        description: List of Account IDs to filter by
        type: '[]string'
        required: false
        example: ["4000000000000000000"]
    output:
      up_to_date:
        title: Up to Date Number
        description: Number of agents with the most up-to-date software version
        type: integer
        required: false
        example: 2
      out_of_date:
        title: Out of Date Number
        description: Number of agents running an older software version
        type: integer
        required: false
        example: 1
      total:
        title: Total
        description: Number of installed active agents
        type: integer
        required: false
        example: 2
      online:
        title: Online
        description: Number of online agents
        type: integer
        required: false
        example: 2
      decommissioned:
        title: Decommissioned
        description: Number of decommissioned agents
        type: integer
        required: false
        example: 0
      infected:
        title: Infected
        description: Number of agents with at least one active threat
        type: integer
        required: false
        example: 1
  name_available:
    title: Available Name
    description: Is the account name available for this account
    input:
      name:
        title: Name
        description: Account Name to validate
        type: string
        required: true
        example: "example"
    output:
      available:
        title: Available
        description: Account Name to validate
        type: boolean
        required: true
        example: true
  agents_reload:
    title: Agents Reload
    description: Reload an agent module (applies to Windows agents only)
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
        example: '{"ids": ["1000000000000000000"]}'
      module:
        title: Data Module
        description: Agent module to reload
        type: string
        required: true
        enum:
          - monitor
          - static
          - agent
          - log
        example: monitor
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  agents_action:
    title: Run Agent Action
    description: Perform actions relating to your SentinelOne agents. Initiate/Abort scan, connect/disconnect, decommission, restart/shutdown, fetch logs. Documentation for these actions can be found at https://yoururl.sentinelone.net/api-doc/api-details?category=agent-actions
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents. Note - decommission, disconnect, restart-machine, shutdown and uninstall actions require that one of the following filter arguments be supplied - ids, groupIds, or filterId
        type: object
        required: true
        example: '{"ids": ["1000000000000000000"]}'
        default: '{}'
      action:
        title: Agent Action
        description: Agent action to run
        type: string
        required: true
        enum:
          - abort-scan
          - connect
          - decommission
          - disconnect
          - fetch-logs
          - initiate-scan
          - restart-machine
          - shutdown
          - uninstall
        example: "connect"
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  search_agents:
    title: Search Agents
    description: Search for agents
    input:
      agent:
        title: Agent
        description: Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID. If empty, this action will return all active or inactive agents depending on the value of the Agent Active input
        type: string
        example: hostname123
        required: false
      agent_active:
        title: Agent Active
        description: Return a list of all active or inactive agents when Agent input is not specified. Note that setting this to true for Active agents can return a very large amount of data
        type: boolean
        example: true
        default: true
        required: false
      case_sensitive:
        title: Case Sensitive
        description: Looks up agents in a case-sensitive manner. Setting this value to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
      operational_state:
        title: Operational State
        description: Agent operational state
        type: string
        example: na
        default: Any
        enum:
        - Any
        - na
        - fully_disabled
        - partially_disabled
        - disabled_error
        required: false
    output:
      agents:
        title: Agents
        description: Detailed information about agents found
        type: "[]agent_data"
        required: false
        example: '{ "agents": [ { "accountId": "433241117337583618", "accountName": "SentinelOne", "activeDirectory": { "computerDistinguishedName": "None", "computerMemberOf": [], "lastUserDistinguishedName": "None", "lastUserMemberOf": [] }, "activeThreats": 0, "agentVersion": "4.1.4.82", "allowRemoteShell": false, "appsVulnerabilityStatus": "up_to_date", "cloudProviders": {}, "computerName": "so-agent-win12", "consoleMigrationStatus": "N/A", "coreCount": 1, "cpuCount": 1, "cpuId": "Intel(R) Xeon(R) CPU E5-2690 v2 @ 3.00GHz", "createdAt": "2020-05-28T14:53:03.014660Z", "domain": "WORKGROUP", "encryptedApplications": false, "externalId": "", "externalIp": "198.51.100.100", "firewallEnabled": true, "groupId": "521580416411822676", "groupIp": "198.51.100.x", "groupName": "Default Group", "id": "901345720792880606", "inRemoteShellSession": false, "infected": false, "installerType": ".exe", "isActive": true, "isDecommissioned": false, "isPendingUninstall": false, "isUninstalled": false, "isUpToDate": true, "lastActiveDate": "2020-06-05T18:32:56.748620Z", "lastIpToMgmt": "10.4.24.55", "lastLoggedInUserName": "", "licenseKey": "", "locationEnabled": true, "locationType": "fallback", "locations": [ { "id": "629380164464502476", "name": "Fallback", "scope": "global" } ], "machineType": "server", "mitigationMode": "protect", "mitigationModeSuspicious": "detect", "modelName": "VMware, Inc. - VMware Virtual Platform", "networkInterfaces": [ { "id": "901345720801269215", "inet": [ "198.51.100.100" ], "inet6": [ "2001:db8:8:4::2" ], "name": "Ethernet", "physical": "00:50:56:94:17:08" } ], "networkQuarantineEnabled": false, "networkStatus": "disconnected", "operationalState": "na", "operationalStateExpiration": "None", "osArch": "64 bit", "osName": "Windows Server 2012 Standard", "osRevision": "9200", "osStartTime": "2020-05-28T14:59:36Z", "osType": "windows", "osUsername": "None", "rangerStatus": "NotApplicable", "rangerVersion": "None", "registeredAt": "2020-05-28T14:53:03.010853Z", "remoteProfilingState": "disabled", "remoteProfilingStateExpiration": "None", "scanAbortedAt": "None", "scanFinishedAt": "2020-05-28T22:24:59.420166Z", "scanStartedAt": "2020-05-28T21:12:58.216807Z", "scanStatus": "finished", "siteId": "521580416395045459", "siteName": "Rapid7", "threatRebootRequired": false, "totalMemory": 1023, "updatedAt": "2020-06-05T15:39:10.754112Z", "userActionsNeeded": [], "uuid": "28db47168fa54f89aeed99769ac8d4dc" } ] }'
  get_agent_details:
    title: Get Agent Details
    description: Retrieve agent details
    input:
      agent:
        title: Agent
        description: Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID
        type: string
        example: hostname123
        required: true
      case_sensitive:
        title: Case Sensitive
        description: Looks up the specified Agent in a case-sensitive manner. Setting this to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
      operational_state:
        title: Operational State
        description: Agent operational state
        type: string
        example: na
        default: Any
        enum:
        - Any
        - na
        - fully_disabled
        - partially_disabled
        - disabled_error
        required: false
    output:
      agent:
        title: Agent
        description: Detailed information about agent found
        type: agent_data
        required: false
        example: '{ "agent": { "accountId": "433241117337583618", "accountName": "SentinelOne", "activeDirectory": { "computerDistinguishedName": "None", "computerMemberOf": [], "lastUserDistinguishedName": "None", "lastUserMemberOf": [] }, "activeThreats": 0, "agentVersion": "4.1.4.82", "allowRemoteShell": false, "appsVulnerabilityStatus": "up_to_date", "cloudProviders": {}, "computerName": "so-agent-win12", "consoleMigrationStatus": "N/A", "coreCount": 1, "cpuCount": 1, "cpuId": "Intel(R) Xeon(R) CPU E5-2690 v2 @ 3.00GHz", "createdAt": "2020-05-28T14:53:03.014660Z", "domain": "WORKGROUP", "encryptedApplications": false, "externalId": "", "externalIp": "198.51.100.100", "firewallEnabled": true, "groupId": "521580416411822676", "groupIp": "198.51.100.x", "groupName": "Default Group", "id": "901345720792880606", "inRemoteShellSession": false, "infected": false, "installerType": ".exe", "isActive": true, "isDecommissioned": false, "isPendingUninstall": false, "isUninstalled": false, "isUpToDate": true, "lastActiveDate": "2020-06-05T18:32:56.748620Z", "lastIpToMgmt": "10.4.24.55", "lastLoggedInUserName": "", "licenseKey": "", "locationEnabled": true, "locationType": "fallback", "locations": [ { "id": "629380164464502476", "name": "Fallback", "scope": "global" } ], "machineType": "server", "mitigationMode": "protect", "mitigationModeSuspicious": "detect", "modelName": "VMware, Inc. - VMware Virtual Platform", "networkInterfaces": [ { "id": "901345720801269215", "inet": [ "198.51.100.100" ], "inet6": [ "2001:db8:8:4::2" ], "name": "Ethernet", "physical": "00:50:56:94:17:08" } ], "networkQuarantineEnabled": false, "networkStatus": "disconnected", "operationalState": "na", "operationalStateExpiration": "None", "osArch": "64 bit", "osName": "Windows Server 2012 Standard", "osRevision": "9200", "osStartTime": "2020-05-28T14:59:36Z", "osType": "windows", "osUsername": "None", "rangerStatus": "NotApplicable", "rangerVersion": "None", "registeredAt": "2020-05-28T14:53:03.010853Z", "remoteProfilingState": "disabled", "remoteProfilingStateExpiration": "None", "scanAbortedAt": "None", "scanFinishedAt": "2020-05-28T22:24:59.420166Z", "scanStartedAt": "2020-05-28T21:12:58.216807Z", "scanStatus": "finished", "siteId": "521580416395045459", "siteName": "Rapid7", "threatRebootRequired": false, "totalMemory": 1023, "updatedAt": "2020-06-05T15:39:10.754112Z", "userActionsNeeded": [], "uuid": "28db47168fa54f89aeed99769ac8d4dc" } }'
  quarantine:
    title: Quarantine
    description: Isolate (quarantine) endpoint from the network
    input:
      agent:
        title: Agent
        description: Agent to perform quarantine action on. Accepts IP address, MAC address, hostname, UUID or agent ID
        type: string
        example: hostname123
        required: true
      quarantine_state:
        title: Quarantine State
        description: True to quarantine host, false to unquarantine host
        type: boolean
        example: true
        required: true
      whitelist:
        title: Whitelist
        description: This list contains a set of devices that should not be blocked. This can include IPs, hostnames, UUIDs and agent IDs
        type: "[]string"
        example: ["198.51.100.100", "hostname123", "901345720792880606", "28db47168fa54f89aeed99769ac8d4dc"]
        required: false
      case_sensitive:
        title: Case Sensitive
        description: Looks up the specified Agent in a case-sensitive manner. Setting this value to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: quarantine_response
        required: false
        example: '{ "response": { "data": [ { "agentDomain": "WORKGROUP", "agentGroupId": "123123456712356789", "agentId": "123123456712356789" } } }'
  blacklist:
    title: Blacklist
    description: Blacklist and unblacklist a SHA1 hash
    input:
      hash:
        title: Hash
        description: Create a blacklist item from a SHA1 hash
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
      description:
        title: Description
        description: Description for why the hash is blacklisted
        type: string
        default: "Hash Blacklisted from InsightConnect"
        required: false
        example: "Hash Blacklisted from InsightConnect"
      blacklist_state:
        title: Blacklist State
        description: True to create blacklist hash, false to unblacklist hash
        type: boolean
        required: true
        default: true
        example: true
    output:
      success:
        title: Success
        description: Return true if blacklist item was created or deleted
        type: boolean
        required: true
        example: true
      message:
        title: Message
        description: Return details about action results
        type: string
        required: true
        example: 'The given hash has been blocked'
  threats_fetch_file:
    title: Fetch Threats File
    description: Fetch a file associated with the threat that matches the filter. Your user role must have permissions to Fetch Threat File - Admin, IR Team, SOC
    input:
      id:
        title: ID
        description: Threat ID
        type: string
        required: true
        example: "939039647215561624"
      password:
        title: Password
        description: File encryption password, min. length 10 characters and cannot contain whitespace
        type: password
        required: true
        example: "Rapid7 Insightconnect"
    output:
      file:
        title: File
        description: Base64 encoded threat file
        type: file
        required: true
        example: '{ "file": { "filename": "report.txt", "content": "UmFwaWQ3IEluc2lnaHRDb25uZWN0Cg==" } }'
  disable_agent:
    title: Disable Agent
    description: Disable agents that match a filter
    input:
      agent:
        title: Agent
        description: Agent to perform disable action on. Accepts IP address, MAC address, hostname, UUID or agent ID. Leave empty to perform action on all applicable Agents
        type: string
        example: hostname123
        required: false
      reboot:
        title: Reboot
        description: Set true to reboot the endpoint, false to skip rebooting
        type: boolean
        required: true
        example: true
      expiration_timezone:
        title: Expiration Timezone
        description: Timezone for the expiration timestamp. Set with expiration time
        type: string
        required: false
        enum:
          - Australian Central Daylight Saving Time [ACDT]
          - Australian Central Standard Time [ACST]
          - Acre Time [ACT]
          - Atlantic Daylight Time [ADT]
          - Australian Eastern Daylight Saving Time [AEDT]
          - Australian Eastern Standard Time [AEST]
          - Australian Eastern Time [AET]
          - Afghanistan Time [AFT]
          - Alaska Daylight Time [AKDT]
          - Alaska Standard Time [AKST]
          - Alma-Ata Time [ALMT]
          - Amazon Summer Time (Brazil) [AMST]
          - Amazon Time (Brazil) [AMT]
          - Armenia Time [AMT]
          - Anadyr Time [ANAT]
          - Aqtobe Time [AQTT]
          - Argentina Time [ART]
          - Arabia Standard Time [AST]
          - Atlantic Standard Time [AST]
          - Australian Western Standard Time [AWST]
          - Azores Summer Time [AZOST]
          - Azores Standard Time [AZOT]
          - Azerbaijan Time [AZT]
          - Brunei Time [BNT]
          - British Indian Ocean Time [BIOT]
          - Baker Island Time [BIT]
          - Bolivia Time [BOT]
          - Brasilia Summer Time [BRST]
          - Brasilia Time [BRT]
          - Bangladesh Standard Time [BST]
          - Bougainville Standard Time [BST]
          - Bhutan Time [BTT]
          - Central Africa Time [CAT]
          - Cocos Islands Time [CCT]
          - Central Daylight Time (North America) [CDT]
          - Cuba Daylight Time [CDT]
          - Central European Summer Time [CEST]
          - Central European Time [CET]
          - Chatham Daylight Time [CHADT]
          - Chatham Standard Time [CHAST]
          - Choibalsan Standard Time [CHOT]
          - Choibalsan Summer Time [CHOST]
          - Chamorro Standard Time [CHST]
          - Chuuk Time [CHUT]
          - Clipperton Island Standard Time [CIST]
          - Central Indonesia Time [WITA]
          - Cook Island Time [CKT]
          - Chile Summer Time [CLST]
          - Chile Standard Time [CLT]
          - Colombia Summer Time [COST]
          - Colombia Time [COT]
          - Central Standard Time (North America) [CST]
          - China Standard Time [CST]
          - Cuba Standard Time [CST]
          - Central Time [CT]
          - Cape Verde Time [CVT]
          - Christmas Island Time [CXT]
          - Davis Time [DAVT]
          - Dumont dUrville Time [DDUT]
          - AIX-specific equivalent of Central European Time [DFT]
          - Easter Island Summer Time [EASST]
          - Easter Island Standard Time [EAST]
          - East Africa Time [EAT]
          - Ecuador Time [ECT]
          - Eastern Daylight Time (North America) [EDT]
          - Eastern European Summer Time [EEST]
          - Eastern European Time [EET]
          - Eastern Greenland Summer Time [EGST]
          - Eastern Greenland Time [EGT]
          - Eastern Indonesian Time [WIT]
          - Eastern Standard Time (North America) [EST]
          - Further-eastern European Time [FET]
          - Fiji Time [FJT]
          - Falkland Islands Summer Time [FKST]
          - Falkland Islands Time [FKT]
          - Fernando de Noronha Time [FNT]
          - Galapagos Time [GALT]
          - Gambier Islands Time [GAMT]
          - Georgia Standard Time [GET]
          - French Guiana Time [GFT]
          - Gilbert Island Time [GILT]
          - Gambier Island Time [GIT]
          - Greenwich Mean Time [GMT]
          - South Georgia and the South Sandwich Islands Time [GST]
          - Gulf Standard Time [GST]
          - Guyana Time [GYT]
          - Hawaii-Aleutian Daylight Time [HDT]
          - Heure Avancee Europe Centrale French-language name for CEST [HAEC]
          - Hawaii-Aleutian Standard Time [HST]
          - Hong Kong Time [HKT]
          - Heard and McDonald Islands Time [HMT]
          - Hovd Time [HOVT]
          - Indochina Time [ICT]
          - International Day Line West time zone [IDLW]
          - Israel Daylight Time [IDT]
          - Indian Ocean Time [IOT]
          - Iran Daylight Time [IRDT]
          - Irkutsk Time [IRKT]
          - Iran Standard Time [IRST]
          - Indian Standard Time [IST]
          - Irish Standard Time [IST]
          - Israel Standard Time [IST]
          - Japan Standard Time [JST]
          - Kaliningrad Time [KALT]
          - Kyrgyzstan Time [KGT]
          - Kosrae Time [KOST]
          - Krasnoyarsk Time [KRAT]
          - Korea Standard Time [KST]
          - Lord Howe Standard Time [LHST]
          - Lord Howe Summer Time [LHST]
          - Line Islands Time [LINT]
          - Magadan Time [MAGT]
          - Marquesas Islands Time [MART]
          - Mawson Station Time [MAWT]
          - Mountain Daylight Time (North America) [MDT]
          - Middle European Time [MET]
          - Middle European Summer Time [MEST]
          - Marshall Islands Time [MHT]
          - Macquarie Island Station Time [MIST]
          - Marquesas Islands Time [MIT]
          - Myanmar Standard Time [MMT]
          - Moscow Time [MSK]
          - Malaysia Standard Time [MST]
          - Mountain Standard Time (North America) [MST]
          - Mauritius Time [MUT]
          - Maldives Time [MVT]
          - Malaysia Time [MYT]
          - New Caledonia Time [NCT]
          - Newfoundland Daylight Time [NDT]
          - Norfolk Island Time [NFT]
          - Novosibirsk Time [NOVT]
          - Nepal Time [NPT]
          - Newfoundland Standard Time [NST]
          - Newfoundland Time [NT]
          - Niue Time [NUT]
          - New Zealand Daylight Time [NZDT]
          - New Zealand Standard Time [NZST]
          - Omsk Time [OMST]
          - Oral Time [ORAT]
          - Pacific Daylight Time (North America) [PDT]
          - Peru Time [PET]
          - Kamchatka Time [PETT]
          - Papua New Guinea Time [PGT]
          - Phoenix Island Time [PHOT]
          - Philippine Time [PHT]
          - Pakistan Standard Time [PKT]
          - Saint Pierre and Miquelon Daylight Time [PMDT]
          - Saint Pierre and Miquelon Standard Time [PMST]
          - Pohnpei Standard Time [PONT]
          - Pacific Standard Time (North America) [PST]
          - Philippine Standard Time [PST]
          - Palau Time [PWT]
          - Paraguay Summer Time [PYST]
          - Paraguay Time [PYT]
          - Reunion Time [RET]
          - Rothera Research Station Time [ROTT]
          - Sakhalin Island Time [SAKT]
          - Samara Time [SAMT]
          - South African Standard Time [SAST]
          - Solomon Islands Time [SBT]
          - Seychelles Time [SCT]
          - Samoa Daylight Time [SDT]
          - Singapore Time [SGT]
          - Sri Lanka Standard Time [SLST]
          - Srednekolymsk Time [SRET]
          - Suriname Time [SRT]
          - Samoa Standard Time [SST]
          - Singapore Standard Time [SST]
          - Showa Station Time [SYOT]
          - Tahiti Time [TAHT]
          - Thailand Standard Time [THA]
          - French Southern and Antarctic Time [TFT]
          - Tajikistan Time [TJT]
          - Tokelau Time [TKT]
          - Timor Leste Time [TLT]
          - Turkmenistan Time [TMT]
          - Turkey Time [TRT]
          - Tonga Time [TOT]
          - Tuvalu Time [TVT]
          - Ulaanbaatar Summer Time [ULAST]
          - Ulaanbaatar Standard Time [ULAT]
          - Coordinated Universal Time [UTC]
          - Uruguay Summer Time [UYST]
          - Uruguay Standard Time [UYT]
          - Uzbekistan Time [UZT]
          - Venezuelan Standard Time [VET]
          - Vladivostok Time [VLAT]
          - Volgograd Time [VOLT]
          - Vostok Station Time [VOST]
          - Vanuatu Time [VUT]
          - Wake Island Time [WAKT]
          - West Africa Summer Time [WAST]
          - West Africa Time [WAT]
          - Western European Summer Time [WEST]
          - Western European Time [WET]
          - Western Indonesian Time [WIB]
          - West Greenland Summer Time [WGST]
          - West Greenland Time [WGT]
          - Western Standard Time [WST]
          - Yakutsk Time [YAKT]
          - Yekaterinburg Time [YEKT]
        default: Central Standard Time (North America) [CST]
        example: Central Standard Time (North America) [CST]
      expiration_time:
        title: Expiration Time
        description: Agents will be re-enabled after this timestamp
        type: string
        required: false
        example: 2020-02-27T04:49:26.257525Z
      filter:
        title: Filter
        description: Filter to apply action on specified agents. Leave empty to perform action on all applicable Agents
        required: false
        type: object
        example: '{ "updatedAt__gt": "2019-02-27T04:49:26.257525Z" }'
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: true
        example: 1
  enable_agent:
    title: Enable Agent
    description: Enable agents that match the filter
    input:
      agent:
        title: Agent
        description: Agent to perform disable action on. Accepts IP address, MAC address, hostname, UUID or agent ID. Leave empty to perform action on all applicable Agents
        type: string
        example: hostname123
        required: false
      reboot:
        title: Reboot
        description: Set true to reboot the endpoint, false to skip rebooting
        type: boolean
        required: true
        example: true
      filter:
        title: Filter
        description: Filter to apply action on specified agents. Leave empty to perform action on all applicable Agents
        required: false
        type: object
        example: '{ "updatedAt__gt": "2019-02-27T04:49:26.257525Z" }'
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: true
        example: 1
  create_query:
    title: Create Query
    description: Start a Deep Visibility Query and get the queryId. You can use the queryId for other commands, such as Get Events and Get Query Status
    input:
      query:
        title: Query
        description: Events matching the query search term will be returned
        type: string
        example: AgentName IS NOT EMPTY
        required: true
      from_date:
        title: From Date
        description: From date
        type: string
        example: 2021-03-01T04:49:26.257525Z
        required: true
      to_date:
        title: To Date
        description: Events created before or at this timestamp
        type: string
        example: 2021-03-20T04:49:26.257525Z
        required: true
      limit:
        title: Limit
        description: Limit number of returned items (1-20000)
        type: integer
        example: 10
        required: false
      site_ids:
        title: Site IDs
        description: List of site IDs to filter by
        type: "[]string"
        example: ["225494730938491234", "225494730938491235"]
        required: false
      tenant: 
        title: Tenant
        description: Indicates a Global (tenant) scope request
        type: boolean
        example: true
        required: false
      account_ids:
        title: Account IDs
        description: List of account IDs to filter by
        type: "[]string"
        example: ["225494730938491234", "225494730938491235"]
        required: false
      is_verbose: 
        title: Is Verbose
        description: Show all fields or just priority fields
        type: boolean
        example: true
        required: false
      group_ids:
        title: Account IDs
        description: List of group IDs to filter by
        type: "[]string"
        example: ["225494730938491234", "225494730938491235"]
        required: false
      query_type:
        title: Query Type
        description: Query search type
        type: "[]string"
        example: ["events"]
        required: false
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: create_query_response
        required: false
        example: '{ "response": { "data": { "affected": 0 } } }'
  get_query_status:
    title: Get Query Status
    description: Get that status of a Deep Visibility Query
    input:
      query_id:
        title: Query ID
        description: QueryId obtained when creating a query under Create Query
        type: string
        example: qd94e330ac025d525b5948bdf897b955e
        required: true
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: get_query_status_response
        required: false
        example: '{ "response": { "data": { "progressStatus": 50, "responseState": "RUNNING" } } }'
  cancel_running_query:
    title: Cancel Running Query
    description: Stop a Deep Visibility Query by queryId
    input:
      query_id:
        title: Query ID
        description: QueryId obtained when creating a query under Create Query
        type: string
        example: qd94e330ac025d525b5948bdf897b955e
        required: true
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: cancel_query_response
        required: false
        example: '{ "response": { "success": true } }'
  get_events:
    title: Get Events
    description: Get all Deep Visibility events from a queryId
    input:
      query_id:
        title: Query ID
        description: QueryId obtained when creating a query under Create Query
        type: string
        example: qd94e330ac025d525b5948bdf897b955e
        required: true
      limit:
        title: Limit
        description: Limit number of returned items (1-1000), if no limit is provided returns all the results up to 20,000
        type: integer
        example: 10
        required: false
      sub_query:
        title: Sub Query
        description: Sub query to run on the data that was already pulled
        type: string
        example: AgentName IS NOT EMPTY
        required: false
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: get_events_response
        required: false
        example: '{ "response": { "data": [ { "agentDomain": "WORKGROUP", "agentGroupId": "123123456712356789", "agentId": "123123456712356789" } } }'
  get_events_by_type:
    title: Get Events by Type
    description: Get Deep Visibility results from the query that matches the given event type
    input:
      query_id:
        title: Query ID
        description: QueryId obtained when creating a query under Create Query
        type: string
        example: qd94e330ac025d525b5948bdf897b955e
        required: true
      event_type:
        title: Event Type
        description: Event type for Autocomplete
        type: string
        enum: 
        - Process Exit
        - Process Modification
        - Process Creation
        - Duplicate Process Handle
        - Duplicate Thread Handle
        - Open Remote Process Handle
        - Remote Thread Creation
        - Remote Process Termination
        - Command Script
        - IP Connect
        - IP Listen
        - File Modification
        - File Creation
        - File Scan
        - File Deletion
        - File Rename
        - Pre Execution Detection
        - Login
        - Logout
        - GET
        - OPTIONS
        - POST
        - PUT
        - DELETE
        - CONNECT
        - HEAD
        - DNS Resolved
        - DNS Unresolved
        - Task Register
        - Task Update
        - Task Start
        - Task Trigger
        - Task Delete
        - Registry Key Create
        - Registry Key Rename
        - Registry Key Delete
        - Registry Key Export
        - Registry Key Security Changed
        - Registry Key Import
        - Registry Value Modified
        - Registry Value Create
        - Registry Value Delete
        - Behavioral Indicators
        - Module Load
        example: Registry Key Create
        required: true
      limit:
        title: Limit
        description: Limit number of returned items (1-1000), if no limit is provided returns all the results up to 20,000
        type: integer
        example: 10
        required: false
      sub_query:
        title: Sub Query
        description: Sub query to run on the data that was already pulled
        type: string
        example: AgentName IS NOT EMPTY
        required: false
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: get_events_response
        required: false
        example: '{ "response": { "data": [ { "agentDomain": "WORKGROUP", "agentGroupId": "123123456712356789", "agentId": "123123456712356789" }}}'
  update_analyst_verdict:
    title: Update Analyst Verdict
    description: Updates an analyst verdict for each incident ID provided
    input:
      incident_ids:
        title: Incident IDs
        description: A list of alert or threat IDs on which we may update the analyst verdict
        type: "[]string"
        example: [ "1118189762920424575", "1118189762920424576" ]
        required: true
      analyst_verdict:
        title: Analyst Verdict
        description: Analyst verdict
        type: string
        enum:
          - true positive
          - suspicious
          - false positive
          - undefined
        example: true positive
        required: true
      type:
        title: Type
        description: Type of incidents
        type: string
        enum:
          - threats
          - alerts
        example: threats
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  update_incident_status:
    title: Update Incident Status
    description: Updates an incident status for each incident ID provided
    input:
      incident_ids:
        title: Incident IDs
        description: A list of alert or threat IDs to update the incident status on
        type: "[]string"
        example: ["1118189762920424575", "1118189762920424576"]
        required: true
      incident_status:
        title: Incident Status
        description: Incident status
        type: string
        enum:
          - unresolved
          - in progress
          - resolved
        example: resolved
        required: true
      type:
        title: Type
        description: Type of incidents
        type: string
        enum:
          - threats
          - alerts
        example: threats
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  run_remote_script:
    title: Run Remote Script
    description: Run a remote script
    input:
      ids:
        title: IDs
        description: IDs of the agents to execute the script on. If no IDs provided, the script will run on ALL applicable agents. This id can be retrieved by using the get agent details action if neccessary
        type: '[]string'
        required: false
        example: '["100000000000000000"]'
      script_id:
        title: Script ID
        description: ID of the script to run (select the ID of a SentinelOne or user script from SentinelOne console)
        type: string
        required: true
        example: "1234567891234"
      task_description:
        title: Task Description
        description: Task Description
        type: string
        required: true
        example: "Task Description"
      output_destination:
        title: Output Destination
        description: Output destination of any script output
        type: string
        enum:
          - Local
          - None
          - SentinelCloud
        example: SentinelCloud
        required: true
      output_directory:
        title: Output Directory
        description: Output Directory (Only relevant if Local is selected for Output Destination)
        type: string
        required: false
        example: "/tmp/script_output"
      password:
        title: Password
        description: Password (Only relevant if SentinelCloud is selected for Output Destination). At least 10 characters and no whitespace
        type: string
        required: false
        example: "Password123??"
      input_parameters:
        title: Input Script Parameters
        description: Parameters which will be passed to the remote script (may or may not be required, depending on script)
        type: string
        required: false
        example: "input_parameter1"
      timeout:
        title: Script Execution Timeout
        description: Script runtime timeout (in seconds) for current execution (Value between 60 and 172800 seconds)
        type: integer
        required: false
        default: 3600
        example: 3600
    output:
      affected:
        description: Number of entities affected by requested operation. For detailed output from running the script, log onto the SentinelOne console. Note this may be lower than the number of agent ids submitted if the script cannot be run on a particular agent e.g. due to OS type
        type: integer
        required: true
        example: 2
triggers:
  get_threats:
    title: Get Threats
    description: Get threats
    input:
      resolved:
        title: Resolved
        description: Set True to only trigger on resolved threats
        type: boolean
        required: false
        example: true
      classifications:
        title: Classifications
        description: List of classifications to search
        type: '[]string'
        required: false
        example: [""]
      agent_is_active:
        title: Agent is Active
        description: Include agents currently connected to the management console
        type: boolean
        default: true
        required: false
        example: true
      engines:
        title: Engines
        description: Included engines
        type: '[]string'
        required: false
        example: [""]
      frequency:
        title: Frequency
        description: Poll frequency in seconds
        type: integer
        required: false
        default: 5
        example: 5
    output:
      threat:
        title: Threat
        description: Threat
        type: threat_data
        required: false
        example: "{ 'threat': { 'agentComputerName':'vagrant-pc', 'agentDomain':'WORKGROUP', 'agentId':'560700200554747611' }}"