# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Search for agents"


class Input:
    AGENT = "agent"
    AGENTACTIVE = "agentActive"
    OPERATIONALSTATE = "operationalState"


class Output:
    AGENTS = "agents"


class SearchAgentsInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "agent": {
      "type": "string",
      "title": "Agent",
      "description": "Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID. If empty, this action will return all active or inactive agents depending on the value of the Agent Active input",
      "order": 1
    },
    "agentActive": {
      "type": "string",
      "title": "Agent Active",
      "description": "Return a list of active, inactive or all agents when Agent input is not specified. Note that leaving it empty can return a very large amount of data",
      "default": "",
      "enum": [
        "True",
        "False",
        ""
      ],
      "order": 2
    },
    "operationalState": {
      "type": "string",
      "title": "Operational State",
      "description": "Agent operational state",
      "default": "Any",
      "enum": [
        "Any",
        "na",
        "fully_disabled",
        "partially_disabled",
        "disabled_error"
      ],
      "order": 3
    }
  },
  "definitions": {}
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SearchAgentsOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "agents": {
      "type": "array",
      "title": "Agents",
      "description": "Detailed information about agents found",
      "items": {
        "$ref": "#/definitions/agentData"
      },
      "order": 1
    }
  },
  "definitions": {
    "agentData": {
      "type": "object",
      "title": "agentData",
      "properties": {
        "scanFinishedAt": {
          "type": "string",
          "title": "Scan Finished At",
          "description": "Finish time of last scan",
          "order": 1
        },
        "inRemoteShellSession": {
          "type": "boolean",
          "title": "In Remote Shell Session",
          "description": "Is the Agent in a remote shell session",
          "order": 2
        },
        "externalIp": {
          "type": "string",
          "title": "External IP",
          "description": "External IPv4 address",
          "order": 3
        },
        "mitigationMode": {
          "type": "string",
          "title": "Mitigation Mode",
          "description": "Agent mitigation mode policy",
          "order": 4
        },
        "isUpToDate": {
          "type": "boolean",
          "title": "Is Up to Date",
          "description": "Indicates if the agent version is up to date",
          "order": 5
        },
        "scanAbortedAt": {
          "type": "string",
          "title": "Scan Aborted At",
          "description": "Abort time of last scan",
          "order": 6
        },
        "appsVulnerabilityStatus": {
          "type": "string",
          "title": "Apps Vulnerability Status",
          "description": "Apps vulnerability status",
          "order": 7
        },
        "rangerVersion": {
          "type": "string",
          "title": "Ranger Version",
          "description": "The version of Ranger",
          "order": 8
        },
        "createdAt": {
          "type": "string",
          "title": "Created At",
          "description": "Created at date",
          "order": 9
        },
        "userActionsNeeded": {
          "type": "array",
          "title": "User Actions Needed",
          "description": "A list of pending user actions",
          "items": {
            "type": "string"
          },
          "order": 10
        },
        "groupId": {
          "type": "string",
          "title": "Group ID",
          "description": "A reference to the containing network group",
          "order": 11
        },
        "isPendingUninstall": {
          "type": "boolean",
          "title": "Is Pending Uninstall",
          "description": "Agent with a pending uninstall request",
          "order": 12
        },
        "accountName": {
          "type": "string",
          "title": "Account Name",
          "description": "Name of the containing account",
          "order": 13
        },
        "siteId": {
          "type": "string",
          "title": "Site ID",
          "description": "A reference to the containing site",
          "order": 14
        },
        "siteName": {
          "type": "string",
          "title": "Site Name",
          "description": "Name of the containing site",
          "order": 15
        },
        "osStartTime": {
          "type": "string",
          "title": "OS Start Time",
          "description": "Last boot time",
          "order": 16
        },
        "activeDirectory": {
          "$ref": "#/definitions/activeDirectory",
          "title": "Active Directory",
          "description": "Active Directory data",
          "order": 17
        },
        "networkInterfaces": {
          "type": "array",
          "title": "Network Interfaces",
          "description": "Device's network interfaces",
          "items": {
            "$ref": "#/definitions/networkInterfaces"
          },
          "order": 18
        },
        "rangerStatus": {
          "type": "string",
          "title": "Ranger Status",
          "description": "Is Agent disabled as a Ranger",
          "order": 19
        },
        "accountId": {
          "type": "string",
          "title": "Account ID",
          "description": "A reference to the containing account",
          "order": 20
        },
        "threatRebootRequired": {
          "type": "boolean",
          "title": "Threat Reboot Required",
          "description": "Has at least one threat with at least one mitigation action that is pending reboot to succeed",
          "order": 21
        },
        "osArch": {
          "type": "string",
          "title": "OS Arch",
          "description": "OS Arch",
          "order": 22
        },
        "activeThreats": {
          "type": "integer",
          "title": "Active Threats",
          "description": "Current number of active threats",
          "order": 23
        },
        "installerType": {
          "type": "string",
          "title": "Installer Type",
          "description": "Installer package type (file extension)",
          "order": 24
        },
        "scanStatus": {
          "type": "string",
          "title": "Scan Status",
          "description": "Last scan status",
          "order": 25
        },
        "groupName": {
          "type": "string",
          "title": "Group Name",
          "description": "Name of the containing network group",
          "order": 26
        },
        "consoleMigrationStatus": {
          "type": "string",
          "title": "Console Migration Status",
          "description": "What step the agent is at in the process of migrating to another console, if any",
          "order": 27
        },
        "infected": {
          "type": "boolean",
          "title": "Infected",
          "description": "Indicates if the Agent has active threats",
          "order": 28
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "Agent ID",
          "order": 29
        },
        "updatedAt": {
          "type": "string",
          "title": "Updated at",
          "description": "Last updated date",
          "order": 30
        },
        "machineType": {
          "type": "string",
          "title": "Machine Type",
          "description": "Machine type",
          "order": 31
        },
        "isDecommissioned": {
          "type": "boolean",
          "title": "Is Decommissioned",
          "description": "Is Agent decommissioned",
          "order": 32
        },
        "osRevision": {
          "type": "string",
          "title": "OS Revision",
          "description": "OS revision",
          "order": 33
        },
        "scanStartedAt": {
          "type": "string",
          "title": "Scan Started At",
          "description": "Start time of last scan",
          "order": 34
        },
        "policyUpdatedAt": {
          "type": "string",
          "title": "Policy Updated At",
          "description": "Date of when the policy was last updated",
          "order": 35
        },
        "encryptedApplications": {
          "type": "boolean",
          "title": "Encrypted Applications",
          "description": "Disk encryption status",
          "order": 36
        },
        "locations": {
          "type": "array",
          "title": "Locations",
          "description": "A list of locations reported by the Agent",
          "items": {
            "$ref": "#/definitions/location"
          },
          "order": 37
        },
        "domain": {
          "type": "string",
          "title": "Domain",
          "description": "Network domain",
          "order": 38
        },
        "locationType": {
          "type": "string",
          "title": "Location Type",
          "description": "Reported location type",
          "order": 39
        },
        "registeredAt": {
          "type": "string",
          "title": "Registered At",
          "description": "Time of first registration to management console (similar to createdAt)",
          "order": 40
        },
        "totalMemory": {
          "type": "integer",
          "title": "Total Memory",
          "description": "Memory size (MB)",
          "order": 41
        },
        "groupUpdatedAt": {
          "type": "string",
          "title": "Group Updated At",
          "description": "Date of when the group was last updated",
          "order": 42
        },
        "computerName": {
          "type": "string",
          "title": "Computer Name",
          "description": "Computer name",
          "order": 43
        },
        "isUninstalled": {
          "type": "boolean",
          "title": "Is Uninstalled",
          "description": "Indicates if Agent was removed from the device",
          "order": 44
        },
        "uuid": {
          "type": "string",
          "title": "UUID",
          "description": "Agent's universally unique identifier",
          "order": 45
        },
        "licenseKey": {
          "type": "string",
          "title": "License Key",
          "description": "License key",
          "order": 46
        },
        "isActive": {
          "type": "boolean",
          "title": "Is Active",
          "description": "Indicates if the agent was recently active",
          "order": 47
        },
        "cpuCount": {
          "type": "integer",
          "title": "CPU Count",
          "description": "Number of CPUs",
          "order": 48
        },
        "modelName": {
          "type": "string",
          "title": "Model Name",
          "description": "Model name",
          "order": 49
        },
        "externalId": {
          "type": "string",
          "title": "External ID",
          "description": "External id set by customer",
          "order": 50
        },
        "coreCount": {
          "type": "integer",
          "title": "Core Count",
          "description": "Number of CPU cores",
          "order": 51
        },
        "allowRemoteShell": {
          "type": "boolean",
          "title": "Allow Remote Shell",
          "description": "Agent is capable and policy enabled for remote shell",
          "order": 52
        },
        "agentVersion": {
          "type": "string",
          "title": "Agent Version",
          "description": "Agent version",
          "order": 53
        },
        "groupIp": {
          "type": "string",
          "title": "Group IP",
          "description": "IP Address subnet",
          "order": 54
        },
        "osName": {
          "type": "string",
          "title": "OS Name",
          "description": "Os name",
          "order": 55
        },
        "mitigationModeSuspicious": {
          "type": "string",
          "title": "Mitigation Mode Suspicious",
          "description": "Mitigation mode policy for suspicious activity",
          "order": 56
        },
        "osUsername": {
          "type": "string",
          "title": "OS Username",
          "description": "Os username",
          "order": 57
        },
        "lastLoggedInUserName": {
          "type": "string",
          "title": "Last Logged In User Name",
          "description": "Last logged in user name",
          "order": 58
        },
        "cpuId": {
          "type": "string",
          "title": "CPU ID",
          "description": "CPU model",
          "order": 59
        },
        "lastActiveDate": {
          "type": "string",
          "title": "Last Active Date",
          "description": "Last active date",
          "order": 60
        },
        "osType": {
          "type": "string",
          "title": "OS Type",
          "description": "OS type",
          "order": 61
        },
        "networkStatus": {
          "type": "string",
          "title": "Network Status",
          "description": "Agent's network connectivity status",
          "order": 62
        },
        "lastIpToMgmt": {
          "type": "string",
          "title": "Last IP to Management Console",
          "description": "The last IP used to connect to the Management console",
          "order": 63
        },
        "networkQuarantineEnabled": {
          "type": "boolean",
          "title": "Network Quarantine Enabled",
          "description": "Network quarantine enabled",
          "order": 64
        },
        "remoteProfilingState": {
          "type": "string",
          "title": "Remote Profiling State",
          "description": "Agent remote profiling state",
          "order": 65
        },
        "cloudProviders": {
          "type": "object",
          "title": "Cloud Providers",
          "description": "Cloud providers for this agent",
          "order": 66
        },
        "operationalState": {
          "type": "string",
          "title": "Operational State",
          "description": "Agent operational state",
          "order": 67
        },
        "remoteProfilingStateExpiration": {
          "type": "string",
          "title": "Remote Profiling State Expiration",
          "description": "Agent remote profiling state expiration in seconds",
          "order": 68
        },
        "operationalStateExpiration": {
          "type": "string",
          "title": "Operational State Expiration",
          "description": "Agent operational state expiration",
          "order": 69
        },
        "locationEnabled": {
          "type": "boolean",
          "title": "Location Enabled",
          "description": "Location enabled",
          "order": 70
        },
        "firewallEnabled": {
          "type": "boolean",
          "title": "Firewall Enabled",
          "description": "Firewall enabled",
          "order": 71
        }
      }
    },
    "activeDirectory": {
      "type": "object",
      "title": "activeDirectory",
      "properties": {
        "computerMemberOf": {
          "type": "array",
          "title": "Computer Member Of",
          "description": "Computer member of",
          "items": {
            "type": "string"
          },
          "order": 1
        },
        "lastUserDistinguishedName": {
          "type": "string",
          "title": "Last User Distinguished Name",
          "description": "Last user distinguished name",
          "order": 2
        },
        "lastUserMemberOf": {
          "type": "array",
          "title": "Last User Member Of",
          "description": "Last user member of",
          "items": {
            "type": "string"
          },
          "order": 3
        },
        "computerDistinguishedName": {
          "type": "string",
          "title": "Computer Distinguished Name",
          "description": "Computer distinguished name",
          "order": 4
        }
      }
    },
    "networkInterfaces": {
      "type": "object",
      "title": "networkInterfaces",
      "properties": {
        "gatewayMacAddress": {
          "type": "string",
          "title": "Gateway MAC Address",
          "description": "The default gateway MAC address",
          "order": 1
        },
        "inet6": {
          "type": "array",
          "title": "IPv6 Addresses",
          "description": "IPv6 addresses",
          "items": {
            "type": "string"
          },
          "order": 2
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "ID",
          "order": 3
        },
        "physical": {
          "type": "string",
          "title": "Physical",
          "description": "Interface's MAC address",
          "order": 4
        },
        "gatewayIp": {
          "type": "string",
          "title": "Gateway IP",
          "description": "The default gateway IP",
          "order": 5
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "Name",
          "order": 6
        },
        "inet": {
          "type": "array",
          "title": "IPv4 Addresses",
          "description": "IPv4 addresses",
          "items": {
            "type": "string"
          },
          "order": 7
        }
      }
    },
    "location": {
      "type": "object",
      "title": "location",
      "properties": {
        "name": {
          "type": "string",
          "title": "Name",
          "description": "Location name",
          "order": 1
        },
        "scope": {
          "type": "string",
          "title": "Scope",
          "description": "Location scope",
          "order": 2
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "Location ID",
          "order": 3
        }
      }
    }
  }
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
