#!/usr/bin/env python
# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import os
import json
from sys import argv

Name = "SentinelOne"
Vendor = "rapid7"
Version = "11.1.5"
Description = "[SentinelOne](https://www.sentinelone.com/) is a next-gen cybersecurity company focused on protecting the enterprise through the endpoint. The SentinelOne plugin allows you to manage and mitigate all your security operations through SentinelOne.This plugin utilizes the SentinelOne API, the documentation is located in the SentinelOne console"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import insightconnect_plugin_runtime
    from komand_sentinelone import connection, actions, triggers, tasks

    class ICONSentinelone(insightconnect_plugin_runtime.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_trigger(triggers.GetThreats())
        
            self.add_action(actions.GetThreatSummary())
        
            self.add_action(actions.BlacklistByContentHash())
        
            self.add_action(actions.CreateIocThreat())
        
            self.add_action(actions.MitigateThreat())
        
            self.add_action(actions.MarkAsBenign())
        
            self.add_action(actions.MarkAsThreat())
        
            self.add_action(actions.ActivitiesList())
        
            self.add_action(actions.ActivitiesTypes())
        
            self.add_action(actions.AppsByAgentIds())
        
            self.add_action(actions.FetchFileByAgentId())
        
            self.add_action(actions.AgentsSummary())
        
            self.add_action(actions.NameAvailable())
        
            self.add_action(actions.AgentsReload())
        
            self.add_action(actions.AgentsAction())
        
            self.add_action(actions.SearchAgents())
        
            self.add_action(actions.GetAgentDetails())
        
            self.add_action(actions.Quarantine())
        
            self.add_action(actions.Blacklist())
        
            self.add_action(actions.ThreatsFetchFile())
        
            self.add_action(actions.DisableAgent())
        
            self.add_action(actions.EnableAgent())
        
            self.add_action(actions.CreateQuery())
        
            self.add_action(actions.GetQueryStatus())
        
            self.add_action(actions.CancelRunningQuery())
        
            self.add_action(actions.GetEvents())
        
            self.add_action(actions.GetEventsByType())
        
            self.add_action(actions.UpdateAnalystVerdict())
        
            self.add_action(actions.UpdateIncidentStatus())
        
            self.add_action(actions.RunRemoteScript())
        
            self.add_action(actions.MoveBetweenSites())
        
            self.add_task(tasks.MonitorLogs())
        

    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONSentinelone())
    cli.run()


if __name__ == "__main__":
    main()
