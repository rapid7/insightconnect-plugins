# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Retrieves a list of OpenIOC files from the Apex Central server"


class Input:
    FILE_HASH_ID_LIST = "file_hash_id_list"
    FUZZY_MATCH_STRING = "fuzzy_match_string"
    PAGE_NUMBER = "page_number"
    PAGE_SIZE = "page_size"
    SORTING_COLUMN = "sorting_column"
    SORTING_DIRECTION = "sorting_direction"
    

class Output:
    DATA = "data"
    FEATURE_CTRL = "feature_ctrl"
    META = "meta"
    PERMISSION_CTRL = "permission_ctrl"
    SYSTEM_CTRL = "system_ctrl"
    

class OpeniocFilesListInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "file_hash_id_list": {
      "type": "array",
      "title": "File Hash ID List",
      "description": "Filters the list for file SHA-1 values",
      "items": {
        "type": "string"
      },
      "default": "[]",
      "order": 1
    },
    "fuzzy_match_string": {
      "type": "string",
      "title": "Fuzzy Match String",
      "description": "Filters the list for matching strings in the File Name, Title, and Source Context fields",
      "order": 2
    },
    "page_number": {
      "type": "integer",
      "title": "Page Number",
      "description": "Filters the list to uploaded files that appear on the specified page number on the Threat Intel \\u003e Custom Intelligence \\u003e STIX tab",
      "default": 1,
      "order": 3
    },
    "page_size": {
      "type": "integer",
      "title": "Page Size",
      "description": "Filters the list to the specified number of uploaded files per page",
      "default": 10,
      "order": 4
    },
    "sorting_column": {
      "type": "string",
      "title": "Sorting Column",
      "description": "Sorts the list by the specified table column",
      "default": "FileAddedDatetime",
      "enum": [
        "FileName",
        "Title",
        "FileAddedDatetime",
        "UploadedFrom",
        "UploadedBy",
        "ExtractingStatus"
      ],
      "order": 5
    },
    "sorting_direction": {
      "type": "string",
      "title": "Sorting Direction",
      "description": "Sorts the list in the specified direction",
      "default": "Descending",
      "enum": [
        "Ascending",
        "Descending"
      ],
      "order": 6
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class OpeniocFilesListOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "data": {
      "$ref": "#/definitions/IOC_Data",
      "title": "Data",
      "description": "Contains the data returned by the specific API",
      "order": 1
    },
    "feature_ctrl": {
      "$ref": "#/definitions/FeatureCtrl",
      "title": "Feature CTRL",
      "description": "The Apex Central deployment model",
      "order": 2
    },
    "meta": {
      "$ref": "#/definitions/Meta",
      "title": "Meta",
      "description": "Indicates the response status, including the result, error code, and error message",
      "order": 3
    },
    "permission_ctrl": {
      "$ref": "#/definitions/PermissionCtrl",
      "title": "Permission CTRL",
      "description": "Indicates the permissions assigned to the logged-on user account for accessing Apex Central menu items and features",
      "order": 4
    },
    "system_ctrl": {
      "$ref": "#/definitions/SystemCtrl",
      "title": "System CTRL",
      "description": "Indicates the suspicious object distribution role of the Apex Central server",
      "order": 5
    }
  },
  "definitions": {
    "FeatureCtrl": {
      "type": "object",
      "title": "FeatureCtrl",
      "properties": {
        "mode": {
          "type": "string",
          "title": "Mode",
          "description": "Mode",
          "order": 1
        }
      }
    },
    "FilingCabinet": {
      "type": "object",
      "title": "FilingCabinet",
      "properties": {
        "ExtractingStatus": {
          "type": "integer",
          "title": "Extracting Status",
          "description": "The suspicious object extraction status of the uploaded file",
          "order": 1
        },
        "FileAddedDatetime": {
          "type": "string",
          "title": "File Added Datetime",
          "description": "The date and time for when the file was uploaded",
          "order": 2
        },
        "FileHashID": {
          "type": "string",
          "title": "File Hash ID",
          "description": "The file hash ID of the uploaded file",
          "order": 3
        },
        "FileName": {
          "type": "string",
          "title": "File Name",
          "description": "The file name of the uploaded file",
          "order": 4
        },
        "ShortDesc": {
          "type": "string",
          "title": "Short Desc",
          "description": "Short description",
          "order": 5
        },
        "Title": {
          "type": "string",
          "title": "Title",
          "description": "The short description of the uploaded file",
          "order": 6
        },
        "UploadedBy": {
          "type": "string",
          "title": "Uploaded",
          "description": "The name of the user account that uploaded the file",
          "order": 7
        },
        "UploadedFrom": {
          "type": "integer",
          "title": "Uploaded From",
          "description": "The Source of the uploaded file",
          "order": 8
        }
      }
    },
    "IOC_Data": {
      "type": "object",
      "title": "IOC_Data",
      "properties": {
        "FilingCabinet": {
          "type": "array",
          "title": "Filing Cabinet",
          "description": "OpenIOC filing cabinet list",
          "items": {
            "$ref": "#/definitions/FilingCabinet"
          },
          "order": 1
        },
        "TotalIOCCount": {
          "type": "integer",
          "title": "Total IOC Count",
          "description": "The total number of objects extracted from the uploaded file",
          "order": 2
        }
      },
      "definitions": {
        "FilingCabinet": {
          "type": "object",
          "title": "FilingCabinet",
          "properties": {
            "ExtractingStatus": {
              "type": "integer",
              "title": "Extracting Status",
              "description": "The suspicious object extraction status of the uploaded file",
              "order": 1
            },
            "FileAddedDatetime": {
              "type": "string",
              "title": "File Added Datetime",
              "description": "The date and time for when the file was uploaded",
              "order": 2
            },
            "FileHashID": {
              "type": "string",
              "title": "File Hash ID",
              "description": "The file hash ID of the uploaded file",
              "order": 3
            },
            "FileName": {
              "type": "string",
              "title": "File Name",
              "description": "The file name of the uploaded file",
              "order": 4
            },
            "ShortDesc": {
              "type": "string",
              "title": "Short Desc",
              "description": "Short description",
              "order": 5
            },
            "Title": {
              "type": "string",
              "title": "Title",
              "description": "The short description of the uploaded file",
              "order": 6
            },
            "UploadedBy": {
              "type": "string",
              "title": "Uploaded",
              "description": "The name of the user account that uploaded the file",
              "order": 7
            },
            "UploadedFrom": {
              "type": "integer",
              "title": "Uploaded From",
              "description": "The Source of the uploaded file",
              "order": 8
            }
          }
        }
      }
    },
    "Meta": {
      "type": "object",
      "title": "Meta",
      "properties": {
        "errorCode": {
          "type": "integer",
          "title": "Error Code",
          "description": "The error code of the response",
          "order": 1
        },
        "errorMessgae": {
          "type": "string",
          "title": "Error Message",
          "description": "The error message of the response",
          "order": 2
        },
        "result": {
          "type": "integer",
          "title": "Result",
          "description": "The result code of the response",
          "order": 3
        }
      }
    },
    "PermissionCtrl": {
      "type": "object",
      "title": "PermissionCtrl",
      "properties": {
        "elements": {
          "type": "string",
          "title": "Elements",
          "description": "The value is always null for Custom Intelligence Automation APIs",
          "order": 1
        },
        "permission": {
          "type": "string",
          "title": "Permission",
          "description": "Permission",
          "order": 2
        }
      }
    },
    "SystemCtrl": {
      "type": "object",
      "title": "SystemCtrl",
      "properties": {
        "TmcmSoDist_Role": {
          "type": "string",
          "title": "Tmcm So Dist Role",
          "description": "Tmcm so dist role",
          "enum": [
            "none",
            "hub",
            "edge"
          ],
          "order": 1
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
