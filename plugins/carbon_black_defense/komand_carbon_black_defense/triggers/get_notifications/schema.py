# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Allows consumers to get alert and policy action notifications that a connector is subscribed to. Only API keys of type 'SIEM' can call the notifications API"


class Input:
    
    FREQUENCY = "frequency"
    

class Output:
    
    MESSAGE = "message"
    NOTIFICATIONS = "notifications"
    SUCCESS = "success"
    

class GetNotificationsInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "frequency": {
      "type": "integer",
      "title": "Frequency",
      "description": "How often to poll for new notifications requests, in seconds",
      "default": 10,
      "order": 1
    }
  },
  "required": [
    "frequency"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class GetNotificationsOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "message": {
      "type": "string",
      "title": "Message",
      "description": "Notification Message",
      "order": 2
    },
    "notifications": {
      "type": "array",
      "title": "Notifications",
      "description": "Collection of Notifications",
      "items": {
        "$ref": "#/definitions/notifications"
      },
      "order": 1
    },
    "success": {
      "type": "boolean",
      "title": "Success",
      "description": "Notification Success",
      "order": 3
    }
  },
  "definitions": {
    "deviceInfo": {
      "type": "object",
      "title": "deviceInfo",
      "properties": {
        "deviceHostName": {
          "type": "string",
          "title": "Device Hostname",
          "description": "Device Hostname",
          "order": 1
        },
        "deviceId": {
          "type": "integer",
          "title": "Device ID",
          "description": "Device ID",
          "order": 2
        },
        "deviceName": {
          "type": "string",
          "title": "Device Name",
          "description": "Device Name",
          "order": 3
        },
        "deviceType": {
          "type": "string",
          "title": "Device Type",
          "description": "Device Type",
          "order": 4
        },
        "deviceVersion": {
          "type": "string",
          "title": "Device Version",
          "description": "Device Version",
          "order": 5
        },
        "email": {
          "type": "string",
          "title": "Email",
          "description": "Email",
          "order": 6
        },
        "externalIpAddress": {
          "type": "string",
          "title": "External IP Address",
          "description": "External IP Address",
          "order": 7
        },
        "groupName": {
          "type": "string",
          "title": "Group Name",
          "description": "Group Name",
          "order": 8
        },
        "internalIpAddress": {
          "type": "string",
          "title": "Internal IP Address",
          "description": "Internal IP Address",
          "order": 9
        },
        "targetPriorityCode": {
          "type": "integer",
          "title": "Target Priority Code",
          "description": "Target Priority Code",
          "order": 10
        },
        "targetPriorityType": {
          "type": "string",
          "title": "Target Priority Type",
          "description": "Target Priority Type",
          "order": 11
        }
      }
    },
    "indicators": {
      "type": "object",
      "title": "indicators",
      "properties": {
        "applicationName": {
          "type": "string",
          "title": "Application Name",
          "description": "Application Name",
          "order": 1
        },
        "indicatorName": {
          "type": "string",
          "title": "Indicator Name",
          "description": "Indicator Name",
          "order": 2
        },
        "sha256Hash": {
          "type": "string",
          "title": "SHA-256 Hash",
          "description": "SHA-256 Hash",
          "order": 3
        }
      }
    },
    "notifications": {
      "type": "object",
      "title": "notifications",
      "properties": {
        "deviceInfo": {
          "$ref": "#/definitions/deviceInfo",
          "title": "Notifications",
          "description": "Notifications",
          "order": 1
        },
        "eventDescription": {
          "type": "string",
          "title": "Event Description",
          "description": "Event Description",
          "order": 2
        },
        "eventId": {
          "type": "string",
          "title": "Event ID",
          "description": "Event ID",
          "order": 3
        },
        "eventTime": {
          "type": "integer",
          "title": "Event Time",
          "description": "Event Time",
          "order": 4
        },
        "ruleName": {
          "type": "string",
          "title": "Rule Name",
          "description": "Rule Name",
          "order": 5
        },
        "threatInfo": {
          "$ref": "#/definitions/threatInfo",
          "title": "Threat Information",
          "description": "Threat Information",
          "order": 6
        },
        "type": {
          "type": "string",
          "title": "Type",
          "description": "Type",
          "order": 7
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "URL",
          "order": 8
        }
      },
      "definitions": {
        "deviceInfo": {
          "type": "object",
          "title": "deviceInfo",
          "properties": {
            "deviceHostName": {
              "type": "string",
              "title": "Device Hostname",
              "description": "Device Hostname",
              "order": 1
            },
            "deviceId": {
              "type": "integer",
              "title": "Device ID",
              "description": "Device ID",
              "order": 2
            },
            "deviceName": {
              "type": "string",
              "title": "Device Name",
              "description": "Device Name",
              "order": 3
            },
            "deviceType": {
              "type": "string",
              "title": "Device Type",
              "description": "Device Type",
              "order": 4
            },
            "deviceVersion": {
              "type": "string",
              "title": "Device Version",
              "description": "Device Version",
              "order": 5
            },
            "email": {
              "type": "string",
              "title": "Email",
              "description": "Email",
              "order": 6
            },
            "externalIpAddress": {
              "type": "string",
              "title": "External IP Address",
              "description": "External IP Address",
              "order": 7
            },
            "groupName": {
              "type": "string",
              "title": "Group Name",
              "description": "Group Name",
              "order": 8
            },
            "internalIpAddress": {
              "type": "string",
              "title": "Internal IP Address",
              "description": "Internal IP Address",
              "order": 9
            },
            "targetPriorityCode": {
              "type": "integer",
              "title": "Target Priority Code",
              "description": "Target Priority Code",
              "order": 10
            },
            "targetPriorityType": {
              "type": "string",
              "title": "Target Priority Type",
              "description": "Target Priority Type",
              "order": 11
            }
          }
        },
        "indicators": {
          "type": "object",
          "title": "indicators",
          "properties": {
            "applicationName": {
              "type": "string",
              "title": "Application Name",
              "description": "Application Name",
              "order": 1
            },
            "indicatorName": {
              "type": "string",
              "title": "Indicator Name",
              "description": "Indicator Name",
              "order": 2
            },
            "sha256Hash": {
              "type": "string",
              "title": "SHA-256 Hash",
              "description": "SHA-256 Hash",
              "order": 3
            }
          }
        },
        "threatInfo": {
          "type": "object",
          "title": "threatInfo",
          "properties": {
            "incidentId": {
              "type": "string",
              "title": "Incident ID",
              "description": "Incident ID",
              "order": 1
            },
            "indicators": {
              "type": "array",
              "title": "Indicators",
              "description": "Indicators",
              "items": {
                "$ref": "#/definitions/indicators"
              },
              "order": 2
            },
            "score": {
              "type": "integer",
              "title": "Score",
              "description": "Score",
              "order": 3
            },
            "summary": {
              "type": "string",
              "title": "Summary",
              "description": "Summary",
              "order": 4
            },
            "time": {
              "type": "integer",
              "title": "Time",
              "description": "Time",
              "order": 5
            }
          },
          "definitions": {
            "indicators": {
              "type": "object",
              "title": "indicators",
              "properties": {
                "applicationName": {
                  "type": "string",
                  "title": "Application Name",
                  "description": "Application Name",
                  "order": 1
                },
                "indicatorName": {
                  "type": "string",
                  "title": "Indicator Name",
                  "description": "Indicator Name",
                  "order": 2
                },
                "sha256Hash": {
                  "type": "string",
                  "title": "SHA-256 Hash",
                  "description": "SHA-256 Hash",
                  "order": 3
                }
              }
            }
          }
        }
      }
    },
    "threatInfo": {
      "type": "object",
      "title": "threatInfo",
      "properties": {
        "incidentId": {
          "type": "string",
          "title": "Incident ID",
          "description": "Incident ID",
          "order": 1
        },
        "indicators": {
          "type": "array",
          "title": "Indicators",
          "description": "Indicators",
          "items": {
            "$ref": "#/definitions/indicators"
          },
          "order": 2
        },
        "score": {
          "type": "integer",
          "title": "Score",
          "description": "Score",
          "order": 3
        },
        "summary": {
          "type": "string",
          "title": "Summary",
          "description": "Summary",
          "order": 4
        },
        "time": {
          "type": "integer",
          "title": "Time",
          "description": "Time",
          "order": 5
        }
      },
      "definitions": {
        "indicators": {
          "type": "object",
          "title": "indicators",
          "properties": {
            "applicationName": {
              "type": "string",
              "title": "Application Name",
              "description": "Application Name",
              "order": 1
            },
            "indicatorName": {
              "type": "string",
              "title": "Indicator Name",
              "description": "Indicator Name",
              "order": 2
            },
            "sha256Hash": {
              "type": "string",
              "title": "SHA-256 Hash",
              "description": "SHA-256 Hash",
              "order": 3
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
