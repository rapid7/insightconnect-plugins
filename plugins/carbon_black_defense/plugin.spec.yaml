plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: carbon_black_defense
title: VMware Carbon Black Cloud Endpoint Standard
description: Find events and retrieve details for specific events
version: 3.0.0
vendor: rapid7
support: rapid7
supported_versions: ["09/03/2022"]
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/carbon_black_defense
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.carbonblack.com/
tags:
- carbon black
- defense
- antivirus
- cloud
- vmware
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [defense, antivirus]
  features: []
types:
  deviceInfo:
    deviceHostName:
      description: Device Hostname
      title: Device Hostname
      type: string
    deviceId:
      description: Device ID
      title: Device ID
      type: integer
    deviceName:
      description: Device Name
      title: Device Name
      type: string
    deviceType:
      description: Device Type
      title: Device Type
      type: string
    deviceVersion:
      description: Device Version
      title: Device Version
      type: string
    email:
      description: Email
      title: Email
      type: string
    externalIpAddress:
      description: External IP Address
      title: External IP Address
      type: string
    groupName:
      description: Group Name
      title: Group Name
      type: string
    internalIpAddress:
      description: Internal IP Address
      title: Internal IP Address
      type: string
    targetPriorityCode:
      description: Target Priority Code
      title: Target Priority Code
      type: integer
    targetPriorityType:
      description: Target Priority Type
      title: Target Priority Type
      type: string
  indicators:
    applicationName:
      description: Application Name
      title: Application Name
      type: string
    indicatorName:
      description: Indicator Name
      title: Indicator Name
      type: string
    sha256Hash:
      description: SHA-256 Hash
      title: SHA-256 Hash
      type: string
  threatInfo:
    incidentId:
      description: Incident ID
      title: Incident ID
      type: string
    indicators:
      description: Indicators
      title: Indicators
      type: '[]indicators'
    score:
      description: Score
      title: Score
      type: integer
    summary:
      description: Summary
      title: Summary
      type: string
    time:
      description: Time
      title: Time
      type: integer
  notifications:
    deviceInfo:
      description: Notifications
      title: Notifications
      type: deviceInfo
    eventDescription:
      description: Event Description
      title: Event Description
      type: string
    eventId:
      description: Event ID
      title: Event ID
      type: string
    eventTime:
      description: Event Time
      title: Event Time
      type: integer
    ruleName:
      description: Rule Name
      title: Rule Name
      type: string
    threatInfo:
      description: Threat Information
      title: Threat Information
      type: threatInfo
    type:
      description: Type
      title: Type
      type: string
    url:
      description: URL
      title: URL
      type: string
  event_info:
    event_network_location:
      title: "Event Network Location"
      type: string
      description: "Event network location"
      required: false
    process_name:
      title: "Process Name"
      type: "[]string"
      description: "Process name"
      required: false
    device_target_priority:
      title: "Device Target Priority"
      type: string
      description: "Device target priority"
      required: false
    event_type:
      title: "Event Type"
      type: string
      description: "Event type"
      required: false
    netconn_inbound:
      title: "Netconn Inbound"
      type: boolean
      description: "Netconn inbound"
      required: false
    process_effective_reputation:
      title: "Process Effective Reputation"
      type: string
      description: "Process effective reputation"
      required: false
    event_network_remote_port:
      title: "Event Network Remote Port"
      type: integer
      description: "Event network remote port"
      required: false
    device_group_id:
      title: "Device Group ID"
      type: integer
      description: "Device group ID"
      required: false
    process_effective_reputation_source:
      title: "Process Effective Reputation Source"
      type: string
      description: "Process effective reputation source"
      required: false
    legacy:
      title: "Legacy"
      type: boolean
      description: "Legacy"
      required: false
    process_start_time:
      title: "Process Start Time"
      type: string
      description: "Process start time"
      required: false
    process_username:
      title: "Process Username"
      type: "[]string"
      description: "Process username"
      required: false
    netconn_port:
      title: "Netconn Port"
      type: integer
      description: "Netconn port"
      required: false
    netconn_protocol:
      title: "Netconn Protocol"
      type: string
      description: "Netconn protocol"
      required: false
    device_timestamp:
      title: "Device Timestamp"
      type: date
      description: "Device timestamp"
      required: false
    netconn_location:
      title: "Netconn Location"
      type: string
      description: "Netconn location"
      required: false
    ttp:
      title: "TTP"
      type: "[]string"
      description: "TTP"
      required: false
    netconn_domain:
      title: "Netconn Domain"
      type: string
      description: "Netconn domain"
      required: false
    event_description:
      title: "Event Description"
      type: string
      description: "Event description"
      required: false
    process_cmdline:
      title: "Process Cmdline"
      type: "[]string"
      description: "Process cmdline"
      required: false
    event_id:
      title: "Event ID"
      type: string
      description: "Event ID"
      required: false
    parent_guid:
      title: "Parent GUID"
      type: string
      description: "Parent GUID"
      required: false
    document_guid:
      title: "Document GUID"
      type: string
      description: "Document GUID"
      required: false
    process_cmdline_length:
      title: "Process Cmdline Length"
      type: "[]integer"
      description: "Process cmdline length"
      required: false
    enriched_event_type:
      title: "Enriched Event Type"
      type: "string"
      description: "Enriched event type"
      required: false
    enriched:
      title: "Enriched"
      type: boolean
      description: "Enriched"
      required: false
    netconn_local_ipv4:
      title: "Netconn Local IPv4"
      type: integer
      description: "Netconn local IPv4"
      required: false
    parent_hash:
      title: "Parent Hash"
      type: "[]string"
      description: "Parent hash"
      required: false
    event_network_protocol:
      title: "Event Network Protocol"
      type: string
      description: "Event network protocol"
      required: false
    parent_effective_reputation_source:
      title: "Parent Effective Reputation Source"
      type: string
      description: "Parent effective reputation source"
      required: false
    process_pid:
      title: "Process PID"
      type: "[]integer"
      description: "Process PID"
      required: false
    event_network_remote_ipv4:
      title: "Event Network Remote IPv4"
      type: string
      description: "Event network remote IPv4"
      required: false
    process_hash:
      title: "Process Hash"
      type: "[]string"
      description: "Process hash"
      required: false
    parent_effective_reputation:
      title: "Parent Effective Reputation"
      type: string
      description: "Parent effective reputation"
      required: false
    process_sha256:
      title: "Process SHA-256"
      type: string
      description: "Process SHA-256"
      required: false
    parent_name:
      title: "Parent Name"
      type: string
      description: "Parent name"
      required: false
    device_external_ip:
      title: "Device External IP"
      type: "[]string"
      description: "Device external IP"
      required: false
    netconn_ipv4:
      title: "Netconn IPv4"
      type: integer
      description: "Netconn IPv4"
      required: false
    event_report_code:
      title: "Event Report Code"
      type: string
      description: "Event report code"
      required: false
    event_threat_score:
      title: "Event Threat Score"
      type: "[]integer"
      description: "Event threat score"
      required: false
    device_internal_ip:
      title: "Device Internal IP"
      type: string
      description: "Device internal IP"
      required: false
    event_network_local_ipv4:
      title: "Event Network Local IPv4"
      type: string
      description: "Event network local IPv4"
      required: false
    process_reputation:
      title: "Process Reputation"
      type: string
      description: "Process reputation"
      required: false
    ingress_time:
      title: "Ingress Time"
      type: integer
      description: "Ingress time"
      required: false
    device_os:
      title: "Device OS"
      type: string
      description: "Device OS"
      required: false
    device_policy_id:
      title: "Device Policy ID"
      type: integer
      description: "Device policy ID"
      required: false
    device_id:
      title: "Device ID"
      type: integer
      description: "Device ID"
      required: false
    event_network_inbound:
      title: "Event Network Inbound"
      type: boolean
      description: "Event network inbound"
      required: false
    process_guid:
      title: "Process GUID"
      type: string
      description: "Process GUID"
      required: false
    device_location:
      title: "Device Location"
      type: string
      description: "Device location"
      required: false
    netconn_local_port:
      title: "Netconn Local Port"
      type: integer
      description: "Netconn local port"
      required: false
    device_os_version:
      title: "Device OS Version"
      type: string
      description: "Device OS version"
      required: false
    org_id:
      title: "Org ID"
      type: string
      description: "Org ID"
      required: false
    device_name:
      title: "Device Name"
      type: "[]string"
      description: "Device name"
      required: false
    backend_timestamp:
      title: "Backend Timestamp"
      type: date
      description: "Backend timestamp"
      required: false
    parent_pid:
      title: "Parent PID"
      type: integer
      description: "Parent PID"
      required: false
    device_policy:
      title: "Device Policy"
      type: string
      description: "Device policy"
      required: false
    parent_reputation:
      title: "Parent Reputation"
      type: string
      description: "Parent reputation"
      required: false
connection:
  url:
    title: URL
    type: string
    description: API URL
    default: https://defense.conferdeploy.net
    required: true
    example: https://example.com
  api_key:
    title: API Key
    type: credential_secret_key
    description: API key
    required: true
    example: 9de5069c5afe602b2ea0a04b66beb2c0
  org_key:
    title: Organization Key
    type: string
    description: Organization key
    required: true
    example: 1ABCDE5GH
  connector:
    title: Connector
    type: string
    description: Connector ID
    required: true
    example: 1Y72FRRWVP
actions:
  find_event:
    title: Find Event
    description: Retrieves all events matching the input search criteria. Response
      is a list of events in JSON format. Resulting events are sorted in descending
      order of time
    input:
      device_name:
        title: "Device Name"
        description: "Device name"
        type: "[]string"
        required: false
        example: "CONTOSO\\bruce-win10"
      device_external_ip:
        title: "Device External IP"
        type: "[]string"
        description: "Device external IP"
        required: false
        example: "192.0.2.0"
      process_hash:
        title: SHA-256 Hash
        description: Filter on events generated by a process with the given SHA-256
          hash. Note that this hash must be lowercase
        type: "[]string"
        required: false
        example: ["A3DED3871AC66498E406798B0CA33F1B5E94B9CFB60DD4489475B9C19FBFD7F5"]
      process_name:
        title: "Process Name"
        description: "Process name"
        type: "[]string"
        required: false
        example: "c:\\windows\\system32\\windowspowershell\\v1.0\\modules\\smbshare\\disableunusedsmb1.ps1"
      enriched_event_type:
        title: "Enriched Event Type"
        type: "[]string"
        description: "Enriched event type"
        required: false
        example: "SYSTEM_API_CALL"
      time_range:
        title: "Time Range"
        type: string
        description: "Time frame to limit your search to. Integer used for amount of the following: s=second(s), m=minute(s), h=hour(s), d=day(s), w=week(s), or y=year(s). Example: -2d"
        required: false
        example: "-2d"
    output:
      success:
        description: Success
        title: Success
        type: boolean
        required: false
      eventinfo:
        title: Event Info
        description: Detailed information on the event
        type: event_info
        required: false
  get_details_for_specific_event:
    title: Get Details for Specific Event
    description: Retrieve details for an individual event given the event ID
    input:
      event_ids:
        title: Event ID
        description: "Event ID used to retrieve event details. Example: 422af3fc3a7411ea8da649e797467dc0"
        type: string
        required: true
        example: "422af3fc3a7411ea8da649e797467dc0"
    output:
      success:
        title: Success
        description: Success
        type: boolean
        required: false
      eventinfo:
        title: Event Info
        description: Detailed information on the event
        type: event_info
        required: false
triggers:
  get_notifications:
    title: Get Notifications
    description: Allows consumers to get alert and policy action notifications that
      a connector is subscribed to. Only API keys of type 'SIEM' can call the notifications
      API
    input:
      frequency:
        type: integer
        title: Frequency
        description: How often to poll for new notifications requests, in seconds
        default: 10
        required: true
        example: 10
    output:
      notifications:
        description: Collection of Notifications
        title: Notifications
        type: '[]notifications'
        required: false
      message:
        description: Notification Message
        title: Message
        type: string
        required: false
      success:
        description: Notification Success
        title: Success
        type: boolean
        required: false
