plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: carbon_black_defense
title: VMware Carbon Black Cloud Endpoint Standard
description: Find events and retrieve details for specific events
version: 3.0.0
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/carbon_black_defense
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.carbonblack.com/
tags:
- carbon black
- defense
- antivirus
- cloud
- vmware
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [carbon black, vmware, defense, antivirus, cloud]
  features: []
types:
  deviceInfo:
    deviceHostName:
      description: Device Hostname
      title: Device Hostname
      type: string
    deviceId:
      description: Device ID
      title: Device ID
      type: integer
    deviceName:
      description: Device Name
      title: Device Name
      type: string
    deviceType:
      description: Device Type
      title: Device Type
      type: string
    deviceVersion:
      description: Device Version
      title: Device Version
      type: string
    email:
      description: Email
      title: Email
      type: string
    externalIpAddress:
      description: External IP Address
      title: External IP Address
      type: string
    groupName:
      description: Group Name
      title: Group Name
      type: string
    internalIpAddress:
      description: Internal IP Address
      title: Internal IP Address
      type: string
    targetPriorityCode:
      description: Target Priority Code
      title: Target Priority Code
      type: integer
    targetPriorityType:
      description: Target Priority Type
      title: Target Priority Type
      type: string
  indicators:
    applicationName:
      description: Application Name
      title: Application Name
      type: string
    indicatorName:
      description: Indicator Name
      title: Indicator Name
      type: string
    sha256Hash:
      description: SHA-256 Hash
      title: SHA-256 Hash
      type: string
  policyAction:
    action:
      description: Policy Action
      title: Policy Action
      type: string
    applicationName:
      description: Application Name
      title: Application Name
      type: string
    reputation:
      description: Reputation
      title: Reputation
      type: string
    sha256Hash:
      description: SHA-256 Hash
      title: SHA-256 Hash
      type: string
  threatInfo:
    incidentId:
      description: Incident ID
      title: Incident ID
      type: string
    indicators:
      description: Indicators
      title: Indicators
      type: '[]indicators'
    score:
      description: Score
      title: Score
      type: integer
    summary:
      description: Summary
      title: Summary
      type: string
    time:
      description: Time
      title: Time
      type: integer
  notifications:
    deviceInfo:
      description: Notifications
      title: Notifications
      type: deviceInfo
    eventDescription:
      description: Event Description
      title: Event Description
      type: string
    eventId:
      description: Event ID
      title: Event ID
      type: string
    eventTime:
      description: Event Time
      title: Event Time
      type: integer
    ruleName:
      description: Rule Name
      title: Rule Name
      type: string
    threatInfo:
      description: Threat Information
      title: Threat Information
      type: threatInfo
    type:
      description: Type
      title: Type
      type: string
    url:
      description: URL
      title: URL
      type: string
  event_info:
    event_network_location:
      title: "Event Network Location"
      type: string
      description: "Event network location"
      required: false
    process_name:
      title: "Process Name"
      type: string
      description: "Process name"
      required: false
    device_target_priority:
      title: "Device Target Priority"
      type: string
      description: "Device target priority"
      required: false
    event_type:
      title: "Event Type"
      type: string
      description: "Event type"
      required: false
    netconn_inbound:
      title: "Netconn Inbound"
      type: boolean
      description: "Netconn inbound"
      required: false
    process_effective_reputation:
      title: "Process Effective Reputation"
      type: string
      description: "Process effective reputation"
      required: false
    event_network_remote_port:
      title: "Event Network Remote Port"
      type: integer
      description: "Event network remote port"
      required: false
    device_group_id:
      title: "Device Group Id"
      type: integer
      description: "Device group id"
      required: false
    process_effective_reputation_source:
      title: "Process Effective Reputation Source"
      type: string
      description: "Process effective reputation source"
      required: false
    legacy:
      title: "Legacy"
      type: boolean
      description: "Legacy"
      required: false
    process_start_time:
      title: "Process Start Time"
      type: string
      description: "Process start time"
      required: false
    process_username:
      title: "Process Username"
      type: "[]string"
      description: "Process username"
      required: false
    netconn_port:
      title: "Netconn Port"
      type: integer
      description: "Netconn port"
      required: false
    netconn_protocol:
      title: "Netconn Protocol"
      type: string
      description: "Netconn protocol"
      required: false
    device_timestamp:
      title: "Device Timestamp"
      type: string
      description: "Device timestamp"
      required: false
    netconn_location:
      title: "Netconn Location"
      type: string
      description: "Netconn location"
      required: false
    ttp:
      title: "Ttp"
      type: "[]string"
      description: "Ttp"
      required: false
    netconn_domain:
      title: "Netconn Domain"
      type: string
      description: "Netconn domain"
      required: false
    event_description:
      title: "Event Description"
      type: string
      description: "Event description"
      required: false
    process_cmdline:
      title: "Process Cmdline"
      type: "[]string"
      description: "Process cmdline"
      required: false
    device_installed_by:
      title: "Device Installed By"
      type: string
      description: "Device installed by"
      required: false
    event_id:
      title: "Event Id"
      type: string
      description: "Event id"
      required: false
    parent_guid:
      title: "Parent Guid"
      type: string
      description: "Parent guid"
      required: false
    document_guid:
      title: "Document Guid"
      type: string
      description: "Document guid"
      required: false
    process_cmdline_length:
      title: "Process Cmdline Length"
      type: "[]integer"
      description: "Process cmdline length"
      required: false
    enriched_event_type:
      title: "Enriched Event Type"
      type: string
      description: "Enriched event type"
      required: false
    enriched:
      title: "Enriched"
      type: boolean
      description: "Enriched"
      required: false
    netconn_local_ipv4:
      title: "Netconn Local Ipv4"
      type: integer
      description: "Netconn local ipv4"
      required: false
    parent_hash:
      title: "Parent Hash"
      type: "[]string"
      description: "Parent hash"
      required: false
    event_network_protocol:
      title: "Event Network Protocol"
      type: string
      description: "Event network protocol"
      required: false
    parent_effective_reputation_source:
      title: "Parent Effective Reputation Source"
      type: string
      description: "Parent effective reputation source"
      required: false
    process_pid:
      title: "Process Pid"
      type: "[]integer"
      description: "Process pid"
      required: false
    event_network_remote_ipv4:
      title: "Event Network Remote Ipv4"
      type: string
      description: "Event network remote ipv4"
      required: false
    process_hash:
      title: "Process Hash"
      type: "[]string"
      description: "Process hash"
      required: false
    parent_effective_reputation:
      title: "Parent Effective Reputation"
      type: string
      description: "Parent effective reputation"
      required: false
    process_sha256:
      title: "Process Sha256"
      type: string
      description: "Process sha256"
      required: false
    parent_name:
      title: "Parent Name"
      type: string
      description: "Parent name"
      required: false
    device_external_ip:
      title: "Device External Ip"
      type: string
      description: "Device external ip"
      required: false
    netconn_ipv4:
      title: "Netconn Ipv4"
      type: integer
      description: "Netconn ipv4"
      required: false
    event_report_code:
      title: "Event Report Code"
      type: string
      description: "Event report code"
      required: false
    event_threat_score:
      title: "Event Threat Score"
      type: "[]integer"
      description: "Event threat score"
      required: false
    device_internal_ip:
      title: "Device Internal Ip"
      type: string
      description: "Device internal ip"
      required: false
    event_network_local_ipv4:
      title: "Event Network Local Ipv4"
      type: string
      description: "Event network local ipv4"
      required: false
    process_reputation:
      title: "Process Reputation"
      type: string
      description: "Process reputation"
      required: false
    ingress_time:
      title: "Ingress Time"
      type: integer
      description: "Ingress time"
      required: false
    device_os:
      title: "Device Os"
      type: string
      description: "Device os"
      required: false
    device_policy_id:
      title: "Device Policy Id"
      type: integer
      description: "Device policy id"
      required: false
    device_id:
      title: "Device Id"
      type: integer
      description: "Device id"
      required: false
    event_network_inbound:
      title: "Event Network Inbound"
      type: boolean
      description: "Event network inbound"
      required: false
    process_guid:
      title: "Process Guid"
      type: string
      description: "Process guid"
      required: false
    device_location:
      title: "Device Location"
      type: string
      description: "Device location"
      required: false
    netconn_local_port:
      title: "Netconn Local Port"
      type: integer
      description: "Netconn local port"
      required: false
    device_os_version:
      title: "Device Os Version"
      type: string
      description: "Device os version"
      required: false
    org_id:
      title: "Org Id"
      type: string
      description: "Org id"
      required: false
    device_name:
      title: "Device Name"
      type: string
      description: "Device name"
      required: false
    backend_timestamp:
      title: "Backend Timestamp"
      type: string
      description: "Backend timestamp"
      required: false
    parent_pid:
      title: "Parent Pid"
      type: integer
      description: "Parent pid"
      required: false
    device_policy:
      title: "Device Policy"
      type: string
      description: "Device policy"
      required: false
    parent_reputation:
      title: "Parent Reputation"
      type: string
      description: "Parent reputation"
      required: false


output:
  contacted:
    title: "Contacted"
    type: integer
    description: "Contacted"
    required: false
  num_aggregated:
    title: "Num Aggregated"
    type: integer
    description: "Num aggregated"
    required: false
  results:
    title: "Results"
    type: event_info
    description: "Results"
    required: false
  num_available:
    title: "Num Available"
    type: integer
    description: "Num available"
    required: false
  num_found:
    title: "Num Found"
    type: integer
    description: "Num found"
    required: false
  approximate_unaggregated:
    title: "Approximate Unaggregated"
    type: integer
    description: "Approximate unaggregated"
    required: false
  completed:
    title: "Completed"
    type: integer
    description: "Completed"
    required: false



connection:
  url:
    title: URL
    type: string
    description: API URL
    default: https://defense.conferdeploy.net
    required: true
  api_key:
    title: API Key
    type: credential_secret_key
    description: API key
    required: true
  org_key:
    title: Organization Key
    type: string
    description: Organization key
    required: true
  connector:
    title: Connector
    type: string
    description: Connector ID
    required: true
actions:
  find_event:
    title: Find Event
    description: Retrieves all events matching the input search criteria. Response
      is a list of events in JSON format. Resulting events are sorted in descending
      order of time
    input:
      hostName:
        title: Hostname
        description: Filter on hostnames case insensitive. For example hostName=win-IA9NQ1GN8OI
          will match the hostname WIN-IA9NQ1GN8OI
        type: string
        required: false
      hostNameExact:
        title: Hostname Exact
        description: Filter on the exact hostname. For example hostName=WIN-IA9NQ1GN8OI
          will only return devices with the exact hostname WIN-IA9NQ1GN8OI but not
          a host named win-IA9NQ1GN8OI
        type: string
        required: false
      ownerName:
        title: Owners Name
        description: Filter on owner name case insensitive
        type: string
        required: false
      ownerNameExact:
        title: Owners Name Exact
        description: Same as 'Owners Name' but with case sensitivity
        type: string
        required: false
      ipAddress:
        title: IP Address
        description: Filter on events generated by a device with a given external
          or internal IP address
        type: string
        required: false
      sha256hash:
        title: SHA-256 Hash
        description: Filter on events generated by a process with the given SHA-256
          hash. Note that this hash must be lowercase
        type: string
        required: false
      applicationName:
        title: Application Name
        description: Filter on events generated by a process with the given application
          name (for example, googleupdate.exe. Note that this name must be lowercase)
        type: string
        required: false
      eventType:
        title: Event Type
        description: Filter on events with a given event type
        type: string
        enum:
        - ''
        - NETWORK
        - FILE_CREATE
        - REGISTRY_ACCESS
        - SYSTEM_API_CALL
        - CREATE_PROCESS
        - DATA_ACCESS
        - INJECT_CODE
        required: false
      searchWindow:
        title: Search Window
        description: Filter on events generated within a given relative time frame.
          Note that the default is one day if a searchWindow is not specified. Note
          that events may not be available past 30 days due to retention policies
          e.g. 4d, 2w
        type: string
        required: false
    output:
      success:
        description: Success
        title: Success
        type: boolean
        required: false
      latestTime:
        description: Latest Time
        title: Latest Time
        type: integer
        required: false
      results:
        description: Results
        title: Results
        type: event_info
        required: false
      elapsed:
        description: Elapsed
        title: Elapsed
        type: integer
        required: false
      message:
        description: Message
        title: Message
        type: string
        required: false
      totalResults:
        description: Total Results
        title: Total Results
        type: integer
        required: false
  get_details_for_specific_event:
    title: Get Details for Specific Event
    description: Retrieve details for an individual event given the event ID
    input:
      event_id:
        title: Event ID
        description: Event ID
        type: string
        required: true
    output:
      eventinfo:
        title: Event Info
        description: Detailed information on the event
        type: event_info
        required: false
triggers:
  get_notifications:
    title: Get Notifications
    description: Allows consumers to get alert and policy action notifications that
      a connector is subscribed to. Only API keys of type 'SIEM' can call the notifications
      API
    input:
      frequency:
        type: integer
        title: Frequency
        description: How often to poll for new notifications requests, in seconds
        default: 10
        required: true
    output:
      notifications:
        description: Collection of Notifications
        title: Notifications
        type: '[]notifications'
        required: false
      message:
        description: Notification Message
        title: Message
        type: string
        required: false
      success:
        description: Notification Success
        title: Success
        type: boolean
        required: false
