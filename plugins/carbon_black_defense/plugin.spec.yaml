plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: carbon_black_defense
title: VMware Carbon Black Cloud Endpoint Standard
description: Find events and retrieve details for specific events
version: 3.0.0
vendor: rapid7
support: rapid7
supported_versions: ["2022-03-15"]
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/carbon_black_defense
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.carbonblack.com/
tags:
- carbon black
- defense
- antivirus
- cloud
- vmware
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [defense, antivirus]
  features: []
types:
  deviceInfo:
    deviceHostName:
      description: Device Hostname
      title: Device Hostname
      type: string
    deviceId:
      description: Device ID
      title: Device ID
      type: integer
    deviceName:
      description: Device Name
      title: Device Name
      type: string
    deviceType:
      description: Device Type
      title: Device Type
      type: string
    deviceVersion:
      description: Device Version
      title: Device Version
      type: string
    email:
      description: Email
      title: Email
      type: string
    externalIpAddress:
      description: External IP Address
      title: External IP Address
      type: string
    groupName:
      description: Group Name
      title: Group Name
      type: string
    internalIpAddress:
      description: Internal IP Address
      title: Internal IP Address
      type: string
    targetPriorityCode:
      description: Target Priority Code
      title: Target Priority Code
      type: integer
    targetPriorityType:
      description: Target Priority Type
      title: Target Priority Type
      type: string
  indicators:
    applicationName:
      description: Application Name
      title: Application Name
      type: string
    indicatorName:
      description: Indicator Name
      title: Indicator Name
      type: string
    sha256Hash:
      description: SHA-256 Hash
      title: SHA-256 Hash
      type: string
  threatInfo:
    incidentId:
      description: Incident ID
      title: Incident ID
      type: string
    indicators:
      description: Indicators
      title: Indicators
      type: '[]indicators'
    score:
      description: Score
      title: Score
      type: integer
    summary:
      description: Summary
      title: Summary
      type: string
    time:
      description: Time
      title: Time
      type: integer
  notifications:
    deviceInfo:
      description: Notifications
      title: Notifications
      type: deviceInfo
    eventDescription:
      description: Event Description
      title: Event Description
      type: string
    eventId:
      description: Event ID
      title: Event ID
      type: string
    eventTime:
      description: Event Time
      title: Event Time
      type: integer
    ruleName:
      description: Rule Name
      title: Rule Name
      type: string
    threatInfo:
      description: Threat Information
      title: Threat Information
      type: threatInfo
    type:
      description: Type
      title: Type
      type: string
    url:
      description: URL
      title: URL
      type: string
  event_info:
    event_network_location:
      title: Event Network Location
      type: string
      description: Geolocation of the remote side of the network connection
      required: false
    process_name:
      title: Process Name
      type: string
      description: Filesystem path of the actor process binary
      required: false
    device_target_priority:
      title: Device Target Priority
      type: string
      description: The 'Target value' configured in the policy assigned to the sensor
      required: false
    event_type:
      title: Event Type
      type: string
      description: Type of event observed
      required: false
    netconn_inbound:
      title: Netconn Inbound
      type: boolean
      description: True if the network connection was inbound; false if outbound
      required: false
    process_effective_reputation:
      title: Process Effective Reputation
      type: string
      description: Effective reputation of the actor process; applied by the sensor when the event occurred
      required: false
    event_network_remote_port:
      title: Event Network Remote Port
      type: integer
      description: TCP or UDP port used by the remote side of the network connection
      required: false
    device_group_id:
      title: Device Group ID
      type: integer
      description: ID assigned to the device_group by Carbon Black Cloud
      required: false
    process_effective_reputation_source:
      title: Process Effective Reputation Source
      type: string
      description: Source of the effective reputation for the actor process
      required: false
    legacy:
      title: Legacy
      type: boolean
      description: True if the record includes data from the Endpoint Standard
      required: false
    process_start_time:
      title: Process Start Time
      type: date
      description: Sensor reported ISO 8601 timestamp of when the process started
      required: false
    process_username:
      title: Process Username
      type: "[]string"
      description: User context in which the actor process was executed
      required: false
    netconn_port:
      title: Netconn Port
      type: integer
      description: TCP or UDP port used by the interesting side of the network connection
      required: false
    netconn_protocol:
      title: Netconn Protocol
      type: string
      description: Network protocol of the network connection
      required: false
    device_timestamp:
      title: Device Timestamp
      type: date
      description: Sensor-reported ISO 8601 timestamp of the batch of events in which this record was submitted to Carbon Black Cloud
      required: false
    netconn_location:
      title: Netconn Location
      type: string
      description: Geolocation of the remote side of the network connection
      required: false
    ttp:
      title: TTP
      type: "[]string"
      description: Patterns of behavior (i.e. tactics, techniques, procedures) associated with specific threat actor(s) attributed to events of the process
      required: false
    netconn_domain:
      title: Netconn Domain
      type: string
      description: Domain name (FQDN) associated with the remote end of the network connection, if available
      required: false
    event_description:
      title: Event Description
      type: string
      description: Event description calculated by the Carbon Black Cloud
      required: false
    process_cmdline:
      title: Process Cmdline
      type: "[]string"
      description: Command line executed by the actor process
      required: false
    event_id:
      title: Event ID
      type: string
      description: Unique event identifier assigned by the Carbon Black Cloud
      required: false
    event_hash:
      title: Event Hash
      type: string
      description: Hash of the event to allow for deduplication of events
      required: false
    parent_guid:
      title: Parent GUID
      type: string
      description: Unique process identifier assigned to the parent process
      required: false
    document_guid:
      title: Document GUID
      type: string
      description: Unique process identifier assigned to document
      required: false
    process_cmdline_length:
      title: Process Cmdline Length
      type: "[]integer"
      description: Character count of the actor process command line
      required: false
    enriched_event_type:
      title: Enriched Event Type
      type: string
      description: Event type(s) as determined by the Carbon Black Cloud
      required: false
    enriched:
      title: Enriched
      type: boolean
      description: True if the result includes data from the Endpoint Standard product
      required: false
    netconn_local_ipv4:
      title: Netconn Local IPv4
      type: integer
      description: Pv4 address of the local side of the network connection; stored as an integer
      required: false
    parent_hash:
      title: Parent Hash
      type: "[]string"
      description: MD5 and/or SHA-256 hash of the parent process binary
      required: false
    event_network_protocol:
      title: Event Network Protocol
      type: string
      description: Network protocol of the network connection
      required: false
    parent_effective_reputation_source:
      title: Parent Effective Reputation Source
      type: string
      description: Source of the effective reputation for the parent process
      required: false
    process_pid:
      title: Process PID
      type: "[]integer"
      description: Process identifier assigned by the operating system; can be multi-valued in case of fork() or exec() process operations on Linux and macOS
      required: false
    event_network_remote_ipv4:
      title: Event Network Remote IPv4
      type: string
      description: IPv4 address of the remote side of the network connection
      required: false
    process_hash:
      title: Process Hash
      type: "[]string"
      description: Aggregate set of MD5 and SHA-256 hashes associated with the process
      required: false
    parent_effective_reputation:
      title: Parent Effective Reputation
      type: string
      description: Effective reputation of the parent process; applied by the sensor when the event occurred
      required: false
    process_sha256:
      title: Process SHA-256
      type: string
      description: SHA-256 hash of the actor process binary
      required: false
    parent_name:
      title: Parent Name
      type: string
      description: Filesystem path of the parent process binary
      required: false
    device_external_ip:
      title: Device External IP
      type: string
      description: IP address of the endpoint according to the Carbon Black Cloud
      required: false
    netconn_ipv4:
      title: Netconn IPv4
      type: integer
      description: IPv4 address of the remote side of the network connection
      required: false
    event_report_code:
      title: Event Report Code
      type: string
      description: Report code of the detected threat
      required: false
    event_threat_score:
      title: Event Threat Score
      type: "[]integer"
      description: Score(s) assigned by Carbon Black Cloud for the detected threat (Returns values 0-8)
      required: false
    device_internal_ip:
      title: Device Internal IP
      type: string
      description: IP address of the endpoint reported by the sensor
      required: false
    event_network_local_ipv4:
      title: Event Network Local IPv4
      type: string
      description: IPv4 address of the local side of the network connection
      required: false
    process_reputation:
      title: Process Reputation
      type: string
      description: Reputation of the actor process; applied when event is processed by the Carbon Black Cloud
      required: false
    ingress_time:
      title: Ingress Time
      type: integer
      description: Timestamp of when the Carbon Black Cloud receives data for initial processing (Unix format)
      required: false
    device_os:
      title: Device OS
      type: string
      description: The operating system of the endpoint
      required: false
    device_policy_id:
      title: Device Policy ID
      type: integer
      description: ID assigned to the device_policy by the Carbon Black Cloud
      required: false
    device_id:
      title: Device ID
      type: integer
      description: ID assigned to the endpoint by Carbon Black Cloud; unique across all Carbon Black Cloud environments
      required: false
    event_network_inbound:
      title: Event Network Inbound
      type: boolean
      description: True if the network connection was inbound
      required: false
    process_guid:
      title: Process GUID
      type: string
      description: Unique process identifier for the actor process
      required: false
    device_location:
      title: Device Location
      type: string
      description: The endpoints current location relative to the organizations network, based on the current IP address and the devices registered DNS domain suffix
      required: false
    netconn_local_port:
      title: Netconn Local Port
      type: integer
      description: TCP or UDP port used by the local side of the network connection
      required: false
    device_os_version:
      title: Device OS Version
      type: string
      description: The operating system and version of the endpoint
      required: false
    org_id:
      title: Org ID
      type: string
      description: Organization identifer
      required: false
    device_name:
      title: Device Name
      type: string
      description: Hostname of the endpoint recorded by the sensor when last initialized
      required: false
    backend_timestamp:
      title: Backend Timestamp
      type: date
      description: ISO 8601 Timestamp when the Carbon Black Cloud processed and enabled the data for searching
      required: false
    parent_pid:
      title: Parent PID
      type: integer
      description: Identifier assigned by the operating system to the parent process
      required: false
    device_policy:
      title: Device Policy
      type: string
      description: Policy applied to the endpoint in the Carbon Black Cloud
      required: false
    parent_reputation:
      title: Parent Reputation
      type: string
      description: Reputation of the parent process; applied when event is processed by the Carbon Black Cloud
      required: false
    alert_category:
      title: Alert Category
      type: "[]string"
      description: A Carbon Black Cloud classification for events tagged to an alert indicating whether the event is a 'threat' or 'observed'
      required: false
    alert_id:
      title: Alert ID
      type: "[]string"
      description: ID of the alert(s) associated with the process or event
      required: false
    blocked_effective_reputation:
      title: Blocked Effective Reputation
      type: string
      description: Effective reputation of the blocked file; applied by the sensor when the event occurs
      required: false
    blocked_hash:
      title: Blocked Hash
      type: "[]string"
      description: MD5 and SHA-256 hash(es) of the child process(es) binary; for any process(es) terminated by the sensor
      required: false
    blocked_name:
      title: Blocked Name
      type: string
      description: Tokenized file path of the files blocked by sensor action
      required: false
    childproc_cmdline:
      title: Childproc Cmdline
      type: string
      description: Command line of the child process
      required: false
    childproc_cmdline_length:
      title: Childproc Cmdline Length
      type: integer
      description: Character count of the child process' command line
    childproc_count:
      title: Childproc Count
      type: integer
      description: Count of childproc events reported by the sensor since last initialization
      required: false
    childproc_effective_reputation:
      title: Childproc Effective Reputation
      type: string
      description: Effective reputation of the child process; applied by the sensor when the event occurs
      required: false
    childproc_effective_reputation_source:
      title: Childproc Effective Reputation Source
      type: string
      description: Source of the effective reputation for the child process
      required: false
    childproc_guid:
      title: Childproc GUID
      type: string
      description: Unique identifier for the child process
      required: false
    childproc_hash:
      title: Childproc Hash
      type: "[]string"
      description: Hash(es) of the child process(es)' binary (MD5 or SHA-256 for Enterprise EDR, SHA-256 for Endpoint Standard)
      required: false
    childproc_md5:
      title: Childproc MD5
      type: string
      description: MD5 hash of the binary executed by the child process
      required: false
    childproc_name:
      title: Childproc Name
      type: string
      description: Filesystem path of the child process' binary
      required: false
    childproc_pid:
      title: Childproc PID
      type: integer
      description: Process identifier assigned by the operating system to the child process
      required: false
    childproc_process_guid:
      title: Childproc Process GUID
      type: string
      description: Unique identifier for the child process
      required: false
    childproc_publisher:
      title: Childproc Publisher
      type: "[]string"
      description: Publisher name on the certificate used to sign the Windows or macOS binary of child process(es)
      required: false
    childproc_publisher_state:
      title: Childproc Publisher State
      type: "[]string"
      description: State of the digital signature(s) of the child processes' binaries
      required: false
    childproc_reputation:
      title: Childproc Reputation
      type: string
      description: Reputation of the child process; applied by the Carbon Black Cloud when the event was processed
      required: false
    childproc_sha256:
      title: Childproc SHA-256
      type: string
      description: SHA-256 hash of the binary executed by the child process in the event
      required: false
    childproc_suppressed:
      title: Childproc Suppressed
      type: boolean
      description: Cloud suppressed one or more childproc process records; not present if false (suppressed if the child process shows no interesting activity after the process is created); Linux sensors only
      required: false
    childproc_username:
      title: Childproc Username
      type: string
      description: The user context in which the child process was executed
      required: false
    crossproc_action:
      title: Crossproc Action
      type: string
      description: The cross-process action initiated by the actor process
      required: false
    crossproc_api:
      title: Crossproc API
      type: string
      description: Name of the operating system API called by the actor process
      required: false
    crossproc_cmdline:
      title: Crossproc Cmdline
      type: string
      description: Command line of the cross-process command
      required: false
    crossproc_cmdline_length:
      title: Crossproc Cmdline Length
      type: string
      description: Character count of the cross-process command line executed
      required: false
    crossproc_count:
      title: Crossproc Count
      type: integer
      description: Count of crossproc events reported by the sensor since last initialization
      required: false
    crossproc_effective_reputation:
      title: Crossproc Effective Reputation
      type: string
      description: Effective reputation of the binary on one side of the cross-process action
      required: false
    crossproc_effective_reputation_source:
      title: Crossproc Effective Reputation Source
      type: string
      description: Source of the effective reputation for the cross-process
      required: false
    crossproc_guid:
      title: Crossproc GUID
      type: string
      description: Unique process identifier of one of the cross-process members
      required: false
    crossproc_hash:
      title: Crossproc Hash
      type: "[]string"
      description: MD5 and/or SHA-256 hash(es) of the binaries whose processes are running on one side of the cross-process action
      required: false
    crossproc_md5:
      title: Crossproc MD5
      type: string
      description: MD5 hash of the binary on one side of the cross-process action
      required: false
    crossproc_name:
      title: Crossproc Name
      type: string
      description: Filesystem path of the binary of one side of the cross-process action
      required: false
    crossproc_pid:
      title: Crossproc PID
      type: integer
      description: Process identifier assigned by the operating system to one of the cross-process members
      required: false
    crossproc_process_guid:
      title: Crossproc Process GUID
      type: string
      description: Unique identifer of the process on one side of the cross-process action
      required: false
    crossproc_sha256:
      title: Crossproc SHA-256
      type: string
      description: SHA-256 hash of the binary on one side of the cross-process action
      required: false
    crossproc_target:
      title: Crossproc Target
      type: boolean
      description: True if the process was the target of the cross-process event; false if the process was the actor
      required: false
    device_group:
      title: Device Group
      type: string
      description: Sensor group to which the endpoint was assigned when the sensor recorded the event data
      required: false
    device_installed_by:
      title: Device Installed By
      type: string
      description: The Carbon Black Cloud user who was logged in to the endpoint when the sensor was installed
      required: false
    event_attack_stage:
      title: Event Attack Stage
      type: string
      description: Stage(s) of the cyber kill chain when an attack was terminated by sensor
      required: false
    event_timestamp:
      title: Event Timestamp
      type: date
      description: ISO 8601 Timestamp reported by the sensor when the event occured
      required: false
    file_scan_result:
      title: File Scan Result
      type: string
      description: Classification of malware detected during a background scan performed by the Endpoint Standard sensor
      required: false
    fileless_scriptload_cmdline:
      title: Fileless Scriptload Cmdline
      type: "[]string"
      description: Deobfuscated script content run in a fileless context by the process
      required: false
    fileless_scriptload_cmdline_length:
      title: Fileless Scriptload Cmdline Length
      type: "[]integer"
      description: Character count of the deobfuscated script content run in a fileless context
      required: false
    fileless_scriptload_hash:
      title: Fileless Scriptload Hash
      type: "[]string"
      description: SHA-256 hash(es) of the deobfuscated script content run by the process in a fileless context
      required: false
    fileless_scriptload_sha256:
      title: Fileless Scriptload SHA-256
      type: string
      description: SHA-256 hash of the deobfuscated script content run by the process in a fileless context
      required: false
    filemod_action:
      title: Filemod Action
      type: string
      description: Action(s) associated with the filemod operation
      required: false
    filemod_count:
      title: Filemod Count
      type: integer
      description: Count of filemod events reported by the sensor since last initialization
      required: false
    filemod_hash:
      title: Filemod Hash
      type: "[]string"
      description: MD5 and/or SHA-256 hash(es) of the file(s) modified by the actor process
      required: false
    filemod_md5:
      title: Filemod MD5
      type: string
      description: MD5 hash of the file modified by the actor process
      required: false
    filemod_new_name:
      title: Filemod New Name
      type: string
      description: Filesystem path of the new file modified by the process during
      required: false
    filemod_name:
      title: Filemod Name
      type: string
      description: Filesystem path of the file modified by the process
      required: false
    filemod_old_name:
      title: Filemod Old Name
      type: string
      description: Filesystem path of the old file modified by the process during
      required: false
    filemod_publisher:
      title: Filemod Publisher
      type: "[]string"
      description: Publisher name on the certificate(s) used to sign the target file of the filemod
      required: false
    filemod_publisher_state:
      title: Filemod Publisher State
      type: "[]string"
      description: State of the digital signature(s) of the target file of the filemod
      required: false
    filemod_reputation:
      title: Filemod Reputation
      type: string
      description: Reputation of the target file
      required: false
    filemod_sha256:
      title: Filemod SHA-256
      type: string
      description: SHA-256 hash of the file modified by the actor process
      required: false
    filemod_type:
      title: Filemod Type
      type: string
      description: Type of file involved in the filemod operation
      required: false
    hash:
      title: Hash
      type: "[]string"
      description: Aggregate set of MD5 and SHA-256 hashes associated with the process
      required: false
    modload_action:
      title: Modload Action
      type: string
      description: Action associated with the modload operation
      required: false
    modload_count:
      title: Modload Count
      type: integer
      description: Count of modload events reported by the sensor since last initialization
      required: false
    modload_effective_reputation:
      title: Modload Effective Reputation
      type: string
      description: Effective reputation(s) of the loaded module(s); applied by the sensor when the event occurred
      required: false
    modload_hash:
      title: Modload Hash
      type: "[]string"
      description: MD5 or SHA-256 hash(es) of the module(s) loaded by the process
      required: false
    modload_md5:
      title: Modload MD5
      type: string
      description: MD5 hash of the module loaded by the process
      required: false
    modload_name:
      title: Modload Name
      type: "[]string"
      description: Filesystem path(s) of the module(s) loaded by the process
      required: false
    modload_publisher:
      title: Modload Publisher
      type: string
      description: Publisher name on the certificate(s) used to sign the Windows or macOS module binary
      required: false
    modload_publisher_state:
      title: Modoad Publisher State
      type: "[]string"
      description: Digital signature state(s) of the loaded modules' binaries
      required: false
    modload_sha256:
      title: Modload SHA-256
      type: string
      description: SHA-256 hash of the module loaded by the process
      required: false
    netconn_action:
      title: Netconn Action
      type: string
      description: Action(s) associated with the netconn operation
      required: false
    netconn_count:
      title: Netconn Count
      type: integer
      description: Count of netconn events reported by the sensor since last initialization
      required: false
    netconn_failed:
      title: Netconn Failed
      type: boolean
      description: True if the outbound network connection attempt failed
      required: false
    netconn_ipv6:
      title: Netconn IPv6
      type: string
      description: IPv6 address of the remote side of the network connection
      required: false
    netconn_listen:
      title: Netconn Listen
      type: boolean
      description: True if the process opened a socket to listen for incoming connections
      required: false
    netconn_local_ipv6:
      title: Netconn Local IPv6
      type: string
      description: IPv6 address of the local side of the network connection; stored as a string without octet-separating colon characters
      required: false
    netconn_local_location:
      title: Netconn Local Location
      type: string
      description: Geolocation of the local side of the network connection
      required: false
    netconn_proxy_domain:
      title: Netconn Proxy Domain
      type: string
      description: Domain name (FQDN) associated with the remote side of the connection with an intermediary HTTP network device, usually a proxy server
      required: false
    netconn_proxy_ipv4:
      title: Netconn Proxy IPv4
      type: integer
      description: Pv4 address of the remote side of the connection with an intermediary HTTP network device, usually a proxy server
      required: false
    netconn_proxy_ipv6:
      title: Netconn Proxy IPv6
      type: string
      description: IPv6 address of the remote side of the connection with an intermediary HTTP network device, usually a proxy server
      required: false
    netconn_proxy_port:
      title: Netconn Proxy Port
      type: integer
      description: TCP or UDP port used by the remote side of the connection with an intermediary HTTP network device, usually a proxy server
      required: false
    netconn_remote_ipv4:
      title: Netconn Remote IPv4
      type: integer
      description: IPv4 address of the remote side of the network connection
      required: false
    netconn_remote_ipv6:
      title: Netconn Remote IPv6
      type: string
      description: IPv6 address of the remote side of the network connection
      required: false
    netconn_remote_port:
      title: Netconn Remote Port
      type: integer
      description: CP or UDP port used by the remote side of the network connection; same as netconn_port and event_network_remote_port
      required: false
    num_devices:
      title: Num Devices
      type: integer
      description: Count of devices where application is reported for the requested search population
      required: false
    num_events:
      title: Num Events
      type: integer
      description: Count of events attributed to the device or application running on the requested search population
      required: false
    parent_cmdline:
      title: Parent Cmdline
      type: string
      description: Command line of the parent process
      required: false
    parent_cmdline_length:
      title: Parent Cmdline Length
      type: integer
      description: Character count of the parent process' command line
      required: false
    parent_publisher:
      title: Parent Publisher
      type: "[]string"
      description: Publisher name(s) on the certificate(s) used to sign the Windows or macOS binary of the parent process
      required: false
    parent_publisher_state:
      title: Parent Publisher State
      type: "[]string"
      description: State of the digital signature(s) of the parent process' binary
      required: false
    process_company_name:
      title: Process Company Name
      type: string
      description: Company name embedded in the portable executable header of the Windows process binary
      required: false
    process_duration:
      title: Process Duration
      type: integer
      description: Duration of the process (in milliseconds)
      required: false
    process_elevated:
      title: Process Elevated
      type: boolean
      description: "'True' if the process was running with elevated privileges"
      required: false
    process_end_time:
      title: Process End Time
      type: date
      description: Sensor ISO 8601 timestamp when the process terminated; available after sensor reports the process has terminated
      required: false
    process_file_description:
      title: Process File Description
      type: string
      description: File description embedded in the portable executable header of the Windows process binary
      required: false
    process_integrity_level:
      title: Process Integrity Level
      type: string
      description: Windows Mandatory Integrity Control (MIC) level of the process
      required: false
    process_internal_name:
      title: Process Internal Name
      type: string
      description: Internal name embedded in the portable executable header of the Windows process binary
      required: false
    process_loaded_script_hash:
      title: Process Loaded Script Hash
      type: "[]string"
      description: SHA-256 hash(es) of any script loaded from the filesystem through the duration of the process
      required: false
    process_loaded_script_name:
      title: Process Loaded Script Name
      type: "[]string"
      description: Filesystem path(s) of any script content loaded from the filesystem through the duration of the process
      required: false
    process_original_filename:
      title: Process Original Filename
      type: string
      description: Original filename embedded in the portable executable header of the Windows process binary
      required: false
    process_privileges:
      title: Process Privileges
      type: "[]string"
      description: Windows privileges associated wth the process (see Microsoft documentation for complete list privilege-constants)
      required: false
    process_product_name:
      title: Process Product Name
      type: string
      description: Product name embedded in the portable executable header of the Windows process binary
      required: false
    process_product_version:
      title: Process Product Version
      type: string
      description: Product version embedded in the portable executable header of the Windows process binary
      required: false
    process_publisher:
      title: Process Publisher
      type: "[]string"
      description: Publisher name on the certificate used to sign the Windows or macOS process binary
      required: false
    process_publisher_state:
      title: Process Publisher State
      type: "[]string"
      description: State of the digital signature(s) of a Windows or macOS process binary
      required: false
    process_service_name:
      title: Process Service Name
      type: "[]string"
      description: Windows service name(s) assigned to the process
      required: false
    process_terminated:
      title: Process Terminated
      type: boolean
      description: "'True' indicates the process has terminated; always 'false' for enriched events (process termination not recorded)"
      required: false
    regmod_action:
      title: Regmod Action
      type: string
      description: Action associated with the regmod operation
      required: false
    regmod_count:
      title: Regmod Count
      type: integer
      description: Count of regmod events reported by the sensor since last initialization
      required: false
    regmod_name:
      title: Regmod Name
      type: string
      description: Full path of the registry key(s) modified by the process
      required: false
    regmod_new_name:
      title: Regmod New Name
      type: string
      description: New registry key name; renamed keys only
      required: false
    regmod_old_name:
      title: Regmod Old Name
      type: string
      description: Old registry key name; renamed keys only
      required: false
    report_id:
      title: Report ID
      type: string
      description: ID of the watchlist report(s) that detected a hit on the process
      required: false
    report_severity:
      title: Report Severity
      type: integer
      description: Severity rating of the watchlist report; ranges 1-10, where 10 is 'severe'
      required: false
    scriptload_content:
      title: Scriptload Content
      type: "[]string"
      description: Deobfuscated script content (string, binary, or raw executable image) loaded from the filesystem at process launch
      required: false
    scriptload_content_length:
      title: Scriptload Content Length
      type: "[]integer"
      description: Character count of the deobfuscated filesystem script
      required: false
    scriptload_count:
      title: Scriptload Count
      type: integer
      description: Count of scriptload events across all processes reported by the sensor since last initialization
      required: false
    scriptload_effective_reputation:
      title: Scriptload Effective Reputation
      type: string
      description: Effective reputation(s) of the loaded script(s); applied by the sensor when the event occurred
      required: false
    scriptload_hash:
      title: Scriptload Hash
      type: "[]string"
      description: MD5 and/or SHA-256 hash(es) of the filesystem script file loaded at process launch
      required: false
    scriptload_md5:
      title: Scriptload MD5
      type: string
      description: MD5 hash of the filesystem script file loaded at process launch
      required: false
    scriptload_name:
      title: Scriptload Name
      type: string
      description: Filesystem path of script file(s) loaded at process launch
      required: false
    scriptload_publisher:
      title: Scriptload Publisher
      type: string
      description: Publisher name on the certificate used to sign the script file from the filesystem
      required: false
    scriptload_publisher_state:
      title: Scriptload Publisher State
      type: "[]string"
      description: State of the loaded script(s)' digital signature(s); checks signatures on Powershell scripts and .MSI/.MSP files
      required: false
    scriptload_sha256:
      title: Scriptload SHA-256
      type: string
      description: SHA-256 hash of the filesystem script file loaded at process launch
      required: false
    sensor_action:
      title: Sensor Action
      type: "[]string"
      description: An action performed by the sensor on the process
      required: false
    sensor_action_reason:
      title: Sensor Action Reason
      type: "[]string"
      description: Reason(s) why the sensor performed a specific action on the process
      required: false
    watchlist_hit:
      title: Watchlist Hit
      type: "[]string"
      description: Identifier for specific hit record(s) generated by a watchlist, from report metadata; format '<watchlist_id>:<report_id>:<report_severity>'
      required: false
connection:
  url:
    title: URL
    type: string
    description: API URL
    default: https://defense.conferdeploy.net
    required: true
    example: https://example.com
  api_key:
    title: API Key
    type: credential_secret_key
    description: API key
    required: true
    example: 9de5069c5afe602b2ea0a04b66beb2c0
  org_key:
    title: Organization Key
    type: string
    description: Organization key
    required: true
    example: 1ABCDE5GH
  connector:
    title: Connector
    type: string
    description: Connector ID
    required: true
    example: 1Y72FRRWVP
actions:
  find_event:
    title: Find Event
    description: Retrieves all events matching the input search criteria. Response
      is a list of events in JSON format. Resulting events are sorted in descending
      order of time
    input:
      device_name:
        title: "Device Name"
        description: "Device name"
        type: "[]string"
        required: false
        example: "CONTOSO\\bruce-win10"
      device_external_ip:
        title: "Device External IP"
        type: "[]string"
        description: "Device external IP"
        required: false
        example: "192.0.2.0"
      process_hash:
        title: SHA-256 Hash
        description: Filter on events generated by a process with the given SHA-256
          hash. Note that this hash must be lowercase
        type: "[]string"
        required: false
        example: ["A3DED3871AC66498E406798B0CA33F1B5E94B9CFB60DD4489475B9C19FBFD7F5"]
      process_name:
        title: "Process Name"
        description: "Process name"
        type: "[]string"
        required: false
        example: "c:\\windows\\system32\\windowspowershell\\v1.0\\modules\\smbshare\\disableunusedsmb1.ps1"
      enriched_event_type:
        title: "Enriched Event Type"
        type: "[]string"
        description: "Enriched event type"
        required: false
        example: "SYSTEM_API_CALL"
      time_range:
        title: "Time Range"
        type: string
        description: "Time frame to limit your search to. Integer used for amount of the following: s=second(s), m=minute(s), h=hour(s), d=day(s), w=week(s), or y=year(s). Example: -2d"
        required: false
        example: "-2d"
    output:
      success:
        title: Success
        description: Success
        type: boolean
        required: false
      num_found:
        title: Num Found
        description: Number of results found
        type: integer
        required: false
      num_available:
        title: Num Available
        description: Number of found results able to be paginated
        type: integer
        required: false
      num_aggregated:
        title: Num Aggregated
        description: The number of processes that were constructed from the events which will be equal or greater than Num Available
        type: integer
        required: false
      completed:
        title: Completed
        description: The number of searchers that have reported their results
        type: integer
        required: false
      contacted:
        title: Contacted
        description: The number of searchers contacted for this query
        type: integer
        required: false
      approximate_unaggregated:
        title: Approximate Unaggregated
        description: The number of matching events used to construct the processes which will be equivalent to Num Found
        type: integer
        required: false
      results:
        title: Results
        description: Detailed information on the event
        type: "[]event_info"
        required: false
  get_details_for_specific_event:
    title: Get Details for Specific Event
    description: Retrieve details for an individual event given the event ID
    input:
      event_ids:
        title: Event ID
        description: "Event ID used to retrieve event details. Example: 422af3fc3a7411ea8da649e797467dc0"
        type: string
        required: true
        example: "422af3fc3a7411ea8da649e797467dc0"
    output:
      success:
        title: Success
        description: Success
        type: boolean
        required: false
      num_found:
        title: Num Found
        description: Number of results found
        type: integer
        required: false
      num_available:
        title: Num Available
        description: Number of found results able to be paginated
        type: integer
        required: false
      num_aggregated:
        title: Num Aggregated
        description: The number of processes that were constructed from the events which will be equal or greater than Num Available
        type: integer
        required: false
      completed:
        title: Completed
        description: The number of searchers that have reported their results
        type: integer
        required: false
      contacted:
        title: Contacted
        description: The number of searchers contacted for this query
        type: integer
        required: false
      approximate_unaggregated:
        title: Approximate Unaggregated
        description: The number of matching events used to construct the processes which will be equivalent to Num Found
        type: integer
        required: false
      results:
        title: Results
        description: Detailed information on the event
        type: "[]event_info"
        required: false
triggers:
  get_notifications:
    title: Get Notifications
    description: Allows consumers to get alert and policy action notifications that
      a connector is subscribed to. Only API keys of type 'SIEM' can call the notifications
      API
    input:
      frequency:
        type: integer
        title: Frequency
        description: How often to poll for new notifications requests, in seconds
        default: 10
        required: true
        example: 10
    output:
      notifications:
        description: Collection of Notifications
        title: Notifications
        type: '[]notifications'
        required: false
      message:
        description: Notification Message
        title: Message
        type: string
        required: false
      success:
        description: Notification Success
        title: Success
        type: boolean
        required: false
