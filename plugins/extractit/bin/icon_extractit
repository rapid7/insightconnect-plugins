#!/usr/bin/env python
# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import os
import json
from sys import argv

Name = "ExtractIt"
Vendor = "rapid7"
Version = "3.0.12"
Description = "The ExtractIt plugin is a collection of data extraction actions. This plugin allows users to extract various pieces of information from blocks of text. The pieces of information this plugin can extract include IPs, URLs, file paths, dates, domains, hashes, MAC addresses, and email addresses"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import insightconnect_plugin_runtime
    from icon_extractit import connection, actions, triggers, tasks

    class ICONExtractit(insightconnect_plugin_runtime.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_action(actions.UrlExtractor())
        
            self.add_action(actions.IpExtractor())
        
            self.add_action(actions.EmailExtractor())
        
            self.add_action(actions.MacExtractor())
        
            self.add_action(actions.DomainExtractor())
        
            self.add_action(actions.FilepathExtractor())
        
            self.add_action(actions.DateExtractor())
        
            self.add_action(actions.IocExtractor())
        
            self.add_action(actions.Md5Extractor())
        
            self.add_action(actions.Sha1Extractor())
        
            self.add_action(actions.Sha256Extractor())
        
            self.add_action(actions.Sha512Extractor())
        
            self.add_action(actions.CveExtractor())
        
            self.add_action(actions.UuidExtractor())
        
            self.add_action(actions.ExtractAll())
        

    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONExtractit())
    cli.run()


if __name__ == "__main__":
    main()
