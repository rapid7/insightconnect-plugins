# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Upload multiple threat reports in one request"


class Input:
    REPORTS = "reports"
    

class Output:
    REPORTS = "reports"
    

class SubmitReportsInBulkInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "reports": {
      "type": "array",
      "title": "Reports",
      "description": "Reports to upload",
      "items": {
        "$ref": "#/definitions/uploaded_report"
      },
      "order": 1
    }
  },
  "required": [
    "reports"
  ],
  "definitions": {
    "report_ioc": {
      "type": "object",
      "title": "report_ioc",
      "properties": {
        "domain": {
          "type": "string",
          "title": "Domain",
          "description": "Root domain",
          "order": 4
        },
        "hostname": {
          "type": "string",
          "title": "Hostname",
          "description": "Domain with all subdomains",
          "order": 3
        },
        "ip": {
          "type": "string",
          "title": "IP",
          "description": "IPv4 or IPv6",
          "order": 1
        },
        "md5": {
          "type": "string",
          "title": "MD5",
          "description": "MD5 hash of a malicious binary",
          "order": 5
        },
        "sha1": {
          "type": "string",
          "title": "SHA1",
          "description": "SHA1 hash of a malicious binary",
          "order": 6
        },
        "sha256": {
          "type": "string",
          "title": "SHA256",
          "description": "SHA256 hash of a malicious binary",
          "order": 7
        },
        "ssdeep": {
          "type": "string",
          "title": "SSDEEP",
          "description": "SSDEEP hash of a malicious binary",
          "order": 8
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "Malicious URL indicator",
          "order": 2
        }
      }
    },
    "uploaded_report": {
      "type": "object",
      "title": "uploaded_report",
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "order": 3
        },
        "feed_id": {
          "type": "string",
          "title": "Feed ID",
          "description": "The feed ID to post this report in",
          "order": 1
        },
        "ioc": {
          "$ref": "#/definitions/report_ioc",
          "title": "IoC",
          "description": "Object with observables",
          "order": 6
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "List of tags to categorize and help others find this report",
          "items": {
            "type": "string"
          },
          "order": 4
        },
        "timestamp": {
          "type": "integer",
          "title": "Timestamp",
          "description": "An ISO8601 date string for when this IoC was observed",
          "order": 5
        },
        "title": {
          "type": "string",
          "title": "Title",
          "description": "Short report title",
          "order": 2
        }
      },
      "required": [
        "feed_id",
        "ioc",
        "tags",
        "title"
      ],
      "definitions": {
        "report_ioc": {
          "type": "object",
          "title": "report_ioc",
          "properties": {
            "domain": {
              "type": "string",
              "title": "Domain",
              "description": "Root domain",
              "order": 4
            },
            "hostname": {
              "type": "string",
              "title": "Hostname",
              "description": "Domain with all subdomains",
              "order": 3
            },
            "ip": {
              "type": "string",
              "title": "IP",
              "description": "IPv4 or IPv6",
              "order": 1
            },
            "md5": {
              "type": "string",
              "title": "MD5",
              "description": "MD5 hash of a malicious binary",
              "order": 5
            },
            "sha1": {
              "type": "string",
              "title": "SHA1",
              "description": "SHA1 hash of a malicious binary",
              "order": 6
            },
            "sha256": {
              "type": "string",
              "title": "SHA256",
              "description": "SHA256 hash of a malicious binary",
              "order": 7
            },
            "ssdeep": {
              "type": "string",
              "title": "SSDEEP",
              "description": "SSDEEP hash of a malicious binary",
              "order": 8
            },
            "url": {
              "type": "string",
              "title": "URL",
              "description": "Malicious URL indicator",
              "order": 2
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SubmitReportsInBulkOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "reports": {
      "type": "array",
      "title": "Reports",
      "description": "Uploaded reports",
      "items": {
        "$ref": "#/definitions/threat_report"
      },
      "order": 1
    }
  },
  "required": [
    "reports"
  ],
  "definitions": {
    "coordinates": {
      "type": "object",
      "title": "coordinates",
      "properties": {
        "lat": {
          "type": "number",
          "title": "Lat",
          "description": "Latitude",
          "order": 1
        },
        "lon": {
          "type": "number",
          "title": "Lon",
          "description": "Longitude",
          "order": 2
        }
      }
    },
    "geo_ip_location": {
      "type": "object",
      "title": "geo_ip_location",
      "properties": {
        "city": {
          "type": "string",
          "title": "City",
          "description": "City name",
          "order": 2
        },
        "country": {
          "type": "string",
          "title": "Country",
          "description": "Country code",
          "order": 1
        },
        "point": {
          "$ref": "#/definitions/coordinates",
          "title": "Point",
          "description": "Longitude and latitude coordinates",
          "order": 3
        }
      },
      "definitions": {
        "coordinates": {
          "type": "object",
          "title": "coordinates",
          "properties": {
            "lat": {
              "type": "number",
              "title": "Lat",
              "description": "Latitude",
              "order": 1
            },
            "lon": {
              "type": "number",
              "title": "Lon",
              "description": "Longitude",
              "order": 2
            }
          }
        }
      }
    },
    "report_ioc": {
      "type": "object",
      "title": "report_ioc",
      "properties": {
        "domain": {
          "type": "string",
          "title": "Domain",
          "description": "Root domain",
          "order": 4
        },
        "hostname": {
          "type": "string",
          "title": "Hostname",
          "description": "Domain with all subdomains",
          "order": 3
        },
        "ip": {
          "type": "string",
          "title": "IP",
          "description": "IPv4 or IPv6",
          "order": 1
        },
        "md5": {
          "type": "string",
          "title": "MD5",
          "description": "MD5 hash of a malicious binary",
          "order": 5
        },
        "sha1": {
          "type": "string",
          "title": "SHA1",
          "description": "SHA1 hash of a malicious binary",
          "order": 6
        },
        "sha256": {
          "type": "string",
          "title": "SHA256",
          "description": "SHA256 hash of a malicious binary",
          "order": 7
        },
        "ssdeep": {
          "type": "string",
          "title": "SSDEEP",
          "description": "SSDEEP hash of a malicious binary",
          "order": 8
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "Malicious URL indicator",
          "order": 2
        }
      }
    },
    "threat_report": {
      "type": "object",
      "title": "threat_report",
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "order": 4
        },
        "feed": {
          "type": "string",
          "title": "Feed",
          "description": "The feed name",
          "order": 2
        },
        "feed_id": {
          "type": "string",
          "title": "Feed ID",
          "description": "The feed ID",
          "order": 1
        },
        "ioc": {
          "$ref": "#/definitions/report_ioc",
          "title": "IoC",
          "description": "Object with observables",
          "order": 7
        },
        "location": {
          "$ref": "#/definitions/geo_ip_location",
          "title": "Location",
          "description": "Geo IP location",
          "order": 9
        },
        "reported_by": {
          "type": "string",
          "title": "Reported By",
          "description": "The username of the person who submitted the report",
          "order": 8
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "List of tags to categorize and help others find this report",
          "items": {
            "type": "string"
          },
          "order": 5
        },
        "timestamp": {
          "type": "integer",
          "title": "Timestamp",
          "description": "An ISO8601 date string for when this IoC was observed",
          "order": 6
        },
        "title": {
          "type": "string",
          "title": "Title",
          "description": "Short report title",
          "order": 3
        }
      },
      "definitions": {
        "coordinates": {
          "type": "object",
          "title": "coordinates",
          "properties": {
            "lat": {
              "type": "number",
              "title": "Lat",
              "description": "Latitude",
              "order": 1
            },
            "lon": {
              "type": "number",
              "title": "Lon",
              "description": "Longitude",
              "order": 2
            }
          }
        },
        "geo_ip_location": {
          "type": "object",
          "title": "geo_ip_location",
          "properties": {
            "city": {
              "type": "string",
              "title": "City",
              "description": "City name",
              "order": 2
            },
            "country": {
              "type": "string",
              "title": "Country",
              "description": "Country code",
              "order": 1
            },
            "point": {
              "$ref": "#/definitions/coordinates",
              "title": "Point",
              "description": "Longitude and latitude coordinates",
              "order": 3
            }
          },
          "definitions": {
            "coordinates": {
              "type": "object",
              "title": "coordinates",
              "properties": {
                "lat": {
                  "type": "number",
                  "title": "Lat",
                  "description": "Latitude",
                  "order": 1
                },
                "lon": {
                  "type": "number",
                  "title": "Lon",
                  "description": "Longitude",
                  "order": 2
                }
              }
            }
          }
        },
        "report_ioc": {
          "type": "object",
          "title": "report_ioc",
          "properties": {
            "domain": {
              "type": "string",
              "title": "Domain",
              "description": "Root domain",
              "order": 4
            },
            "hostname": {
              "type": "string",
              "title": "Hostname",
              "description": "Domain with all subdomains",
              "order": 3
            },
            "ip": {
              "type": "string",
              "title": "IP",
              "description": "IPv4 or IPv6",
              "order": 1
            },
            "md5": {
              "type": "string",
              "title": "MD5",
              "description": "MD5 hash of a malicious binary",
              "order": 5
            },
            "sha1": {
              "type": "string",
              "title": "SHA1",
              "description": "SHA1 hash of a malicious binary",
              "order": 6
            },
            "sha256": {
              "type": "string",
              "title": "SHA256",
              "description": "SHA256 hash of a malicious binary",
              "order": 7
            },
            "ssdeep": {
              "type": "string",
              "title": "SSDEEP",
              "description": "SSDEEP hash of a malicious binary",
              "order": 8
            },
            "url": {
              "type": "string",
              "title": "URL",
              "description": "Malicious URL indicator",
              "order": 2
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
