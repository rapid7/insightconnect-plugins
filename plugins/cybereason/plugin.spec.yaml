plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: cybereason
title: Cybereason
description: The Cybereason platform provides military-grade cyber security with real-time awareness and detection. Respond to threats and remediate in seconds using the Cybereason plugin
version: 2.0.0
vendor: rapid7
support: rapid7
status: []
tags: [investigate, malware, threat tntel]
hub_tags:
  use_cases: [threat_detection_and_response, vulnerability_management]
  keywords: [investigate]
  features: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/cybereason
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.cybereason.com/
enable_cache: true
types:
  fileSearchRequestConfiguration:
    minThrottleAmountMilli:
      title: Min Throttle Amount Milli
      type: integer
      description: Min throttle amount milli
      required: false
    diskRateBytesPerMilli:
      title: Disk Rate Bytes Per Milli
      type: integer
      description: Disk rate bytes per milli
      required: false
    minFileReadPriceMilli:
      title: Min File Read Price Milli
      type: integer
      description: Min file read price milli
      required: false
    cpuTrackingWindowMilli:
      title: CPU Tracking Window Milli
      type: integer
      description: CPU tracking window milli
      required: false
    targetCpuPercentage:
      title: Target CPU Percentage
      type: integer
      description: Target CPU percentage
      required: false
    maxResults:
      title: Max Results
      type: integer
      description: Max results
      required: false
    maxYaraTimeouts:
      title: Max Yara timeouts
      type: integer
      description: Max yara timeouts
      required: false
    timoutPerFileScan:
      title: Timout Per File Scan
      type: integer
      description: Timout per file scan
      required: false
    maxDiskIOWindowMilli:
      title: Max Disk IOWindow Milli
      type: integer
      description: Max disk IO window milli
      required: false
    searchTimeoutDataScanSec:
      title: Search Timeout Data Scan Sec
      type: integer
      description: Search timeout data scan sec
      required: false
    maxConcurrentFileSearches:
      title: Max Concurrent File Searches
      type: integer
      description: Max concurrent file searches
      required: false
    searchTimeoutSec:
      title: Search Timeout Sec
      type: integer
      description: Search timeout sec
      required: false
    shouldUseNewAPI:
      title: Should Use New API
      type: boolean
      description: Should use new API
      required: false
    maxReadBytesPerFile:
      title: Max Read Bytes Per File
      type: integer
      description: Max read bytes per file
      required: false
  filters:
    operator:
      title: Operator
      type: string
      description: Operator
      required: false
    values:
      title: Values
      type: "[]string"
      description: Values
      required: false
    fieldName:
      title: Field Name
      type: string
      description: Field name
      required: false
  actionArguments:
     yaraName:
       title: Yara Name
       type: string
       description: Yara name
       required: false
     machines:
       title: Machines
       type: "[]string"
       description: Machines
       required: false
     filters:
       title: Filters
       type: "[]filters"
       description: Filters
       required: false
     fileSearchRequestConfiguration:
       title: File Search Request Configuration
       type: fileSearchRequestConfiguration
       description: File search request configuration
       required: false
  stats:
    Aborting:
      title: Aborting
      type: integer
      description: Aborting
      required: false
    EndedWithYaraCompileError:
      title: Ended With Yara Compile Error
      type: integer
      description: Ended with yara compile error
      required: false
    AlreadyUpdated:
      title: Already Updated
      type: integer
      description: Already updated
      required: false
    EndedWithTooManyResults:
      title: Ended With Too Many Results
      type: integer
      description: Ended with too many results
      required: false
    UnknownProbe:
      title: Unknown Probe
      type: integer
      description: Unknown probe
      required: false
    Failed:
      title: Failed
      type: integer
      description: Failed
      required: false
    EndedWithUnsupportedFilter:
      title: Ended With Unsupported Filter
      type: integer
      description: Ended with unsupported filter
      required: false
    ProbeRemoved:
      title: Probe Removed
      type: integer
      description: Probe removed
      required: false
    EndedWithInvalidParam:
      title: Ended With Invalid Param
      type: integer
      description: Ended with invalid param
      required: false
    InProgress:
      title: In Progress
      type: integer
      description: In progress
      required: false
    Pending:
      title: Pending
      type: integer
      description: Pending
      required: false
    EndedWithUnknownError:
      title: Ended With Unknown Error
      type: integer
      description: Ended with unknown error
      required: false
    MsiFileCorrupted:
      title: MSI File Corrupted
      type: integer
      description: MSI file corrupted
      required: false
    Started:
      title: Started
      type: integer
      description: Started
      required: false
    SendingMsi:
      title: Sending MSI
      type: integer
      description: Sending MSI
      required: false
    GettingChunks:
      title: Getting Chunks
      type: integer
      description: Getting chunks
      required: false
    Aborted:
      title: Aborted
      type: integer
      description: Aborted
      required: false
    InvalidState:
      title: Invalid State
      type: integer
      description: Invalid state
      required: false
    BadArgument:
      title: Bad Argument
      type: integer
      description: Bad argument
      required: false
    EndedWithNoValidFolder:
      title: Ended With No Valid Folder
      type: integer
      description: Ended with no valid folder
      required: false
    MsiSendFail:
      title: MSI Send Fail
      type: integer
      description: MSI Send Fail
      required: false
    NewerInstalled:
      title: Newer Installed
      type: integer
      description: Newer installed
      required: false
    None:
      title: None
      type: integer
      description: None
      required: false
    Disconnected:
      title: Disconnected
      type: integer
      description: Disconnected
      required: false
    Succeeded:
      title: Succeeded
      type: integer
      description: Succeeded
      required: false
    EndedWithTooManySearches:
      title: Ended With Too Many Searches
      type: integer
      description: Ended with too many searches
      required: false
    FailedSending:
      title: Failed Sending
      type: integer
      description: Failed sending
      required: false
    ChunksRequired:
      title: Chunks Required
      type: integer
      description: Chunks required
      required: false
    Timeout:
      title: Timeout
      type: integer
      description: Timeout
      required: false
    EndedWithSensorTimeout:
      title: Ended With Sensor Timeout
      type: integer
      description: Ended with sensor timeout
      required: false
    UnauthorizedUser:
      title: Unauthorized User
      type: integer
      description: Unauthorized user
      required: false
    NotSupported:
      title: Not Supported
      type: integer
      description: Not supported
      required: false
    TimeoutSending:
      title: Timeout Sending
      type: integer
      description: Timeout sending
      required: false
    AbortTimeout:
      title: Abort Timeout
      type: integer
      description: Abort timeout
      required: false
    SendingPlatform:
      title: Sending Platform
      type: integer
      description: Sending platform
      required: false
    Primed:
      title: Primed
      type: integer
      description: Primed
      required: false
    FailedSendingToServer:
      title: Failed Sending To Server
      type: integer
      description: Failed sending to server
      required: false
    partialResponse:
      title: Partial Response
      type: integer
      description: Partial response
      required: false
  globalStats:
    stats:
      title: Stats
      type: stats
      description: Stats
      required: false
  response:
    globalStats:
      title: Global Stats
      type: globalStats
      description: Global stats
      required: false
    initiatorUser:
      title: Initiator User
      type: string
      description: Initiator user
      required: false
    abortHttpStatusCode:
      title: Abort HTTP Status Code
      type: string
      description: Abort HTTP status code
      required: false
    actionArguments:
      title: Action Arguments
      type: actionArguments
      description: Action arguments
      required: false
    abortTimeout:
      title: Abort Timeout
      type: boolean
      description: Abort timeout
      required: false
    aborterUser:
      title: Aborter User
      type: string
      description: Aborter user
      required: false
    batchId:
      title: Batch ID
      type: integer
      description: Batch ID
      required: false
    abortTime:
      title: Abort Time
      type: integer
      description: Abort time
      required: false
    actionType:
      title: Action Type
      type: string
      description: Action type
      required: false
    finalState:
      title: Final State
      type: boolean
      description: Final state
      required: false
    startTime:
      title: Start Time
      type: integer
      description: Start time
      required: false
    totalNumberOfProbes:
      title: Total Number Probes
      type: integer
      description: Total number of probes
      required: false
  statusLog:
    machineId:
      title: Machine ID
      description: The unique ID for the machine or machines on which the remediation was performed
      type: string
      required: false
    targetID:
      title: Target ID
      description: Reports a null value
      type: string
      required: false
    status:
      title: Status
      description: The status of the remediation request
      type: string
      required: false
    actionType:
      title: Action Type
      description: The type of action you attempted to perform
      type: string
      required: false
    timestamp:
      title: Timestamp
      description: The time (in epoch) of the status report for the remediation request
      type: integer
      required: false
  error:
    message:
      title: Message
      description: A description of the error
      type: string
      required: false
    errorType:
      title: Error Type
      description: The type of error
      type: string
      required: false
  remediate_items:
    malopId:
      title: Malop ID
      description: The numerical identifier of the Malop assigned by Cybereason
      type: string
      required: false
    remediationID:
      title: Remediation ID
      description: The numerical identifier of the Malop assigned by Cybereason
      type: string
      required: false
    start:
      title: Start
      description: The time (in epoch) that the remediation operation began
      type: integer
      required: false
    end:
      title: End
      description: The time (in epoch) that the remediation operation ended
      type: integer
      required: false
    initiatingUser:
      title: Initiating User
      description: The Cybereason user name of the user initiating the remediation
      type: string
      required: false
    statusLog:
      title: Status Log
      description: An object containing information about the remediation
      type: '[]statusLog'
      required: false
    error:
      title: Error
      description: An object containing details of the error
      type: '[]error'
      required: false
connection:
  hostname:
    title: Host
    description: Enter the hostname
    type: string
    required: true
    example: example.com
  port:
    description: Enter the port
    type: integer
    default: 8443
    required: true
    example: 8443
  credentials:
    title: Credentials
    description: Username and password
    type: credential_username_password
    required: false
    example: '{"username": "user@example.com", "password": "mypassword"}'
actions:
  search_for_files:
    title: Search for Files
    description: Find files on any machine in your environment with a Cybereason sensor installed
    input:
      server_filter:
        title: Server Filter
        description: A Sensor filters string for filtering sensors by different criteria such as operating system
        type: string
        required: false
        example: 'machineName: ["rapid7-windows"]'
      file_filter:
        title: File Filter
        description: A fileFilters object for filtering by machine name, folder, file creation or modification time or file size with operator Equals, NotEquals, ContainsIgnoreCase, NotContainsIgnoreCase and others
        type: string
        required: true
        example: 'fileName Equals: ["sample.py"]'
    output:
      response:
        title: Response
        description: Search file response
        type: response
        required: true
  isolate_machine:
    title: Isolate Machine
    description: Isolate or un-isolate a machine
    input:
      sensor:
        title: Sensor
        description: Sensor ID, hostname or IP address of the sensor to perform the action on
        type: string
        required: true
        example: 198.51.100.100
      quarantine_state:
        title: Quarantine State
        description: True to isolate the sensor, false to un-isolate it
        type: boolean
        required: true
        default: true
        example: true
      malop_id:
        title: Malop ID
        description: Malop ID to associate with the quarantine action
        type: string
        required: false
        example: "22.2787422324806222966"
    output:
      machine_id:
        title: Machine Pylum ID
        description: Machine Pylum ID
        type: string
        required: true
      success:
        title: Success
        description: Success
        type: boolean
        required: true
  quarantine_file:
    title: Quarantine File
    description: Quarantine a detected malicious file in a secure location or unquarantine a file
    input:
      malop_id:
        title: Malop ID
        description: Malop ID related to the file you wish to quarantine or unquarantine
        type: string
        required: true
        example: "22.2787422324806222966"
      sensor:
        title: Sensor
        description: The unique identifier of the machine you wish to perform the quarantine/unquarantine operation on, this can be an internal IPv4 address, hostname or sensor GUID
        type: string
        required: true
        example: "-1632138521.1198775089551518743"
      quarantine:
        title: Quaratine
        description: True to quarantine a file, False to remove file quarantine
        type: boolean
        required: true
        example: true
    output:
      remediate_items_response:
        title: Remediate Items Response
        description: Remediate items response
        type: remediate_items
        required: true
  remediate_items:
    title: Remediate Items
    description: Remediate a specific process, file or registry key if remediation is possible
    input:
      initiator_user_name:
        title: Initiator User Name
        description: Initiator user name
        type: string
        required: true
        example: user@example.com
      actions_by_machine:
        title: Actions by Machine
        description: Actions by machine
        type: object
        required: true
        example: '{"126811122.2298225282553311122": [{"targetId": "531122333.-3391199199911692223","actionType": "KILL_PROCESS"}]}'
      malop_id:
        title: Malop ID
        description: Malop ID to associate with the remediation actions
        type: string
        required: false
        example: "22.2787422324806222966"
    output:
      response:
        title: Malop Response
        description: Malop response
        type: remediate_items
        required: true
