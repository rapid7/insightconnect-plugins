# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Find files on any machine in your environment with a Cybereason sensor installed"


class Input:
    FILE_FILTER = "file_filter"
    SERVER_FILTER = "server_filter"


class Output:
    RESPONSE = "response"


class SearchForFilesInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "file_filter": {
      "type": "string",
      "title": "File Filter",
      "description": "A fileFilters object for filtering by machine name, folder, file creation or modification time or file size with operator Equals, NotEquals, ContainsIgnoreCase, NotContainsIgnoreCase and others",
      "order": 2
    },
    "server_filter": {
      "type": "string",
      "title": "Server Filter",
      "description": "A Sensor filters string for filtering sensors by different criteria such as operating system",
      "order": 1
    }
  },
  "required": [
    "file_filter"
  ],
  "definitions": {}
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SearchForFilesOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "response": {
      "$ref": "#/definitions/response",
      "title": "Response",
      "description": "Search file response",
      "order": 1
    }
  },
  "required": [
    "response"
  ],
  "definitions": {
    "response": {
      "type": "object",
      "title": "response",
      "properties": {
        "globalStats": {
          "$ref": "#/definitions/globalStats",
          "title": "Global Stats",
          "description": "Global stats",
          "order": 1
        },
        "initiatorUser": {
          "type": "string",
          "title": "Initiator User",
          "description": "Initiator user",
          "order": 2
        },
        "abortHttpStatusCode": {
          "type": "string",
          "title": "Abort HTTP Status Code",
          "description": "Abort HTTP status code",
          "order": 3
        },
        "actionArguments": {
          "$ref": "#/definitions/actionArguments",
          "title": "Action Arguments",
          "description": "Action arguments",
          "order": 4
        },
        "abortTimeout": {
          "type": "boolean",
          "title": "Abort Timeout",
          "description": "Abort timeout",
          "order": 5
        },
        "aborterUser": {
          "type": "string",
          "title": "Aborter User",
          "description": "Aborter user",
          "order": 6
        },
        "batchId": {
          "type": "integer",
          "title": "Batch ID",
          "description": "Batch ID",
          "order": 7
        },
        "abortTime": {
          "type": "integer",
          "title": "Abort Time",
          "description": "Abort time",
          "order": 8
        },
        "actionType": {
          "type": "string",
          "title": "Action Type",
          "description": "Action type",
          "order": 9
        },
        "finalState": {
          "type": "boolean",
          "title": "Final State",
          "description": "Final state",
          "order": 10
        },
        "startTime": {
          "type": "integer",
          "title": "Start Time",
          "description": "Start time",
          "order": 11
        },
        "totalNumberOfProbes": {
          "type": "integer",
          "title": "Total Number Probes",
          "description": "Total number of probes",
          "order": 12
        }
      }
    },
    "globalStats": {
      "type": "object",
      "title": "globalStats",
      "properties": {
        "stats": {
          "$ref": "#/definitions/stats",
          "title": "Stats",
          "description": "Stats",
          "order": 1
        }
      }
    },
    "stats": {
      "type": "object",
      "title": "stats",
      "properties": {
        "Aborting": {
          "type": "integer",
          "title": "Aborting",
          "description": "Aborting",
          "order": 1
        },
        "EndedWithYaraCompileError": {
          "type": "integer",
          "title": "Ended With Yara Compile Error",
          "description": "Ended with yara compile error",
          "order": 2
        },
        "AlreadyUpdated": {
          "type": "integer",
          "title": "Already Updated",
          "description": "Already updated",
          "order": 3
        },
        "EndedWithTooManyResults": {
          "type": "integer",
          "title": "Ended With Too Many Results",
          "description": "Ended with too many results",
          "order": 4
        },
        "UnknownProbe": {
          "type": "integer",
          "title": "Unknown Probe",
          "description": "Unknown probe",
          "order": 5
        },
        "Failed": {
          "type": "integer",
          "title": "Failed",
          "description": "Failed",
          "order": 6
        },
        "EndedWithUnsupportedFilter": {
          "type": "integer",
          "title": "Ended With Unsupported Filter",
          "description": "Ended with unsupported filter",
          "order": 7
        },
        "ProbeRemoved": {
          "type": "integer",
          "title": "Probe Removed",
          "description": "Probe removed",
          "order": 8
        },
        "EndedWithInvalidParam": {
          "type": "integer",
          "title": "Ended With Invalid Param",
          "description": "Ended with invalid param",
          "order": 9
        },
        "InProgress": {
          "type": "integer",
          "title": "In Progress",
          "description": "In progress",
          "order": 10
        },
        "Pending": {
          "type": "integer",
          "title": "Pending",
          "description": "Pending",
          "order": 11
        },
        "EndedWithUnknownError": {
          "type": "integer",
          "title": "Ended With Unknown Error",
          "description": "Ended with unknown error",
          "order": 12
        },
        "MsiFileCorrupted": {
          "type": "integer",
          "title": "MSI File Corrupted",
          "description": "MSI file corrupted",
          "order": 13
        },
        "Started": {
          "type": "integer",
          "title": "Started",
          "description": "Started",
          "order": 14
        },
        "SendingMsi": {
          "type": "integer",
          "title": "Sending MSI",
          "description": "Sending MSI",
          "order": 15
        },
        "GettingChunks": {
          "type": "integer",
          "title": "Getting Chunks",
          "description": "Getting chunks",
          "order": 16
        },
        "Aborted": {
          "type": "integer",
          "title": "Aborted",
          "description": "Aborted",
          "order": 17
        },
        "InvalidState": {
          "type": "integer",
          "title": "Invalid State",
          "description": "Invalid state",
          "order": 18
        },
        "BadArgument": {
          "type": "integer",
          "title": "Bad Argument",
          "description": "Bad argument",
          "order": 19
        },
        "EndedWithNoValidFolder": {
          "type": "integer",
          "title": "Ended With No Valid Folder",
          "description": "Ended with no valid folder",
          "order": 20
        },
        "MsiSendFail": {
          "type": "integer",
          "title": "MSI Send Fail",
          "description": "MSI Send Fail",
          "order": 21
        },
        "NewerInstalled": {
          "type": "integer",
          "title": "Newer Installed",
          "description": "Newer installed",
          "order": 22
        },
        "None": {
          "type": "integer",
          "title": "None",
          "description": "None",
          "order": 23
        },
        "Disconnected": {
          "type": "integer",
          "title": "Disconnected",
          "description": "Disconnected",
          "order": 24
        },
        "Succeeded": {
          "type": "integer",
          "title": "Succeeded",
          "description": "Succeeded",
          "order": 25
        },
        "EndedWithTooManySearches": {
          "type": "integer",
          "title": "Ended With Too Many Searches",
          "description": "Ended with too many searches",
          "order": 26
        },
        "FailedSending": {
          "type": "integer",
          "title": "Failed Sending",
          "description": "Failed sending",
          "order": 27
        },
        "ChunksRequired": {
          "type": "integer",
          "title": "Chunks Required",
          "description": "Chunks required",
          "order": 28
        },
        "Timeout": {
          "type": "integer",
          "title": "Timeout",
          "description": "Timeout",
          "order": 29
        },
        "EndedWithSensorTimeout": {
          "type": "integer",
          "title": "Ended With Sensor Timeout",
          "description": "Ended with sensor timeout",
          "order": 30
        },
        "UnauthorizedUser": {
          "type": "integer",
          "title": "Unauthorized User",
          "description": "Unauthorized user",
          "order": 31
        },
        "NotSupported": {
          "type": "integer",
          "title": "Not Supported",
          "description": "Not supported",
          "order": 32
        },
        "TimeoutSending": {
          "type": "integer",
          "title": "Timeout Sending",
          "description": "Timeout sending",
          "order": 33
        },
        "AbortTimeout": {
          "type": "integer",
          "title": "Abort Timeout",
          "description": "Abort timeout",
          "order": 34
        },
        "SendingPlatform": {
          "type": "integer",
          "title": "Sending Platform",
          "description": "Sending platform",
          "order": 35
        },
        "Primed": {
          "type": "integer",
          "title": "Primed",
          "description": "Primed",
          "order": 36
        },
        "FailedSendingToServer": {
          "type": "integer",
          "title": "Failed Sending To Server",
          "description": "Failed sending to server",
          "order": 37
        },
        "partialResponse": {
          "type": "integer",
          "title": "Partial Response",
          "description": "Partial response",
          "order": 38
        }
      }
    },
    "actionArguments": {
      "type": "object",
      "title": "actionArguments",
      "properties": {
        "yaraName": {
          "type": "string",
          "title": "Yara Name",
          "description": "Yara name",
          "order": 1
        },
        "machines": {
          "type": "array",
          "title": "Machines",
          "description": "Machines",
          "items": {
            "type": "string"
          },
          "order": 2
        },
        "filters": {
          "type": "array",
          "title": "Filters",
          "description": "Filters",
          "items": {
            "$ref": "#/definitions/filters"
          },
          "order": 3
        },
        "fileSearchRequestConfiguration": {
          "$ref": "#/definitions/fileSearchRequestConfiguration",
          "title": "File Search Request Configuration",
          "description": "File search request configuration",
          "order": 4
        }
      }
    },
    "filters": {
      "type": "object",
      "title": "filters",
      "properties": {
        "operator": {
          "type": "string",
          "title": "Operator",
          "description": "Operator",
          "order": 1
        },
        "values": {
          "type": "array",
          "title": "Values",
          "description": "Values",
          "items": {
            "type": "string"
          },
          "order": 2
        },
        "fieldName": {
          "type": "string",
          "title": "Field Name",
          "description": "Field name",
          "order": 3
        }
      }
    },
    "fileSearchRequestConfiguration": {
      "type": "object",
      "title": "fileSearchRequestConfiguration",
      "properties": {
        "minThrottleAmountMilli": {
          "type": "integer",
          "title": "Min Throttle Amount Milli",
          "description": "Min throttle amount milli",
          "order": 1
        },
        "diskRateBytesPerMilli": {
          "type": "integer",
          "title": "Disk Rate Bytes Per Milli",
          "description": "Disk rate bytes per milli",
          "order": 2
        },
        "minFileReadPriceMilli": {
          "type": "integer",
          "title": "Min File Read Price Milli",
          "description": "Min file read price milli",
          "order": 3
        },
        "cpuTrackingWindowMilli": {
          "type": "integer",
          "title": "CPU Tracking Window Milli",
          "description": "CPU tracking window milli",
          "order": 4
        },
        "targetCpuPercentage": {
          "type": "integer",
          "title": "Target CPU Percentage",
          "description": "Target CPU percentage",
          "order": 5
        },
        "maxResults": {
          "type": "integer",
          "title": "Max Results",
          "description": "Max results",
          "order": 6
        },
        "maxYaraTimeouts": {
          "type": "integer",
          "title": "Max Yara timeouts",
          "description": "Max yara timeouts",
          "order": 7
        },
        "timoutPerFileScan": {
          "type": "integer",
          "title": "Timout Per File Scan",
          "description": "Timout per file scan",
          "order": 8
        },
        "maxDiskIOWindowMilli": {
          "type": "integer",
          "title": "Max Disk IOWindow Milli",
          "description": "Max disk IO window milli",
          "order": 9
        },
        "searchTimeoutDataScanSec": {
          "type": "integer",
          "title": "Search Timeout Data Scan Sec",
          "description": "Search timeout data scan sec",
          "order": 10
        },
        "maxConcurrentFileSearches": {
          "type": "integer",
          "title": "Max Concurrent File Searches",
          "description": "Max concurrent file searches",
          "order": 11
        },
        "searchTimeoutSec": {
          "type": "integer",
          "title": "Search Timeout Sec",
          "description": "Search timeout sec",
          "order": 12
        },
        "shouldUseNewAPI": {
          "type": "boolean",
          "title": "Should Use New API",
          "description": "Should use new API",
          "order": 13
        },
        "maxReadBytesPerFile": {
          "type": "integer",
          "title": "Max Read Bytes Per File",
          "description": "Max read bytes per file",
          "order": 14
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
