# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Add scan results from a third-party vulnerability scanner"


class Input:
    OPERATION = "operation"
    SCAN_RESULTS = "scan_results"


class Output:
    COMMANDS_PROCESSED = "commands_processed"
    ERRORS = "errors"


class BulkAddScanResultInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "operation": {
      "type": "string",
      "title": "Operation",
      "description": "The operation to be performed when adding scan results. ScanFlush to remove existing scan results or ScanUpdate to keep existing scan results",
      "enum": [
        "ScanUpdate",
        "ScanFlush"
      ],
      "order": 2
    },
    "scan_results": {
      "type": "array",
      "title": "Scan Results",
      "description": "Host scan results to be added",
      "items": {
        "$ref": "#/definitions/scan_result"
      },
      "order": 1
    }
  },
  "required": [
    "operation"
  ],
  "definitions": {
    "scan_result": {
      "type": "object",
      "title": "scan_result",
      "properties": {
        "host": {
          "$ref": "#/definitions/host",
          "title": "Host",
          "description": "Add an untracked host to the network map",
          "order": 1
        },
        "scan_result_details": {
          "$ref": "#/definitions/result_details",
          "title": "Scan Result Details",
          "description": "Scan result for the host",
          "order": 2
        }
      }
    },
    "host": {
      "type": "object",
      "title": "host",
      "properties": {
        "ip_address": {
          "type": "string",
          "title": "IP Address",
          "description": "IP address",
          "order": 1
        },
        "operating_system": {
          "$ref": "#/definitions/os",
          "title": "Host Operating System",
          "description": "Host operating system",
          "order": 2
        }
      },
      "required": [
        "ip_address"
      ]
    },
    "os": {
      "type": "object",
      "title": "os",
      "properties": {
        "vendor": {
          "type": "string",
          "title": "Vendor",
          "description": "Vendor",
          "order": 1
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "Name",
          "order": 2
        },
        "version": {
          "type": "string",
          "title": "Version",
          "description": "Version",
          "order": 3
        }
      }
    },
    "result_details": {
      "type": "object",
      "title": "result_details",
      "properties": {
        "source_id": {
          "type": "string",
          "title": "Source ID",
          "description": "Application or source ID",
          "order": 1
        },
        "scanner_id": {
          "type": "string",
          "title": "Scanner ID",
          "description": "Scanner ID for the scanner that obtained the scan results",
          "order": 2
        },
        "vulnerability_id": {
          "type": "string",
          "title": "Vulnerability ID",
          "description": "Vulnerability ID",
          "order": 3
        },
        "vulnerability_title": {
          "type": "string",
          "title": "Vulnerability Title",
          "description": "Title of the vulnerability",
          "order": 4
        },
        "port": {
          "type": "string",
          "title": "Port",
          "description": "Port",
          "order": 5
        },
        "protocol_id": {
          "type": "string",
          "title": "Protocol ID",
          "description": "Protocol ID",
          "order": 6
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description",
          "order": 7
        },
        "cve_ids": {
          "type": "array",
          "title": "CVE IDs",
          "description": "The identification number associated with the vulnerability in MITRE's Common Vulnerabilities and Exposures (CVE) database (http://www.cve.mitre.org/)",
          "items": {
            "type": "string"
          },
          "order": 8
        },
        "bugtraq_ids": {
          "type": "array",
          "title": "Bugtraq IDs",
          "description": "The identification numbers associated with the vulnerability in the Bugtraq database (http://www.securityfocus.com/bid)",
          "items": {
            "type": "string"
          },
          "order": 9
        }
      },
      "required": [
        "scanner_id",
        "source_id",
        "vulnerability_id",
        "vulnerability_title"
      ]
    }
  }
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class BulkAddScanResultOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "commands_processed": {
      "type": "number",
      "title": "Commands Processed",
      "description": "Number of commands processed",
      "order": 2
    },
    "errors": {
      "type": "number",
      "title": "Errors",
      "description": "Number of errors",
      "order": 1
    }
  },
  "required": [
    "commands_processed",
    "errors"
  ],
  "definitions": {}
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
