#!/usr/bin/env python
# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import os
import json
from sys import argv

Name = "Cisco Firepower Management Center"
Vendor = "rapid7"
Version = "2.1.4"
Description = "[Cisco Firepower Management Center](https://www.cisco.com/c/en/us/products/security/firepower-management-center/index.html) is your administrative nerve center for managing critical Cisco network security solutions.The Cisco Firepower Management Center InsightConnect plugin allows you to block URLs and hosts. Firewall best practices for blocking and unblocking hosts is to add and remove address objects from a group attached to an existing firewall policy such as a deny-all rule.In this example, adding an address object to a group attached to a deny-all rule will block the host, and removing the address object from the same group would unblock the host. Automating firewall blocking can be accomplished using the address object management actions in this plugin"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import insightconnect_plugin_runtime
    from icon_cisco_firepower_management_center import connection, actions, triggers, tasks

    class ICONCiscoFirepowerManagementCenter(insightconnect_plugin_runtime.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_action(actions.BlockUrlPolicy())
        
            self.add_action(actions.CreateAddressObject())
        
            self.add_action(actions.DeleteAddressObject())
        
            self.add_action(actions.CheckIfAddressInGroup())
        
            self.add_action(actions.AddAddressToGroup())
        
            self.add_action(actions.RemoveAddressFromGroup())
        
            self.add_action(actions.AddScanResult())
        
            self.add_action(actions.BulkAddScanResult())
        

    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONCiscoFirepowerManagementCenter())
    cli.run()


if __name__ == "__main__":
    main()
