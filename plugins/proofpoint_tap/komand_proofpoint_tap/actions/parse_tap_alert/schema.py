# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Parses a TAP alert"


class Input:
    TAPALERT = "tapAlert"
    

class Output:
    RESULTS = "results"
    

class ParseTapAlertInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "tapAlert": {
      "type": "string",
      "title": "Proofpoint TAP Alert",
      "description": "A Proofpoint TAP alert",
      "order": 1
    }
  },
  "required": [
    "tapAlert"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class ParseTapAlertOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "results": {
      "$ref": "#/definitions/tapResults",
      "title": "Results",
      "description": "Proofpoint TAP results",
      "order": 1
    }
  },
  "definitions": {
    "browser": {
      "type": "object",
      "title": "browser",
      "properties": {
        "sourceIp": {
          "type": "string",
          "title": "Source IP",
          "description": "Source IP",
          "order": 2
        },
        "time": {
          "type": "string",
          "title": "Time",
          "description": "Time",
          "order": 1
        },
        "userAgent": {
          "type": "string",
          "title": "User Agent",
          "description": "User agent string",
          "order": 3
        }
      }
    },
    "message": {
      "type": "object",
      "title": "message",
      "properties": {
        "headerFrom": {
          "type": "string",
          "title": "Header From",
          "description": "Header from",
          "order": 5
        },
        "headerReplyto": {
          "type": "string",
          "title": "Header Reply To",
          "description": "Header reply to",
          "order": 6
        },
        "messageGuid": {
          "type": "string",
          "title": "Message GUID",
          "description": "Message GUID",
          "order": 7
        },
        "messageId": {
          "type": "string",
          "title": "Message ID",
          "description": "Message ID",
          "order": 8
        },
        "messageSize": {
          "type": "string",
          "title": "Message Size",
          "description": "Message size",
          "order": 10
        },
        "recipients": {
          "type": "string",
          "title": "Recipients",
          "description": "Recipients",
          "order": 2
        },
        "sender": {
          "type": "string",
          "title": "Sender",
          "description": "Sender",
          "order": 4
        },
        "senderIp": {
          "type": "string",
          "title": "Sender IP",
          "description": "Sender IP",
          "order": 9
        },
        "subject": {
          "type": "string",
          "title": "Subject",
          "description": "Subject",
          "order": 3
        },
        "threatId": {
          "type": "string",
          "title": "Threat ID",
          "description": "Unique identifier for this threat",
          "order": 11
        },
        "timeDelivered": {
          "type": "string",
          "title": "Time Delivered",
          "description": "Time delivered",
          "order": 1
        }
      }
    },
    "tapResults": {
      "type": "object",
      "title": "tapResults",
      "properties": {
        "browser": {
          "$ref": "#/definitions/browser",
          "title": "Browser",
          "description": "Browser information",
          "order": 3
        },
        "message": {
          "$ref": "#/definitions/message",
          "title": "Message",
          "description": "TAP alert meta data",
          "order": 2
        },
        "threat": {
          "$ref": "#/definitions/threat",
          "title": "Threat",
          "description": "Threat information",
          "order": 1
        }
      },
      "definitions": {
        "browser": {
          "type": "object",
          "title": "browser",
          "properties": {
            "sourceIp": {
              "type": "string",
              "title": "Source IP",
              "description": "Source IP",
              "order": 2
            },
            "time": {
              "type": "string",
              "title": "Time",
              "description": "Time",
              "order": 1
            },
            "userAgent": {
              "type": "string",
              "title": "User Agent",
              "description": "User agent string",
              "order": 3
            }
          }
        },
        "message": {
          "type": "object",
          "title": "message",
          "properties": {
            "headerFrom": {
              "type": "string",
              "title": "Header From",
              "description": "Header from",
              "order": 5
            },
            "headerReplyto": {
              "type": "string",
              "title": "Header Reply To",
              "description": "Header reply to",
              "order": 6
            },
            "messageGuid": {
              "type": "string",
              "title": "Message GUID",
              "description": "Message GUID",
              "order": 7
            },
            "messageId": {
              "type": "string",
              "title": "Message ID",
              "description": "Message ID",
              "order": 8
            },
            "messageSize": {
              "type": "string",
              "title": "Message Size",
              "description": "Message size",
              "order": 10
            },
            "recipients": {
              "type": "string",
              "title": "Recipients",
              "description": "Recipients",
              "order": 2
            },
            "sender": {
              "type": "string",
              "title": "Sender",
              "description": "Sender",
              "order": 4
            },
            "senderIp": {
              "type": "string",
              "title": "Sender IP",
              "description": "Sender IP",
              "order": 9
            },
            "subject": {
              "type": "string",
              "title": "Subject",
              "description": "Subject",
              "order": 3
            },
            "threatId": {
              "type": "string",
              "title": "Threat ID",
              "description": "Unique identifier for this threat",
              "order": 11
            },
            "timeDelivered": {
              "type": "string",
              "title": "Time Delivered",
              "description": "Time delivered",
              "order": 1
            }
          }
        },
        "threat": {
          "type": "object",
          "title": "threat",
          "properties": {
            "attachmentSha256": {
              "type": "string",
              "title": "Attachment SHA256 Hash",
              "description": "Attachment SHA256 hash",
              "order": 1
            },
            "category": {
              "type": "string",
              "title": "Category",
              "description": "Category",
              "order": 3
            },
            "condemnationTime": {
              "type": "string",
              "title": "Condemnation Time",
              "description": "Condemnation time",
              "order": 4
            },
            "threatDetailsUrl": {
              "type": "string",
              "title": "Threat Details URL",
              "description": "URL to the details of the threat",
              "order": 5
            },
            "url": {
              "type": "string",
              "title": "URL",
              "description": "URL",
              "order": 2
            }
          }
        }
      }
    },
    "threat": {
      "type": "object",
      "title": "threat",
      "properties": {
        "attachmentSha256": {
          "type": "string",
          "title": "Attachment SHA256 Hash",
          "description": "Attachment SHA256 hash",
          "order": 1
        },
        "category": {
          "type": "string",
          "title": "Category",
          "description": "Category",
          "order": 3
        },
        "condemnationTime": {
          "type": "string",
          "title": "Condemnation Time",
          "description": "Condemnation time",
          "order": 4
        },
        "threatDetailsUrl": {
          "type": "string",
          "title": "Threat Details URL",
          "description": "URL to the details of the threat",
          "order": 5
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "URL",
          "order": 2
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
