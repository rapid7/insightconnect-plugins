#!/usr/bin/env python
# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import os
import json
from sys import argv

Name = "AWS EC2"
Vendor = "rapid7"
Version = "1.3.1"
Description = "[Amazon EC2](https://aws.amazon.com/documentation/ec2) is a Amazon Elastic Compute Cloud (Amazon EC2) provides resizable computing capacity in the Amazon Web Services (AWS) cloud.This plugin allows security practitioners to perform host containment and implement security group policies in addition to general management of EC2 instances"


def main():
    if 'http' in argv:
        if os.environ.get("GUNICORN_CONFIG_FILE"):
            with open(os.environ.get("GUNICORN_CONFIG_FILE")) as gf:
                gunicorn_cfg = json.load(gf)
                if gunicorn_cfg.get("worker_class", "sync") == "gevent":
                    from gevent import monkey
                    monkey.patch_all()
        elif 'gevent' in argv:
            from gevent import monkey
            monkey.patch_all()

    import insightconnect_plugin_runtime
    from icon_aws_ec2 import connection, actions, triggers, tasks

    class ICONAwsEc2(insightconnect_plugin_runtime.Plugin):
        def __init__(self):
            super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
            )
            self.add_action(actions.AuthorizeSecurityGroupEgress())
        
            self.add_action(actions.AuthorizeSecurityGroupIngress())
        
            self.add_action(actions.DescribeInstances())
        
            self.add_action(actions.DescribeSecurityGroups())
        
            self.add_action(actions.RevokeSecurityGroupEgress())
        
            self.add_action(actions.RevokeSecurityGroupIngress())
        
            self.add_action(actions.UpdateSecurityGroupRuleDescriptionsEgress())
        
            self.add_action(actions.UpdateSecurityGroupRuleDescriptionsIngress())
        

    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONAwsEc2())
    cli.run()


if __name__ == "__main__":
    main()
