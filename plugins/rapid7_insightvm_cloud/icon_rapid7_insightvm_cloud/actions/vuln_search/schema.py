# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Search for vulnerabilities using filtered vulnerability search"


class Input:
    ASSET_CRITERIA = "asset_criteria"
    SIZE = "size"
    SORT_CRITERIA = "sort_criteria"
    VULN_CRITERIA = "vuln_criteria"
    

class Output:
    VULNERABILITIES = "vulnerabilities"
    

class VulnSearchInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "asset_criteria": {
      "type": "string",
      "title": "Asset Criteria",
      "description": "Filters to apply to the asset search such as IPv4 or IPv6 addresses and hostnames",
      "order": 3
    },
    "size": {
      "type": "integer",
      "title": "Size",
      "description": "The number of vulnerabilities to retrieve. If blank then will default to 200 vulnerabilities returned, the maximum limit is 500 vulnerabilities",
      "default": 200,
      "order": 1
    },
    "sort_criteria": {
      "type": "object",
      "title": "Sort Criteria",
      "description": "JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)",
      "order": 2
    },
    "vuln_criteria": {
      "type": "string",
      "title": "Vulnerability Criteria",
      "description": "Vulnerability criteria to filter by",
      "order": 4
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class VulnSearchOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "vulnerabilities": {
      "type": "array",
      "title": "Vulnerabilities",
      "description": "Vulnerabilities associated with the asset",
      "items": {
        "$ref": "#/definitions/vulnerability"
      },
      "order": 1
    }
  },
  "required": [
    "vulnerabilities"
  ],
  "definitions": {
    "vulnerability": {
      "type": "object",
      "title": "vulnerability",
      "properties": {
        "first_found": {
          "type": "string",
          "title": "First Found",
          "displayType": "date",
          "description": "Date the vulnerability was first found in InsightVM",
          "format": "date-time",
          "order": 1
        },
        "key": {
          "type": "string",
          "title": "Vulnerability Key",
          "description": "The key to identify a specific instance if the type is Instance",
          "order": 2
        },
        "last_found": {
          "type": "string",
          "title": "Last Found",
          "displayType": "date",
          "description": "Date the vulnerability was last found in InsightVM",
          "format": "date-time",
          "order": 3
        },
        "proof": {
          "type": "string",
          "title": "Proof",
          "description": "Proof of the vulnerability, i.e. \\u003cp\\u003e\\u003cp\\u003eOpenBSD OpenSSH 4.3 on Linux\\u003c/p\\u003e\\u003c/p\\u003e",
          "order": 4
        },
        "solution_fix": {
          "type": "string",
          "title": "Fix",
          "description": "The steps that are part of the fix this solution prescribes",
          "order": 5
        },
        "solution_id": {
          "type": "string",
          "title": "Solution ID",
          "description": "The identifier of the solution",
          "order": 6
        },
        "solution_summary": {
          "type": "string",
          "title": "Solution Summary",
          "description": "Remediation summary",
          "order": 7
        },
        "solution_type": {
          "type": "string",
          "title": "Solution Type",
          "description": "Remediation type",
          "order": 8
        },
        "status": {
          "type": "string",
          "title": "Status",
          "description": "Status, i.e. vulnerable",
          "order": 9
        },
        "vulnerability_id": {
          "type": "string",
          "title": "Vulnerability ID",
          "description": "The identifier of the vulnerability",
          "order": 10
        }
      },
      "required": [
        "solution_type"
      ]
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
