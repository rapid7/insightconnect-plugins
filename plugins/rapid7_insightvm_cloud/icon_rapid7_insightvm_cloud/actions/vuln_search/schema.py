# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Search for vulnerabilities using filtered vulnerability search"


class Input:
    SIZE = "size"
    SORT_CRITERIA = "sort_criteria"
    VULN_CRITERIA = "vuln_criteria"


class Output:
    VULNERABILITIES = "vulnerabilities"


class VulnSearchInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "size": {
      "type": "integer",
      "title": "Size",
      "description": "The number of vulnerabilities to retrieve. If blank then will default to 200 vulnerabilities returned, the maximum limit is 500 vulnerabilities",
      "default": 200,
      "order": 1
    },
    "sort_criteria": {
      "type": "object",
      "title": "Sort Criteria",
      "description": "JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)",
      "order": 2
    },
    "vuln_criteria": {
      "type": "string",
      "title": "Vulnerability Criteria",
      "description": "Vulnerability criteria to filter by",
      "order": 3
    }
  },
  "definitions": {}
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class VulnSearchOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(
        r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "vulnerabilities": {
      "type": "array",
      "title": "Vulnerabilities",
      "description": "Vulnerabilities associated with the asset",
      "items": {
        "$ref": "#/definitions/vulnerability"
      },
      "order": 1
    }
  },
  "required": [
    "vulnerabilities"
  ],
  "definitions": {
    "vulnerability": {
      "type": "object",
      "title": "vulnerability",
      "properties": {
        "title": {
          "type": "string",
          "title": "Title",
          "description": "Name of the vulnerability",
          "order": 1
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description of the vulnerability",
          "order": 2
        },
        "added": {
          "type": "string",
          "format": "date-time",
          "displayType": "date",
          "title": "Added",
          "description": "Date the vulnerability was last added to an asset",
          "order": 3
        },
        "modified": {
          "type": "string",
          "format": "date-time",
          "displayType": "date",
          "title": "Modified",
          "description": "Date the vulnerability was last modified",
          "order": 4
        },
        "published": {
          "type": "string",
          "format": "date-time",
          "displayType": "date",
          "title": "Published",
          "description": "Date the vulnerability was added to InsightVM",
          "order": 5
        },
        "categories": {
          "type": "string",
          "title": "Categories",
          "description": "Labels this vulnerability falls under",
          "order": 6
        },
        "cves": {
          "type": "string",
          "title": "CVES",
          "description": "CVES ID",
          "order": 7
        },
        "cvss_v2": {
          "$ref": "#/definitions/cvss_v2",
          "title": "CVSSv2",
          "description": "information regarding CVSSv2",
          "order": 8
        },
        "cvss_v3": {
          "$ref": "#/definitions/cvss_v3",
          "title": "CVSSv3",
          "description": "information regarding CVSSv3",
          "order": 9
        },
        "denial_of_service": {
          "type": "boolean",
          "title": "Denial of Service",
          "description": "Whether or not this vulnerability is a denial of service attack",
          "order": 10
        },
        "exploits": {
          "type": "array",
          "title": "Exploits",
          "description": "List of exploits related to the vulnerability",
          "items": {
            "$ref": "#/definitions/exploit"
          },
          "order": 11
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "ID of the vulnerability",
          "order": 12
        },
        "links": {
          "type": "array",
          "title": "Links",
          "description": "List of links related to the vulnerability",
          "items": {
            "$ref": "#/definitions/link"
          },
          "order": 13
        },
        "malware_kits": {
          "type": "array",
          "title": "Malware Kits",
          "description": "List of malware kits related to the vulnerability",
          "items": {
            "type": "object"
          },
          "order": 14
        },
        "pci": {
          "$ref": "#/definitions/pci",
          "title": "PCI",
          "description": "information regarding PCI",
          "order": 15
        },
        "references": {
          "type": "string",
          "title": "References",
          "description": "Links to information related to the vulnerability",
          "order": 16
        },
        "risk_score": {
          "type": "number",
          "title": "Risk Score",
          "description": "Risk score (with criticality adjustments) of the vulnerability",
          "order": 17
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "Severity of the vulnerability",
          "order": 18
        },
        "severity_score": {
          "type": "integer",
          "title": "Severity Score",
          "description": "Severity score of the vulnerability",
          "order": 19
        }
      },
      "required": [
        "categories",
        "id",
        "published",
        "risk_score",
        "severity",
        "severity_score"
      ]
    },
    "cvss_v2": {
      "type": "object",
      "title": "cvss_v2",
      "properties": {
        "access_complexity": {
          "type": "string",
          "title": "Access Complexity",
          "description": "CVSSv2 access complexity metric",
          "order": 1
        },
        "access_vector": {
          "type": "string",
          "title": "Access Vector",
          "description": "CVSSv2 access vector metric",
          "order": 2
        },
        "authentication": {
          "type": "string",
          "title": "Authentication",
          "description": "CVSSv2 authentication metric",
          "order": 3
        },
        "availability_impact": {
          "type": "string",
          "title": "Availability Impact",
          "description": "CVSSv2 availability impact metric",
          "order": 4
        },
        "confidentiality_impact": {
          "type": "string",
          "title": "Confidentiality Impact",
          "description": "CVSSv2 confidentiality impact metric",
          "order": 5
        },
        "exploit_score": {
          "type": "number",
          "title": "Exploit Score",
          "description": "CVSSv2 combined exploit metric score (Access Complexity/Access Vector/Authentication)",
          "order": 6
        },
        "impact_score": {
          "type": "number",
          "title": "Impact Score",
          "description": "CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)",
          "order": 7
        },
        "integrity_impact": {
          "type": "string",
          "title": "Integrity Impact",
          "description": "CVSSv2 integrity impact metric",
          "order": 8
        },
        "score": {
          "type": "number",
          "title": "Score",
          "description": "CVSSv2 score",
          "order": 9
        },
        "vector": {
          "type": "string",
          "title": "Vector",
          "description": "CVSSv2 combined vector string",
          "order": 10
        }
      }
    },
    "cvss_v3": {
      "type": "object",
      "title": "cvss_v3",
      "properties": {
        "attack_complexity": {
          "type": "string",
          "title": "Attack Complexity",
          "description": "CVSSv3 attack complexity metric",
          "order": 1
        },
        "attack_vector": {
          "type": "string",
          "title": "Attack Vector",
          "description": "CVSSv3 attack vector metric",
          "order": 2
        },
        "availability_impact": {
          "type": "string",
          "title": "Availability Impact",
          "description": "CVSSv3 availability impact metric",
          "order": 3
        },
        "confidentiality_impact": {
          "type": "string",
          "title": "Confidentiality Impact",
          "description": "CVSSv3 confidentiality impact metric",
          "order": 4
        },
        "exploit_score": {
          "type": "number",
          "title": "Exploit Score",
          "description": "CVSSv3 combined exploit metric score (Attack Complexity/Attack Vector/Privilege Required/Scope/User Interaction)",
          "order": 5
        },
        "impact_score": {
          "type": "number",
          "title": "Impact Score",
          "description": "CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)",
          "order": 6
        },
        "integrity_impact": {
          "type": "string",
          "title": "Integrity Impact",
          "description": "CVSSv3 integrity impact metric",
          "order": 7
        },
        "privilege_required": {
          "type": "string",
          "title": "Privilege Required",
          "description": "CVSSv3 privilege required metric",
          "order": 8
        },
        "scope": {
          "type": "string",
          "title": "Scope",
          "description": "CVSSv3 scope metric",
          "order": 9
        },
        "score": {
          "type": "number",
          "title": "Score",
          "description": "CVSSv3 score",
          "order": 10
        },
        "user_interaction": {
          "type": "string",
          "title": "User Interaction",
          "description": "CVSSv3 user interaction metric",
          "order": 11
        },
        "vector": {
          "type": "string",
          "title": "Vector",
          "description": "CVSSv3 combined vector string",
          "order": 12
        }
      }
    },
    "exploit": {
      "type": "object",
      "title": "exploit",
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "description": "A verbose description of the exploit",
          "order": 1
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "The identifier of the exploit",
          "order": 2
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The name of the exploit",
          "order": 3
        },
        "rank": {
          "type": "string",
          "title": "Rank",
          "description": "The exploit rank",
          "order": 4
        },
        "skill_level": {
          "type": "string",
          "title": "Skill level",
          "description": "The level of skill required to use the exploit",
          "order": 5
        },
        "source": {
          "type": "string",
          "title": "Source",
          "description": "Details about where the exploit is defined",
          "order": 6
        }
      },
      "required": [
        "description",
        "id",
        "name",
        "rank",
        "skill_level",
        "source"
      ]
    },
    "link": {
      "type": "object",
      "title": "link",
      "properties": {
        "href": {
          "type": "string",
          "title": "URL",
          "description": "A hypertext reference, which is either a URI (see RFC 3986) or URI template (see RFC 6570)",
          "order": 1
        },
        "rel": {
          "type": "string",
          "title": "Rel",
          "description": "Link relation type following RFC 5988",
          "order": 2
        }
      }
    },
    "pci": {
      "type": "object",
      "title": "pci",
      "properties": {
        "adjusted_CVSS_score": {
          "type": "integer",
          "title": "Adjusted CVSS score",
          "description": "PCI adjusted CVSS score",
          "order": 1
        },
        "adjusted_severity_score": {
          "type": "integer",
          "title": "Adjusted severity score",
          "description": "PCI adjusted severity score",
          "order": 2
        },
        "fail": {
          "type": "boolean",
          "title": "Fail",
          "description": "Whether this vulnerability results in a PCI assessment failure",
          "order": 3
        },
        "special_notes": {
          "type": "string",
          "title": "Special Notes",
          "description": "PCI special notes",
          "order": 4
        },
        "status": {
          "type": "string",
          "title": "Status",
          "description": "PCI status",
          "order": 5
        }
      }
    }
  }
}
    """
    )

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
