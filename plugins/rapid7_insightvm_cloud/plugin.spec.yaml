plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: rapid7_insightvm_cloud
title: Rapid7 InsightVM Cloud
description: InsightVM is a powerful vulnerability management tool which finds, prioritizes, and remediates vulnerabilities. This plugin uses the InsightVM Cloud Integrations API to view assets and start scans
version: 9.0.0
connection_version: 6
key_features:
  - "Perform scan management functionality including starting and checking the status of scans"
  - "Perform asset searches leveraging flexible asset and vulnerability filters"
  - "Retrieve individual asset information"
requirements:
  - "Requires an InsightVM API Key"
  - "InsightVM Scan Engine(s) paired to the Insight Platform"
version_history:
  - "9.0.0 - Refined pagination for `Asset Search` action | SDK Bump to 6.3.6 | Resolved issue in 'Asset Search' where 'Vulnerability Criteria' is appended onto 'Asset Criteria'"
  - "8.1.1 - Updated SDK to the latest version (v6.2.3) | Address vulnerabilities"
  - "8.1.0 - Action `Asset Search`: Added optional asset and vulnerability criteria logical operator | Updated action to return more than 500 results"
  - "8.0.0 - Output for `Asset Search` and `Get Asset` to label fields `ID` and `Solution Type` as un-required"
  - "7.0.0 - `Asset Search` and `Get Asset` actions output field `remediated` updated to type array of object"
  - "6.0.0 - Asset Search: Modify type of output field `new` when `comparison_time` input is used."
  - "5.0.0 - Vulnerability Search: fix malware_kits output and remove Asset Criteria input | Updated the documentation with links related to query builder and operators | Updated the SDK"
  - "4.0.0 - Vulnerability Search: fix schema validation problem for exploits field"
  - "3.3.0 - Asset Search: add filter fields: `current_time`, `comparison_time`"
  - "3.2.0 - Add vulnerability search action"
  - "3.1.0 - Add Cloud enablement to plugin | Updated exception information and error handling | Made status code output for Stop Scan and Get Scan actions more exact | Fix bug relating to empty inputs being passed in request body"
  - "3.0.0 - Changed output of Get Asset action to include vulnerabilities properly"
  - "2.2.0 - Added ability to include vulnerabilities on Get Asset action | API call update"
  - "2.1.0 - Added scanned asset_ids as an output of start_scan"
  - "2.0.0 - Fix issue where string data-type should be date in actions | Update docs"
  - "1.0.0 - Initial plugin"
links:
  - "[InsightVM Query Builder](https://docs.rapid7.com/insightvm/query-builder/)"
  - "[InsightVM Query Operators](https://docs.rapid7.com/insightvm/query-operators-1/)"
references:
  - "[InsightVM Cloud API](https://help.rapid7.com/insightvm/en-us/api/integrations.html)"
  - "[Managing Platform API Keys](https://docs.rapid7.com/insight/managing-platform-api-keys)"
  - "[Scan Engine Pairing](https://docs.rapid7.com/insightvm/scan-engine-management-on-the-insight-platform/#how-to-pair-your-scan-engines-to-the-insight-platform)"
vendor: rapid7
support: rapid7
supported_versions: ["InsightVM Cloud Integration API v4", "2024-06-19"]
status: []
cloud_ready: true
sdk:
  type: slim
  version: 6.3.6
  user: nobody
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/rapid7_insightvm_cloud
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.rapid7.com
tags:
  - insightvm
  - rapid7
  - vulnerability
hub_tags:
  use_cases: [asset_inventory, vulnerability_management]
  keywords: [insightvm, rapid7, cloud, cloud_enabled]
  features: []
types:
  link:
    href:
      description: A hypertext reference, which is either a URI (see RFC 3986) or
        URI template (see RFC 6570)
      title: URL
      type: string
      required: false
    rel:
      description: Link relation type following RFC 5988
      title: Rel
      type: string
      required: false
  address:
    ip:
      description: IPv4 or IPv6 address
      title: IP
      type: string
      required: false
    mac:
      description: Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48
      title: MAC
      type: string
      required: false
  configuration:
    name:
      description: Name of the configuration value
      title: Name
      type: string
      required: false
    value:
      description: Configuration value
      title: Value
      type: string
      required: false
  database:
    description:
      description: Description of the database instance
      title: Description
      type: string
      required: false
    id:
      description: Identifier of the database
      title: ID
      type: integer
      required: false
    name:
      description: Name of the database instance
      title: Name
      type: string
      required: false
  file:
    attributes:
      description: Attributes detected on the file
      title: Attributes
      type: '[]configuration'
      required: false
    name:
      description: Name of the file
      title: Name
      type: string
      required: false
    size:
      description: Size of the regular file (in bytes). If the file is a directory,
        no value is returned
      title: Size
      type: integer
      required: false
    type:
      description: Type of the file, e.g. file or directory
      title: Type
      type: string
      required: false
    content:
      description: Contents of the file
      title: Contents
      type: bytes
      required: false
  history:
    date:
      description: Date the asset information was collected or changed
      title: Date
      type: string
      required: false
    description:
      description: Additional information describing the change
      title: Description
      type: string
      required: false
    scanId:
      description: If a scan-oriented change, the identifier of the corresponding
        scan the asset was scanned in
      title: Scan ID
      type: integer
      required: false
    type:
      description: Type, for additional information see the help section of this plugin
      title: Type
      type: string
      required: false
    user:
      description: User
      title: User
      type: string
      required: false
    version:
      description: Version
      title: Version
      type: integer
      required: false
    vulnerability_exception_id:
      description: Vulnerability exception ID
      title: Vulnerability Exception ID
      type: integer
      required: false
  host_name:
    name:
      description: Name
      title: Name
      type: string
      required: false
    source:
      description: Source
      title: Source
      type: string
      required: false
  id:
    id:
      description: ID
      title: ID
      type: string
      required: false
    source:
      description: Source
      title: Source
      type: string
      required: false
  cpe:
    edition:
      description: Edition-related terms applied by the vendor to the product
      title: Edition
      type: string
      required: false
    language:
      description: Defines the language supported in the user interface of the product
        being described. The format of the language tag adheres to RFC 5646
      title: Language
      type: string
      required: false
    other:
      description: Captures any other general descriptive or identifying information
        which is vendor- or product-specific and which does not logically fit in any
        other attribute value
      title: Other
      type: string
      required: false
    part:
      description: A single letter code that designates the particular platform part
        that is being identified
      title: Part
      type: string
      required: false
    product:
      description: Most common and recognizable title or name of the product
      title: Product
      type: string
      required: false
    sw_edition:
      description: Characterizes how the product is tailored to a particular market
        or class of end users
      title: Software Edition
      type: string
      required: false
    target_HW:
      description: Characterize the instruction set architecture on which the product
        operates
      title: Target Hardware
      type: string
      required: false
    target_SW:
      description: Characterizes the software computing environment within which the
        product operates
      title: Target Software
      type: string
      required: false
    update:
      description: Vendor-specific alphanumeric strings characterizing the particular
        update, service pack, or point release of the product
      title: Update
      type: string
      required: false
    v2.2:
      description: The full CPE string in the CPE 2.2 format
      title: Version 2.2
      type: string
      required: false
    v2.3:
      description: The full CPE string in the CPE 2.3 format
      title: Version 2.3
      type: string
      required: false
    vendor:
      description: The person or organization that manufactured or created the product
      title: Vendor
      type: string
      required: false
    version:
      description: Vendor-specific alphanumeric strings characterizing the particular
        release version of the product
      title: Version
      type: string
      required: false
  os_fingerprint:
    architecture:
      description: The architecture of the operating system
      title: Architecture
      type: string
      required: false
    configurations:
      description: Configuration key-values pairs enumerated on the operating system
      title: Configuration
      type: '[]configuration'
      required: false
    cpe:
      description: Common Platform Enumeration
      title: CPE
      type: cpe
      required: false
    description:
      description: The description of the operating system (containing vendor, family,
        product, version and architecture in a single string)
      title: Description
      type: string
      required: false
    family:
      description: Family of the operating system
      title: Family
      type: string
      required: false
    id:
      description: Identifier of the operating system
      title: ID
      type: integer
      required: false
    product:
      description: Name of the operating system
      title: Product
      type: string
      required: false
    systemName:
      description: A combination of vendor and family (with redundancies removed),
        suitable for grouping
      title: System Name
      type: string
      required: false
    type:
      description: Type of operating system
      title: Type
      type: string
      required: false
    vendor:
      description: Vendor of the operating system
      title: Vendor
      type: string
      required: false
    version:
      description: Version of the operating system
      title: Version
      type: string
      required: false
  user_group:
    id:
      description: Identifier of the user group
      title: ID
      type: integer
      required: false
    name:
      description: Name of the user group
      title: Name
      type: string
      required: false
  user:
    full_name:
      description: Full name of the user account
      title: Full Name
      type: string
      required: false
    id:
      description: Identifier of the user account
      title: ID
      type: integer
      required: false
    name:
      description: Name of the user account
      title: Name
      type: string
      required: false
  page:
    link_type:
      description: Type of link used to traverse or detect the page
      title: Link Type
      type: string
      required: false
    path:
      description: Path to the page (URI)
      title: Path
      type: string
      required: false
    response:
      description: HTTP response code observed with retrieving the page
      title: Response
      type: integer
      required: false
  web_application:
    id:
      description: Identifier of the web application
      title: ID
      type: integer
      required: false
    pages:
      description: Pages
      title: Pages
      type: '[]page'
      required: false
    root:
      description: Web root of the web application
      title: Root
      type: string
      required: false
    virtual_host:
      description: Virtual host of the web application
      title: Virtual Host
      type: string
      required: false
  service:
    configurations:
      description: Configuration key-values pairs enumerated on the service
      title: Configurations
      type: '[]configuration'
      required: false
    databases:
      description: Databases enumerated on the service
      title: Databases
      type: '[]database'
      required: false
    family:
      description: Family of the service
      title: Family
      type: string
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
    name:
      description: Name of the service
      title: Name
      type: string
      required: false
    port:
      description: Port of the service
      title: Port
      type: integer
      required: false
    product:
      description: Product running the service
      title: Product
      type: string
      required: false
    protocol:
      description: Protocol of the service
      title: Protocol
      type: string
      required: false
    user_groups:
      description: User groups
      title: User Groups
      type: '[]user_group'
      required: false
    users:
      description: Users
      title: Users
      type: '[]user'
      required: false
    vendor:
      description: Vendor of the service
      title: Vendor
      type: string
      required: false
    version:
      description: Version of the service
      title: Version
      type: string
      required: false
    web_applications:
      description: Web applications found on the service
      title: Web Applications
      type: '[]web_application'
      required: false
  asset_vulnerability:
    first_found:
      title: First Found
      description: Date the vulnerability was first found in InsightVM
      type: date
      required: false
    key:
      title: Vulnerability Key
      description: The key to identify a specific instance if the type is Instance
      type: string
      required: false
    last_found:
      title: Last Found
      description: Date the vulnerability was last found in InsightVM
      type: date
      required: false
    proof:
      description: Proof of the vulnerability, i.e. <p><p>OpenBSD OpenSSH 4.3 on Linux</p></p>
      title: Proof
      type: string
      required: false
    solution_fix:
      title: Fix
      description: The steps that are part of the fix this solution prescribes
      type: string
      required: false
    solution_id:
      title: Solution ID
      description: The identifier of the solution
      type: string
      required: false
    solution_summary:
      title: Solution Summary
      description: Remediation summary
      type: string
      required: false
    solution_type:
      title: Solution Type
      description: Remediation type
      type: string
      required: false
    status:
      description: Status, i.e. vulnerable
      title: Status
      type: string
      required: false
    vulnerability_id:
      description: The identifier of the vulnerability
      title: Vulnerability ID
      type: string
      required: false
  software:
    configurations:
      description: Configurations
      title: Configurations
      type: '[]configuration'
      required: false
    cpe:
      description: CPE
      title: CPE
      type: cpe
      required: false
    description:
      description: Description of the software
      title: Description
      type: string
      required: false
    family:
      description: Family of the software
      title: Family
      type: string
      required: false
    id:
      description: ID
      title: ID
      type: integer
      required: false
    product:
      description: Product of the software
      title: Product
      type: string
      required: false
    type:
      description: Type of the software
      title: Type
      type: string
      required: false
    vendor:
      description: Vendor of the software
      title: Vendor
      type: string
      required: false
    version:
      description: Version of the software
      title: Version
      type: string
      required: false
  vulnerability_description:
    html:
      title: HTML
      description: Vulnerability description HTML
      type: string
    text:
      title: Text
      description: Vulnerability description raw text
      type: string
  pci:
    adjusted_CVSS_score:
      title: Adjusted CVSS score
      description: PCI adjusted CVSS score
      type: integer
    adjusted_severity_score:
      title: Adjusted severity score
      description: PCI adjusted severity score
      type: integer
    fail:
      title: Fail
      description: Whether this vulnerability results in a PCI assessment failure
      type: boolean
    special_notes:
      title: Special Notes
      description: PCI special notes
      type: string
    status:
      title: Status
      description: PCI status
      type: string
  cvss_v2:
    access_complexity:
      title: Access Complexity
      description: CVSSv2 access complexity metric
      type: string
    access_vector:
      title: Access Vector
      description: CVSSv2 access vector metric
      type: string
    authentication:
      title: Authentication
      description: CVSSv2 authentication metric
      type: string
    availability_impact:
      title: Availability Impact
      description: CVSSv2 availability impact metric
      type: string
    confidentiality_impact:
      title: Confidentiality Impact
      description: CVSSv2 confidentiality impact metric
      type: string
    exploit_score:
      title: Exploit Score
      description: CVSSv2 combined exploit metric score (Access Complexity/Access
        Vector/Authentication)
      type: float
    impact_score:
      title: Impact Score
      description: CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)
      type: float
    integrity_impact:
      title: Integrity Impact
      description: CVSSv2 integrity impact metric
      type: string
    score:
      title: Score
      description: CVSSv2 score
      type: float
    vector:
      title: Vector
      description: CVSSv2 combined vector string
      type: string
  cvss_v3:
    attack_complexity:
      title: Attack Complexity
      description: CVSSv3 attack complexity metric
      type: string
    attack_vector:
      title: Attack Vector
      description: CVSSv3 attack vector metric
      type: string
    availability_impact:
      title: Availability Impact
      description: CVSSv3 availability impact metric
      type: string
    confidentiality_impact:
      title: Confidentiality Impact
      description: CVSSv3 confidentiality impact metric
      type: string
    exploit_score:
      title: Exploit Score
      description: CVSSv3 combined exploit metric score (Attack Complexity/Attack
        Vector/Privilege Required/Scope/User Interaction)
      type: float
    impact_score:
      title: Impact Score
      description: CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)
      type: float
    integrity_impact:
      title: Integrity Impact
      description: CVSSv3 integrity impact metric
      type: string
    privilege_required:
      title: Privilege Required
      description: CVSSv3 privilege required metric
      type: string
    scope:
      title: Scope
      description: CVSSv3 scope metric
      type: string
    score:
      title: Score
      description: CVSSv3 score
      type: float
    user_interaction:
      title: User Interaction
      description: CVSSv3 user interaction metric
      type: string
    vector:
      title: Vector
      description: CVSSv3 combined vector string
      type: string
  cvss:
    links:
      title: Links
      description: List of hypermedia links to corresponding resources
      type: '[]link'
    v2:
      title: V2
      description: CVSSv2 details
      type: cvss_v2
    v3:
      title: V3
      description: CVSSv3 details
      type: cvss_v3
  creds:
    port:
      description: The port that is used
      title: Port
      type: integer
      required: false
    protocol:
      title: Protocol
      description: TCP or other
      type: string
      required: false
    status:
      title: Status
      description: Which creds apply
      type: string
      required: false
  identifiers:
    source:
      description: The source
      title: Source
      type: string
      required: false
    id:
      title: ID
      description: The ID
      type: string
      required: false
  asset_tag:
    name:
      description: The name
      title: Name
      type: string
      required: false
    type:
      title: Type
      description: The type
      type: string
      required: false
  asset:
    assessed_for_policies:
      description: Whether the asset has been assessed for policies at least once
      title: Assessed for Policies
      type: boolean
      required: false
    assessed_for_vulnerabilities:
      description: Whether the asset has been assessed for vulnerabilities at least
        once
      title: Assessed for Vulnerabilities
      type: boolean
      required: false
    credential_assessments:
      title: Credential Assessments
      description: Assessments from the credentials
      type: '[]creds'
      required: false
    critical_vulnerabilities:
      title: Critical Vulnerabilities
      description: Number of critical vulnerabilities
      type: integer
      required: false
    exploits:
      title: Exploits
      description: Number of exploits
      type: integer
      required: false
    host_name:
      description: Primary host name (local or FQDN) of the asset
      title: Hostname
      type: string
      required: false
    id:
      description: Identifier of the asset
      title: ID
      type: string
      required: false
    ip:
      description: Primary IPv4 or IPv6 address of the asset
      title: IP
      type: string
      required: false
    last_assessed_for_vulnerabilities:
      description: Date of last scan
      title: Last Assessed For Vulnerabilities
      type: string
      required: false
    last_scan_end:
      description: When the last scan was ended
      title: Last Scan End
      type: string
      required: false
    last_scan_start:
      description: When the last scan was started
      title: Last Scan Start
      type: string
      required: false
    mac:
      description: Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48
      title: MAC
      type: string
      required: false
    malware_kits:
      description: Number of malware kits
      title: Malware Kits
      type: integer
      required: false
    moderate_vulnerabilities:
      description: Number of moderate vulnerabilities
      title: Moderate Vulnerabilities
      type: integer
      required: false
    new:
      title: New
      description: If comparison time is supplied, the vulnerabilities that are new in the latest version at current time
      type: '[]object'
      required: false
    os_architecture:
      description: The architecture of the os
      title:  OS Architecture
      type: string
      required: false
    os_description:
      description: Description of the os
      title: OS Description
      type: string
      required: false
    os_family:
      description: Family of the os
      title: OS Family
      type: string
      required: false
    os_name:
      description: Name of the os
      title: OS Name
      type: string
      required: false
    os_system_name:
      description: Name of the system os
      title: OS System Name
      type: string
      required: false
    os_type:
      description: Type of os
      title: OS Type
      type: string
      required: false
    os_vendor:
      description: Vendor of the os
      title: OS Vendor
      type: string
      required: false
    os_version:
      description: The version of the operating system
      title: OS Version
      type: string
      required: false
    risk_score:
      description: Risk score (with criticality adjustments) of the asset
      title: Risk Score
      type: float
      required: false
    severe_vulnerabilities:
      description: The count of severe vulnerability findings
      title: Severe Vulnerabilities
      type: integer
      required: false
    tags:
      description: The tags applied to the asset
      title: Tags
      type: '[]asset_tag'
      required: false
    total_vulnerabilities:
      description: The total count of vulnerability findings
      title: Total Vulnerabilities
      type: integer
      required: false
    type:
      description: The type of asset
      title: Type
      type: string
      required: false
    source:
      description: Source of the asset
      title: Source
      type: string
      required: false
    unique_identifiers:
      description: Uniqure aspects of the asset
      title: Unique Identifiers
      type: '[]identifiers'
      required: false
    remediated:
      description: Vulnerabilities that were remediated in the latest version at current time for the asset
      title: Remediated Vulnerabilities
      type: '[]object'
      required: false
  exploit:
    description:
      title: Description
      description: A verbose description of the exploit
      type: string
      required: true
    id:
      title: ID
      description: The identifier of the exploit
      type: string
      required: true
    name:
      title: Name
      description: The name of the exploit
      type: string
      required: true
    rank:
      title: Rank
      description: The exploit rank
      type: string
      required: true
    skill_level:
      title: Skill level
      description: The level of skill required to use the exploit
      type: string
      required: true
    source:
      title: Source
      description: Details about where the exploit is defined
      type: string
      required: true
  vulnerability:
    title:
      title: Title
      description: Name of the vulnerability
      type: string
      required: false
    description:
      title: Description
      description: Description of the vulnerability
      type: string
      required: false
    added:
      title: Added
      description: Date the vulnerability was last added to an asset
      type: date
      required: false
    modified:
      title: Modified
      description: Date the vulnerability was last modified
      type: date
      required: false
    published:
      title: Published
      description: Date the vulnerability was added to InsightVM
      type: date
      required: true
    categories:
      title: Categories
      description: Labels this vulnerability falls under
      type: string
      required: true
    cves:
      title: CVES
      description: CVES ID
      type: string
      required: false
    cvss_v2:
      title: CVSSv2
      description: information regarding CVSSv2
      type: cvss_v2
      required: false
    cvss_v3:
      title: CVSSv3
      description: information regarding CVSSv3
      type: cvss_v3
      required: false
    denial_of_service:
      title: Denial of Service
      description: Whether or not this vulnerability is a denial of service attack
      type: boolean
      required: false
    exploits:
      title: Exploits
      description: List of exploits related to the vulnerability
      type: '[]exploit'
      required: false
    id:
      title: ID
      description: ID of the vulnerability
      type: string
      required: true
    links:
      title: Links
      description: List of links related to the vulnerability
      type: '[]link'
      required: false
    malware_kits:
      title: Malware Kits
      description: List of malware kits related to the vulnerability
      type: '[]object'
      required: false
    pci:
      title: PCI
      description: information regarding PCI
      type: pci
      required: false
    references:
      title: References
      description: Links to information related to the vulnerability
      type: string
      required: false
    risk_score:
      description: Risk score (with criticality adjustments) of the vulnerability
      title: Risk Score
      type: float
      required: true
    severity:
      title: Severity
      description: Severity of the vulnerability
      type: string
      required: true
    severity_score:
      title: Severity Score
      description: Severity score of the vulnerability
      type: integer
      required: true
connection:
  credentials:
    title: API Key
    description: API key from account
    type: credential_secret_key
    required: true
    example: 9de5069c5afe602b2ea0a04b66beb2c0
  region:
    title: Region
    description: the region in which the plugin will work
    type: string
    required: true
    enum:
      - us
      - us2
      - us3
      - eu
      - ca
      - au
      - ap
    example: us
actions:
  start_scan:
    title: Start Scan
    description: Start an InsightVM scan of previously scanned devices
    input:
      asset_ids:
        title: Asset IDs
        description: IDs of the assets to scan
        type: "[]string"
        required: false
        example: '["abc978-5678-abc-a5a94a1234b8-asset"]'
      name:
        title: Name
        description: The name of the scan
        type: string
        required: true
        example: "test cloud scan"
      ips:
        title: IPs
        description: List of IPv4 or IPv6 addresses to scan
        type: "[]string"
        required: false
        example: '["2001:db8:1:1:1:1:1:1"]'
      hostnames:
        title: Hostnames
        description: List of hostnames to scan
        type: "[]string"
        required: false
        example: '["rapid7.com"]'
    output:
      ids:
        description: List of identifiers of the scans started
        title: Scan IDs
        type: "[]string"
        required: false
        example: '["5058b0b4-701a-414e-9630-430d2cddbf4d"]'
      asset_ids:
        description: List of identifiers of the assets scanned
        title: Asset IDs
        type: "[]string"
        required: false
        example: '["5058b0b4-701a-414e-9630-430d2cddbf4d"]'
      data:
        description: Information received about the scan
        title: Data
        type: object
        required: false
        example: '{"scans":[{"engine_id":"5058b0b4-701a-414e-9630-430d2cddbf4d","id":"5058b0b4-701a-414e-9630-430d2cddbf4d","name":"TestScan","asset_ids":["5058b0b4-701a-414e-9630-430d2cddbf4d"]}],"unscanned_assets":[{"id":"5058b0b4-701a-414e-9630-430d2cddbf4d","reason":"Asset has never been scanned with an InsightVM Platform registered engine."}]}'
  get_scan:
    title: Get Scan
    description: Get the status of a scan
    input:
      scan_id:
        title: Scan ID
        description: ID of the scan to obtain
        type: string
        required: true
        example: "abb37782-df95-4cf6-b4c2-8d466ca57349"
    output:
      asset_ids:
        description: List of IDs of the scanned assets
        title: Asset IDs
        type: "[]string"
        required: false
        example: '["abc978-5678-abc-a5a94a1234b8-asset"]'
      scan_id:
        description: ID of the scan
        title: Scan ID
        type: string
        required: false
        example: "a9870dce1234180e202af83b66cd0c4b"
      name:
        description: User-driven scan name for the scan
        title: Name
        type: string
        required: false
        example: "testing scan action"
      status:
        description: Current status of the retrieved scan
        title: Status
        type: string
        required: false
        example: "Stopped"
      started:
        description: When the scan was started
        title: Started
        type: date
        required: false
        example: "2021-04-15T17:56:47Z"
      finished:
        description: When the scan was finished
        title: Finished
        type: date
        required: false
        example: "2021-04-15T18:00:33Z"
  asset_search:
    title: Asset Search
    description: Search for assets using filtered asset search
    input:
      size:
        title: Size
        description: The number of assets to retrieve. If blank then will default to 200 assets returned
        type: integer
        required: false
        default: 200
        example: 100
      sort_criteria:
        title: Sort Criteria
        description: JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)
        type: object
        required: false
        example: '{"risk-score": "asc", "criticality-tag": "desc"}'
      asset_criteria:
        title: Asset Criteria
        description: Filters to apply to the asset search such as IPv4 or IPv6 addresses and hostnames. Use '||' for OR and '&&' for AND
        type: string
        required: false
        example: "asset.ipv4 = 2001:db8:1:1:1:1:1:1 || asset.name STARTS WITH 'example'"
      vuln_criteria:
        title: Vulnerability Criteria
        description: Vulnerability criteria to filter by
        type: string
        required: false
        example: "vulnerability.categories IN ['example']"
      current_time:
        title: Current Time
        description: The current date and time to compare against the asset state to detect changes
        type: date
        required: false
        example: "2021-04-15T17:56:47Z"
      comparison_time:
        title: Comparison Time
        description: The date and time to compare the asset current state against to detect changes
        type: date
        required: false
        example: "2021-04-15T17:56:47Z"
    output:
      assets:
        title: Assets
        description: List of asset details returned by the search
        type: '[]asset'
        required: true
        example: '[{"assessed_for_policies":false,"assessed_for_vulnerabilities":true,"credential_assessments":[],"critical_vulnerabilities":12,"exploits":5,"id":"cdc978de-4178-a1d9-d5a94a114b87-example","ip":"2001:db8:1:1:1:1:1:1","last_assessed_for_vulnerabilities":"2020-06-25T15:19:51.543Z","last_scan_end":"2020-10-26T22:35:53.590Z","last_scan_start":"2020-10-26T22:35:53.564Z","mac":"00:50:56:94:52:04","malware_kits":0,"moderate_vulnerabilities":4,"new":[],"os_architecture":"","os_description":"Linux 2.6.32","os_family":"Linux","os_name":"Linux","os_system_name":"Linux","os_type":"General","os_vendor":"Linux","os_version":"2.6.32","remediated":[],"risk_score":9304.376953125,"severe_vulnerabilities":21,"tags":[{"name":"integrations discovery","type":"SITE"}],"total_vulnerabilities":37,"unique_identifiers":[]},{"assessed_for_policies":false,"assessed_for_vulnerabilities":true,"credential_assessments":[],"critical_vulnerabilities":12,"exploits":5,"id":"cdc978de-4178-a1d9-d5a94a114b87-example","ip":"2001:db8:1:1:1:1:1:1","last_assessed_for_vulnerabilities":"2020-06-25T15:19:51.543Z","last_scan_end":"2020-10-26T22:35:53.590Z","last_scan_start":"2020-10-26T22:35:53.564Z","mac":"00:50:56:94:52:04","malware_kits":0,"moderate_vulnerabilities":4,"new":[],"os_architecture":"","os_description":"Linux 2.6.32","os_family":"Linux","os_name":"Linux","os_system_name":"Linux","os_type":"General","os_vendor":"Linux","os_version":"2.6.32","remediated":[],"risk_score":9304.376953125,"severe_vulnerabilities":21,"tags":[{"name":"integrations discovery","type":"SITE"}],"total_vulnerabilities":37,"unique_identifiers":[]}]'
  get_asset:
    title: Get Asset
    description: Get an asset by ID
    input:
      id:
        title: ID
        description: Get an asset by ID
        type: string
        example: "abc978-5678-abc-a5a94a1234b8-asset"
        required: true
      include_vulns:
        title: Include Vulnerabilities
        description: Whether or not the list of vulnerabilities should be returned
        type: boolean
        required: false
        default: false
        example: true
    output:
      asset:
        title: Asset
        description: Asset details
        type: asset
        required: true
        example: '{"assessed_for_policies":false,"assessed_for_vulnerabilities":true,"credential_assessments":[{"port":22,"protocol":"TCP","status":"NO_CREDS_SUPPLIED"}],"critical_vulnerabilities":1,"exploits":2,"host_name":"example.rapid7.com","id":"cdc978de-4178-a1d9-d5a94a114b87-example","ip":"2001:db8:1:1:1:1:1:1","last_assessed_for_vulnerabilities":"2021-04-26T08:04:28.536Z","last_scan_end":"2021-04-26T08:04:28.536Z","last_scan_start":"2021-04-26T08:00:56.006Z","mac":"00:50:56:94:42:6B","malware_kits":0,"moderate_vulnerabilities":7,"new":[],"remediated":[],"risk_score":9006.3388671875,"severe_vulnerabilities":19,"tags":[{"name":"sn_pt_LDAP Admins","type":"OWNER"},{"name":"sn_CAB Approval","type":"OWNER"},{"name":"integrations","type":"CUSTOM"},{"name":"ck_test_site_2","type":"SITE"},{"name":"integrations","type":"SITE"},{"name":"ck_test_site_3","type":"SITE"},{"name":"integrations discovery","type":"SITE"},{"name":"ck_test_site_1","type":"SITE"}],"total_vulnerabilities":27,"unique_identifiers":[]}'
      vulnerabilities:
        title: Vulnerabilities
        description: Vulnerabilities associated with the asset
        type: '[]asset_vulnerability'
        required: false
        example: []
  stop_scan:
    title: Stop Scan
    description: Stop a scan in progress
    input:
      id:
        title: ID
        description: Scan ID
        type: string
        example: "abb37782-df95-4cf6-b4c2-8d466ca5734"
        required: true
    output:
      success:
        title: Success
        description: Was operation successful
        type: boolean
        required: true
        example: true
      status_code:
        title: Status Code
        description: Code returned by API call
        type: integer
        required: false
        example: 400
      message:
        title: Message
        description: Reason why the action failed
        type: string
        required: false
        example: "The scan could not be stopped"
  vuln_search:
    title: Vulnerability Search
    description: Search for vulnerabilities using filtered vulnerability search
    input:
      size:
        title: Size
        description: The number of vulnerabilities to retrieve. If blank then will default to 200 vulnerabilities returned, the maximum limit is 500 vulnerabilities
        type: integer
        required: false
        default: 200
        example: 100
      sort_criteria:
        title: Sort Criteria
        description: JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)
        type: object
        required: false
        example: '{"risk-score": "asc", "criticality-tag": "desc"}'
      vuln_criteria:
        title: Vulnerability Criteria
        description: Vulnerability criteria to filter by
        type: string
        required: false
        example: "vulnerability.categories IN ['example']"
    output:
      vulnerabilities:
        title: Vulnerabilities
        description: Vulnerabilities associated with the asset
        type: '[]vulnerability'
        required: true
        example: '[{"added":"2018-05-16T00:00:00Z","categories":"7-Zip","cves":"CVE-1234-5678","cvss_v2_access_complexity":"low","cvss_v2_access_vector":"network","cvss_v2_authentication":"none","cvss_v2_availability_impact":"complete","cvss_v2_confidentiality_impact":"complete","cvss_v2_exploit_score":9.996799945831299,"cvss_v2_impact_score":10.000845454680942,"cvss_v2_integrity_impact":"complete","cvss_v2_score":10,"cvss_v2_vector":"(AV:N/AC:L/Au:N/C:C/I:C/A:C)","cvss_v3_attack_complexity":null,"cvss_v3_attack_vector":null,"cvss_v3_availability_impact":null,"cvss_v3_confidentiality_impact":null,"cvss_v3_exploit_score":0,"cvss_v3_impact_score":null,"cvss_v3_integrity_impact":null,"cvss_v3_privileges_required":null,"cvss_v3_scope":null,"cvss_v3_score":0,"cvss_v3_user_interaction":null,"cvss_v3_vector":null,"denial_of_service":false,"description":"Unspecified vulnerability in 7-zip before 4.5.7 has unknown impact and remote attack vectors, as demonstrated by the PROTOS GENOME test suite for Archive Formats (c10).","exploits":[],"id":"7-zip-cve-1234-5678","links":[{"href":"http://www.example.com","id":"http://www.example.com","source":"url"}],"malware_kits":[],"modified":"2018-06-08T00:00:00Z","pci_cvss_score":10,"pci_fail":true,"pci_severity_score":5,"pci_special_notes":"","pci_status":"fail","published":"2009-03-29T00:00:00Z","references":"http://www.example.com","risk_score":898.76,"severity":"critical","severity_score":10,"title":"7-Zip: CVE-1234-5678: Unspecified vulnerability in 7-zip before 4.5.7"},{"added":"2018-05-16T00:00:00Z","categories":"7-Zip,Remote Execution","cves":"CVE-1234-5678","cvss_v2_access_complexity":"medium","cvss_v2_access_vector":"network","cvss_v2_authentication":"none","cvss_v2_availability_impact":"complete","cvss_v2_confidentiality_impact":"complete","cvss_v2_exploit_score":8.588799953460693,"cvss_v2_impact_score":10.000845454680942,"cvss_v2_integrity_impact":"complete","cvss_v2_score":9.3,"cvss_v2_vector":"(AV:N/AC:M/Au:N/C:C/I:C/A:C)","cvss_v3_attack_complexity":"low","cvss_v3_attack_vector":"local","cvss_v3_availability_impact":"high","cvss_v3_confidentiality_impact":"high","cvss_v3_exploit_score":1.8345765900000002,"cvss_v3_impact_score":5.873118720000001,"cvss_v3_integrity_impact":"high","cvss_v3_privileges_required":"none","cvss_v3_scope":"unchanged","cvss_v3_score":7.8,"cvss_v3_user_interaction":"required","cvss_v3_vector":"CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H","denial_of_service":false,"description":"Heap-based buffer overflow in the NArchive::NHfs::CHandler::ExtractZlibFile method in 7zip before 16.00 and p7zip allows remote attackers to execute arbitrary code via a crafted HFS+ image.","exploits":[],"id":"7-zip-cve-1234-5678","links":[{"href":"http://www.example.com","id":"http://www.example.com","source":"url"}],"malware_kits":[],"modified":"2018-06-08T00:00:00Z","pci_cvss_score":9.3,"pci_fail":true,"pci_severity_score":5,"pci_special_notes":"","pci_status":"fail","published":"2016-12-13T00:00:00Z","references":"http://www.example.com","risk_score":718.8,"severity":"critical","severity_score":9,"title":"7-Zip: CVE-1234-5678: Heap-based buffer overflow vulnerability"}]'
