plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: rapid7_insightvm
title: Rapid7 InsightVM Console
description: InsightVM is a powerful vulnerability management tool which finds, prioritizes, and remediates vulnerabilities. This plugin uses an orchestrator to get top remediations, scan results and start scans
version: 6.1.0
supported_versions: ["Rapid7 InsightVM API v3 2022-05-25"]
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/plugins/rapid7_insightvm
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.rapid7.com
tags:
- insightvm
- rapid7
hub_tags:
  use_cases: [asset_inventory, remediation_management, vulnerability_management, reporting_and_analytics]
  keywords: [insightvm, rapid7]
  features: []
types:
  report_id:
    id:
      description: Identifer
      title: Report ID
      type: integer
      required: false
    name:
      title: Report Name
      description: Name of report
      type: string
      required: false
  link:
    href:
      description: A hypertext reference, which is either a URI (see RFC 3986) or
        URI template (see RFC 6570)
      title: URL
      type: string
      required: false
    rel:
      description: Link relation type following RFC 5988
      title: Rel
      type: string
      required: false
  fingerprint:
    description:
      title: Description
      type: string
      required: false
    family:
      title: Family
      type: string
      required: false
    product:
      title: Product
      type: string
      required: false
    vendor:
      title: Vendor
      type: string
      required: false
    version:
      title: Version
      type: string
      required: false
  match:
    confidence:
      title: Confidence
      type: string
      required: false
    fingerprint:
      title: Fingerprint
      type: fingerprint
      required: false
  step:
    html:
      title: HTML
      type: string
      required: false
    text:
      title: text
      type: string
      required: false
  summary:
    html:
      title: HTML
      type: string
      required: false
    text:
      title: text
      type: string
      required: false
  resources:
    appliesTo:
      title: Applies To
      type: string
      required: false
    confidence:
      title: Confidence
      type: string
      required: false
    estimate:
      title: Estimate
      type: string
      required: false
    id:
      title: ID
      type: string
      required: false
    links:
      title: links
      type: '[]link'
      required: false
    type:
      title: Type
      type: string
      required: false
    matches:
      title: Matches
      type: '[]match'
      required: false
    steps:
      title: Steps
      type: step
      required: false
    summary:
      title: Summary
      type: summary
      required: false
  address:
    ip:
      description: IPv4 or IPv6 address
      title: IP
      type: string
      required: false
    mac:
      description: Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48
      title: MAC
      type: string
      required: false
  configuration:
    name:
      description: Name of the configuration value
      title: Name
      type: string
      required: false
    value:
      description: Configuration value
      title: Value
      type: string
      required: false
  database:
    description:
      description: Description of the database instance
      title: Description
      type: string
      required: false
    id:
      description: Identifier of the database
      title: ID
      type: integer
      required: false
    name:
      description: Name of the database instance
      title: Name
      type: string
      required: false
  insightvm_file:
    attributes:
      description: Attributes detected on the file
      title: Attributes
      type: '[]configuration'
      required: false
    name:
      description: Name of the file
      title: Name
      type: string
      required: false
    size:
      description: Size of the regular file (in bytes). If the file is a directory,
        no value is returned
      title: Size
      type: integer
      required: false
    type:
      description: Type of the file, e.g. file or directory
      title: Type
      type: string
      required: false
    content:
      description: Contents of the file
      title: Contents
      type: bytes
      required: false
  history:
    date:
      description: Date the asset information was collected or changed
      title: Date
      type: string
      required: false
    description:
      description: Additional information describing the change
      title: Description
      type: string
      required: false
    scanId:
      description: If a scan-oriented change, the identifier of the corresponding
        scan the asset was scanned in
      title: Scan ID
      type: integer
      required: false
    type:
      description: Type, for additional information see the help section of this plugin
      title: Type
      type: string
      required: false
    user:
      description: User
      title: User
      type: string
      required: false
    version:
      description: Version
      title: Version
      type: integer
      required: false
    vulnerabilityExceptionId:
      description: Vulnerability exception ID
      title: Vulnerability Exception ID
      type: integer
      required: false
  hostName:
    name:
      description: Name
      title: Name
      type: string
      required: false
    source:
      description: Source
      title: Source
      type: string
      required: false
  id:
    id:
      description: ID
      title: ID
      type: string
      required: false
    source:
      description: Source
      title: Source
      type: string
      required: false
  cpe:
    edition:
      description: Edition-related terms applied by the vendor to the product
      title: Edition
      type: string
      required: false
    language:
      description: Defines the language supported in the user interface of the product
        being described. The format of the language tag adheres to RFC 5646
      title: Language
      type: string
      required: false
    other:
      description: Captures any other general descriptive or identifying information
        which is vendor- or product-specific and which does not logically fit in any
        other attribute value
      title: Other
      type: string
      required: false
    part:
      description: A single letter code that designates the particular platform part
        that is being identified
      title: Part
      type: string
      required: false
    product:
      description: Most common and recognizable title or name of the product
      title: Product
      type: string
      required: false
    swEdition:
      description: Characterizes how the product is tailored to a particular market
        or class of end users
      title: Software Edition
      type: string
      required: false
    targetHW:
      description: Characterize the instruction set architecture on which the product
        operates
      title: Target Hardware
      type: string
      required: false
    targetSW:
      description: Characterizes the software computing environment within which the
        product operates
      title: Target Software
      type: string
      required: false
    update:
      description: Vendor-specific alphanumeric strings characterizing the particular
        update, service pack, or point release of the product
      title: Update
      type: string
      required: false
    v2.2:
      description: The full CPE string in the CPE 2.2 format
      title: Version 2.2
      type: string
      required: false
    v2.3:
      description: The full CPE string in the CPE 2.3 format
      title: Version 2.3
      type: string
      required: false
    vendor:
      description: The person or organization that manufactured or created the product
      title: Vendor
      type: string
      required: false
    version:
      description: Vendor-specific alphanumeric strings characterizing the particular
        release version of the product
      title: Version
      type: string
      required: false
  osFingerprint:
    architecture:
      description: The architecture of the operating system
      title: Architecture
      type: string
      required: false
    configurations:
      description: Configuration key-values pairs enumerated on the operating system
      title: Configuration
      type: '[]configuration'
      required: false
    cpe:
      description: Common Platform Enumeration
      title: CPE
      type: cpe
      required: false
    description:
      description: The description of the operating system (containing vendor, family,
        product, version and architecture in a single string)
      title: Description
      type: string
      required: false
    family:
      description: Family of the operating system
      title: Family
      type: string
      required: false
    id:
      description: Identifier of the operating system
      title: ID
      type: integer
      required: false
    product:
      description: Name of the operating system
      title: Product
      type: string
      required: false
    systemName:
      description: A combination of vendor and family (with redundancies removed),
        suitable for grouping
      title: System Name
      type: string
      required: false
    type:
      description: Type of operating system
      title: Type
      type: string
      required: false
    vendor:
      description: Vendor of the operating system
      title: Vendor
      type: string
      required: false
    version:
      description: Version of the operating system
      title: Version
      type: string
      required: false
  userGroup:
    id:
      description: Identifier of the user group
      title: ID
      type: integer
      required: false
    name:
      description: Name of the user group
      title: Name
      type: string
      required: false
  user:
    fullName:
      description: Full name of the user account
      title: Full Name
      type: string
      required: false
    id:
      description: Identifier of the user account
      title: ID
      type: integer
      required: false
    name:
      description: Name of the user account
      title: Name
      type: string
      required: false
  page:
    linkType:
      description: Type of link used to traverse or detect the page
      title: Link Type
      type: string
      required: false
    path:
      description: Path to the page (URI)
      title: Path
      type: string
      required: false
    response:
      description: HTTP response code observed with retrieving the page
      title: Response
      type: integer
      required: false
  webApplication:
    id:
      description: Identifier of the web application
      title: ID
      type: integer
      required: false
    pages:
      description: Pages
      title: Pages
      type: '[]page'
      required: false
    root:
      description: Web root of the web application
      title: Root
      type: string
      required: false
    virtualHost:
      description: Virtual host of the web application
      title: Virtual Host
      type: string
      required: false
  service:
    configurations:
      description: Configuration key-values pairs enumerated on the service
      title: Configurations
      type: '[]configuration'
      required: false
    databases:
      description: Databases enumerated on the service
      title: Databases
      type: '[]database'
      required: false
    family:
      description: Family of the service
      title: Family
      type: string
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
    name:
      description: Name of the service
      title: Name
      type: string
      required: false
    port:
      description: Port of the service
      title: Port
      type: integer
      required: false
    product:
      description: Product running the service
      title: Product
      type: string
      required: false
    protocol:
      description: Protocol of the service
      title: Protocol
      type: string
      required: false
    userGroups:
      description: User groups
      title: User Groups
      type: '[]userGroup'
      required: false
    users:
      description: Users
      title: Users
      type: '[]user'
      required: false
    vendor:
      description: Vendor of the service
      title: Vendor
      type: string
      required: false
    version:
      description: Version of the service
      title: Version
      type: string
      required: false
    webApplications:
      description: Web applications found on the service
      title: Web Applications
      type: '[]webApplication'
      required: false
  software:
    configurations:
      description: Configurations
      title: Configurations
      type: '[]configuration'
      required: false
    cpe:
      description: CPE
      title: CPE
      type: cpe
      required: false
    description:
      description: Description of the software
      title: Description
      type: string
      required: false
    family:
      description: Family of the software
      title: Family
      type: string
      required: false
    id:
      description: ID
      title: ID
      type: integer
      required: false
    product:
      description: Product of the software
      title: Product
      type: string
      required: false
    type:
      description: Type of the software
      title: Type
      type: string
      required: false
    vendor:
      description: Vendor of the software
      title: Vendor
      type: string
      required: false
    version:
      description: Version of the software
      title: Version
      type: string
      required: false
  vulnerabilities:
    critical:
      description: Number of critical vulnerabilities
      title: Critical
      type: integer
      required: false
    exploits:
      description: Number of distinct exploits that can exploit any of the vulnerabilities
        on the asset
      title: Exploits
      type: integer
      required: false
    malwareKits:
      description: Number of distinct malware kits that vulnerabilities on the asset
        are susceptible to
      title: Malware Kits
      type: integer
      required: false
    moderate:
      description: Number of moderate vulnerabilities
      title: Moderate
      type: integer
      required: false
    severe:
      description: Number of severe vulnerabilities
      title: Severe
      type: integer
      required: false
    total:
      description: Total number of vulnerabilities
      title: Total
      type: integer
      required: false
  vulnerabilities_count:
    critical:
      description: Number of critical vulnerabilities
      title: Critical
      type: integer
      required: false
    moderate:
      description: Number of moderate vulnerabilities
      title: Moderate
      type: integer
      required: false
    severe:
      description: Number of severe vulnerabilities
      title: Severe
      type: integer
      required: false
    total:
      description: Total
      title: Total number of vulnerabilities
      type: integer
      required: false
  vulnerability_exception:
    expires:
      title: Expires
      description: The date and time the vulnerability exception is set to expire
      type: date
      required: false
    state:
      title: State
      description: The state of the vulnerability exception
      type: string
      required: true
      enum:
      - deleted
      - expired
      - approved
      - rejected
      - under review
    id:
      title: Vulnerability Exception ID
      description: The ID uniquely identifying the vulnerability exception
      type: integer
      required: true
    scope:
      title: Exception Scope
      description: Details of the scope of the exception
      type: object
      required: true
    submit:
      title: Submission Details
      description: Details of the exception submission
      type: object
      required: true
    review:
      title: Review Details
      description: Details of the exception review
      type: object
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
  exception_review:
    comment:
      title: Review Comment
      description: The comment from the reviewer detailing the review
      type: string
      required: false
    date:
      title: Review Date
      description: The date and time the review took place
      type: date
      required: false
    name:
      title: Reviewer Name
      description: The login name of the user that reviewed the vulnerability exception
      type: string
      required: false
    user:
      title: Reviewer ID
      description: The identifier of the user that reviewed the vulnerability exception
      type: integer
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
  exception_submit:
    comment:
      title: Submit Comment
      description: The comment from the submit detailing the exception
      type: string
      required: false
    date:
      title: Submit Date
      description: The date and time the exception request took place
      type: date
      required: false
    name:
      title: Submitter Name
      description: The login name of the user that submitted the vulnerability exception
      type: string
      required: false
    user:
      title: Submitter ID
      description: The identifier of the user that submitted the vulnerability exception
      type: integer
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
  exception_scope:
    id:
      title: Vulnerability Scope ID
      description: The identifer of the scope (asset, group, site) the vulnerability exception applies to
      type: integer
      required: true
    key:
      title: Exception Scope Key
      description: Optional key to discriminate the instance when the scope type is Instance
      type: string
      required: false
    port:
      title: Port
      description: If the scope type is Instance, the port the exception applies to
      type: integer
      required: false
    type:
      title: Exception Scope Type
      description: The type of vulnerability exception - Global, Site, Asset, Asset Group, Instance
      type: string
      required: true
      enum:
      - Global
      - Site
      - Asset
      - Asset Group
      - Instance
    vulnerability:
      title: Vulnerability
      description: The vulnerability the exception applies to
      type: string
      required: true
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
  asset:
    addresses:
      description: All addresses discovered on the asset
      title: Addresses
      type: '[]address'
      required: false
    assessedForPolicies:
      description: Whether the asset has been assessed for policies at least once
      title: Assessed for Policies
      type: boolean
      required: false
    assessedForVulnerabilities:
      description: Whether the asset has been assessed for vulnerabilities at least
        once
      title: Assessed for Vulnerabilities
      type: boolean
      required: false
    configurations:
      description: Configuration key-values pairs enumerated on the asset
      title: Configurations
      type: '[]configuration'
      required: false
    databases:
      description: Databases enumerated on the asset
      title: Databases
      type: '[]database'
      required: false
    files:
      description: Files discovered with searching on the asset
      title: Files
      type: '[]insightvm_file'
      required: false
    history:
      description: History of changes to the asset over time
      title: History
      type: '[]history'
      required: false
    hostName:
      description: Primary host name (local or FQDN) of the asset
      title: Hostname
      type: string
      required: false
    hostNames:
      description: All hostnames or aliases discovered on the asset
      title: Hostnames
      type: '[]hostName'
      required: false
    id:
      description: Identifier of the asset
      title: ID
      type: integer
      required: false
    ids:
      description: Unique identifiers found on the asset, such as hardware or operating
        system identifiers
      title: IDs
      type: '[]id'
      required: false
    ip:
      description: Primary IPv4 or IPv6 address of the asset
      title: IP
      type: string
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
    mac:
      description: Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48
      title: MAC
      type: string
      required: false
    os:
      description: Full description of the operating system of the asset
      title: OS
      type: string
      required: false
    osFingerprint:
      description: Details of the operating system of the asset
      title: OS Fingerprint
      type: osFingerprint
      required: false
    rawRiskScore:
      description: Base risk score of the asset
      title: Raw Risk Score
      type: float
      required: false
    riskScore:
      description: Risk score (with criticality adjustments) of the asset
      title: Risk Score
      type: float
      required: false
    services:
      description: Services discovered on the asset
      title: Services
      type: '[]service'
      required: false
    software:
      description: Software discovered on the asset
      title: Software
      type: '[]software'
      required: false
    type:
      description: Type of asset e.g. unknown, guest, hypervisor, physical, mobile
      title: Type
      type: string
      required: false
    userGroups:
      description: User group accounts enumerated on the asset
      title: User Groups
      type: '[]userGroup'
      required: false
    users:
      description: User accounts enumerated on the asset
      title: Users
      type: '[]user'
      required: false
    vulnerabilities:
      description: ' Summary information for vulnerabilities on the asset'
      title: Vulnerabilities
      type: vulnerabilities
      required: false
  asset_vulnerability_result:
    checkId:
      description: Check ID, ie. ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack
      title: Check ID
      type: string
      required: false
    exceptions:
      description: If the result is vulnerable with exceptions applied, the identifier(s)
        of the exceptions actively applied to the result
      title: Exceptions
      type: '[]integer'
      required: false
    key:
      description: An additional discriminating key used to uniquely identify between
        multiple instances of results on the same finding
      title: Key
      type: string
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
    port:
      description: Port of the service the result was discovered on e.g. 22
      title: Port
      type: integer
      required: false
    proof:
      description: Proof of the vulnerability, ie. <p><p>OpenBSD OpenSSH 4.3 on Linux</p></p>
      title: Proof
      type: string
      required: false
    protocol:
      description: Protocol of the service the result was discovered on, ie. TCP
      title: Protocol
      type: string
      required: false
    status:
      description: Status of the vulnerability check result, ie. vulnerable-version
      title: Status
      type: string
      required: false
  asset_vulnerability:
    id:
      description: Vulnerability ID, ie. ssh-openssh-x11uselocalhost-x11-forwarding-session-hijack
      title: ID
      type: string
      required: false
    instances:
      description: Identifier of the report instance
      title: Instances
      type: integer
      required: false
    links:
      description: Hypermedia links to corresponding or related resources
      title: Links
      type: '[]link'
      required: false
    results:
      description: The vulnerability check results for the finding. Multiple instances
        may be present if one or more checks fired, or a check has multiple independent
        results
      title: Results
      type: '[]asset_vulnerability_result'
      required: false
    since:
      description: The date when this vulnerability was first detected
      title: Since
      type: string
      required: false
    status:
      description: Status, ie. vulnerable
      title: Status
      type: string
      required: false
    risk_score:
      title: Risk Score
      description: The risk score for the vulnerability
      type: float
      required: false
  site:
    assets:
      title: Assets
      description: Site asset count
      type: integer
      required: true
    connectionType:
      title: Connection Type
      description: Site discovery connection type (if applicable)
      type: string
      required: false
    description:
      title: Description
      description: Site description
      type: string
      required: false
    id:
      title: ID
      description: Identifier of the site
      type: integer
      required: true
    importance:
      title: Importance
      description: Site importance, used with the 'weighted' risk scoring strategy
      type: string
      required: true
    lastScanTime:
      title: Last Scan Time
      description: Site last scan time
      type: date
      required: false
    links:
      title: Links
      description: Hypermedia links to corresponding or related resources
      type: '[]link'
      required: true
    name:
      title: Name
      description: Site name
      type: string
      required: true
    riskScore:
      title: Risk Score
      description: Site risk score
      type: float
      required: true
    scanEngine:
      title: Scan Engine
      description: Site default scan engine ID
      type: integer
      required: true
    scanTemplate:
      title: Scan Template
      description: Site default scan template
      type: string
      required: true
    type:
      title: Type
      description: Site type
      type: string
      required: true
    vulnerabilities:
      title: Vulnerabilities
      description: Site vulnerability counts
      type: vulnerabilities_count
      required: true
  asset_group:
    assets:
      title: Assets
      description: Site asset count
      type: integer
      required: true
    description:
      title: Description
      description: Asset group description
      type: string
      required: false
    id:
      title: ID
      description: Site ID
      type: integer
      required: true
    links:
      title: Links
      description: Hypermedia links to corresponding or related resources
      type: '[]link'
      required: true
    name:
      title: Name
      description: Asset group name
      type: string
      required: true
    riskScore:
      title: Risk Score
      description: Site risk score
      type: float
      required: true
    searchCriteria:
      title: Search Criteria
      description: Asset group search criteria
      type: object
      required: false
    type:
      title: Type
      description: Asset group type
      type: string
      required: true
    vulnerabilities:
      title: Vulnerabilities
      description: Asset group vulnerability counts
      type: vulnerabilities_count
      required: true
  vulnerability_description:
    html:
      title: HTML
      description: Vulnerability description HTML
      type: string
    text:
      title: Text
      description: Vulnerability description raw text
      type: string
  pci:
    adjustedCVSSScore:
      title: Adjusted CVSS score
      description: PCI adjusted CVSS score
      type: integer
    adjustedSeverityScore:
      title: Adjusted severity score
      description: PCI adjusted severity score
      type: integer
    fail:
      title: Fail
      description: Whether this vulnerability results in a PCI assessment failure
      type: boolean
    specialNotes:
      title: Special Notes
      description: PCI special notes
      type: string
    status:
      title: Status
      description: PCI status
      type: string
  cvss_v2:
    accessComplexity:
      title: Access Complexity
      description: CVSSv2 access complexity metric
      type: string
    accessVector:
      title: Access Vector
      description: CVSSv2 access vector metric
      type: string
    authentication:
      title: Authentication
      description: CVSSv2 authentication metric
      type: string
    availabilityImpact:
      title: Availability Impact
      description: CVSSv2 availability impact metric
      type: string
    confidentialityImpact:
      title: Confidentiality Impact
      description: CVSSv2 confidentiality impact metric
      type: string
    exploitScore:
      title: Exploit Score
      description: CVSSv2 combined exploit metric score (Access Complexity/Access
        Vector/Authentication)
      type: float
    impactScore:
      title: Impact Score
      description: CVSSv2 combined impact metric score (Confidentiality/Integrity/Availability)
      type: float
    integrityImpact:
      title: Integrity Impact
      description: CVSSv2 integrity impact metric
      type: string
    score:
      title: Score
      description: CVSSv2 score
      type: float
    vector:
      title: Vector
      description: CVSSv2 combined vector string
      type: string
  cvss_v3:
    attackComplexity:
      title: Attack Complexity
      description: CVSSv3 attack complexity metric
      type: string
    attackVector:
      title: Attack Vector
      description: CVSSv3 attack vector metric
      type: string
    availabilityImpact:
      title: Availability Impact
      description: CVSSv3 availability impact metric
      type: string
    confidentialityImpact:
      title: Confidentiality Impact
      description: CVSSv3 confidentiality impact metric
      type: string
    exploitScore:
      title: Exploit Score
      description: CVSSv3 combined exploit metric score (Attack Complexity/Attack
        Vector/Privilege Required/Scope/User Interaction)
      type: float
    impactScore:
      title: Impact Score
      description: CVSSv3 combined impact metric score (Confidentiality/Integrity/Availability)
      type: float
    integrityImpact:
      title: Integrity Impact
      description: CVSSv3 integrity impact metric
      type: string
    privilegeRequired:
      title: Privilege Required
      description: CVSSv3 privilege required metric
      type: string
    scope:
      title: Scope
      description: CVSSv3 scope metric
      type: string
    score:
      title: Score
      description: CVSSv3 score
      type: float
    userInteraction:
      title: User Interaction
      description: CVSSv3 user interaction metric
      type: string
    vector:
      title: Vector
      description: CVSSv3 combined vector string
      type: string
  cvss:
    links:
      title: Links
      description: List of hypermedia links to corresponding resources
      type: '[]link'
    v2:
      title: V2
      description: CVSSv2 details
      type: cvss_v2
    v3:
      title: V3
      description: CVSSv3 details
      type: cvss_v3
  vulnerability:
    added:
      title: Added
      description: Date that the vulnerability was added to InsightVM
      type: date
    exploits:
      title: Exploits
      description: Exploit count
      type: integer
    description:
      title: Description
      description: Vulnerability description
      type: vulnerability_description
    links:
      title: Links
      description: List of hypermedia links to corresponding resources
      type: '[]link'
    title:
      title: Title
      description: Vulnerability title
      type: string
    malwareKits:
      title: Malware Kits
      description: Malware kit count
      type: integer
    denialOfService:
      title: Denial of Service
      description: Whether the vulnerability is a denial of service vulnerability
      type: boolean
    modified:
      title: Modified
      description: Date the vulnerability was last modified in InsightVM
      type: date
    id:
      title: ID
      description: Vulnerability ID
      type: string
    severityScore:
      title: Severity Score
      description: Vulnerability severity score
      type: integer
    pci:
      title: PCI
      description: Vulnerability PCI details
      type: pci
    published:
      title: Published
      description: Date the vulnerability was published
      type: date
    severity:
      title: Severity
      description: Vulnerability severity string (Moderate/Severe/Critical)
      type: string
    riskScore:
      title: Risk Score
      description: Vulnerability risk score using the configured risk scoring strategy
        (RealRisk by default)
      type: float
    cvss:
      title: CVSS
      description: Vulnerability CVSS details
      type: cvss
    categories:
      title: Categories
      description: List of vulnerabilities categories with which this vulnerability
        is affiliated
      type: '[]string'
    cves:
      title: CVEs
      description: List of CVE identifiers associated with this vulnerability
      type: '[]string'
  tag:
    color:
      title: Color
      description: Tag color
      type: string
      required: false
    created:
      title: Created
      description: Tag creation date
      type: date
      require: false
    id:
      title: ID
      description: Tag ID
      type: integer
      required: true
    links:
      title: Links
      description: Hypermedia links to corresponding or related resources
      type: '[]link'
      required: false
    name:
      title: Name
      description: Tag name
      type: string
      required: true
    riskModifier:
      title: Risk Modifier
      description: Tag risk score modifier
      type: string
      required: false
    searchCriteria:
      title: Search Criteria
      description: Tag search criteria
      type: object
      required: false
    source:
      title: Source
      description: Tag source
      type: string
      required: false
    type:
      title: Type
      description: Tag type
      type: string
      required: true
  tag_asset:
    id:
      title: ID
      description: Asset ID
      type: integer
      required: true
    sources:
      title: Sources
      description: Tag association sources
      type: '[]string'
      required: true
  scan:
    status:
      title: Status
      description: Scan status (aborted, unknown, running, finished, stopped, error,
        paused, dispatched, integrating)
      type: string
    scanType:
      title: Scan Type
      description: Type of scan (automated, manual, scheduled)
      type: string
    assets:
      title: Assets
      description: Count of assets identified during the scan
      type: integer
    links:
      title: Links
      description: List of hypermedia links to corresponding resources
      type: '[]link'
    siteName:
      title: Site Name
      description: Name of the site scanned
      type: string
    vulnerabilities:
      title: Vulnerabilities
      description: Counts of vulnerabilities identified during the scan
      type: vulnerabilities_count
    startedBy:
      title: Started By
      description: User that started the scan
      type: string
    engineId:
      title: Engine ID
      description: ID for the scan engine/scan engine pool used for the scan
      type: integer
    siteId:
      title: Site ID
      description: ID of the site scanned
      type: integer
    startTime:
      title: Start Time
      description: Start time for the scan
      type: date
    duration:
      title: Duration
      description: Duration of the scan
      type: date
    engineName:
      title: Engine Name
      description: Name of the scan engine/scan engine pool used for the scan
      type: string
    message:
      title: Message
      description: Scan status message
      type: string
    endTime:
      title: End Time
      description: End time of the scan
      type: date
    id:
      title: ID
      description: ID of the scan
      type: integer
    scanName:
      title: Scan Name
      description: Name of the scan
      type: string
  scan_engine:
    address:
      title: Address
      description: Scan engine address (IP/hostname)
      type: string
      required: true
    contentVersion:
      title: Content Version
      description: Scan engine content version
      type: string
      required: false
    enginePools:
      title: Engine Pools
      description: Engine pool IDs with which the scan engine is associated
      type: '[]integer'
      required: true
    id:
      title: ID
      description: Scan engine identifier
      type: integer
      required: true
    lastRefreshedDate:
      title: Last Refreshed Date
      description: Date and time when the engine last communicated with the console
      type: date
      required: false
    lastUpdatedDate:
      title: Last Updated Date
      description: Date and time when the engine was last updated
      type: date
      required: false
    links:
      title: Links
      description: List of hypermedia links to corresponding resources
      type: '[]link'
      required: true
    name:
      title: Name
      description: Scan engine name
      type: string
      required: true
    port:
      title: Port
      description: Scan engine communication port
      type: integer
      required: true
    productVersion:
      title: Product Version
      description: Scan engine product version
      type: string
      required: false
    sites:
      title: Sites
      description: Sites with which the scan engine is associated
      type: '[]integer'
      required: false
  scan_engine_pool:
    name:
      title: Name
      description: Scan engine pool name
      type: string
      required: true
    id:
      title: ID
      description: Scan engine pool identifier
      type: integer
      required: true
    engines:
      title: Engines
      description: List of scan engine IDs associated with the scan engine pool
      type: '[]integer'
      required: true
    links:
      title: Links
      description: List of hypermedia links to corresponding resources
      type: '[]link'
      required: true
  authentication_source:
    external:
      title: External
      description: Whether the authentication source is external (true) or internal
        (false)
      type: boolean
      required: true
    id:
      title: ID
      description: Authentication source identifier
      type: integer
      required: true
    links:
      title: Links
      description: List of hypermedia links to corresponding or related resources
      type: '[]link'
      required: true
    name:
      title: Name
      description: Authentication source name
      type: string
      required: true
    type:
      title: Type
      description: Authentication source type
      type: string
      required: true
      enum:
      - normal
      - kerberos
      - ldap
      - saml
      - admin
  role:
    description:
      title: Description
      description: The description of the role
      type: string
      required: true
    id:
      titler: ID
      description: ID of the role, e.g 'global-admin'
      type: string
      required: true
    links:
      title: Links
      description: List of hypermedia links to corresponding or related resources
      type: '[]link'
      required: true
    name:
      title: Name
      description: Name of the role
      type: string
      required: true
    privileges:
      title: Privileges
      description: List of privileges assigned to the role
      type: '[]string'
      required: true
  user_account_role:
    allAssetGroups:
      title: All Asset Groups
      description: Whether the user has access to all asset groups
      type: boolean
      required: false
    allSites:
      title: All Sites
      description: Whether the user has access to all sites
      type: boolean
      required: false
    id:
      title: ID
      description: The identifier of the role the user is assigned to
      type: string
      required: false
    privileges:
      title: Privileges
      desceiption: The privileges granted to the user by their role
      type: '[]string'
      required: false
    superuser:
      title: Superuser
      description: Whether the user is a superuser
      type: boolean
      required: false
  user_account_locale:
    default:
      title: Default
      description: Default locale
      type: string
      required: true
    reports:
      title: Reports
      description: Reports locale
      type: string
      required: true
  user_account:
    authentication:
      title: Authentication
      description: The authentication source used to authenticate the user
      type: authentication_source
      required: false
    email:
      title: Email
      description: The email address of the user
      type: string
      required: false
    enabled:
      title: Enabled
      description: Whether the user account is enabled
      type: boolean
      required: false
    id:
      title: ID
      description: The identifier of the user
      type: integer
      required: false
    links:
      title: Links
      description: List of hypermedia links to corresponding or related resources
      type: '[]link'
      required: false
    locale:
      title: Locale
      description: The locale and language preferences for the user
      type: user_account_locale
      required: false
    locked:
      title: Locked
      description: Whether the user account is locked (exceeded maximum password retry
        attempts)
      type: boolean
      required: true
    login:
      title: Login
      description: The login name of the user
      type: string
      required: true
    name:
      title: Name
      description: The full name of the user
      type: string
      required: true
    role:
      title: Role
      description: The privileges and role the user is assigned
      type: user_account_role
      required: false
  remediation_asset:
    id:
      description: Identifier of the asset
      title: ID
      type: integer
      required: true
    hostName:
      description: Primary host name (local or FQDN) of the asset
      title: Hostname
      type: string
      required: false
    ip:
      description: Primary IPv4 or IPv6 address of the asset
      title: IP
      type: string
      required: true
    mac:
      description: Media Access Control (MAC) address, e.g. AF:12:BC:5A:F7:48
      title: MAC
      type: string
      required: false
    os:
      description: Full description of the operating system of the asset
      title: OS
      type: string
      required: false
    riskScore:
      description: Risk score (with criticality adjustments) of the asset
      title: Risk Score
      type: float
      required: false
    criticalityTag:
      description: The criticality tag assigned to the asset
      title: Criticality Tag
      type: string
      required: false
  remediation_vulnerability:
    id:
      title: ID
      description: Identifier of the vulnerability
      type: integer
      required: true
    title:
      title: Title
      description: The title of the vulnerability
      type: string
      required: true
    description:
      title: Description
      description: The description of the vulnerability
      type: string
      required: true
    cvssScore:
      title: CVSS Score
      description: The CVSS score of the vulnerability
      type: string
      required: true
    severity:
      title: Severity
      description: The severity of the vulnerability
      type: integer
      required: true
    riskScore:
      title: Risk Score
      description: The risk score of the vulnerability
      type: integer
      required: true
  remediation:
    solutionId:
      title: Solution ID
      description: The identifier of the solution
      type: integer
      required: true
    nexposeId:
      title: Rapid7 Solution ID
      description: The identifier of the solution within InsightVM/Nexpose
      type: string
      required: true
    summary:
      title: Summary
      description: Remediation summary
      type: string
      required: true
    fix:
      title: Fix
      description: The steps that are part of the fix this solution prescribes
      type: string
      required: false
    assetCount:
      title: Asset Count
      description: The number of assets that require the solution to be applied
      type: integer
      required: true
    vulnerabilityCount:
      title: Vulnerability Count
      description: The number of vulnerabilities that would be remediated
      type: integer
      required: true
    riskScore:
      title: Risk Score
      description: The risk score that is reduced by performing the solution
      type: integer
      required: true
    assets:
      title: Assets
      description: The assets that require the solution to be applied
      type: '[]remediation_asset'
      required: true
    vulnerabilities:
      title: Vulnerabilities
      description: The vulnerabilities that would be remediated
      type: '[]remediation_vulnerability'
      required: true
  vulnerability_solution:
    links:
      title: Links
      description: Hypermedia links to corresponding or related resources
      type: '[]link'
      required: false
    resources:
      title: Solutions
      description: Solutions to vulnerabilities
      type: '[]resources'
      required: false
  account:
    authentication_type:
      title: Authentication Type
      description: The authentication protocols available to use in SNMP v3
      type: string
      required: false
      default: no-authentication
      enum:
        - no-authentication
        - md5
        - sha
    community_name:
      title: Community Name
      description: The community name that will be used for authenticating
      type: string
      required: false
    database:
      title: Database
      description: The name of the database. If not specified, a default database name will be used during authentication
      type: string
      required: false
    domain:
      title: Domain
      description: The address of the domain. This property cannot be specified unless property useWindowsAuthentication is set to true
      type: string
      required: false
    enumerate_sids:
      title: Enumerate SIDs
      description: Boolean flag instructing the scan engine to attempt to enumerate SIDs from your environment. If set to true, set the Oracle Net Listener password in property oracleListenerPassword
      type: string
      required: false
    notes_id_password:
      title: Notes ID Password
      description: The password for the account that will be used for authenticating
      type: string
      required: false
    ntlm_hash:
      title: NTLM Hash
      description: The NTLM password hash
      type: string
      required: false
    oracle_listener_password:
      title: Oracle Listener Password
      description: The Oracle Net Listener password. Used to enumerate SIDs from your environment
      type: string
      required: false
    password:
      title: Password
      description: The password for the account that will be used for authenticating
      type: string
      required: false
    pem_key:
      title: PEM Key
      description: The PEM-format private key
      type: string
      required: false
    permission_elevation:
      title: Permission Evaluation
      description: Elevate scan engine permissions to administrative or root access, which is necessary to obtain certain data during the scan. Defaults to "none" if not specified
      type: string
      required: false
      default: none
      enum:
        - none
        - sudo
        - sudosu
        - su
        - pbrun
        - privileged-exec
    permission_elevation_password:
      title: Permission Elevation Password
      description: The password for the account with elevated permissions. This property must not be specified when the property permissionElevation is set to either "none" or "pbrun"; otherwise the property is required
      type: string
      required: false
    permission_elevation_username:
      title: Permission Elevation Username
      description: The user name for the account with elevated permissions. This property must not be specified when the property permissionElevation is set to either "none" or "pbrun"; otherwise the property is required.
      type: string
      required: false
    privacy_password:
      title: Privacy Password
      description: The privacy password for the account that will be used for authenticating. Is required when the property authenticationType is set to valid value other than "no-authentication" and when the privacyType is set to a valid value other than code>"no-privacy"
      type: string
      required: false
    privacy_type:
      title: Privacy Type
      description: The privacy protocols available to use in SNMP v3
      type: string
      required: false
      default: no-privacy
      enum:
        - no-privacy
        - des
        - aes-128
        - aes-192
        - aes-192-with-3-des-key-extension
        - aes-256
        - aes-265-with-3-des-key-extension
    private_key_password:
      title: Private Pey Password
      description: The password for private key
      type: string
      required: false
    realm:
      title: Realm
      description: The realm
      type: string
      required: false
    service:
      title: Service
      description: Specify the type of service to authenticate
      type: string
      required: true
      enum:
        - as400
        - cifs
        - cifshash
        - cvs
        - db2
        - ftp
        - http
        - ms-sql
        - mysql
        - notes
        - oracle
        - pop
        - postgresql
        - remote-exec
        - snmp
        - snmpv3
        - ssh
        - ssh-key
        - sybase
        - telnet
    sid:
      title: SID
      description: The name of the database. If not specified, a default database name will be used during authentication
      type: string
      required: false
    use_windows_authentication:
      title: Use Windows Authentication
      description: Boolean flag signaling whether to connect to the database using Windows authentication. When set to true, Windows authentication is attempted; when set to false, SQL authentication is attempted
      type: boolean
      required: false
    username:
      title: Username
      description: The user name for the account that will be used for authenticating
      type: string
      required: false
connection:
  url:
    title: URL
    description: URL to your InsightVM console, without trailing slashes
    type: string
    required: true
    example: https://insightvm.example.com:3780
  credentials:
    title: Credentials
    description: Username and password
    type: credential_username_password
    required: true
    example: "{'username': 'user1', 'password': 'mypassword'}"
actions:
  scan:
    title: Scan
    description: Start a scan on a site
    input:
      site_id:
        title: Site ID
        description: ID of the site to scan
        type: string
        example: 1
        required: true
      hosts:
        title: Hosts
        description: The hosts that should be included in the scan
        type: "[]string"
        example: ["192.0.2.3", "192.0.2.10-192.0.2.20", "ADSRV.local"]
        required: false
      override_blackout:
        title: Override Blackout
        description: Set True to override any scan blackout window
        type: boolean
        required: false
        default: false
        example: false
    output:
      id:
        description: Identifier of the resource created
        title: Scan ID
        type: integer
        required: false
        example: 188935
      links:
        description: Hypermedia links to corresponding or related resources
        title: Links
        type: '[]link'
        required: false
        example: []
  get_scan:
    title: Get Scan
    description: Get the status of a scan
    input:
      scan_id:
        title: Scan ID
        description: ID of the scan to obtain
        type: string
        example: "11234abc-65c8-4628-adf4-e27f36ea0e2b"
        required: true
    output:
      status:
        description: Scan status (aborted, unknown, running, finished, stopped, error,
          paused, dispatched or integrating)
        title: Status
        type: string
        required: false
      scanType:
        description: Scan type (manual, automated, scheduled)
        title: Scan Type
        type: string
        required: false
      assets:
        description: Number of assets within the scan
        title: Assets
        type: integer
        required: false
      links:
        description: Hypermedia links to corresponding or related resources
        title: Links
        type: '[]link'
        required: false
      vulnerabilities:
        description: Counts of vulnerabilities found within the scan
        title: Vulnerabilities
        type: vulnerabilities_count
        required: false
      startTime:
        description: Start time of the scan in ISO8601 format
        title: Start Time
        type: string
        required: false
      duration:
        description: Duration of the scan in ISO8601 format
        title: Duration
        type: string
        required: false
      engineName:
        description: Name of the engine used for the scan
        title: Engine Name
        type: string
        required: false
      endTime:
        description: End time of the scan in ISO8601 format
        title: End Time
        type: string
        required: false
      id:
        description: ID of the scan
        title: ID
        type: integer
        required: false
      scanName:
        description: User-driven scan name for the scan
        title: Scan Name
        type: string
        required: false
  get_site_assets:
    title: Get Site Assets
    description: Gets assets for a site
    input:
      site_id:
        title: Site ID
        description: ID of the site to get assets for
        type: string
        example: "11234abc-65c8-4628-adf4-e27f36ea0e2b"
        required: true
    output:
      assets:
        title: Assets
        description: Assets
        type: '[]asset'
        required: false
  get_scan_assets:
    title: Get Scan Assets
    description: Gets assets for a scan
    input:
      scan_id:
        title: Scan ID
        description: ID of the scan to get assets for
        type: integer
        example: 123456789
        required: true
    output:
      assets:
        title: Assets
        description: Assets
        type: '[]asset'
        required: false
  get_asset_vulnerabilities:
    title: Get Asset Vulnerabilities
    description: Get vulnerabilities found on an asset. Can only be used if the asset
      has first been scanned
    input:
      asset_id:
        title: Asset ID
        description: ID of the asset for which to find vulnerabilities
        type: integer
        required: true
        example: 234
      get_risk_score:
        title: Get Risk Score
        description: Return risk score along with other vulnerability data
        type: boolean
        required: false
        example: true
    output:
      vulnerabilities:
        title: Vulnerabilities
        description: Vulnerabilities found on the asset
        type: '[]asset_vulnerability'
        required: false
  get_asset_software:
    title: Get Asset Software
    description: Get software found on an asset. Can only be used if the asset has first been scanned
    input:
      asset_id:
        title: Asset ID
        description: ID of the asset for which to find software
        type: integer
        required: true
        example: 234
    output:
      software:
        title: Software
        description: Software found on the asset
        type: '[]software'
        required: false
  download_report:
    title: Download Report
    description: Returns the contents of a generated report
    input:
      id:
        title: Report ID
        description: Identifier of the report to download
        type: integer
        example: 1234
        required: true
      instance:
        title: Instance
        description: The identifier of the report instance, 'latest' or ID
        type: string
        example: "latest"
        required: true
    output:
      report:
        title: Report
        description: Base64 encoded report
        type: bytes
        required: false
  list_reports:
    title: List Reports
    description: List reports and return their identifiers
    input:
      name:
        description: Name of report, otherwise all reports by criteria
        type: string
        required: false
        example: "Name"
      sort:
        description: Sort order, ascending or descending
        type: string
        enum:
        - Ascending
        - Descending
        example: "Ascending"
        required: true
    output:
      found:
        description: Whether optional user supplied report name was found
        type: boolean
        required: false
      list:
        title: List of Reports
        description: List of report identifiers
        type: '[]report_id'
        required: false
  get_vulnerability_affected_assets:
    title: Get Vulnerability Affected Assets
    description: Get the assets affected by the vulnerability
    input:
      vulnerability_id:
        title: Vulnerability ID
        description: The identifier of the vulnerability
        type: string
        example: "jre-vuln-cve-2013-2471"
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
      resources:
        title: Resources
        description: The identifiers of the associated resources
        type: '[]integer'
        required: true
  create_tag:
    title: Create Tag
    description: Create a new tag
    input:
      name:
        title: Name
        description: Tag name
        type: string
        example: "example name"
        required: true
      type:
        title: Type
        description: Tag type
        type: string
        required: true
        example: "owner"
        enum:
        - owner
        - location
        - custom
      color:
        title: Color
        description: Tag color (only available for custom tags)
        type: string
        required: false
        default: default
        example: "default"
        enum:
        - default
        - blue
        - green
        - orange
        - purple
        - red
      searchCriteria:
        title: Search Criteria
        description: Tag search Criteria - options documentation https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria
        type: object
        example: "{'risk-score': 'asc', 'criticality-tag': 'desc'}"
        required: false
    output:
      id:
        title: ID
        description: ID of the created tag
        type: integer
        required: true
  delete_tag:
    title: Delete Tag
    description: Delete an existing tag
    input:
      id:
        title: ID
        description: Tag ID
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_tags:
    title: Get Tags
    description: Get a listing of all tags and return their details
    input:
      name:
        title: Name
        description: Tag name regular expression by which to filter
        type: string
        required: false
        example: "example name"
        default: ''
      type:
        title: Type
        description: Type of tag by which to filter, all types are returned if none
          is specified
        type: string
        required: false
        default: ''
        example: "owner"
        enum:
        - owner
        - location
        - custom
        - criticality
        - ''
    output:
      tags:
        title: Tags
        description: List of tags
        type: '[]tag'
        required: true
  get_tag:
    title: Get Tag
    description: Get tag details by tag ID
    input:
      id:
        title: ID
        description: Tag ID
        type: integer
        example: 1234
        required: true
    output:
      tag:
        title: Tag
        description: Tag Details
        type: tag
        required: true
  get_tag_sites:
    title: Get Tag Sites
    description: Get site IDs associated with a tag
    input:
      id:
        title: ID
        description: Tag ID for which to retrieve site associations
        type: integer
        example: 1234
        required: true
    output:
      site_ids:
        title: Site IDs
        description: Site IDs associated with the tag
        type: '[]integer'
        required: true
  get_tag_assets:
    title: Get Tag Assets
    description: Get asset IDs associated with a tag
    input:
      id:
        title: ID
        description: Tag ID to add to site
        type: integer
        example: 1234
        required: true
    output:
      assets:
        title: Assets
        description: Asset IDs and tag association sources for the tag
        type: '[]tag_asset'
        required: true
  get_tag_asset_groups:
    title: Get Tag Asset Groups
    description: Get asset groups associated with a tag
    input:
      id:
        title: ID
        description: Tag ID for which to retrieve asset group associations
        type: integer
        example: 1234
        required: true
    output:
      asset_group_ids:
        title: Asset Group IDs
        description: Asset group IDs associated with the tag
        type: '[]integer'
        required: true
  remove_asset_tag:
    title: Remove Asset Tag
    description: Remove a tag from an asset
    input:
      asset_id:
        title: Asset ID
        description: Asset ID from which to remove the tag
        type: integer
        example: 12345
        required: true
      tag_id:
        title: Tag ID
        description: Tag ID to remove from the asset
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_asset_group_tags:
    title: Remove Asset Group Tags
    description: Remove all tags from an asset group
    input:
      id:
        title: ID
        description: Asset group ID from which to remove all tags
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_tag_asset_groups:
    title: Remove Tag Asset Groups
    description: Remove all asset group associations from a tag
    input:
      id:
        title: ID
        description: Tag ID from which to remove all asset group associations
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_tag_sites:
    title: Remove Tag Sites
    description: Remove all site associations from a tag
    input:
      id:
        title: ID
        description: Tag ID from which to remove all site associations
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_tag_search_criteria:
    title: Remove Tag Search Criteria
    description: Remove all search criteria from a tag
    input:
      id:
        title: ID
        description: Tag ID from which to remove all search criteria
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  tag_site:
    title: Tag Site
    description: Add a tag to a site
    input:
      site_id:
        title: Site ID
        description: Site ID to tag
        type: integer
        example: 12345
        required: true
      tag_id:
        title: Tag ID
        description: Tag ID to add to site
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  tag_asset:
    title: Tag Asset
    description: Add a tag to an asset
    input:
      asset_id:
        title: Asset ID
        description: Asset ID to tag
        type: integer
        example: 12345
        required: true
      tag_id:
        title: Tag ID
        description: Tag ID to add to site
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  tag_assets:
    title: Tag Assets
    description: Add a tag to multiple assets in bulk
    input:
      asset_ids:
        title: Asset IDs
        description: Asset IDs to tag
        type: "[]integer"
        example: [1,2,3,4]
        required: true
      tag_id:
        title: Tag ID
        description: ID of tag to add to assets
        type: integer
        example: 12345
        required: true
      tag_name:
        title: Tag Name
        description: Name of tag to add to assets
        type: string
        example: "Very High"
        required: true
      tag_type:
        title: Tag Type
        description: Type of tag to add to assets
        type: string
        example: "criticality"
        required: true
      tag_source:
        title: Tag Source
        description: Source of tag to add to assets
        type: string
        example: "built-in"
        required: true
    output:
      success:
        title: Success
        description: Was the operation successful
        type: boolean
        required: true
  tag_asset_group:
    title: Tag Asset Group
    description: Add a tag to an asset group
    input:
      asset_group_id:
        title: Asset Group ID
        description: Asset group ID to tag
        type: integer
        example: 12345
        required: true
      tag_id:
        title: Tag ID
        description: Tag ID to add to site
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_tag_search_criteria:
    title: Update Tag Search Criteria
    description: Update the search criteria for an existing tag
    input:
      id:
        title: ID
        description: Tag ID
        type: integer
        example: 1234
        required: true
      searchCriteria:
        title: Search Criteria
        description: 'Tag search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria'
        type: object
        example: "{'risk-score': 'asc', 'criticality-tag': 'desc'}"
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  asset_search:
    title: Asset Search
    description: Search for assets using filtered asset search
    input:
      searchCriteria:
        title: Search Criteria
        description: 'Tag search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria'
        type: object
        example: "{'risk-score': 'asc', 'criticality-tag': 'desc'}"
        required: true
      size:
        title: Size
        description: The number of records to retrieve. If blank or '0' all assets that match the search will be returned
        type: number
        required: false
        default: 0
        example: 100
      sort_criteria:
        title: Sort Criteria
        description: JSON object for sorting by criteria. Multiple criteria can be specified with an order of 'asc' (ascending) or 'desc' (descending)
        type: object
        required: false
        example: "{'risk-score': 'asc', 'criticality-tag': 'desc'}"
    output:
      assets:
        title: Assets
        description: List of asset details returned by the search
        type: '[]asset'
        required: true
  get_asset:
    title: Get Asset
    description: Gets an asset by ID
    input:
      asset_id:
        title: Asset ID
        description: Identifier of asset
        type: integer
        example: 1234
        required: true
    output:
      asset:
        title: Asset
        description: Asset details
        type: asset
        required: true
  get_asset_tags:
    title: Get Asset Tags
    description: Get a listing of all tags for an asset
    input:
      asset_id:
        title: Asset ID
        description: Identifier of asset
        type: integer
        example: 1234
        required: true
    output:
      tags:
        title: Tags
        description: List of tags
        type: '[]tag'
        required: true
  get_sites:
    title: Get Sites
    description: Get a list of sites
    input:
      name:
        title: Name
        description: Site name regular expression by which to filter
        type: string
        default: ''
        example: "example name"
        required: false
    output:
      sites:
        title: Sites
        description: List of sites
        type: '[]site'
        required: true
  get_site:
    title: Get Site
    description: Get a site by ID
    input:
      id:
        title: ID
        description: Site ID
        type: integer
        example: 1234
        required: true
    output:
      site:
        title: Site
        description: Site details
        type: site
        required: true
  create_site:
    title: Create Site
    description: Create a new site
    input:
      name:
        title: Name
        description: The site name. Name must be unique
        type: string
        example: "example name"
        required: true
      description:
        title: Description
        description: The site's description
        type: string
        example: "example description"
        required: false
      engine_id:
        title: Engine ID
        description: The identifier of a scan engine. Default scan engine is selected
          when not specified
        type: integer
        example: 1234
        required: false
      importance:
        title: Importance
        description: The site importance
        type: string
        required: false
        example: "low"
        enum:
        - very_low
        - low
        - normal
        - high
        - very_high
        default: normal
      scan_template_id:
        title: Scan Template ID
        description: The identifier of a scan template
        type: string
        example: "12345-abcd"
        required: false
      included_addresses:
        title: Included Addresses
        description: List of addresses to include in scan scope
        type: '[]string'
        example: ["1234-abcd", "4567-def"]
        default: []
        required: false
      excluded_addresses:
        title: Excluded Addresses
        description: List of addresses to exclude in scan scope
        type: '[]string'
        example: ["1234-abcd", "4567-def"]
        default: []
        required: false
      included_asset_groups:
        title: Included Asset Groups
        description: Assets associated with these asset group IDs will be included
          in the site
        type: '[]integer'
        example: [1234, 5768]
        default: []
        required: false
      excluded_asset_groups:
        title: Excluded Asset Groups
        description: Assets associated with these asset group IDs will be excluded
          in the site
        type: '[]integer'
        example: [1234, 5768]
        default: []
        required: false
    output:
      id:
        title: ID
        description: The identifier of the created site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site:
    title: Update Site
    description: Update an existing site
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 1234
        required: true
      name:
        title: Name
        description: The site name. Name must be unique
        type: string
        example: "example name"
        required: true
      description:
        title: Description
        description: The site's description
        type: string
        example: "example description"
        required: true
      engine_id:
        title: Engine ID
        description: The identifier of a scan engine. Default scan engine is selected
          when not specified
        type: integer
        example: 1234
        required: true
      importance:
        title: Importance
        description: The site importance
        type: string
        required: true
        example: "low"
        enum:
        - very_low
        - low
        - normal
        - high
        - very_high
        default: normal
      scan_template_id:
        title: Scan Template ID
        description: The identifier of a scan template
        type: string
        example: 1234
        required: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_included_targets:
    title: Update Site Included Targets
    description: Update an existing site scope of included IP address and hostname
      targets
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 1234
        required: true
      included_targets:
        title: Included Targets
        description: List of addresses that represent either a hostname, IPv4 address,
          IPv4 address range, IPv6 address, or CIDR notation
        type: '[]string'
        example: ["10.2.144", "10.8.36.144"]
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the included targets to the current site
          or append to the previous list of included targets
        type: boolean
        required: true
        example: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        example: 1234
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_excluded_targets:
    title: Update Site Excluded Targets
    description: Update an existing site scope of excluded IP address and hostname
      targets
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 1234
        required: true
      excluded_targets:
        title: Excluded Targets
        description: List of addresses that represent either a hostname, IPv4 address,
          IPv4 address range, IPv6 address, or CIDR notation
        type: '[]string'
        example: ["10.2.144", "10.8.36.144"]
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the excluded targets to the current site
          or append to the previous list of excluded targets
        type: boolean
        required: true
        example: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        example: 1234
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_included_asset_groups:
    title: Update Site Included Asset Groups
    description: Update an existing site scope of included asset groups
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 1234
        required: true
      included_asset_groups:
        title: Included Asset Group IDs
        description: Assets associated with these asset group IDs will be included
          in the site
        type: '[]integer'
        example: [1234, 567]
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the included asset group IDs to the current
          site or append to the previous list of asset group IDs
        type: boolean
        required: true
        example: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_excluded_asset_groups:
    title: Update Site Excluded Asset Groups
    description: Update an existing site scope of excluded asset groups
    input:
      id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 1234
        required: true
      excluded_asset_groups:
        title: Excluded Asset Group IDs
        description: Assets associated with these asset group IDs will be excluded
          from the site
        type: '[]integer'
        example: [1234, 567]
        required: false
      overwrite:
        title: Overwrite
        description: Whether to overwrite the excluded asset group IDs to the current
          site or append to the previous list of asset group IDs
        type: boolean
        required: true
        example: true
        default: true
    output:
      id:
        title: ID
        description: The identifier of the updated site
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_site:
    title: Delete Site
    description: Delete an existing site
    input:
      id:
        title: ID
        description: Site ID
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_asset_groups:
    title: Get Asset Groups
    description: Get a list of asset groups
    input:
      name:
        title: Name
        description: Asset group name regular expression by which to filter
        type: string
        default: ''
        example: "example name"
        required: false
    output:
      asset_groups:
        title: Asset Groups
        description: List of asset groups
        type: '[]asset_group'
        required: true
  get_asset_group:
    title: Get Asset Group
    description: Get an asset group by ID
    input:
      id:
        title: ID
        description: Asset group ID
        type: integer
        example: 1234
        required: true
    output:
      asset_group:
        title: Asset Group
        description: Asset group
        type: asset_group
        required: true
  create_asset_group:
    title: Create Asset Group
    description: Create an asset group
    input:
      name:
        title: Name
        description: Asset group name
        type: string
        example: "example name"
        required: true
      description:
        title: Description
        description: Asset group description
        type: string
        example: "example description"
        required: true
      searchCriteria:
        title: Search Criteria
        description: 'Asset group search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria'
        type: object
        example: "{'risk-score': 'asc', 'criticality-tag': 'desc'}"
        required: false
      type:
        title: Type
        description: Asset group type
        type: string
        required: true
        example: "dynamic"
        enum:
        - dynamic
        - static
    output:
      id:
        title: ID
        description: ID of the created tag
        type: integer
        required: true
  delete_asset_group:
    title: Delete Asset Group
    description: Delete an existing asset group
    input:
      id:
        title: ID
        description: Asset group ID
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_asset_group_search_criteria:
    title: Update Asset Group Search Criteria
    description: Update the search criteria for an existing asset group
    input:
      id:
        title: ID
        description: Asset group ID
        type: integer
        example: 1234
        required: true
      searchCriteria:
        title: Search Criteria
        description: 'Asset group search criteria - options documentation: https://help.rapid7.com/insightvm/en-us/api/#section/Responses/SearchCriteria'
        type: object
        example: "{'risk-score': 'asc', 'criticality-tag': 'desc'}"
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_vulnerabilities_by_cve:
    title: Get Vulnerabilities by CVE
    description: Get vulnerability details associated with a CVE
    input:
      cve_id:
        title: CVE ID
        description: Common Vulnerabilities and Exposures ID
        type: string
        example: "CVE-2018-12345"
        required: true
    output:
      vulnerabilities:
        title: Vulnerabilities
        description: Vulnerability details
        type: '[]vulnerability'
        required: true
  get_scans:
    title: Get Scans
    description: Get scans with optional site filter
    input:
      id:
        title: ID
        description: Site ID
        type: integer
        example: 1234
        required: false
      active:
        title: Active
        description: Return running scans or past scans
        default: false
        type: boolean
        example: false
        required: false
    output:
      scans:
        title: Scans
        description: List of scan details
        type: '[]scan'
        required: true
  update_scan_status:
    title: Update Scan Status
    description: Update the status of a scan
    input:
      id:
        title: ID
        description: Scan ID
        type: integer
        example: 1234
        required: true
      status:
        title: Status
        description: Status to which the scan should be set (stop, resume, pause)
        type: string
        required: true
        default: stop
        example: "stop"
        enum:
        - stop
        - resume
        - pause
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  generate_shared_secret:
    title: Generate Shared Secret
    description: Generate a shared secret to pair a scan engine to a security console
    input:
      time_to_live:
        title: Time to Live
        description: Time to live in seconds for the shared secret
        default: 3600
        type: integer
        example: 3600
        required: true
    output:
      shared_secret:
        title: Shared Secret
        description: Scan engine pairing shared secret
        type: string
        required: true
  get_scan_engines:
    title: Get Scan Engines
    description: List scan engines paired with the security console
    input:
      name:
        title: Name
        description: Optional engine name by which to filter, accepts regular expression
          patterns
        type: string
        example: "example name"
        required: false
      address:
        title: Address
        description: Optional address (IP/hostname) by which to filter, accepts regular
          expression patterns
        type: string
        example: "10.4.36.120"
        required: false
    output:
      scan_engines:
        title: Scan Engines
        description: List of scan engines details
        type: '[]scan_engine'
        required: true
  get_scan_engine:
    title: Get Scan Engine
    description: Get a scan engine by ID
    input:
      id:
        title: ID
        description: Scan engine identifier
        type: integer
        example: 1234
        required: true
    output:
      scan_engine:
        title: Scan Engine
        description: Scan engine details
        type: scan_engine
        required: true
  create_scan_engine:
    title: Create Scan Engine
    description: Create a new scan engine with console engine connectivity
    input:
      name:
        title: Name
        description: Scan engine name
        type: string
        example: "example name"
        required: true
      address:
        title: Address
        description: Scan engine address (IP/hostname)
        type: string
        example: "10.4.36.120"
        required: true
      port:
        title: Port
        description: Scan engine connectivity port
        default: 40814
        type: integer
        example: 40814
        required: true
      sites:
        title: Sites
        description: List of site IDs with which to associate the engine
        type: '[]integer'
        default: []
        example: [1234, 5678]
        required: false
    output:
      id:
        title: ID
        description: Scan engine ID
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_scan_engine:
    title: Delete Scan Engine
    description: Delete an existing scan engine from the security console
    input:
      id:
        title: ID
        description: Scan engine identifier
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_scan_engine_pools:
    title: Get Scan Engine Pools
    description: Retrieve a list of configured scan engine pools
    input:
      name:
        title: Name
        description: Scan engine pool name by which to filter, accepts regular expression
          patterns
        type: string
        example: "example name"
        required: false
    output:
      scan_engine_pools:
        title: Scan Engine Pools
        description: List of scan engine pool details
        type: '[]scan_engine_pool'
        required: true
  get_scan_engine_pool:
    title: Get Scan Engine Pool
    description: Retrieve scan engine pool details by ID
    input:
      id:
        title: ID
        description: Scan engine pool identifier
        type: integer
        example: 1234
        required: true
    output:
      scan_engine_pool:
        title: Scan Engine Pool
        description: Scan engine pool details
        type: scan_engine_pool
        required: true
  create_scan_engine_pool:
    title: Create Scan Engine Pool
    description: Create a new scan engine pool
    input:
      name:
        title: Name
        description: Scan engine pool name
        type: string
        example: "example name"
        required: true
      engines:
        title: Engines
        description: List of scan engine IDs to associate with the scan engine pool
        type: '[]integer'
        example: [1234, 5678]
        required: false
    output:
      id:
        title: ID
        description: Scan engine pool ID
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  add_scan_engine_pool_engine:
    title: Add Scan Engine Pool Engine
    description: Add a scan engine to a scan engine pool (AWS pre-authorized engine
      AMI engines cannot be pooled)
    input:
      pool_id:
        title: Pool ID
        description: Scan engine pool ID
        type: integer
        example: 1234
        required: true
      engine_id:
        title: Engine ID
        description: Scan engine ID
        type: integer
        example: 1234567
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_scan_engine_pool_engine:
    title: Remove Scan Engine Pool Engine
    description: Remove a scan engine from a scan engine pool
    input:
      pool_id:
        title: Pool ID
        description: Scan engine pool ID
        type: integer
        example: 1234
        required: true
      engine_id:
        title: Engine ID
        description: Scan engine ID
        type: integer
        example: 5678
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_scan_engine_pool:
    title: Delete Scan Engine Pool
    description: Delete an existing scan engine pool from the security console
    input:
      id:
        title: ID
        description: Scan engine pool identifier
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_site_scan_engine:
    title: Update Site Scan Engine
    description: Update the scan engine/scan engine pool associated with a site
    input:
      site_id:
        title: Site ID
        description: Identifier of the site to update
        type: integer
        example: 1234
        required: true
      engine_id:
        title: Engine ID
        description: Identifier of the scan engine/scan engine pool to associate with
          the site
        type: integer
        example: 5678
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_authentication_sources:
    title: Get Authentication Sources
    description: List authentication sources available for InsightVM users
    input:
      name:
        title: Name
        description: Authentication source name by which to filter, accepts regular
          expression patterns
        type: string
        example: "example name"
        required: false
      type:
        title: Type
        description: Authentication source type by which to filter
        type: string
        required: false
        default: ''
        example: "admin"
        enum:
        - ''
        - admin
        - kerberos
        - ldap
        - normal
        - saml
    output:
      authentication_sources:
        title: Authentication Sources
        description: List of authentication sources
        type: '[]authentication_source'
        required: true
  get_authentication_source:
    title: Get Authentication Source
    description: Get the details for an authentication source
    input:
      id:
        title: ID
        description: Authentication source ID
        type: integer
        example: 1234
        required: true
    output:
      authentication_source:
        title: Authentication Source
        description: User authentication source
        type: authentication_source
        required: true
  get_roles:
    title: Get Roles
    description: List role details
    input:
      name:
        title: Name
        description: Role name by which to filter, accepts regular expression patterns
        type: string
        example: "example name"
        required: false
    output:
      roles:
        title: Roles
        description: List of roles
        type: '[]role'
        required: true
  get_role:
    title: Get Role
    description: Get role details by ID
    input:
      id:
        title: ID
        description: Role ID
        type: string
        example: "global-admin"
        required: true
    output:
      role:
        title: Role
        description: Role details
        type: role
        required: true
  get_users:
    title: Get Users
    description: List user accounts
    input:
      name:
        title: Name
        description: User account name by which to filter, accepts regular expression
          patterns
        type: string
        example: "example name"
        required: false
      login:
        title: Login
        description: User account login name by which to filter, accepts regular expression
          patterns
        type: string
        example: "account"
        required: false
    output:
      users:
        title: Users
        description: List of user account details
        type: '[]user_account'
        required: true
  get_user:
    title: Get User
    description: Get user account details by ID
    input:
      id:
        title: ID
        description: User account ID
        type: integer
        example: 1234
        required: true
    output:
      user:
        title: User
        description: User account details
        type: user_account
        required: true
  create_user:
    title: Create User
    description: Create a new user account (limited to external authentication sources)
    input:
      authentication_id:
        title: Authentication ID
        description: The identifier of the authentication source to use to authenticate
          the user. The source with the specified identifier must be of the type specified
          by Authentication Type. If Authentication ID is omitted, then one source
          of the specified Authentication Type is selected
        type: integer
        example: 1234
        required: false
      authentication_type:
        title: Authentication Type
        description: The type of the authentication source to use to authenticate
          the user
        type: string
        required: true
        default: ldap
        example: "ldap"
        enum:
        - kerberos
        - ldap
        - saml
      email:
        title: Email
        description: The email address of the user
        type: string
        example: "user@example.com"
        required: true
      enabled:
        title: Enabled
        description: Whether the user account is enabled
        type: boolean
        required: true
        example: true
        default: true
      login:
        title: Login
        description: The login name of the user
        type: string
        example: "jdoe24"
        required: true
      name:
        title: Name
        description: The full name of the user
        type: string
        example: "John Doe"
        required: true
      access_all_asset_groups:
        title: Access All Asset Groups
        description: Whether to grant the user access to all asset groups
        type: boolean
        required: true
        example: false
        default: false
      access_all_sites:
        title: Access All Sites
        description: Whether to grant the user access to all sites
        type: boolean
        required: true
        example: false
        default: false
      role_id:
        title: Role ID
        description: The identifier of the role to which the user should be assigned
        type: string
        example: "global-admin"
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
      id:
        title: ID
        description: The identifier of the created user account
        type: integer
        required: true
  update_user:
    title: Update User
    description: Update the configuration of an existing user account
    input:
      id:
        title: ID
        description: The identifier of the user
        type: integer
        example: 1234
        required: true
      authentication_id:
        title: Authentication ID
        description: The identifier of the authentication source to use to authenticate
          the user. The source with the specified identifier must be of the type specified
          by Authentication Type. If Authentication ID is omitted, then one source
          of the specified Authentication Type is selected
        type: integer
        example: 567
        required: false
      authentication_type:
        title: Authentication Type
        description: The type of the authentication source to use to authenticate
          the user
        type: string
        required: true
        default: ldap
        example: "ldap"
        enum:
        - normal
        - admin
        - kerberos
        - ldap
        - saml
      email:
        title: Email
        description: The email address of the user
        type: string
        example: "user@example.com"
        required: true
      enabled:
        title: Enabled
        description: Whether the user account is enabled
        type: boolean
        required: true
        example: true
        default: true
      login:
        title: Login
        description: The login name of the user
        type: string
        example: "jdoe24"
        required: true
      name:
        title: Name
        description: The full name of the user
        type: string
        example: "John Doe"
        required: true
      access_all_asset_groups:
        title: Access All Asset Groups
        description: Whether to grant the user access to all asset groups
        type: boolean
        required: true
        example: false
        default: false
      access_all_sites:
        title: Access All Sites
        description: Whether to grant the user access to all sites
        type: boolean
        required: true
        example: false
        default: false
      role_id:
        title: Role ID
        description: The identifier of the role to which the user should be assigned
        type: string
        example: "global-admin"
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_user:
    title: Delete User
    description: Delete an user account
    input:
      id:
        title: ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  disable_user:
    title: Disable User
    description: Disable an user account
    input:
      id:
        title: ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  enable_user:
    title: Enable User
    description: Enable an user account
    input:
      id:
        title: ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_user_role:
    title: Update User Role
    description: Update the role associated with an user account
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      access_all_asset_groups:
        title: Access All Asset Groups
        description: Whether to grant the user access to all asset groups
        type: boolean
        required: true
        example: false
        default: false
      access_all_sites:
        title: Access All Sites
        description: Whether to grant the user access to all sites
        type: boolean
        required: true
        example: false
        default: false
      role_id:
        title: Role ID
        description: The identifier of the role to which the user should be assigned
        type: string
        example: "global-admin"
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_user_asset_group_access:
    title: Update User Asset Group Access
    description: Update the asset groups to which a user has access in bulk. It can
      be used to remove asset group access as well
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      asset_group_ids:
        title: Asset Group IDs
        description: The identifiers of the asset groups to which the user account
          should be granted access, ignored if the user has access to all asset groups
        type: '[]integer'
        example: [1234, 5678]
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  add_user_asset_group_access:
    title: Add User Asset Group Access
    description: Grant an user account access to an asset group by ID
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      asset_group_id:
        title: Asset Group ID
        description: The identifier of the asset group
        type: integer
        example: 5678
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_user_asset_group_access:
    title: Remove User Asset Group Access
    description: Remove asset group access from an user account
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      asset_group_id:
        title: Asset Group ID
        description: The identifier of the asset group
        type: integer
        example: 4567
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  update_user_site_access:
    title: Update User Site Access
    description: Update the sites to which a user has access in bulk. It can be used
      to remove sites as well
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      site_ids:
        title: Site IDs
        description: The identifiers of the sites to which the user account should
          be granted access, ignored if the user has access to all sites
        type: '[]integer'
        example: [1234, 567]
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  add_user_site_access:
    title: Add User Site Access
    description: Grant an user account access to a site by ID
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      site_id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 4567
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  remove_user_site_access:
    title: Remove User Site Access
    description: Remove site access from an user account
    input:
      user_id:
        title: User ID
        description: The identifier of the user account
        type: integer
        example: 1234
        required: true
      site_id:
        title: Site ID
        description: The identifier of the site
        type: integer
        example: 4567
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  top_remediations:
    title: Top Remediations
    description: Generate results for the top remediations based on a defined scope
    input:
      limit:
        title: Limit
        description: Number of remediations for which tickets should be generated
        type: integer
        required: true
        default: 25
        example: 10
        enum:
          - 10
          - 25
          - 50
          - 100
      scope:
        title: Scope
        description: Scope context for generated report; if set remediations will be scoped by each in scope ID
        type: string
        required: true
        default: none
        example: "none"
        enum:
          - none
          - assets
          - assetGroups
          - sites
          - tags
          - scan
      scope_ids:
        title: Scope IDs
        description: Scope IDs for which tickets should be generated, by default all are included
        type: '[]integer'
        required: false
        example: [1234, 45]
        default: []
      asset_limit:
        title: Asset Limit
        description: The amount of assets to be returned with each top remediation; this can be used to reduce message size and processing time
        type: integer
        example: 4
        required: false
      vulnerability_limit:
        title: Vulnerability Limit
        description: The amount of vulnerabilities to be returned with each top remediation; this can be used to reduce message size and processing time
        type: integer
        example: 2
        required: false
    output:
      remediations:
        title: Remediations
        description: List of top remediations
        type: '[]remediation'
        required: true
  generate_adhoc_sql_report:
    title: Generate AdHoc SQL Report
    description: Create, generate, download, and cleanup a SQL report based on the provided query
    input:
      query:
        title: Query
        type: string
        description: Reporting Data Model SQL query
        example: select * from dim_asset
        required: true
      scope:
        title: Scope
        description: Scope context for generated report; if set, remediations will be scoped by each in scope ID, e.g Site ID, Tag ID, Asset Group ID; scan scope only supports single scan ID as input
        type: string
        required: true
        default: none
        example: "none"
        enum:
          - none
          - assets
          - assetGroups
          - sites
          - tags
          - scan
      scope_ids:
        title: Scope IDs
        description: Scope IDs for which tickets should be generated, by default all are included
        type: '[]integer'
        required: false
        example: [1234, 5678]
        default: []
      filters:
        title: Report Filters
        description: Filters in JSON format to be applied to the contents of the report; review InsightVM API documentation for filter options
        type: string
        required: false
        example: "{filters}"
        default: '{}'
    output:
      report:
        type: file
        title: Base64 Encoded Report
        description: Base64 encoded file making up the report
        required: true
  review_exception:
    title: Review Vulnerability Exception
    description: Approve or Reject a Vulnerability Exception
    input:
      exception:
        title: Exception ID
        description: The vulnerability exception ID to approve or reject
        type: integer
        example: 1234
        required: true
      review:
        title: Review Outcome
        description: Approval or rejection of the exception
        type: string
        required: true
        example: "Approved"
        enum:
        - Approved
        - Rejected
      comment:
        title: Review Comment
        description: Comment to include in the review
        type: string
        example: "example comment"
        required: false
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  delete_exception:
    title: Delete Vulnerability Exception
    description: Delete an existing vulnerability exception
    input:
      exception_id:
        title: Exception ID
        description: Vulnerability exception ID to delete
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  create_exception:
    title: Create Vulnerability Exception Submission
    description: Create a vulnerability exception submission
    input:
      type:
        title: Exception Type
        description: The type of vulnerability exception to create
        type: string
        required: true
        example: "Global"
        enum:
        - Global
        - Site
        - Asset
        - Asset Group
        - Instance
      vulnerability:
        title: Vulnerability
        description: The vulnerability this exception applies to
        type: string
        example: "vulnerability"
        required: true
      scope:
        title: Scope ID
        description: The ID of the scope the vulnerability exception applies to. May be empty if type is Global
        type: integer
        example: 1234
        required: false
      expiration:
        title: Expiration
        description: The date the vulnerability exception expires
        type: date
        example: 2021-12-30 00:00:00
        required: false
      comment:
        title: Comment
        description: Comment to include in the vulnerability exception submission
        type: string
        required: true
        example: "example comment"
        default: Exception created with InsightConnect
      reason:
        title: Reason
        description: Reason for the exception
        type: string
        required: true
        example: "False Positive"
        enum:
        - False Positive
        - Compensating Control
        - Acceptable Use
        - Acceptable Risk
        - Other
      key:
        title: Vulnerability Key
        description: The key to identify a specific instance if the type is Instance
        type: string
        example: "9de5069c5afe602b2ea0a04b66beb2c0"
        required: false
      port:
        title: Vulnerability Port
        description: The port the vulnerability appears on if the type is Instance
        type: integer
        example: 40000
        required: false
    output:
      id:
        title: Created Exception ID
        description: The vulnerability exception that was created
        type: integer
        required: true
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
  get_vulnerability:
    title: Get Vulnerability Details
    description: Get the details of a specific vulnerability by id
    input:
      id:
        title: Vulnerability ID
        description: The identifier of the vulnerability to retrieve from InsightVM
        type: string
        example: "1234-abcd"
        required: true
    output:
      vulnerability:
        title: Vulnerability Details
        description: The details of the vulnerability requested
        type: vulnerability
        required: true
  get_asset_group_assets:
    title: Get Asset Group Assets
    description: Get asset group assets
    input:
      id:
        title: Asset Group ID
        description: Asset group ID
        type: integer
        example: 1234
        required: true
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
      resources:
        title: Resources
        description: The identifiers of the associated resources
        type: '[]integer'
        required: false
  delete_asset:
    title: Delete an Asset
    description: Delete an Asset
    input:
      id:
        title: ID
        description: Asset ID
        type: integer
        example: 1234
        required: true
    output:
      success:
        title: Success
        description: Was the operation successful
        type: boolean
        required: true
  list_inactive_assets:
    title: List Inactive Assets
    description: Returns a list of inactive assets (limit 1000) determined by how many days ago they were scanned
    input:
      days_ago:
        title: Days Ago
        description: How many days ago should an asset be considered still active
        type: integer
        example: 14
        default: 14
        required: true
      size:
        title: Size
        description: The number of assets to retrieve. If blank then 500 inactive assets will be returned, the maximum limit is 1000 assets
        type: number
        required: false
        default: 500
        example: 100
    output:
      assets:
        title: Assets
        description: A list of inactive assets
        type: "[]asset"
        required: true
  get_expiring_vulnerability_exceptions:
    title: Get Expiring Vulnerability Exceptions
    description: Return a list of expiring vulnerability exceptions
    input:
      expires_in_less_than:
        title: Expires in Less Than
        description: Number of days left until the exception expires
        type: integer
        example: 7
        default: 7
        required: true
    output:
      exceptions:
        title: Exceptions
        description: Exceptions about to expire
        type: "[]vulnerability_exception"
        required: false
  update_vulnerability_exception_expiration_date:
    title: Update Vulnerability Exception Expiration Date
    description: Update vulnerability exception expiration date
    input:
      id:
        title: ID
        description: Asset ID
        type: integer
        required: true
        example: 42
      date:
        title: Date
        description: Expiration date
        type: string
        required: true
        example: "2020-02-24T06:59:59.999Z"
    output:
      success:
        title: Success
        description: Was operation successful
        type: boolean
        required: true
        example: True
  asset_vulnerability_solution:
    title: Get Asset Vulnerability Solutions
    description: Returns the highest-superceding rollup solutions for a list of vulnerabilities on an asset
    input:
      asset_id:
        title: Asset ID
        description: The identifier of the asset
        type: integer
        required: true
        example: 423
      vulnerability_ids:
        title: Vulnerability IDs
        description: A list of identifiers of the vulnerabilities
        type: "[]string"
        required: true
        example: ["flash_player-cve-2017-11305"]
    output:
      vulnerabilities_solution:
        title: Solutions for Vulnerabilities
        description: Highest-superceding rollup solutions for a vulnerabilities on an asset
        type: "[]vulnerability_solution"
        required: true
  update_shared_credential:
    title: Update Shared Credentials
    description: Update shared credentials
    input:
      account:
        title: Account
        description: Specify the type of service to authenticate as well as all of the information required by that service
        type: account
        required: true
        example: {
          "authentication_type": "no-authentication",
          "community_name": "rapid community",
          "database": "rapid7_database",
          "domain": "rapid7.com",
          "enumerate_sids": false,
          "notes_id_password": "notes_id_password",
          "ntlm_hash": "86956E15C7F452086BEEB6BB005E0388",
          "oracle_listener_password": "oracle_listener_password",
          "password": "password",
          "pem_key": "-----BEGIN RSA PRIVATE KEY----- MIIEpQIBAAKCAQEA3Tz2mr7SZiAMfQyuvBj...",
          "permission_elevation": "sudo",
          "permission_elevation_password": "permission_elevation_password",
          "permission_elevation_username": "permission_elevation_username",
          "privacy_password": "privacy_password",
          "privacy_type": "no-privacy",
          "private_key_password": "private_key_password",
          "realm": "realm0",
          "service": "telnet",
          "sid": "rapid7_database2",
          "use_windows_authentication": false,
          "username": "username"
        }
      description:
        title: Description
        description: The description of the credential
        type: string
        required: false
        example: example input with every field filled. Note real input will only have specific fields filled
      host_restriction:
        title: Host Restriction
        description: The host name or IP address that you want to restrict the credentials to
        type: string
        required: false
        example: my-macbook-name
      id:
        title: ID
        description: The identifier of the credential
        type: integer
        required: false
        example: 123
      name:
        title: Name
        description: The name of the credential
        type: string
        required: true
        example: my-AS400-credentials
      port_restriction:
        title: Port Restriction
        description: Further restricts the credential to attempt to authenticate on a specific port. The port can only be restricted if the property hostRestriction is specified
        type: string
        required: false
        example: 8888
      site_assignment:
        title: Site Assignment
        description: Assigns the shared scan credential either to be available to all sites or to a specific list of sites. All sites - The shared scan credential is assigned to all current and future sites. specific-sites - The shared scan credential is assigned to zero sites by default. Administrators must explicitly assign sites to the shared credential. Shared scan credentials assigned to a site can disabled within the site configuration, if needed
        type: string
        required: true
        example: "all-sites"
        enum:
          - all-sites
          - specific-sites
      sites:
        title: Sites
        description: List of site identifiers. These sites are explicitly assigned access to the shared scan credential, allowing the site to use the credential for authentication during a scan. This property can only be set if the value of property siteAssignment is set to "specific-sites". When the property siteAssignment is set to "all-sites", this property will be null
        type: '[]integer'
        required: false
        example: [ ]
    output:
      links:
        title: Links
        description: Hypermedia links to corresponding or related resources
        type: '[]link'
        required: true
triggers:
  new_scans:
    title: New Scans
    description: Check for new InsightVM scans by site and scan status
    input:
      frequency:
        title: Frequency
        description: How often the trigger should check for new scans in minutes
        type: integer
        required: true
        example: 5
        default: 5
      site_name_filter:
        title: Site Name Filter
        description: Regular expression to match sites where new scans should be triggered
        type: string
        required: true
        example: "example name"
        default: .*
      most_recent_scan:
        title: Most Recent Scan Only
        description: Only process the most recent scan for a site since the last time the trigger was run
        type: boolean
        required: true
        example: true
        default: true
      status_filter:
        title: Status Filter
        description: 'List of scan statuses to match for trigger; options include: Aborted, Successful, Running, Stopped, Failed, Paused, Unknown'
        type: '[]string'
        required: false
        example: ["Successful"]
        default: '["Successful"]'
    output:
      scan:
        title: Scan
        description: InsightVM Scan
        type: scan
        required: false
  new_exception_request:
    title: New Vulnerability Exception
    description: Check for new InsightVM vulnerability exceptions
    input:
      frequency:
        title: Frequency
        description: How often the trigger should check for new vulnerability exception requests
        type: integer
        required: true
        example: 5
        default: 5
      status_filter:
        title: Status Filter
        description: 'List of vulnerability statuses to match against. Options include: Under Review and Approved'
        type: '[]string'
        required: false
        example: ["Under Review"]
        default: '["Under Review"]'
    output:
      exception:
        title: Vulnerability Exception
        description: InsightVM vulnerability exception
        type: vulnerability_exception
        required: false
