# GENERATED BY INSIGHT-PLUGIN - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Returns security incidents that match the search criteria"


class Input:
    FIELDS = "fields"
    LIMIT = "limit"
    OFFSET = "offset"
    QUERY = "query"


class Output:
    SECURITY_INCIDENTS = "security_incidents"


class SearchSecurityIncidentInput(insightconnect_plugin_runtime.Input):
    schema = json.loads(r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "fields": {
      "type": "string",
      "title": "Fields",
      "description": "A comma-separated list of fields to return in the response",
      "order": 2
    },
    "limit": {
      "type": "integer",
      "title": "Limit",
      "description": "Maximum number of records to return",
      "order": 3
    },
    "offset": {
      "type": "integer",
      "title": "Offset",
      "description": "Starting record index for which to begin retrieving records",
      "order": 4
    },
    "query": {
      "type": "string",
      "title": "Query",
      "description": "An encoded query string used to filter the results",
      "order": 1
    }
  },
  "definitions": {}
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SearchSecurityIncidentOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads(r"""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "security_incidents": {
      "type": "array",
      "title": "Security Incidents",
      "description": "Details of the matching security incidents",
      "items": {
        "$ref": "#/definitions/security_incident"
      },
      "order": 1
    }
  },
  "definitions": {
    "security_incident": {
      "type": "object",
      "title": "security_incident",
      "properties": {
        "active": {
          "type": "boolean",
          "title": "Active",
          "description": "Whether the security incident is active",
          "order": 1
        },
        "activity_due": {
          "type": "string",
          "title": "Activity Due",
          "description": "Date by which the Inactivity Monitor expects the task to be updated",
          "order": 2
        },
        "affected_user": {
          "$ref": "#/definitions/link_value",
          "title": "Affected User",
          "description": "The user related to this security incident",
          "order": 3
        },
        "alert_id": {
          "type": "string",
          "title": "Alert ID",
          "description": "The identifier of the alert",
          "order": 4
        },
        "alert_rule": {
          "type": "string",
          "title": "Alert Rule",
          "description": "The rule of the alert",
          "order": 5
        },
        "assigned_to": {
          "$ref": "#/definitions/link_value",
          "title": "Assigned To",
          "description": "Person primarily responsible for working this task",
          "order": 6
        },
        "assignment_group": {
          "$ref": "#/definitions/link_value",
          "title": "Assignment Group",
          "description": "Group responsible for working this task",
          "order": 7
        },
        "business_criticality": {
          "type": "integer",
          "title": "Business Impact",
          "description": "The business impact of this incident",
          "order": 8
        },
        "caller": {
          "$ref": "#/definitions/link_value",
          "title": "Requested By",
          "description": "Person requesting the work to be done. Determines suggested Location if no Affected CI is defined",
          "order": 9
        },
        "category": {
          "type": "string",
          "title": "Category",
          "description": "Category of the incident",
          "order": 10
        },
        "change_request": {
          "$ref": "#/definitions/link_value",
          "title": "Change Request",
          "description": "The change request related to this security incident",
          "order": 11
        },
        "close_code": {
          "type": "integer",
          "title": "Close Code",
          "description": "Code indicating why the incident is being closed",
          "order": 12
        },
        "close_notes": {
          "type": "string",
          "title": "Close Notes",
          "description": "Notes explaining why the incident is being closed",
          "order": 13
        },
        "closed_at": {
          "type": "string",
          "title": "Closed At",
          "description": "Time when the security incident was closed",
          "order": 14
        },
        "closed_by": {
          "$ref": "#/definitions/link_value",
          "title": "Closed By",
          "description": "The person who closed the security incident",
          "order": 15
        },
        "cmdb_ci": {
          "$ref": "#/definitions/link_value",
          "title": "Configuration Item",
          "description": "Item or service affected",
          "order": 16
        },
        "contact_type": {
          "type": "string",
          "title": "Source",
          "description": "Source of the security incident",
          "order": 17
        },
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Description of the security incident",
          "order": 18
        },
        "incident": {
          "$ref": "#/definitions/link_value",
          "title": "Incident",
          "description": "The incident related to this security incident",
          "order": 19
        },
        "location": {
          "$ref": "#/definitions/link_value",
          "title": "Location",
          "description": "Where the caller or service is located",
          "order": 20
        },
        "number": {
          "type": "string",
          "title": "Number",
          "description": "Identification number of the security incident",
          "order": 21
        },
        "opened_at": {
          "type": "string",
          "title": "Opened At",
          "description": "Time when the security incident was opened",
          "order": 22
        },
        "opened_by": {
          "$ref": "#/definitions/link_value",
          "title": "Opened By",
          "description": "The person who opened the security incident",
          "order": 23
        },
        "opened_for": {
          "$ref": "#/definitions/link_value",
          "title": "Opened For",
          "description": "Person this request was opened for",
          "order": 24
        },
        "parent": {
          "$ref": "#/definitions/link_value",
          "title": "Parent",
          "description": "The parent of this security incident",
          "order": 25
        },
        "parent_security_incident": {
          "$ref": "#/definitions/link_value",
          "title": "Parent Security Incident",
          "description": "The parent security incident to this security incident",
          "order": 26
        },
        "priority": {
          "type": "integer",
          "title": "Priority",
          "description": "Sequence in which the security incident needs to be resolved, based on impact and urgency",
          "order": 27
        },
        "problem": {
          "$ref": "#/definitions/link_value",
          "title": "Problem",
          "description": "The problem related to this security incident",
          "order": 28
        },
        "risk_score": {
          "type": "integer",
          "title": "Risk Score",
          "description": "Score of the risk",
          "order": 29
        },
        "risk_score_override": {
          "type": "boolean",
          "title": "Risk Score Override",
          "description": "When checked, risk score will not be updated automatically",
          "order": 30
        },
        "secure_notes": {
          "type": "string",
          "title": "Secure Notes",
          "description": "Encrypted note of the security incident",
          "order": 31
        },
        "security_tags": {
          "type": "string",
          "title": "Security Tags",
          "description": "Security tags applied to this security incident",
          "order": 32
        },
        "short_description": {
          "type": "string",
          "title": "Short Description",
          "description": "Short description of the security incident",
          "order": 33
        },
        "special_access_write": {
          "type": "string",
          "title": "Special Access Write",
          "description": "Users in the 'Privileged access' list will be able to see the Security Incident, data related to it and edit all data fields on it",
          "order": 34
        },
        "state": {
          "type": "integer",
          "title": "State",
          "description": "State of the security incident",
          "order": 35
        },
        "subcategory": {
          "type": "string",
          "title": "Subcategory",
          "description": "Subcategory of the security incident",
          "order": 36
        },
        "substate": {
          "type": "integer",
          "title": "Substate",
          "description": "Substate of the security incident",
          "order": 37
        },
        "sys_created_by": {
          "type": "string",
          "title": "System Created By",
          "description": "Person this security incident was created by",
          "order": 38
        },
        "sys_created_on": {
          "type": "string",
          "title": "System Created On",
          "description": "Time when the security incident was created",
          "order": 39
        },
        "sys_id": {
          "type": "string",
          "title": "System ID",
          "description": "The unique system ID of the security incident",
          "order": 40
        },
        "sys_updated_by": {
          "type": "string",
          "title": "System Updated By",
          "description": "Person this security incident was updated by",
          "order": 41
        },
        "sys_updated_on": {
          "type": "string",
          "title": "System Updated On",
          "description": "Time when the security incident was updated",
          "order": 42
        },
        "watch_list": {
          "type": "string",
          "title": "Watch List",
          "description": "List of users that are interested on the security incident",
          "order": 43
        },
        "work_notes_list": {
          "type": "string",
          "title": "Work Notes List",
          "description": "Users interested in work notes",
          "order": 44
        }
      }
    },
    "link_value": {
      "type": "object",
      "title": "link_value",
      "properties": {
        "link": {
          "type": "string",
          "title": "Link",
          "description": "Link to the resource",
          "order": 1
        },
        "value": {
          "type": "string",
          "title": "Value",
          "description": "Identifier of the resource",
          "order": 2
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
