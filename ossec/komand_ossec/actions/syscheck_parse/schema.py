# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Parse OSSEC Syscheck alerts"


class Input:
    ALERT = "alert"
    

class Output:
    ALERT = "alert"
    

class SyscheckParseInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "alert": {
      "type": "string",
      "title": "Alert",
      "description": "OSSEC Syscheck alert",
      "order": 1
    }
  },
  "required": [
    "alert"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SyscheckParseOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "alert": {
      "$ref": "#/definitions/syscheck_alert",
      "title": "Alert",
      "description": "Alert",
      "order": 1
    }
  },
  "required": [
    "alert"
  ],
  "definitions": {
    "syscheck_alert": {
      "type": "object",
      "title": "syscheck_alert",
      "properties": {
        "agent": {
          "type": "string",
          "title": "Agent",
          "description": "Agent alert was created on",
          "order": 4
        },
        "alert_id": {
          "type": "number",
          "title": "Alert ID",
          "description": "Alert ID of the OSSEC alert",
          "order": 1
        },
        "category": {
          "type": "string",
          "title": "Alert Category",
          "description": "Alert category",
          "order": 2
        },
        "file": {
          "type": "string",
          "title": "File",
          "description": "File changed",
          "order": 8
        },
        "level": {
          "type": "integer",
          "title": "Level",
          "description": "Alert level",
          "order": 6
        },
        "md5_new": {
          "type": "string",
          "title": "New MD5",
          "description": "MD5 after modification",
          "order": 14
        },
        "md5_old": {
          "type": "string",
          "title": "Old MD5",
          "description": "MD5 before modification",
          "order": 13
        },
        "perms_new": {
          "type": "string",
          "title": "Old Permissions",
          "description": "Permissions before modification",
          "order": 10
        },
        "perms_old": {
          "type": "string",
          "title": "New Permissions",
          "description": "Permissions after modification",
          "order": 9
        },
        "rule_id": {
          "type": "integer",
          "title": "Rule ID",
          "description": "Rule ID",
          "order": 5
        },
        "rule_name": {
          "type": "string",
          "title": "Alert Name",
          "description": "Alert name",
          "order": 7
        },
        "sha_new": {
          "type": "string",
          "title": "New SHA1",
          "description": "SHA1 after modification",
          "order": 12
        },
        "sha_old": {
          "type": "string",
          "title": "Old SHA1",
          "description": "SHA1 before modification",
          "order": 11
        },
        "size_new": {
          "type": "integer",
          "title": "New Size",
          "description": "Size after modification",
          "order": 16
        },
        "size_old": {
          "type": "integer",
          "title": "Old Size",
          "description": "Size before modification",
          "order": 15
        },
        "timestamp": {
          "type": "string",
          "title": "Time Stamp",
          "description": "Time stamp",
          "order": 3
        }
      },
      "required": [
        "agent",
        "alert_id",
        "category",
        "level",
        "rule_id",
        "rule_name",
        "timestamp"
      ]
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
