# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Search urlscan.io"


class Input:
    OFFSET = "offset"
    Q = "q"
    SIZE = "size"
    SORT = "sort"
    

class Output:
    RESULTS = "results"
    TOTAL = "total"
    

class SearchInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "offset": {
      "type": "integer",
      "title": "Offset",
      "description": "Offset of first result (for paginating)",
      "default": 0,
      "order": 3
    },
    "q": {
      "type": "string",
      "title": "Query",
      "description": "The query term (ElasticSearch simple query string), default is *",
      "default": "domain:example.com",
      "order": 1
    },
    "size": {
      "type": "integer",
      "title": "Size",
      "description": "Number of results returned",
      "default": 100,
      "order": 2
    },
    "sort": {
      "type": "string",
      "title": "Sort",
      "description": "Sorting, specificied via $sort_field:$sort_order",
      "default": "_score",
      "order": 4
    }
  },
  "required": [
    "offset",
    "q",
    "size",
    "sort"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SearchOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "results": {
      "type": "array",
      "title": "Results",
      "description": "UrlScan.io Results",
      "items": {
        "$ref": "#/definitions/results"
      },
      "order": 2
    },
    "total": {
      "type": "integer",
      "title": "Total",
      "description": "Total number of results returned",
      "order": 1
    }
  },
  "definitions": {
    "page": {
      "type": "object",
      "title": "page",
      "properties": {
        "asn": {
          "type": "string",
          "title": "Asn",
          "description": "Autonomous System Number",
          "order": 1
        },
        "asnname": {
          "type": "string",
          "title": "Asnname",
          "description": "Autonomous System Name",
          "order": 2
        },
        "city": {
          "type": "string",
          "title": "City",
          "order": 3
        },
        "country": {
          "type": "string",
          "title": "Country",
          "order": 4
        },
        "domain": {
          "type": "string",
          "title": "Domain",
          "order": 5
        },
        "ip": {
          "type": "string",
          "title": "Ip",
          "description": "IP address",
          "order": 6
        },
        "ptr": {
          "type": "string",
          "title": "Ptr",
          "order": 7
        },
        "server": {
          "type": "string",
          "title": "Server",
          "description": "Server Software",
          "order": 8
        },
        "url": {
          "type": "string",
          "title": "Url",
          "order": 9
        }
      }
    },
    "results": {
      "type": "object",
      "title": "results",
      "properties": {
        "_id": {
          "type": "string",
          "title": "Id",
          "order": 1
        },
        "page": {
          "$ref": "#/definitions/page",
          "title": "Page",
          "order": 2
        },
        "result": {
          "type": "string",
          "title": "Result",
          "order": 3
        },
        "stats": {
          "$ref": "#/definitions/stats",
          "title": "Stats",
          "order": 4
        },
        "task": {
          "$ref": "#/definitions/task",
          "title": "Task",
          "order": 5
        },
        "uniq_countries": {
          "type": "integer",
          "title": "Uniq Countries",
          "description": "Unique Countries",
          "order": 6
        }
      },
      "definitions": {
        "page": {
          "type": "object",
          "title": "page",
          "properties": {
            "asn": {
              "type": "string",
              "title": "Asn",
              "description": "Autonomous System Number",
              "order": 1
            },
            "asnname": {
              "type": "string",
              "title": "Asnname",
              "description": "Autonomous System Name",
              "order": 2
            },
            "city": {
              "type": "string",
              "title": "City",
              "order": 3
            },
            "country": {
              "type": "string",
              "title": "Country",
              "order": 4
            },
            "domain": {
              "type": "string",
              "title": "Domain",
              "order": 5
            },
            "ip": {
              "type": "string",
              "title": "Ip",
              "description": "IP address",
              "order": 6
            },
            "ptr": {
              "type": "string",
              "title": "Ptr",
              "order": 7
            },
            "server": {
              "type": "string",
              "title": "Server",
              "description": "Server Software",
              "order": 8
            },
            "url": {
              "type": "string",
              "title": "Url",
              "order": 9
            }
          }
        },
        "stats": {
          "type": "object",
          "title": "stats",
          "properties": {
            "consoleMsgs": {
              "type": "integer",
              "title": "ConsoleMsgs",
              "description": "Console Messages",
              "order": 1
            },
            "dataLength": {
              "type": "integer",
              "title": "DataLength",
              "description": "Data Length",
              "order": 2
            },
            "encodedDataLength": {
              "type": "integer",
              "title": "EncodedDataLength",
              "description": "Encoded Data Length",
              "order": 3
            },
            "requests": {
              "type": "integer",
              "title": "Requests",
              "order": 4
            },
            "uniqIPs": {
              "type": "integer",
              "title": "UniqIPs",
              "description": "Unique IPs",
              "order": 5
            }
          }
        },
        "task": {
          "type": "object",
          "title": "task",
          "properties": {
            "method": {
              "type": "string",
              "title": "Method",
              "order": 1
            },
            "options": {
              "type": "object",
              "title": "Options",
              "order": 2
            },
            "source": {
              "type": "string",
              "title": "Source",
              "order": 3
            },
            "time": {
              "type": "string",
              "title": "Time",
              "displayType": "date",
              "format": "date-time",
              "order": 4
            },
            "url": {
              "type": "string",
              "title": "Url",
              "order": 5
            },
            "visibility": {
              "type": "string",
              "title": "Visibility",
              "order": 6
            }
          }
        }
      }
    },
    "stats": {
      "type": "object",
      "title": "stats",
      "properties": {
        "consoleMsgs": {
          "type": "integer",
          "title": "ConsoleMsgs",
          "description": "Console Messages",
          "order": 1
        },
        "dataLength": {
          "type": "integer",
          "title": "DataLength",
          "description": "Data Length",
          "order": 2
        },
        "encodedDataLength": {
          "type": "integer",
          "title": "EncodedDataLength",
          "description": "Encoded Data Length",
          "order": 3
        },
        "requests": {
          "type": "integer",
          "title": "Requests",
          "order": 4
        },
        "uniqIPs": {
          "type": "integer",
          "title": "UniqIPs",
          "description": "Unique IPs",
          "order": 5
        }
      }
    },
    "task": {
      "type": "object",
      "title": "task",
      "properties": {
        "method": {
          "type": "string",
          "title": "Method",
          "order": 1
        },
        "options": {
          "type": "object",
          "title": "Options",
          "order": 2
        },
        "source": {
          "type": "string",
          "title": "Source",
          "order": 3
        },
        "time": {
          "type": "string",
          "title": "Time",
          "displayType": "date",
          "format": "date-time",
          "order": 4
        },
        "url": {
          "type": "string",
          "title": "Url",
          "order": 5
        },
        "visibility": {
          "type": "string",
          "title": "Visibility",
          "order": 6
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
