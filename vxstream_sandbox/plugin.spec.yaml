plugin_spec_version: v2
extension: plugin
product: ["insightconnect"]
name: vxstream_sandbox
title: VxStream Sandbox
vendor: rapid7
support: community
status: []
description: A plugin to interact with a VxStream Malware analysis service. This plugin allows a user to submit files for analysis and view the file report details. It can also search the service for any matching file hashes. 
version: 2.0.0
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/vxstream_sandbox
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.payload-security.com
tags:
- malware
- sandbox
- malware analysis
hub_tags:
  use_cases: [threat_detection_and_response, threat_intel, soc_automation]
  keywords: [malware, sandbox, malware analysis, vxstream]
  features: []
types:
  dates:
    date_unix:
      title: Date (Unix)
      type: string
      required: false
    date_year:
      title: Date (Year)
      type: integer
      required: false
    dos_date_unix:
      title: DOS Date(Unix)
      type: string
      required: false
    dos_date_utc:
      title: DOS Date(UTC)
      type: string
      required: false
    date_utc:
      title: Date (UTC)
      type: string
      required: false
    dos_date_year:
      title: DOS Date(Year)
      type: string
      required: false
  section:
    rsize:
      type: string
      required: false
    md5:
      title: MD5
      type: string
      required: false
    name:
      type: string
      required: false
    vsize:
      type: string
      required: false
    entropy:
      type: float
      required: false
    va:
      title: VA
      type: string
      required: false
  sections:
    section:
      title: Section List
      type: '[]section'
      required: false
  import:
    module:
      type: string
      required: false
    apis:
      title: APIs
      type: string
      required: false
  imports:
    import:
      title: Import List
      type: '[]import'
      required: false
  static:
    exports:
      type: string
      required: false
    packers:
      type: string
      required: false
    language:
      type: string
      required: false
    crc_actual:
      title: Actual CRC
      type: integer
      required: false
    parser:
      type: string
      required: false
    imphash:
      title: Import Hash
      type: string
      required: false
    entrypoint_va:
      title: Entrypoint VA
      type: string
      required: false
    crc_claimed:
      title: Claimed CRC
      type: integer
      required: false
    imports:
      type: imports
      required: false
    size:
      type: integer
      required: false
    resources:
      type: string
      required: false
    pdb_path:
      title: PDB Path
      type: string
      required: false
    verinfo:
      title: Version Info
      type: string
      required: false
    entrypoint_section:
      type: string
      required: false
    type:
      type: string
      required: false
    ssdeep:
      title: Ssdeep Output
      type: string
      required: false
    architecture:
      type: string
      required: false
    yarahits:
      title: YARA Hits
      type: string
      required: false
    tls_callbacks:
      title: TLS Callbacks
      type: string
      required: false
    authentihash:
      title: Authenticated Hash
      type: string
      required: false
    sections:
      type: sections
      required: false
    dates:
      type: dates
      required: false
  appserver:
    externalip:
      title: External IP
      type: string
      required: false
  trid:
    classification:
      title: Classification List
      type: object
      required: false
  app:
    product:
      type: string
      required: false
    name:
      type: string
      required: false
    version:
      type: string
      required: false
  appinfos:
    app:
      title: App List
      type: '[]app'
      required: false
  virustotal_result:
    avname:
      title: AV Name
      type: string
      required: false
    db:
      title: Database
      type: string
      required: false
    isvirus:
      title: Is Virus?
      type: string
      required: false
    version:
      type: string
      required: false
    date:
      type: date
      required: false
  virustotal:
    sha256:
      title: SHA256
      type: string
      required: false
    detectrate_pcnt:
      title: DetectRate PCNT
      type: string
      required: false
    familyname:
      title: Family Name
      type: string
      required: false
    result:
      title: Result List
      type: '[]virustotal_result'
      required: false
  digests:
    md5:
      title: MD5
      type: string
      required: false
    sha1:
      title: SHA1
      type: string
      required: false
    sha256:
      title: SHA256
      type: string
      required: false
    sha512:
      title: SHA512
      type: string
      required: false
  exec_options:
    dependencies:
      type: string
      required: false
    netsim:
      type: integer
      required: false
    mode:
      type: string
      required: false
    sharedanalysis:
      title: Shared Analysis?
      type: boolean
      required: false
    isstaticanalysis:
      title: Static Analysis?
      type: boolean
      required: false
    isexperimentalantievasion:
      title: Experimental AntiEvasion?
      type: boolean
      required: false
    isscriptlogging:
      title: Script Logging?
      type: boolean
      required: false
    script:
      type: string
      required: false
    nohashlookup:
      title: No HashLookup?
      type: boolean
      required: false
    isallowsampletampering:
      title: Allow SampleTampering?
      type: boolean
      required: false
    istorenabledanalysis:
      title: Tor-Enabled Analysis?
      type: boolean
      required: false
    script_desc:
      title: Script Description
      type: string
      required: false
    duration:
      type: integer
      required: false
    isfolderanalysis:
      title: Folder Analysis?
      type: boolean
      required: false
  controller:
    start_time:
      type: date
      required: false
    network_enabled:
      title: Network Enabled?
      type: boolean
      required: false
    client_address:
      type: string
      required: false
    sniffer_enabled:
      title: Sniffer Enabled?
      type: boolean
      required: false
    client_path:
      type: string
      required: false
    crashfile:
      title: Crashfile?
      type: boolean
      required: false
    client_architecture:
      type: string
      required: false
    client_id:
      title: Client ID
      type: string
      required: false
    exec_options:
      type: exec_options
      required: false
    architecture:
      type: string
      required: false
    client_description:
      type: string
      required: false
    ismissingkernelmode:
      title: Missing KernelMode?
      type: boolean
      required: false
    client_type:
      type: string
      required: false
    end_time:
      type: date
      required: false
    environmentid:
      title: Environment ID
      type: integer
      required: false
    total_time:
      type: integer
      required: false
    client_name:
      type: string
      required: false
    originalname:
      title: Original Name
      type: string
      required: false
  banner:
    ha_enabled:
      title: HA Enabled?
      type: boolean
      required: false
    author_version:
      type: string
      required: false
    tiny_tags:
      title: Tiny Tags?
      type: boolean
      required: false
    author_name:
      type: string
      required: false
    architecture:
      type: string
      required: false
  general:
    icon:
      type: bytes
      required: false
    winver_edition:
      title: Windows Edition
      type: string
      required: false
    extrastatic:
      title: Extra Static
      type: string
      required: false
    winver_version:
      title: Windows Version
      type: string
      required: false
    banner:
      type: banner
      required: false
    sample:
      type: string
      required: false
    winver_servicepack:
      title: ServicePack Number
      type: string
      required: false
    winver_bitness:
      title: Windows Bitness
      type: integer
      required: false
    controller:
      type: controller
      required: false
    digests:
      type: digests
      required: false
    virustotal:
      title: VirusTotal
      type: virustotal
      required: false
    appinfos:
      title: App Infos
      type: appinfos
      required: false
    trid:
      title: TRID
      type: trid
      required: false
    winver_spoofedusername:
      title: Spoofed Username
      type: string
      required: false
    winver_name:
      title: Windows VersionName
      type: string
      required: false
    isdelayedavscan:
      title: Delayed AVScan?
      type: boolean
      required: false
    appserver:
      title: App Server
      type: appserver
      required: false
    winver_username:
      title: Windows Username
      type: string
      required: false
    static:
      type: static
      required: false
    isurlanalysis:
      title: Is URLAnalysis?
      type: boolean
      required: false
  registry_access:
    tick:
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
    type:
      type: string
      required: false
    path:
      type: string
      required: false
  registry:
    access:
      title: Access List
      type: '[]registry_access'
      required: false
  fileaccesses:
    real_total:
      type: string
      required: false
  apidb_apicall:
    sysnum:
      title: SysNum
      type: string
      required: false
    name:
      type: string
      required: false
    module:
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
    va:
      title: VA
      type: string
      required: false
  apidb:
    apicall:
      title: APICall List
      type: '[]apidb_apicall'
      required: false
  parameterdb_parameter:
    id:
      title: ID
      type: string
      required: false
    db:
      title: Database
      type: string
      required: false
  parameterdb:
    parameter:
      title: Parameter List
      type: '[]parameterdb_parameter'
      required: false
  chronology_parameter:
    id:
      title: ID
      type: string
      required: false
    num:
      title: Number
      type: string
      required: false
    meaning:
      type: string
      required: false
  parameters:
    parameter:
      title: Parameter List
      type: '[]chronology_parameter'
      required: false
  chronology_apicall:
    parameters:
      type: parameters
      required: false
    uid:
      title: UID
      type: string
      required: false
    tick:
      type: string
      required: false
    refid:
      title: Ref ID
      type: string
      required: false
  chronology:
    apicall:
      title: APICall List
      type: '[]chronology_apicall'
      required: false
  apicalls:
    chronology:
      type: chronology
      required: false
    parameterdb:
      title: Parameter DB
      type: parameterdb
      required: false
    apidb:
      title: API DB
      type: apidb
      required: false
  module:
    base:
      type: string
      required: false
    name:
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
    tick:
      type: string
      required: false
    path:
      type: string
      required: false
  modules:
    handle:
      title: Module List
      type: '[]module'
      required: false
  handle:
    id:
      title: ID
      type: string
      required: false
    type:
      type: string
      required: false
    db:
      title: Database
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
    tick:
      type: string
      required: false
  handles:
    handle:
      title: Handle List
      type: '[]handle'
      required: false
  runtime_target:
    parentpid:
      title: Parent PID
      type: integer
      required: false
    handles:
      type: handles
      required: false
    commandline:
      type: string
      required: false
    modules:
      type: modules
      required: false
    name:
      type: string
      required: false
    mutants:
      type: object
      required: false
    normalizedpath:
      title: Normalized Path
      type: string
      required: false
    apicalls:
      title: API Calls
      type: apicalls
      required: false
    monitored:
      title: Monitored?
      type: boolean
      required: false
    date:
      type: date
      required: false
    isinjected:
      title: Is Injected?
      type: boolean
      required: false
    fileaccesses:
      title: File Accesses
      type: fileaccesses
      required: false
    cputick:
      title: CPU Tick
      type: integer
      required: false
    network:
      type: string
      required: false
    pid:
      title: PID
      type: integer
      required: false
    additionalContext:
      title: Additonal Context
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
    parentuid:
      title: Parent UID
      type: integer
      required: false
    hooks:
      type: object
      required: false
    ospath:
      title: OS Path
      type: string
      required: false
    vbeeevents:
      title: VBE Events
      type: string
      required: false
    createdfiles:
      title: Created Files
      type: object
      required: false
    inject:
      type: string
      required: false
    registry:
      type: registry
      required: false
  runtime_targets:
    target:
      title: Runtime Target
      type: runtime_target
      required: false
  network:
    httprequests:
      title: HTTP Requests
      type: string
      required: false
    portinfo:
      title: Port Info
      type: string
      required: false
    domains:
      type: string
      required: false
    hosts:
      type: string
      required: false
    ftpconnections:
      title: FTP Connections
      type: string
      required: false
    suricata_alerts:
      type: string
      required: false
  runtime:
    network:
      type: network
      required: false
    targets:
      type: runtime_targets
      required: false
  verdict:
    isreliable:
      title: Is Reliable?
      type: string
      required: false
    threatscore:
      title: Threat Score
      type: string
      required: false
    threatlevel:
      title: Threat Level
      type: string
      required: false
  characteristics:
    has_carved_files:
      title: Carved Files?
      type: string
      required: false
    total_runtime_targets:
      title: Runtime TargetNum
      type: string
      required: false
  custom_string:
    delta:
      type: string
      required: false
    filename:
      title: File Name
      type: string
      required: false
    type:
      type: string
      required: false
    sigmatch:
      title: Signature Match
      type: string
      required: false
    db:
      title: Database
      type: string
      required: false
    sourceid:
      title: Source ID
      type: string
      required: false
    origin:
      type: string
      required: false
  strings:
    string:
      title: String List
      type: '[]custom_string'
      required: false
  image:
    file:
      title: File Name
      type: string
      required: false
  imageprocessing:
    image:
      title: Image List
      type: '[]image'
      required: false
  confidence:
    threatsigimpact:
      title: ThreatSig Impact
      type: string
      required: false
    theoreticalmaxthreatsigimpact:
      title: Max Impact
      type: string
      required: false
    overallconfidence:
      title: Overall Confidence
      type: string
      required: false
  engine:
    name:
      type: string
      required: false
    total_detected:
      type: string
      required: false
    total_scans:
      type: string
      required: false
  engines:
    engine:
      type: engine
      required: false
  multiscan:
    detectrate_pcnt:
      title: DetectRate PCNT
      type: integer
      required: false
    engines:
      type: engines
      required: false
  signature:
    relevance:
      type: string
      required: false
    name:
      type: string
      required: false
    sources:
      type: string
      required: false
    type:
      type: string
      required: false
    threatlevel:
      title: Threat Level
      type: string
      required: false
    identifier:
      type: string
      required: false
    db:
      title: Database
      type: string
      required: false
  category:
    signature:
      title: Signature List
      type: '[]signature'
      required: false
    description:
      type: string
      required: false
    order:
      type: string
      required: false
    count:
      type: string
      required: false
  signatures:
    category:
      title: Category List
      type: '[]category'
      required: false
  final:
    signatures:
      type: signatures
      required: false
    multiscan:
      title: MultiScan
      type: multiscan
      required: false
    business_threats:
      type: string
      required: false
    confidence:
      type: confidence
      required: false
    imageprocessing:
      title: Image Processing
      type: imageprocessing
      required: false
    signatures_chronology:
      type: string
      required: false
    strings:
      type: strings
      required: false
    signatures_triplets:
      type: string
      required: false
    yarascanner:
      title: YARA Scanner
      type: string
      required: false
    warnings:
      type: object
      required: false
    characteristics:
      type: characteristics
      required: false
    verdict:
      type: verdict
      required: false
  hybrid_target:
    pois:
      title: POIS
      type: integer
      required: false
    streams:
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
    shellcodes:
      type: string
      required: false
  hybrid_targets:
    target:
      type: hybrid_target
      required: false
  sample:
    streams:
      type: string
      required: false
    uid:
      title: UID
      type: string
      required: false
  hybridanalysis:
    targets:
      type: hybrid_targets
      required: false
    banner:
      type: banner
      required: false
    sample:
      type: sample
      required: false
  analysis:
    general:
      type: general
      required: false
    runtime:
      type: runtime
      required: false
    final:
      type: final
      required: false
    hybridanalysis:
      title: Hybrid Analysis
      type: hybridanalysis
      required: false
  result:
    sha256:
      title: SHA256 Hash
      type: string
      required: false
    environmentId:
      title: Environment ID
      type: string
      required: false
    size:
      title: Filesize (Bytes)
      type: integer
      required: false
    vxfamily:
      description: VxFamily e.g. Trojan.Generic
      type: string
      required: false
    avdetect:
      description: AV MultiScan Detection Percentage
      type: integer
      required: false
    start_time:
      title: Analysis StartTime
      type: date
      required: false
    threatscore:
      description: Confidence value of VxStream Sandbox in the verdict; lies between
        0 and 100
      type: integer
      required: false
    verdict:
      description: File verdict e.g. malicious
      type: string
      required: false
    environmentDescription:
      title: Environment Description
      type: string
      required: false
    submitname:
      title: Filename
      description: File name
      type: string
      required: false
    type_short:
      title: File Extension
      type: string
      description: File type e.g. exe
      required: false
  report:
    classification_tags:
      type: '[]string'
      required: false
    sha256:
      title: SHA256 Hash
      type: string
      required: false
    environmentId:
      title: Environment ID
      type: string
      required: false
    submitname:
      title: Filename
      description: File name
      type: string
      required: false
    environmentDescription:
      title: Environment Description
      type: string
      required: false
    size:
      title: Filesize (Bytes)
      type: integer
      required: false
    type:
      type: string
      description: File type
      required: false
    targeturl:
      type: string
      required: false
    md5:
      title: MD5 Hash
      type: string
      required: false
    sha1:
      title: SHA1 Hash
      type: string
      required: false
    isurlanalysis:
      title: URL Analysis?
      type: boolean
      required: false
    isinteresting:
      title: Interesting?
      type: boolean
      required: false
    analysis_start_time:
      title: Analysis StartTime
      type: date
      required: false
    total_signatures:
      type: integer
      required: false
    total_processes:
      type: integer
      required: false
    total_network_connections:
      type: integer
      required: false
    threatscore:
      description: Confidence value of VxStream Sandbox in the verdict; lies between
        0 and 100
      type: integer
      required: false
    threatlevel:
      description: Threat Level
      type: integer
      required: false
    domains:
      type: '[]string'
      required: false
    hosts:
      type: '[]string'
      required: false
    verdict:
      description: File verdict e.g. malicious
      type: string
      required: false
    vxfamily:
      description: VxFamily e.g. Trojan.Generic
      type: string
      required: false
    avdetect:
      description: AV MultiScan Detection Percentage
      type: string
      required: false
connection:
  server:
    type: string
    description: VxStream Sandbox API Server URL
    required: true
    default: https://www.hybrid-analysis.com/api
  api_key:
    title: API Key
    type: credential_secret_key
    description: API key
    required: true
  api_secret:
    title: API Secret
    type: credential_secret_key
    description: API secret
    required: true
actions:
  submit:
    title: Submit File
    description: Submit file for analysis
    input:
      file:
        description: File to be analyzed. See https://vxstream-sandbox.com/faq for
          supported filetypes
        type: bytes
        required: true
      filename:
        type: string
        description: Optional filename of the malware
        required: false
      promptfill_password:
        title: Password
        description: Optional malware password to pass in to the analysis (shortcut
          for /VX:promptfill)
        type: string
        required: false
      customcmdline:
        title: Custom Command Line
        description: Custom Command Line, e.g. /VX:promptfill mypassword
        type: string
        required: false
      env_id:
        title: Environment ID
        description: Environment ID
        type: integer
        default: 100
        required: false
      scriptlogging:
        type: boolean
        title: Enable Script Logging
        default: true
        description: Enable the script logging feature. This feature can give deeper
          insights into the functionality of Javascripts, VBA macros and similar script
          languages (see 'Script calls' in the per process details)
        required: false
      hybridanalysis:
        title: Enable Hybrid Analysis
        description: Enable a unique process memory inspection. This feature may slow
          down the overall analysis, but improves behavior analysis through instruction
          level inspection regardless of execution
        type: boolean
        default: true
        required: false
      experimentalantievasion:
        title: Enable Experimental Anti Evasion Techniques
        description: Enable experimental anti-evasion features. This feature can have
          an impact application execution, but at the same time can improve performance
          for very evasive malware
        type: boolean
        default: true
        required: false
    output:
      submission_url:
        type: string
        required: false
        description: Submission URL
      response_code:
        description: Response code
        type: integer
        required: true
      hash:
        description: SHA256 Hash
        type: string
        required: false
  lookup:
    title: Lookup by Hash
    description: Get summary information for a given hash
    input:
      hash:
        description: MD5/SHA1/SHA256 hash
        type: string
        required: true
    output:
      response_code:
        description: Response code
        type: integer
        required: true
      reports:
        title: Reports
        description: Reports
        type: '[]report'
        required: false
      count:
        title: Count
        description: Number of reports returned
        type: integer
        required: false
  query:
    title: Search Database
    description: Search the database using query syntax provided at https://www.hybrid-analysis.com/faq
    input:
      query:
        description: Search parameters; syntax available at https://www.hybrid-analysis.com/faq
        type: string
        required: false
    output:
      response_code:
        description: Response code
        type: integer
        required: true
      count:
        title: Count
        description: Number of results returned
        type: integer
        required: false
      query:
        description: Query
        type: string
        required: false
      results:
        title: Results List
        description: List of results
        type: '[]result'
        required: false
  report:
    title: Retrieve Report
    description: Retrieve report by providing SHA256 hash
    input:
      hash:
        description: SHA256 Hash
        type: string
        required: false
      env_id:
        title: Environment ID
        description: Environment ID
        type: string
        required: false
    output:
      found:
        title: Found
        type: boolean
        description: True if found
        required: false
      response_code:
        title: Response code
        description: Response code
        type: integer
        required: false
      state:
        title: Analysis State
        description: State
        type: string
        required: false
      analysis:
        title: Analysis
        type: analysis
        description: Analysis
        required: false
