# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
import json


class Component:
    DESCRIPTION = "Get events for a customer based on the parameters provided"


class Input:
    CURSOR = "cursor"
    EXCLUDE_TYPES = "exclude_types"
    FROM_DATE = "from_date"
    LIMIT = "limit"
    

class Output:
    EVENTS = "events"
    

class GetSiemEventsInput(insightconnect_plugin_runtime.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "cursor": {
      "type": "string",
      "title": "Cursor",
      "description": "Identifier for next item in the list, this value is available in response as next_cursor. Response will default to last 24 hours if cursor is not within last 24 hours",
      "order": 2
    },
    "exclude_types": {
      "type": "string",
      "title": "Exclude Types",
      "description": "The string of list of types of events to be excluded",
      "order": 4
    },
    "from_date": {
      "type": "integer",
      "title": "From Date",
      "description": "The starting date from which alerts will be retrieved defined as Unix timestamp in UTC. Ignored if cursor is set. Must be within last 24 hours",
      "order": 3
    },
    "limit": {
      "type": "integer",
      "title": "Limit",
      "description": "The maximum number of items to return, default is 200, max is 1000",
      "default": 200,
      "order": 1
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class GetSiemEventsOutput(insightconnect_plugin_runtime.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "events": {
      "$ref": "#/definitions/event_aggregate",
      "title": "Events",
      "description": "Events for the specified time period",
      "order": 1
    }
  },
  "required": [
    "events"
  ],
  "definitions": {
    "core_remedy_item": {
      "type": "object",
      "title": "core_remedy_item",
      "properties": {
        "descriptor": {
          "type": "string",
          "title": "Descriptor",
          "order": 1
        },
        "result": {
          "type": "string",
          "title": "Result",
          "enum": [
            "NOT_APPLICABLE",
            "SUCCESS",
            "NOT_FOUND",
            "DELETED",
            "FAILED_TO_DELETE",
            "WHITELISTED",
            "OTHER_ERROR",
            "FAILED_TO_DELETE_SYSTEM_PROTECTED"
          ],
          "order": 2
        },
        "type": {
          "type": "string",
          "title": "Type",
          "order": 3
        }
      }
    },
    "core_remedy_items": {
      "type": "object",
      "title": "core_remedy_items",
      "properties": {
        "items": {
          "type": "array",
          "title": "Items",
          "items": {
            "$ref": "#/definitions/core_remedy_item"
          },
          "order": 1
        },
        "totalItems": {
          "type": "integer",
          "title": "TotalItems",
          "order": 2
        }
      },
      "definitions": {
        "core_remedy_item": {
          "type": "object",
          "title": "core_remedy_item",
          "properties": {
            "descriptor": {
              "type": "string",
              "title": "Descriptor",
              "order": 1
            },
            "result": {
              "type": "string",
              "title": "Result",
              "enum": [
                "NOT_APPLICABLE",
                "SUCCESS",
                "NOT_FOUND",
                "DELETED",
                "FAILED_TO_DELETE",
                "WHITELISTED",
                "OTHER_ERROR",
                "FAILED_TO_DELETE_SYSTEM_PROTECTED"
              ],
              "order": 2
            },
            "type": {
              "type": "string",
              "title": "Type",
              "order": 3
            }
          }
        }
      }
    },
    "endpoint_whitelist_properties": {
      "type": "object",
      "title": "endpoint_whitelist_properties",
      "properties": {
        "property": {
          "type": "string",
          "title": "Property",
          "order": 1
        },
        "type": {
          "type": "string",
          "title": "Type",
          "enum": [
            "SHA_256",
            "CERTIFICATE_SIGNER",
            "PATH"
          ],
          "order": 2
        }
      }
    },
    "event_aggregate": {
      "type": "object",
      "title": "event_aggregate",
      "properties": {
        "has_more": {
          "type": "boolean",
          "title": "Has More",
          "order": 1
        },
        "items": {
          "type": "array",
          "title": "Items",
          "items": {
            "$ref": "#/definitions/legacy_event_entity"
          },
          "order": 2
        },
        "next_cursor": {
          "type": "string",
          "title": "Next Cursor",
          "description": "Value of the next cursor. This will be used to make next call of API",
          "order": 3
        }
      },
      "definitions": {
        "core_remedy_item": {
          "type": "object",
          "title": "core_remedy_item",
          "properties": {
            "descriptor": {
              "type": "string",
              "title": "Descriptor",
              "order": 1
            },
            "result": {
              "type": "string",
              "title": "Result",
              "enum": [
                "NOT_APPLICABLE",
                "SUCCESS",
                "NOT_FOUND",
                "DELETED",
                "FAILED_TO_DELETE",
                "WHITELISTED",
                "OTHER_ERROR",
                "FAILED_TO_DELETE_SYSTEM_PROTECTED"
              ],
              "order": 2
            },
            "type": {
              "type": "string",
              "title": "Type",
              "order": 3
            }
          }
        },
        "core_remedy_items": {
          "type": "object",
          "title": "core_remedy_items",
          "properties": {
            "items": {
              "type": "array",
              "title": "Items",
              "items": {
                "$ref": "#/definitions/core_remedy_item"
              },
              "order": 1
            },
            "totalItems": {
              "type": "integer",
              "title": "TotalItems",
              "order": 2
            }
          },
          "definitions": {
            "core_remedy_item": {
              "type": "object",
              "title": "core_remedy_item",
              "properties": {
                "descriptor": {
                  "type": "string",
                  "title": "Descriptor",
                  "order": 1
                },
                "result": {
                  "type": "string",
                  "title": "Result",
                  "enum": [
                    "NOT_APPLICABLE",
                    "SUCCESS",
                    "NOT_FOUND",
                    "DELETED",
                    "FAILED_TO_DELETE",
                    "WHITELISTED",
                    "OTHER_ERROR",
                    "FAILED_TO_DELETE_SYSTEM_PROTECTED"
                  ],
                  "order": 2
                },
                "type": {
                  "type": "string",
                  "title": "Type",
                  "order": 3
                }
              }
            }
          }
        },
        "endpoint_whitelist_properties": {
          "type": "object",
          "title": "endpoint_whitelist_properties",
          "properties": {
            "property": {
              "type": "string",
              "title": "Property",
              "order": 1
            },
            "type": {
              "type": "string",
              "title": "Type",
              "enum": [
                "SHA_256",
                "CERTIFICATE_SIGNER",
                "PATH"
              ],
              "order": 2
            }
          }
        },
        "legacy_event_entity": {
          "type": "object",
          "title": "legacy_event_entity",
          "properties": {
            "core_remedy_items": {
              "$ref": "#/definitions/core_remedy_items",
              "title": "Core Remedy Items",
              "description": "details of the items cleaned or restored",
              "order": 1
            },
            "created_at": {
              "type": "string",
              "title": "Created At",
              "description": "The date at which the event was created",
              "order": 2
            },
            "customer_id": {
              "type": "string",
              "title": "Customer Id",
              "description": "The identifier of the customer for which record is created",
              "order": 3
            },
            "endpoint_id": {
              "type": "string",
              "title": "Endpoint Id",
              "description": "The corresponding endpoint id associated with the record",
              "order": 4
            },
            "endpoint_type": {
              "type": "string",
              "title": "Endpoint Type",
              "description": "The corresponding endpoint type associated with the record",
              "order": 5
            },
            "group": {
              "type": "string",
              "title": "Group",
              "description": "The group associated with the group",
              "order": 6
            },
            "id": {
              "type": "string",
              "title": "Id",
              "description": "The Identifier for the event",
              "order": 7
            },
            "location": {
              "type": "string",
              "title": "Location",
              "description": "The location captured for this record",
              "order": 8
            },
            "name": {
              "type": "string",
              "title": "Name",
              "description": "The name of the record created",
              "order": 9
            },
            "origin": {
              "type": "string",
              "title": "Origin",
              "description": "originating component of a detection",
              "order": 10
            },
            "severity": {
              "type": "string",
              "title": "Severity",
              "description": "The severity for this alert",
              "enum": [
                "NONE",
                "LOW",
                "MEDIUM",
                "HIGH",
                "CRITICAL"
              ],
              "order": 11
            },
            "source": {
              "type": "string",
              "title": "Source",
              "description": "The source for this record",
              "order": 12
            },
            "threat": {
              "type": "string",
              "title": "Threat",
              "description": "The threat associated with the record",
              "order": 13
            },
            "type": {
              "type": "string",
              "title": "Type",
              "description": "The type of this record",
              "order": 14
            },
            "user_id": {
              "type": "string",
              "title": "User Id",
              "description": "The identifier of the user for which record is created",
              "order": 15
            },
            "when": {
              "type": "string",
              "title": "When",
              "description": "The date at which the event was created",
              "order": 16
            },
            "whitelist_properties": {
              "type": "array",
              "title": "Whitelist Properties",
              "description": "The properties by which this event can be whitelisted on an endpoint, if applicable",
              "items": {
                "$ref": "#/definitions/endpoint_whitelist_properties"
              },
              "order": 17
            }
          },
          "definitions": {
            "core_remedy_item": {
              "type": "object",
              "title": "core_remedy_item",
              "properties": {
                "descriptor": {
                  "type": "string",
                  "title": "Descriptor",
                  "order": 1
                },
                "result": {
                  "type": "string",
                  "title": "Result",
                  "enum": [
                    "NOT_APPLICABLE",
                    "SUCCESS",
                    "NOT_FOUND",
                    "DELETED",
                    "FAILED_TO_DELETE",
                    "WHITELISTED",
                    "OTHER_ERROR",
                    "FAILED_TO_DELETE_SYSTEM_PROTECTED"
                  ],
                  "order": 2
                },
                "type": {
                  "type": "string",
                  "title": "Type",
                  "order": 3
                }
              }
            },
            "core_remedy_items": {
              "type": "object",
              "title": "core_remedy_items",
              "properties": {
                "items": {
                  "type": "array",
                  "title": "Items",
                  "items": {
                    "$ref": "#/definitions/core_remedy_item"
                  },
                  "order": 1
                },
                "totalItems": {
                  "type": "integer",
                  "title": "TotalItems",
                  "order": 2
                }
              },
              "definitions": {
                "core_remedy_item": {
                  "type": "object",
                  "title": "core_remedy_item",
                  "properties": {
                    "descriptor": {
                      "type": "string",
                      "title": "Descriptor",
                      "order": 1
                    },
                    "result": {
                      "type": "string",
                      "title": "Result",
                      "enum": [
                        "NOT_APPLICABLE",
                        "SUCCESS",
                        "NOT_FOUND",
                        "DELETED",
                        "FAILED_TO_DELETE",
                        "WHITELISTED",
                        "OTHER_ERROR",
                        "FAILED_TO_DELETE_SYSTEM_PROTECTED"
                      ],
                      "order": 2
                    },
                    "type": {
                      "type": "string",
                      "title": "Type",
                      "order": 3
                    }
                  }
                }
              }
            },
            "endpoint_whitelist_properties": {
              "type": "object",
              "title": "endpoint_whitelist_properties",
              "properties": {
                "property": {
                  "type": "string",
                  "title": "Property",
                  "order": 1
                },
                "type": {
                  "type": "string",
                  "title": "Type",
                  "enum": [
                    "SHA_256",
                    "CERTIFICATE_SIGNER",
                    "PATH"
                  ],
                  "order": 2
                }
              }
            }
          }
        }
      }
    },
    "legacy_event_entity": {
      "type": "object",
      "title": "legacy_event_entity",
      "properties": {
        "core_remedy_items": {
          "$ref": "#/definitions/core_remedy_items",
          "title": "Core Remedy Items",
          "description": "details of the items cleaned or restored",
          "order": 1
        },
        "created_at": {
          "type": "string",
          "title": "Created At",
          "description": "The date at which the event was created",
          "order": 2
        },
        "customer_id": {
          "type": "string",
          "title": "Customer Id",
          "description": "The identifier of the customer for which record is created",
          "order": 3
        },
        "endpoint_id": {
          "type": "string",
          "title": "Endpoint Id",
          "description": "The corresponding endpoint id associated with the record",
          "order": 4
        },
        "endpoint_type": {
          "type": "string",
          "title": "Endpoint Type",
          "description": "The corresponding endpoint type associated with the record",
          "order": 5
        },
        "group": {
          "type": "string",
          "title": "Group",
          "description": "The group associated with the group",
          "order": 6
        },
        "id": {
          "type": "string",
          "title": "Id",
          "description": "The Identifier for the event",
          "order": 7
        },
        "location": {
          "type": "string",
          "title": "Location",
          "description": "The location captured for this record",
          "order": 8
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "The name of the record created",
          "order": 9
        },
        "origin": {
          "type": "string",
          "title": "Origin",
          "description": "originating component of a detection",
          "order": 10
        },
        "severity": {
          "type": "string",
          "title": "Severity",
          "description": "The severity for this alert",
          "enum": [
            "NONE",
            "LOW",
            "MEDIUM",
            "HIGH",
            "CRITICAL"
          ],
          "order": 11
        },
        "source": {
          "type": "string",
          "title": "Source",
          "description": "The source for this record",
          "order": 12
        },
        "threat": {
          "type": "string",
          "title": "Threat",
          "description": "The threat associated with the record",
          "order": 13
        },
        "type": {
          "type": "string",
          "title": "Type",
          "description": "The type of this record",
          "order": 14
        },
        "user_id": {
          "type": "string",
          "title": "User Id",
          "description": "The identifier of the user for which record is created",
          "order": 15
        },
        "when": {
          "type": "string",
          "title": "When",
          "description": "The date at which the event was created",
          "order": 16
        },
        "whitelist_properties": {
          "type": "array",
          "title": "Whitelist Properties",
          "description": "The properties by which this event can be whitelisted on an endpoint, if applicable",
          "items": {
            "$ref": "#/definitions/endpoint_whitelist_properties"
          },
          "order": 17
        }
      },
      "definitions": {
        "core_remedy_item": {
          "type": "object",
          "title": "core_remedy_item",
          "properties": {
            "descriptor": {
              "type": "string",
              "title": "Descriptor",
              "order": 1
            },
            "result": {
              "type": "string",
              "title": "Result",
              "enum": [
                "NOT_APPLICABLE",
                "SUCCESS",
                "NOT_FOUND",
                "DELETED",
                "FAILED_TO_DELETE",
                "WHITELISTED",
                "OTHER_ERROR",
                "FAILED_TO_DELETE_SYSTEM_PROTECTED"
              ],
              "order": 2
            },
            "type": {
              "type": "string",
              "title": "Type",
              "order": 3
            }
          }
        },
        "core_remedy_items": {
          "type": "object",
          "title": "core_remedy_items",
          "properties": {
            "items": {
              "type": "array",
              "title": "Items",
              "items": {
                "$ref": "#/definitions/core_remedy_item"
              },
              "order": 1
            },
            "totalItems": {
              "type": "integer",
              "title": "TotalItems",
              "order": 2
            }
          },
          "definitions": {
            "core_remedy_item": {
              "type": "object",
              "title": "core_remedy_item",
              "properties": {
                "descriptor": {
                  "type": "string",
                  "title": "Descriptor",
                  "order": 1
                },
                "result": {
                  "type": "string",
                  "title": "Result",
                  "enum": [
                    "NOT_APPLICABLE",
                    "SUCCESS",
                    "NOT_FOUND",
                    "DELETED",
                    "FAILED_TO_DELETE",
                    "WHITELISTED",
                    "OTHER_ERROR",
                    "FAILED_TO_DELETE_SYSTEM_PROTECTED"
                  ],
                  "order": 2
                },
                "type": {
                  "type": "string",
                  "title": "Type",
                  "order": 3
                }
              }
            }
          }
        },
        "endpoint_whitelist_properties": {
          "type": "object",
          "title": "endpoint_whitelist_properties",
          "properties": {
            "property": {
              "type": "string",
              "title": "Property",
              "order": 1
            },
            "type": {
              "type": "string",
              "title": "Type",
              "enum": [
                "SHA_256",
                "CERTIFICATE_SIGNER",
                "PATH"
              ],
              "order": 2
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
