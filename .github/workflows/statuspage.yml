 name: Rapid7 Status

 on: [push]

 jobs:
   check-status:

     runs-on: ubuntu-latest
    
     steps:
     - name: Install dependencies
       run: sudo apt-get install -y curl jq

     - name: Check InsightConnect status
       shell: bash
       run: |
         echo "START OUTPUT"
         status=$(curl --no-progress-meter https://xj0q6t5s793q.statuspage.io/api/v2/components.json \
         | jq '.components[] | select((.name | contains("InsightConnect")) and .status!="operational")')
         echo $status
         echo "END OUTPUT"

#         if [[ -n "$status" ]]; then
#             exit 0
#         else
#             exit 77
#         fi
