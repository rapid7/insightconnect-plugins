#!/usr/bin/env python
# GENERATED BY KOMAND SDK - DO NOT EDIT
import insightconnect_plugin_runtime
from komand_microsoft_atp import connection, actions, triggers


Name = "Microsoft Windows Defender ATP"
Vendor = "rapid7"
Version = "4.4.0"
Description = "The Windows Defender Advanced Threat Protection plugin allows Rapid7 InsightConnect users to quickly take remediation actions across their organization. This plugin can isolate machines, run virus scans, and quarantine files"


class ICONMicrosoftAtp(insightconnect_plugin_runtime.Plugin):
    def __init__(self):
        super(self.__class__, self).__init__(
                name=Name,
                vendor=Vendor,
                version=Version,
                description=Description,
                connection=connection.Connection()
                )
        self.add_trigger(triggers.GetAlertMatchingKey())

        self.add_trigger(triggers.GetAlerts())

        self.add_action(actions.Blacklist())

        self.add_action(actions.FindMachinesWithInstalledSoftware())

        self.add_action(actions.GetFileIdFromAlertId())

        self.add_action(actions.GetMachineAction())

        self.add_action(actions.GetMachineInformation())

        self.add_action(actions.GetMachineVulnerabilities())

        self.add_action(actions.GetSecurityRecommendations())

        self.add_action(actions.IsolateMachine())

        self.add_action(actions.RunAntivirusScan())

        self.add_action(actions.StopAndQuarantineFile())

        self.add_action(actions.UnisolateMachine())


def main():
    """Run plugin"""
    cli = insightconnect_plugin_runtime.CLI(ICONMicrosoftAtp())
    cli.run()


if __name__ == "__main__":
    main()
