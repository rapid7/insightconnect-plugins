plugin_spec_version: v2
extension: plugin
product: ["insightconnect"]
name: cisco_threatgrid
title: Cisco ThreatGrid
description: Threat Grid combines advanced sandboxing with threat intelligence into one unified solution to protect organizations from malware
version: 1.3.0
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
tags:
- ThreatGrid
- Cisco
- malware
- analysis
- url
- file

types:
  behaviors:
    name:
      title: "Name"
      type: string
      description: "Name"
      required: false
    threat:
      title: "Threat"
      type: integer
      description: "Threat"
      required: false
    title:
      title: "Title"
      type: string
      description: "Title"
      required: false

  analyzed_file:
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    magic:
      title: "Magic"
      type: string
      description: "Magic"
      required: false
    filename:
      title: "Filename"
      type: string
      description: "Filename"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false

  general_details:
    sandbox_version:
      title: "Sandbox Version"
      type: string
      description: "Sandbox version"
      required: false
    report_created:
      title: "Report Created"
      type: string
      description: "Report created"
      required: false
    sandbox_id:
      title: "Sandbox ID"
      type: string
      description: "Sandbox ID"
      required: false

  malware_desc:
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    magic:
      title: "Magic"
      type: string
      description: "Magic"
      required: false
    filename:
      title: "Filename"
      type: string
      description: "Filename"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false

  sandcastle_env:
    display_name:
      title: "Display Name"
      type: string
      description: "Display name"
      required: false
    sample_executed:
      title: "Sample Executed"
      type: integer
      description: "Sample executed"
      required: false
    sandcastle:
      title: "Sandcastle"
      type: string
      description: "Sandcastle"
      required: false
    controlsubject:
      title: "Control Subject"
      type: string
      description: "Control subject"
      required: false
    vm:
      title: "VM"
      type: string
      description: "VM"
      required: false
    analysis_end:
      title: "Analysis End"
      type: string
      description: "Analysis end"
      required: false
    analysis_start:
      title: "Analysis Start"
      type: string
      description: "Analysis start"
      required: false
    run_time:
      title: "Run Time"
      type: integer
      description: "Run time"
      required: false
    analysis_features:
      title: "Analysis Features"
      type: "[]object"
      description: "Analysis features"
      required: false
    current_os:
      title: "Current OS"
      type: string
      description: "Current OS"
      required: false
    vm_id:
      title: "VM ID"
      type: string
      description: "VM ID"
      required: false

  metadata:
    general_details:
      title: "General Details"
      type: general_details
      description: "General details"
      required: false
    sandcastle_env:
      title: "Sandcastle ENV"
      type: sandcastle_env
      description: "Sandcastle ENV"
      required: false
    analyzed_file:
      title: "Analyzed File"
      type: analyzed_file
      description: "Analyzed file"
      required: false
    submitted_file:
      title: "Submitted File"
      type: analyzed_file
      description: "Submitted file"
      required: false
    malware_desc:
      title: "Malware Description"
      type: "[]malware_desc"
      description: "Malware description"
      required: false

  analysis:
    behaviors:
      title: "Behaviors"
      type: "[]behaviors"
      description: "Behaviors"
      required: false
    threat_score:
      title: "Threat Score"
      type: integer
      description: "Threat score"
      required: false
    metadata:
      title: "Metadata"
      type: metadata
      description: "Metadata"
      required: false

  properties:
    metadata:
      title: "Metadata"
      type: object
      description: "Metadata"
      required: false

  sample_report:
    status:
      title: "Status"
      type: string
      description: "Status"
      required: false
    sample:
      title: "Sample"
      type: string
      description: "Sample"
      required: false
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    submitted_at:
      title: "Submitted At"
      type: string
      description: "Submitted at"
      required: false
    tags:
      title: "Tags"
      type: "[]string"
      description: "Tags"
      required: false
    private:
      title: "Private"
      type: boolean
      description: "Private"
      required: false
    filename:
      title: "Filename"
      type: string
      description: "Filename"
      required: false
    organization_id:
      title: "Organization ID"
      type: integer
      description: "Organization ID"
      required: false
    state:
      title: "State"
      type: string
      description: "State"
      required: false
    vm_runtime:
      title: "VM Runtime"
      type: integer
      description: "VM runtime"
      required: false
    analysis:
      title: "Analysis"
      type: analysis
      description: "Analysis"
      required: false
    login:
      title: "Login"
      type: string
      description: "Login"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    properties:
      title: "Properties"
      type: properties
      description: "Properties"
      required: false
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false

  submit_sample_data:
      filename:
        title: "Filename"
        type: string
        description: "Filename"
        required: false
      id:
        title: "ID"
        type: string
        description: "ID"
        required: false
      login:
        title: "Login"
        type: string
        description: "Login"
        required: false
      md5:
        title: "MD5"
        type: string
        description: "MD5"
        required: false
      os:
        title: "OS"
        type: string
        description: "OS"
        required: false
      sha1:
        title: "SHA1"
        type: string
        description: "SHA1"
        required: false
      sha256:
        title: "SHA256"
        type: string
        description: "SHA256"
        required: false
      state:
        title: "State"
        type: string
        description: "State"
        required: false
      status:
        title: "Status"
        type: string
        description: "Status"
        required: false
      submission_id:
        title: "Submission ID"
        type: integer
        description: "Submission ID"
        required: false
      submitted_at:
        title: "Submitted At"
        type: string
        description: "Submitted at"
        required: false
      tags:
        title: "Tags"
        type: "[]object"
        description: "Tags"
        required: false
      vm:
        title: "VM"
        type: string
        description: "VM"
        required: false

  submit_sample_results:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    data:
      title: "Data"
      type: submit_sample_data
      description: "Data"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
  file_transaction_process:
    path:
      title: "Path"
      type: string
      description: "Path"
      required: false
    rolled_back:
      title: "Rolled Back"
      type: boolean
      description: "Rolled back"
      required: false
  error_process_data:
    error_status:
      title: "Error Status"
      type: string
      description: "Error status"
      required: false
    nt_status:
      title: "NT Status"
      type: string
      description: "NT status"
      required: false
    number_of_params:
      title: "Number Of Params"
      type: integer
      description: "Number of params"
      required: false
    parameters:
      title: "Parameters"
      type: string
      description: "Parameters"
      required: false

  error_process:
    data:
      title: "Data"
      type: error_process_data
      description: "Data"
      required: false
    timestamp:
      title: "Timestamp"
      type: float
      description: "Timestamp"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false

  entry_process:
    base_address:
      title: "Base Address"
      type: string
      description: "Base address"
      required: false
    size:
      title: "Size"
      type: string
      description: "Size"
      required: false
  memory_process:
    allocation_type:
      title: "Allocation Type"
      type: "[]string"
      description: "Allocation type"
      required: false
    entry:
      title: "Entry"
      type: "[]entry_process"
      description: "Entry"
      required: false
    process:
      title: "Process"
      type: string
      description: "Process"
      required: false
    process_handle:
      title: "Process Handle"
      type: string
      description: "Process handle"
      required: false
    protect:
      title: "Protect"
      type: "[]string"
      description: "Protect"
      required: false
    zero_bits:
      title: "Zero Bits"
      type: integer
      description: "Zero bits"
      required: false
  startup_info_process:
    command_line:
      title: "Command Line"
      type: string
      description: "Command line"
      required: false
    current_directory:
      title: "Current Directory"
      type: string
      description: "Current directory"
      required: false
    desktop_info:
      title: "Desktop Info"
      type: string
      description: "Desktop info"
      required: false
    dll_path:
      title: "DLL Path"
      type: string
      description: "DLL path"
      required: false
    image_pathname:
      title: "Image Pathname"
      type: string
      description: "Image pathname"
      required: false
    runtime_data:
      title: "Runtime Data"
      type: string
      description: "Runtime data"
      required: false
    shell_info:
      title: "Shell Info"
      type: string
      description: "Shell info"
      required: false
    tid:
      title: "TID"
      type: string
      description: "TID"
      required: false
    upid:
      title: "UpID"
      type: integer
      description: "UpID"
      required: false
    uthread:
      title: "Uthread"
      type: integer
      description: "Uthread"
      required: false
    window_title:
      title: "Window Title"
      type: string
      description: "Window title"
      required: false
  threads_process:
    client_id:
      title: "Client ID"
      type: integer
      description: "Client ID"
      required: false
    create_suspended:
      title: "Create Suspended"
      type: string
      description: "Create suspended"
      required: false
    process:
      title: "Process"
      type: string
      description: "Process"
      required: false
    process_handle:
      title: "Process Handle"
      type: string
      description: "Process handle"
      required: false
    return:
      title: "Return"
      type: integer
      description: "Return"
      required: false
    thread:
      title: "Thread"
      type: string
      description: "Thread"
      required: false

  process_analysis_item:
    analyzed_because:
      title: "Analyzed Because"
      type: string
      description: "Analyzed because"
      required: false
    atoms_added:
      title: "Atoms Added"
      type: "[]string"
      description: "Atoms added"
      required: false
    children:
      title: "Children"
      type: "[]string"
      description: "Children"
      required: false
    errors:
      title: "Errors"
      type: "[]error_process"
      description: "Errors"
      required: false
    file_transactions:
      title: "File Transactions"
      type: "[]file_transaction_process"
      description: "File transactions"
      required: false
    files_checked:
      title: "Files Checked"
      type: "[]string"
      description: "Files checked"
      required: false
    files_created:
      title: "Files Created"
      type: "[]string"
      description: "Files created"
      required: false
    files_deleted:
      title: "Files Deleted"
      type: "[]string"
      description: "Files deleted"
      required: false
    files_modified:
      title: "Files Modified"
      type: "[]string"
      description: "Files modified"
      required: false
    files_read:
      title: "Files Read"
      type: "[]string"
      description: "Files read"
      required: false
    kpid:
      title: "KpID"
      type: string
      description: "KpID"
      required: false
    memory:
      title: "Memory"
      type: "[]memory_process"
      description: "Memory"
      required: false
    monitored:
      title: "Monitored"
      type: boolean
      description: "Monitored"
      required: false
    mutants_created:
      title: "Mutants Created"
      type: "[]string"
      description: "Mutants created"
      required: false
    mutants_opened:
      title: "Mutants Opened"
      type: "[]string"
      description: "Mutants opened"
      required: false
    new:
      title: "New"
      type: boolean
      description: "New"
      required: false
    parent:
      title: "Parent"
      type: string
      description: "Parent"
      required: false
    pid:
      title: "PID"
      type: integer
      description: "PID"
      required: false
    ppid:
      title: "PpID"
      type: integer
      description: "PpID"
      required: false
    process_name:
      title: "Process Name"
      type: string
      description: "Process name"
      required: false
    registry_keys_created:
      title: "Registry Keys Created"
      type: "[]object"
      description: "Registry keys created"
      required: false
    registry_keys_deleted:
      title: "Registry Keys Deleted"
      type: "[]string"
      description: "Registry keys deleted"
      required: false
    registry_keys_modified:
      title: "Registry Keys Modified"
      type: "[]object"
      description: "Registry keys modified"
      required: false
    registry_keys_opened:
      title: "Registry Keys Opened"
      type: "[]object"
      description: "Registry keys opened"
      required: false
    registry_keys_read:
      title: "Registry Keys Read"
      type: "[]object"
      description: "Registry keys read"
      required: false
    sockets:
      title: "Sockets"
      type: "[]object"
      description: "Sockets"
      required: false
    sockets_traffic:
      title: "Sockets Traffic"
      type: "[]object"
      description: "Sockets traffic"
      required: false
    startup_info:
      title: "Startup Info"
      type: startup_info_process
      description: "Startup info"
      required: false
    threads:
      title: "Threads"
      type: "[]threads_process"
      description: "Threads"
      required: false
    time:
      title: "Time"
      type: string
      description: "Time"
      required: false


  ClamAV_artifact:
    product:
      title: "Product"
      type: string
      description: "Product"
      required: false
    product_version:
      title: "Product Version"
      type: string
      description: "Product version"
      required: false
    result:
      title: "Result"
      type: string
      description: "Result"
      required: false
    signature_version:
      title: "Signature Version"
      type: string
      description: "Signature version"
      required: false
  classification_artifact:
    family_name:
      title: "Family Name"
      type: string
      description: "Family name"
      required: false
    platform:
      title: "Platform"
      type: string
      description: "Platform"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
  query_hash_artifact:
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
  reversing_labs_artifact:
    classification:
      title: "Classification"
      type: classification_artifact
      description: "Classification"
      required: false
    first_seen:
      title: "First Seen"
      type: string
      description: "First seen"
      required: false
    last_seen:
      title: "Last Seen"
      type: string
      description: "Last seen"
      required: false
    query_hash:
      title: "Query Hash"
      type: query_hash_artifact
      description: "Query hash"
      required: false
    scanner_count:
      title: "Scanner Count"
      type: integer
      description: "Scanner count"
      required: false
    scanner_match:
      title: "Scanner Match"
      type: integer
      description: "Scanner match"
      required: false
    status:
      title: "Status"
      type: string
      description: "Status"
      required: false
    threat_level:
      title: "Threat Level"
      type: integer
      description: "Threat level"
      required: false
    threat_name:
      title: "Threat Name"
      type: string
      description: "Threat name"
      required: false
    trust_factor:
      title: "Trust Factor"
      type: integer
      description: "Trust factor"
      required: false
  yara_artifact:
    description:
      title: "Description"
      type: string
      description: "Description"
      required: false
    id:
      title: "ID"
      type: string
      description: "ID"
      required: false
    tags:
      title: "Tags"
      type: "[]string"
      description: "Tags"
      required: false
  antivirus_artifact:
    ClamAV:
      title: "Clam AV"
      type: ClamAV_artifact
      description: "Clam AV"
      required: false
    reversing_labs:
      title: "Reversing Labs"
      type: reversing_labs_artifact
      description: "Reversing labs"
      required: false
    yara:
      title: "Yara"
      type: "[]yara_artifact"
      description: "Yara"
      required: false
  file_info_artifact:
    company_name:
      title: "Company Name"
      type: string
      description: "Company name"
      required: false
    copyright:
      title: "Copyright"
      type: string
      description: "Copyright"
      required: false
    file_description:
      title: "File Description"
      type: string
      description: "File description"
      required: false
    file_version:
      title: "File Version"
      type: string
      description: "File version"
      required: false
    internal_name:
      title: "Internal Name"
      type: string
      description: "Internal name"
      required: false
    original_file_name:
      title: "Original File Name"
      type: string
      description: "Original file name"
      required: false
    product_name:
      title: "Product Name"
      type: string
      description: "Product name"
      required: false
    product_version:
      title: "Product Version"
      type: string
      description: "Product version"
      required: false
  dos_artifact:
    checksum:
      title: "Checksum"
      type: integer
      description: "Checksum"
      required: false
    header_relocations:
      title: "Header Relocations"
      type: integer
      description: "Header relocations"
      required: false
    initial_code_segment:
      title: "Initial Code Segment"
      type: integer
      description: "Initial code segment"
      required: false
    initial_instruction_pointer:
      title: "Initial Instruction Pointer"
      type: integer
      description: "Initial instruction pointer"
      required: false
    initial_stack_pointer:
      title: "Initial Stack Pointer"
      type: integer
      description: "Initial stack pointer"
      required: false
    initial_stack_segment:
      title: "Initial Stack Segment"
      type: integer
      description: "Initial stack segment"
      required: false
    pages:
      title: "Pages"
      type: integer
      description: "Pages"
      required: false
    size_in_paragraphs:
      title: "Size In Paragraphs"
      type: integer
      description: "Size in paragraphs"
      required: false
  optional_header_artifact:
    actual_checksum:
      title: "Actual Checksum"
      type: integer
      description: "Actual checksum"
      required: false
    claimed_checksum:
      title: "Claimed Checksum"
      type: integer
      description: "Claimed checksum"
      required: false
    entrypoint_address:
      title: "Entrypoint Address"
      type: integer
      description: "Entrypoint address"
      required: false
    file_alignment:
      title: "File Alignment"
      type: integer
      description: "File alignment"
      required: false
    linker_major_version:
      title: "Linker Major Version"
      type: integer
      description: "Linker major version"
      required: false
    linker_minor_version:
      title: "Linker Minor Version"
      type: integer
      description: "Linker minor version"
      required: false
    loader_flag:
      title: "Loader Flag"
      type: integer
      description: "Loader flag"
      required: false
    number_of_rva_and_sizes:
      title: "Number Of Relative Virtual Addresses And Sizes"
      type: integer
      description: "Number of relative virtual addresses and sizes"
      required: false
    reserved_field:
      title: "Reserved Field"
      type: integer
      description: "Reserved field"
      required: false
    section_alignment:
      title: "Section Alignment"
      type: integer
      description: "Section alignment"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false
    subsystem:
      title: "Subsystem"
      type: integer
      description: "Subsystem"
      required: false
    type:
      title: "Type"
      type: integer
      description: "Type"
      required: false

  actual_artifact:
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
  certificates_artifact:
    issuer:
      title: "Issuer"
      type: string
      description: "Issuer"
      required: false
    not_after:
      title: "Not After"
      type: integer
      description: "Not after"
      required: false
    not_before:
      title: "Not Before"
      type: integer
      description: "Not before"
      required: false
    serial:
      title: "Serial"
      type: string
      description: "Serial"
      required: false
    subject:
      title: "Subject"
      type: string
      description: "Subject"
      required: false
  signed_artifact:
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
  certificate_artifact:
    actual:
      title: "Actual"
      type: actual_artifact
      description: "Actual"
      required: false
    certificates:
      title: "Certificates"
      type: "[]certificates_artifact"
      description: "Certificates"
      required: false
    issuer:
      title: "Issuer"
      type: string
      description: "Issuer"
      required: false
    program:
      title: "Program"
      type: string
      description: "Program"
      required: false
    serial:
      title: "Serial"
      type: string
      description: "Serial"
      required: false
    signature_match:
      title: "Signature Match"
      type: boolean
      description: "Signature match"
      required: false
    signed:
      title: "Signed"
      type: signed_artifact
      description: "Signed"
      required: false
    subject:
      title: "Subject"
      type: string
      description: "Subject"
      required: false
    timestamp:
      title: "Timestamp"
      type: string
      description: "Timestamp"
      required: false
    url:
      title: "URL"
      type: string
      description: "URL"
      required: false



  pe_artifact:
    certificate:
      title: "Certificate"
      type: certificate_artifact
      description: "Certificate"
      required: false
    import_hash:
      title: "Import Hash"
      type: string
      description: "Import hash"
      required: false
    machine:
      title: "Machine"
      type: string
      description: "Machine"
      required: false
    number_of_symbols:
      title: "Number Of Symbols"
      type: integer
      description: "Number of symbols"
      required: false
    optional_header:
      title: "Optional Header"
      type: optional_header_artifact
      description: "Optional header"
      required: false
    signed:
      title: "Signed"
      type: boolean
      description: "Signed"
      required: false
    timestamp:
      title: "Timestamp"
      type: integer
      description: "Timestamp"
      required: false
    tls_callback_addr:
      title: "TLS Callback Address"
      type: integer
      description: "TLS callback address"
      required: false
    tls_callback_rva:
      title: "TLS Callback Relative Virtual Address"
      type: integer
      description: "TLS callback relative virtual address"
      required: false
    vt_import_hash:
      title: "VT Import Hash"
      type: string
      description: "VT import hash"
      required: false
  headers_artifact:
    dos:
      title: "Dos"
      type: dos_artifact
      description: "Dos"
      required: false
    pe:
      title: "PE"
      type: pe_artifact
      description: "PE"
      required: false
  imports_artifact:
    dll:
      title: "DLL"
      type: string
      description: "DLL"
      required: false
    entries:
      title: "Entries"
      type: "[][]string"
      description: "Entries"
      required: false
  resources_artifact:
    codepage:
      title: "Codepage"
      type: integer
      description: "Codepage"
      required: false
    language:
      title: "Language"
      type: string
      description: "Language"
      required: false
    locale:
      title: "Locale"
      type: string
      description: "Locale"
      required: false
    magic:
      title: "Magic"
      type: string
      description: "Magic"
      required: false
    mime:
      title: "MIME"
      type: string
      description: "MIME"
      required: false
    name:
      title: "Name"
      type: string
      description: "Name"
      required: false
    offset:
      title: "Offset"
      type: integer
      description: "Offset"
      required: false
    path:
      title: "Path"
      type: string
      description: "Path"
      required: false
    resource_sha256:
      title: "Resource SHA256"
      type: string
      description: "Resource SHA256"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false
    sublanguage:
      title: "Sublanguage"
      type: string
      description: "Sublanguage"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
  sections_artifact:
    address:
      title: "Address"
      type: integer
      description: "Address"
      required: false
    characteristics:
      title: "Characteristics"
      type: "[]string"
      description: "Characteristics"
      required: false
    data_pointer:
      title: "Data Pointer"
      type: integer
      description: "Data pointer"
      required: false
    entropy:
      title: "Entropy"
      type: float
      description: "Entropy"
      required: false
    entropy_type:
      title: "Entropy Type"
      type: "[]string"
      description: "Entropy type"
      required: false
    section:
      title: "Section"
      type: string
      description: "Section"
      required: false
    section_hash:
      title: "Section Hash"
      type: string
      description: "Section hash"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false
    virtual_size:
      title: "Virtual Size"
      type: integer
      description: "Virtual size"
      required: false
  forensics_artifact:
    exports:
      title: "Exports"
      type: "[][]string"
      description: "Exports"
      required: false
    file_info:
      title: "File Info"
      type: file_info_artifact
      description: "File info"
      required: false
    headers:
      title: "Headers"
      type: headers_artifact
      description: "Headers"
      required: false
    imports:
      title: "Imports"
      type: "[]imports_artifact"
      description: "Imports"
      required: false
    internal_checksum_match:
      title: "Internal Checksum Match"
      type: boolean
      description: "Internal checksum match"
      required: false
    resources:
      title: "Resources"
      type: "[]resources_artifact"
      description: "Resources"
      required: false
    sections:
      title: "Sections"
      type: "[]sections_artifact"
      description: "Sections"
      required: false
    signatures:
      title: "Signatures"
      type: "[]string"
      description: "Signatures"
      required: false
  relation_artifact:
    contains:
      title: "Contains"
      type: "[]string"
      description: "Contains"
      required: false
    extracted_from:
      title: "Extracted From"
      type: "[]string"
      description: "Extracted from"
      required: false
    network:
      title: "Network"
      type: "[]string"
      description: "Network"
      required: false
    process:
      title: "Process"
      type: "[]string"
      description: "Process"
      required: false

  artifact_analysis_item:
    antivirus:
      title: "Antivirus"
      type: antivirus_artifact
      description: "Antivirus"
      required: false
    created-time:
      title: "Created-Time"
      type: number
      description: "Created-time"
      required: false
    created_by:
      title: "Created By"
      type: "[]integer"
      description: "Created by"
      required: false
    entropy:
      title: "Entropy"
      type: float
      description: "Entropy"
      required: false
    executed_from:
      title: "Executed From"
      type: "[]integer"
      description: "Executed from"
      required: false
    forensics:
      title: "Forensics"
      type: forensics_artifact
      description: "Forensics"
      required: false
    magic-type:
      title: "Magic-Type"
      type: string
      description: "Magic-type"
      required: false
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false
    mime-type:
      title: "Mime-Type"
      type: string
      description: "Mime-type"
      required: false
    modified_by:
      title: "Modified By"
      type: "[]integer"
      description: "Modified by"
      required: false
    origin:
      title: "Origin"
      type: string
      description: "Origin"
      required: false
    path:
      title: "Path"
      type: string
      description: "Path"
      required: false
    read_by:
      title: "Read By"
      type: "[]integer"
      description: "Read by"
      required: false
    relation:
      title: "Relation"
      type: relation_artifact
      description: "Relation"
      required: false
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
    whitelist:
      title: "Whitelist"
      type: "[]object"
      description: "Whitelist"
      required: false

  ioc_data:
    Antivirus_Product:
      title: "Antivirus Product"
      description: "Antivirus product"
      type: string
      required: false
    Antivirus_Result:
      title: "Antivirus Result"
      description: "Antivirus result"
      type: string
      required: false
    Artifact_ID:
      title: "Artifact ID"
      description: "Artifact ID"
      type: integer
      required: false
    Path:
      title: "Path"
      description: "Path"
      type: string
      required: false
  ioc_analysis_item:
    category:
      title: "Category"
      type: "[]string"
      description: "Category"
      required: false
    confidence:
      title: "Confidence"
      type: integer
      description: "Confidence"
      required: false
    data:
      title: "Data"
      type: "[]ioc_data"
      description: "Data"
      required: false
    description:
      title: "Description"
      type: string
      description: "Description"
      required: false
    heuristic_coefficient:
      title: "Heuristic Coefficient"
      type: float
      description: "Heuristic coefficient"
      required: false
    hits:
      title: "Hits"
      type: integer
      description: "Hits"
      required: false
    ioc:
      title: "IOC"
      type: string
      description: "Indicator of compromise"
      required: false
    mitre-tactics:
      title: "Mitre-Tactics"
      type: "[]string"
      description: "Mitre-tactics"
      required: false
    severity:
      title: "Severity"
      type: integer
      description: "Severity"
      required: false
    tags:
      title: "Tags"
      type: "[]string"
      description: "Tags"
      required: false
    title:
      title: "Title"
      type: string
      description: "Title"
      required: false
    truncated:
      title: "Truncated"
      type: boolean
      description: "Truncated"
      required: false

  annotation_network:
    ip:
      title: "IP"
      description: "IP"
      type: string
      required: false
    asn:
      title: "ASN"
      description: "ASN"
      type: integer
      required: false
    country:
      title: "Country"
      description: "Country"
      type: string
      required: false
    country_name:
      title: "Country Name"
      description: "Country name"
      type: string
      required: false
    org:
      title: "Organization"
      description: "Organization"
      type: string
      required: false
    ts:
      title: "TS"
      description: "TS"
      type: integer
      required: false
    reverse_dns:
      title: "Reverse DNS"
      description: "Reverse DNS list"
      type: "[]string"
      required: false

  annotation_item:
    network:
      title: "Network"
      type: "[]annotation_network"
      description: "Network"
      required: false

  artifact_analysis:
    items:
      title: "Items"
      type: "[]artifact_analysis_item"
      description: "Items"
      required: false

  iocs_analysis:
    items:
      title: "Items"
      type: "[]ioc_analysis_item"
      description: "Items"
      required: false

  network_headers:
    cache-control:
      title: "Cache-Control"
      type: string
      description: "Cache-control"
      required: false
    content-length:
      title: "Content-Length"
      type: string
      description: "Content-length"
      required: false
    host:
      title: "Host"
      type: string
      description: "Host"
      required: false
    user-agent:
      title: "User-Agent"
      type: string
      description: "User-agent"
      required: false
  network_decoded:
    actual_content_type:
      title: "Actual Content Type"
      type: string
      description: "Actual content type"
      required: false
    body_len:
      title: "Body Len"
      type: integer
      description: "Body len"
      required: false
    decoded_url:
      title: "Decoded URL"
      type: string
      description: "Decoded URL"
      required: false
    fuids:
      title: "Filesystem Access User ID"
      type: "[]string"
      description: "Filesystem access user ID"
      required: false
    headers:
      title: "Headers"
      type: network_headers
      description: "Headers"
      required: false
    host:
      title: "Host"
      type: string
      description: "Host"
      required: false
    method:
      title: "Method"
      type: string
      description: "Method"
      required: false
    port:
      title: "Port"
      type: integer
      description: "Port"
      required: false
    request_filename:
      title: "Request Filename"
      type: string
      description: "Request filename"
      required: false
    request_path:
      title: "Request Path"
      type: string
      description: "Request path"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    ts:
      title: "TS"
      type: float
      description: "TS"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
    url:
      title: "URL"
      type: string
      description: "URL"
      required: false
    version:
      title: "Version"
      type: string
      description: "Version"
      required: false
  network_relation:
    process:
      title: "Process"
      type: "[]integer"
      description: "Process"
      required: false
  network_decoded_list:
    decoded:
      title: "Decoded"
      description: "List of decoded results"
      type: "[]network_decoded"
      required: false

  network_streams_analysis:
    bytes:
      title: "Bytes"
      type: integer
      description: "Bytes"
      required: false
    bytes_missed:
      title: "Bytes Missed"
      type: integer
      description: "Bytes missed"
      required: false
    bytes_orig:
      title: "Bytes Orig"
      type: integer
      description: "Bytes orig"
      required: false
    bytes_orig_payload:
      title: "Bytes Orig Payload"
      type: integer
      description: "Bytes orig payload"
      required: false
    bytes_payload:
      title: "Bytes Payload"
      type: integer
      description: "Bytes payload"
      required: false
    bytes_resp:
      title: "Bytes Resp"
      type: integer
      description: "Bytes resp"
      required: false
    bytes_resp_payload:
      title: "Bytes Resp Payload"
      type: integer
      description: "Bytes resp payload"
      required: false
    conn_state:
      title: "Conn State"
      type: string
      description: "Conn state"
      required: false
    decoded:
      title: "Decoded"
      type: "[]network_decoded_list"
      description: "Decoded"
      required: false
    dst:
      title: "Dst"
      type: string
      description: "Dst"
      required: false
    dst_port:
      title: "Dst Port"
      type: integer
      description: "Dst port"
      required: false
    duration:
      title: "Duration"
      type: float
      description: "Duration"
      required: false
    history:
      title: "History"
      type: string
      description: "History"
      required: false
    packets:
      title: "Packets"
      type: integer
      description: "Packets"
      required: false
    packets_orig:
      title: "Packets Orig"
      type: integer
      description: "Packets orig"
      required: false
    packets_resp:
      title: "Packets Resp"
      type: integer
      description: "Packets resp"
      required: false
    protocol:
      title: "Protocol"
      type: string
      description: "Protocol"
      required: false
    relation:
      title: "Relation"
      type: network_relation
      description: "Relation"
      required: false
    service:
      title: "Service"
      type: string
      description: "Service"
      required: false
    session:
      title: "Session"
      type: integer
      description: "Session"
      required: false
    src:
      title: "Src"
      type: string
      description: "Src"
      required: false
    src_port:
      title: "Src Port"
      type: integer
      description: "Src port"
      required: false
    transport:
      title: "Transport"
      type: string
      description: "Transport"
      required: false
    ts_begin:
      title: "TS Begin"
      type: float
      description: "TS begin"
      required: false
    ts_end:
      title: "TS End"
      type: float
      description: "TS end"
      required: false
    uid:
      title: "UID"
      type: string
      description: "UID"
      required: false

  processes_analysis:
    items:
      title: "Items"
      type: "[]process_analysis_item"
      description: "Items"
      required: false

  annotations_analysis:
    items:
      title: "Items"
      type: annotation_network
      description: "Items"
      required: false

  general_details_metadata:
    report_created:
      title: "Report Created"
      type: integer
      description: "Report created"
      required: false
    sandbox_id:
      title: "Sandbox ID"
      type: string
      description: "Sandbox ID"
      required: false
    sandbox_version:
      title: "Sandbox Version"
      type: string
      description: "Sandbox version"
      required: false
  malware_desc_metadata:
    filename:
      title: "Filename"
      type: string
      description: "Filename"
      required: false
    magic:
      title: "Magic"
      type: string
      description: "Magic"
      required: false
    md5:
      title: "MD5"
      type: string
      description: "MD5"
      required: false
    sha1:
      title: "SHA1"
      type: string
      description: "SHA1"
      required: false
    sha256:
      title: "SHA256"
      type: string
      description: "SHA256"
      required: false
    size:
      title: "Size"
      type: integer
      description: "Size"
      required: false
    type:
      title: "Type"
      type: string
      description: "Type"
      required: false
  sandcastle_env_metadata:
    analysis_end:
      title: "Analysis End"
      type: integer
      description: "Analysis end"
      required: false
    analysis_start:
      title: "Analysis Start"
      type: integer
      description: "Analysis start"
      required: false
    controlsubject:
      title: "Control Subject"
      type: string
      description: "Control subject"
      required: false
    current_os:
      title: "Current OS"
      type: string
      description: "Current OS"
      required: false
    display_name:
      title: "Display Name"
      type: string
      description: "Display name"
      required: false
    run_time:
      title: "Run Time"
      type: integer
      description: "Run time"
      required: false
    sample_executed:
      title: "Sample Executed"
      type: integer
      description: "Sample executed"
      required: false
    sandcastle:
      title: "Sandcastle"
      type: string
      description: "Sandcastle"
      required: false
    vm:
      title: "VM"
      type: string
      description: "VM"
      required: false
    vm_id:
      title: "VM ID"
      type: string
      description: "VM ID"
      required: false

  data_metadata:
    general_details:
      title: "General Details"
      type: general_details_metadata
      description: "General details"
      required: false
    malware_desc:
      title: "Malware Desc"
      type: "[]malware_desc_metadata"
      description: "Malware desc"
      required: false
    sandcastle_env:
      title: "Sandcastle Env"
      type: sandcastle_env_metadata
      description: "Sandcastle env"
      required: false

  artifact_report:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
    data:
      title: "Data"
      type: artifact_analysis
      description: "Data"
      required: false
  iocs_report:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
    data:
      title: "Data"
      type: iocs_analysis
      description: "Data"
      required: false
  network_streams_report:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
    data:
      title: "Data"
      type: network_streams_analysis
      description: "Data"
      required: false
  processes_report:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
    data:
      title: "Data"
      type: processes_analysis
      description: "Data"
      required: false
  annotations_report:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
    data:
      title: "Data"
      type: annotations_analysis
      description: "Data"
      required: false
  metadata_report:
    api_version:
      title: "API Version"
      type: integer
      description: "API version"
      required: false
    id:
      title: "ID"
      type: integer
      description: "ID"
      required: false
    data:
      title: "Data"
      type: data_metadata
      description: "Data"
      required: false

connection:
  region:
    title: Region
    description: Region
    type: string
    required: true
    default: US
    enum:
      - US
      - Europe
  api_key:
    title: API Key
    description: API Key
    type: credential_secret_key
    required: true

actions:
  search_for_sample_report_by_sha256:
    title: Search for a Sample Report by SHA256
    description: Search for a sample report matching the given hash
    input:
      sha256:
        title: SHA256
        type: string
        description: SHA256
        required: true
    output:
      sample_report_list:
        title: Sample Report List
        description: Sample report list
        type: "[]sample_report"
        required: true
  search_for_sample_report_by_domain:
    title: Search for a Sample Report by URL
    description: Search for a sample report matching the given domain. e.g. rapid7.com
    input:
      domain:
        title: Domain
        type: string
        description: Domain to search for
        required: true
    output:
      sample_report:
        title: Sample Report
        description: Sample report
        type: sample_report
        required: true
  search_for_sample_report_by_id:
    title: Search for a Sample Report by ID
    description: Search for a sample report matching the given ID. e.g. 87e6c357fafbc2cfcec1e1432aa03eee
    input:
      sample_id:
        title: Sample ID
        type: string
        description: Sample ID to search for
        required: true
    output:
      sample_report:
        title: Sample Report
        description: Sample report
        type: sample_report
        required: true
  submit_url:
    title: Submit URL
    description: Submit a URL to Threat Grid for analysis
    input:
      url:
        title: URL
        description: The URL to submit for analysis
        type: string
        required: true
      callback_url:
        title: Callback URL
        description: A URL where the results will POST to, upon completion of analysis
        type: string
        required: false
      email_notification:
        title: Email Notification
        description: If true, sends an email to the email address of the user that submitted the sample, upon completion of the sample analysis
        type: boolean
        required: false
      network_exit:
        title: Network Exit
        description: Any outgoing network traffic that is generated during the analysis to appear to exit from the Network Exit Location
        type: string
        required: false
      playbook:
        title: Playbook
        description: Name of a playbook to apply to this sample run
        type: string
        required: false
      private:
        title: Private
        description: Mark sample as private if not set to 'false' or any other value
        type: string
        required: false
      tags:
        type: string
        title: Tags
        description: A comma-separated list of tags applied to this sample
        required: false
      vm:
        type: string
        title: VM
        description: A string identifying a specific VM to use. See the linked configuration endpoint
        required: false
    output:
      results:
        type: submit_sample_results
        title: Results
        description: Results from submit sample
        required: false
  submit_sample:
    title: Submit Sample
    description: Submits a sample to Threat Grid for analysis
    input:
      sample:
        title: Sample
        description: The sample file
        type: file
        required: true
      callback_url:
        title: Callback URL
        description: A URL where the results will `POST` to, upon completion of analysis
        type: string
        required: false
      email_notification:
        title: Email Notification
        description: If true, sends an email to the email address of the user that submitted the sample, upon completion of the sample analysis
        type: boolean
        required: false
      network_exit:
        title: Network Exit
        description: Any outgoing network traffic that is generated during the analysis to appear to exit from the Network Exit Location
        type: string
        required: false
      playbook:
        title: Playbook
        description: Name of a playbook to apply to this sample run
        type: string
        required: false
      private:
        title: Private
        description: If present, and set to any value but `false` the sample will be marked private
        type: string
        required: false
      sample_filename:
        type: string
        title: Sample Filename
        description: Filename to use to override the default filename
        required: false
      sample_password:
        type: string
        title: Sample Password
        description: Password used to open the submitted archive or document
        required: false
      tags:
        type: string
        title: Tags
        description: A comma-separated list of tags applied to this sample
        required: false
      vm:
        type: string
        title: VM
        description: A string identifying a specific VM to use. See the linked configuration endpoint
        required: false
    output:
      results:
        type: submit_sample_results
        title: Results
        description: Results from submit sample
        required: false
  get_sample_analysis:
    title: Get Sample Analysis
    description: Retrieves analysis on a sample with the given ID
    input:
      sample_id:
        title: Sample ID
        description: ID in ThreatGrid of sample
        type: string
        required: true
    output:
      artifact_report:
        title: Artifact Report
        description: Artifact analysis
        type: artifact_report
        required: false
      iocs_report:
        title: IOCs Report
        description: IOCs analysis
        type: iocs_report
        required: false
      network_streams_report:
        title: Network Streams Report
        description: Network Streams Report
        type: network_streams_report
        required: false
      processes_report:
        title: Processes Report
        description: Processes analysis
        type: processes_report
        required: false
      annotations_report:
        title: Annotations Report
        description: Annotations analysis
        type: annotations_report
        required: false
      metadata_report:
        title: Metadata Report
        description: Metadata Analysis
        type: metadata_report
        required: false
