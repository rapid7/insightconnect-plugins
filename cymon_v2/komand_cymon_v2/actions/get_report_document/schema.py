# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Get the threat report from a feed"


class Input:
    FEED_ID = "feed_id"
    REPORT_ID = "report_id"
    

class Output:
    FEED = "feed"
    REPORT = "report"
    

class GetReportDocumentInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "feed_id": {
      "type": "string",
      "title": "Feed ID",
      "description": "Feed ID",
      "order": 1
    },
    "report_id": {
      "type": "string",
      "title": "Report ID",
      "description": "Report ID",
      "order": 2
    }
  },
  "required": [
    "feed_id",
    "report_id"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class GetReportDocumentOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "feed": {
      "$ref": "#/definitions/feed",
      "title": "Feed",
      "description": "Feed",
      "order": 1
    },
    "report": {
      "$ref": "#/definitions/searched_threat_report",
      "title": "Report",
      "description": "Report",
      "order": 2
    }
  },
  "required": [
    "feed",
    "report"
  ],
  "definitions": {
    "coordinates": {
      "type": "object",
      "title": "coordinates",
      "properties": {
        "lat": {
          "type": "number",
          "title": "Lat",
          "description": "Latitude",
          "order": 1
        },
        "lon": {
          "type": "number",
          "title": "Lon",
          "description": "Longitude",
          "order": 2
        }
      }
    },
    "feed": {
      "type": "object",
      "title": "feed",
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "description": "Feed description text",
          "order": 4
        },
        "id": {
          "type": "string",
          "title": "ID",
          "description": "Feed ID",
          "order": 1
        },
        "is_admin": {
          "type": "boolean",
          "title": "Is Admin",
          "description": "Boolean indicating if current user can administer this feed",
          "order": 11
        },
        "is_guest": {
          "type": "boolean",
          "title": "Is Guest",
          "description": "Boolean indicating if current user can read from this feed",
          "order": 13
        },
        "is_member": {
          "type": "boolean",
          "title": "Is Member",
          "description": "Boolean indicating if current user can contribute to this feed",
          "order": 12
        },
        "is_owner": {
          "type": "boolean",
          "title": "Is Owner",
          "description": "Boolean indicating if current user owns this feed",
          "order": 10
        },
        "link": {
          "type": "string",
          "title": "Link",
          "description": "URL for blog or website where users can learn more about this feed",
          "order": 5
        },
        "logo": {
          "type": "string",
          "title": "Logo",
          "description": "URL for small thumbnail for this feed (must be hosted on imgur CDN: `https://i.imgur.com/img-id`)",
          "order": 7
        },
        "name": {
          "type": "string",
          "title": "Name",
          "description": "Feed name",
          "order": 2
        },
        "privacy": {
          "type": "string",
          "title": "Privacy",
          "description": "Can be set to either `private` or `public` (default)",
          "order": 8
        },
        "slug": {
          "type": "string",
          "title": "Slug",
          "description": "URL-friendly slug",
          "order": 3
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "List of tags to categorize and help others find this feed",
          "items": {
            "type": "string"
          },
          "order": 9
        },
        "tos": {
          "type": "string",
          "title": "TOS",
          "description": "Terms of Use for this feed",
          "order": 6
        }
      }
    },
    "geo_ip_location": {
      "type": "object",
      "title": "geo_ip_location",
      "properties": {
        "city": {
          "type": "string",
          "title": "City",
          "description": "City name",
          "order": 2
        },
        "country": {
          "type": "string",
          "title": "Country",
          "description": "Country code",
          "order": 1
        },
        "point": {
          "$ref": "#/definitions/coordinates",
          "title": "Point",
          "description": "Longitude and latitude coordinates",
          "order": 3
        }
      },
      "definitions": {
        "coordinates": {
          "type": "object",
          "title": "coordinates",
          "properties": {
            "lat": {
              "type": "number",
              "title": "Lat",
              "description": "Latitude",
              "order": 1
            },
            "lon": {
              "type": "number",
              "title": "Lon",
              "description": "Longitude",
              "order": 2
            }
          }
        }
      }
    },
    "report_ioc": {
      "type": "object",
      "title": "report_ioc",
      "properties": {
        "domain": {
          "type": "string",
          "title": "Domain",
          "description": "Root domain",
          "order": 4
        },
        "hostname": {
          "type": "string",
          "title": "Hostname",
          "description": "Domain with all subdomains",
          "order": 3
        },
        "ip": {
          "type": "string",
          "title": "IP",
          "description": "IPv4 or IPv6",
          "order": 1
        },
        "md5": {
          "type": "string",
          "title": "MD5",
          "description": "MD5 hash of a malicious binary",
          "order": 5
        },
        "sha1": {
          "type": "string",
          "title": "SHA1",
          "description": "SHA1 hash of a malicious binary",
          "order": 6
        },
        "sha256": {
          "type": "string",
          "title": "SHA256",
          "description": "SHA256 hash of a malicious binary",
          "order": 7
        },
        "ssdeep": {
          "type": "string",
          "title": "SSDEEP",
          "description": "SSDEEP hash of a malicious binary",
          "order": 8
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "Malicious URL indicator",
          "order": 2
        }
      }
    },
    "searched_threat_report": {
      "type": "object",
      "title": "searched_threat_report",
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "order": 4
        },
        "feed": {
          "type": "string",
          "title": "Feed",
          "description": "The feed name",
          "order": 2
        },
        "feed_id": {
          "type": "string",
          "title": "Feed ID",
          "description": "The feed ID",
          "order": 1
        },
        "ioc": {
          "$ref": "#/definitions/report_ioc",
          "title": "IoC",
          "description": "Object with observables",
          "order": 7
        },
        "location": {
          "$ref": "#/definitions/geo_ip_location",
          "title": "Location",
          "description": "Geo IP location",
          "order": 9
        },
        "reported_by": {
          "type": "string",
          "title": "Reported By",
          "description": "The username of the person who submitted the report",
          "order": 8
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "List of tags to categorize and help others find this report",
          "items": {
            "type": "string"
          },
          "order": 5
        },
        "timestamp": {
          "type": "string",
          "title": "Timestamp",
          "displayType": "date",
          "description": "An ISO8601 date string for when this IoC was observed",
          "format": "date-time",
          "order": 6
        },
        "title": {
          "type": "string",
          "title": "Title",
          "description": "Short report title",
          "order": 3
        }
      },
      "definitions": {
        "coordinates": {
          "type": "object",
          "title": "coordinates",
          "properties": {
            "lat": {
              "type": "number",
              "title": "Lat",
              "description": "Latitude",
              "order": 1
            },
            "lon": {
              "type": "number",
              "title": "Lon",
              "description": "Longitude",
              "order": 2
            }
          }
        },
        "geo_ip_location": {
          "type": "object",
          "title": "geo_ip_location",
          "properties": {
            "city": {
              "type": "string",
              "title": "City",
              "description": "City name",
              "order": 2
            },
            "country": {
              "type": "string",
              "title": "Country",
              "description": "Country code",
              "order": 1
            },
            "point": {
              "$ref": "#/definitions/coordinates",
              "title": "Point",
              "description": "Longitude and latitude coordinates",
              "order": 3
            }
          },
          "definitions": {
            "coordinates": {
              "type": "object",
              "title": "coordinates",
              "properties": {
                "lat": {
                  "type": "number",
                  "title": "Lat",
                  "description": "Latitude",
                  "order": 1
                },
                "lon": {
                  "type": "number",
                  "title": "Lon",
                  "description": "Longitude",
                  "order": 2
                }
              }
            }
          }
        },
        "report_ioc": {
          "type": "object",
          "title": "report_ioc",
          "properties": {
            "domain": {
              "type": "string",
              "title": "Domain",
              "description": "Root domain",
              "order": 4
            },
            "hostname": {
              "type": "string",
              "title": "Hostname",
              "description": "Domain with all subdomains",
              "order": 3
            },
            "ip": {
              "type": "string",
              "title": "IP",
              "description": "IPv4 or IPv6",
              "order": 1
            },
            "md5": {
              "type": "string",
              "title": "MD5",
              "description": "MD5 hash of a malicious binary",
              "order": 5
            },
            "sha1": {
              "type": "string",
              "title": "SHA1",
              "description": "SHA1 hash of a malicious binary",
              "order": 6
            },
            "sha256": {
              "type": "string",
              "title": "SHA256",
              "description": "SHA256 hash of a malicious binary",
              "order": 7
            },
            "ssdeep": {
              "type": "string",
              "title": "SSDEEP",
              "description": "SSDEEP hash of a malicious binary",
              "order": 8
            },
            "url": {
              "type": "string",
              "title": "URL",
              "description": "Malicious URL indicator",
              "order": 2
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
