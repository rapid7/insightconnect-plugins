# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Search threat reports"


class Input:
    END_DATE = "end_date"
    SEARCH_BY = "search_by"
    START_DATE = "start_date"
    VALUE = "value"
    

class Output:
    HITS = "hits"
    

class SearchInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "end_date": {
      "type": "string",
      "title": "End Data",
      "description": "The end date for searching",
      "order": 4
    },
    "search_by": {
      "type": "string",
      "title": "Search By",
      "description": "Type of search value",
      "enum": [
        "ip_address",
        "domain_name",
        "hostname",
        "md5_hash",
        "sha1_hash",
        "sha256_hash",
        "ssdeep_hash",
        "term",
        "feed_id"
      ],
      "order": 1
    },
    "start_date": {
      "type": "string",
      "title": "Start Date",
      "description": "The start date for searching",
      "order": 3
    },
    "value": {
      "type": "string",
      "title": "Value",
      "description": "The query value to search for",
      "order": 2
    }
  },
  "required": [
    "search_by",
    "value"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class SearchOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "hits": {
      "type": "array",
      "title": "Hits",
      "description": "Threat reports matching search value",
      "items": {
        "$ref": "#/definitions/searched_threat_report"
      },
      "order": 1
    }
  },
  "required": [
    "hits"
  ],
  "definitions": {
    "coordinates": {
      "type": "object",
      "title": "coordinates",
      "properties": {
        "lat": {
          "type": "number",
          "title": "Lat",
          "description": "Latitude",
          "order": 1
        },
        "lon": {
          "type": "number",
          "title": "Lon",
          "description": "Longitude",
          "order": 2
        }
      }
    },
    "geo_ip_location": {
      "type": "object",
      "title": "geo_ip_location",
      "properties": {
        "city": {
          "type": "string",
          "title": "City",
          "description": "City name",
          "order": 2
        },
        "country": {
          "type": "string",
          "title": "Country",
          "description": "Country code",
          "order": 1
        },
        "point": {
          "$ref": "#/definitions/coordinates",
          "title": "Point",
          "description": "Longitude and latitude coordinates",
          "order": 3
        }
      },
      "definitions": {
        "coordinates": {
          "type": "object",
          "title": "coordinates",
          "properties": {
            "lat": {
              "type": "number",
              "title": "Lat",
              "description": "Latitude",
              "order": 1
            },
            "lon": {
              "type": "number",
              "title": "Lon",
              "description": "Longitude",
              "order": 2
            }
          }
        }
      }
    },
    "report_ioc": {
      "type": "object",
      "title": "report_ioc",
      "properties": {
        "domain": {
          "type": "string",
          "title": "Domain",
          "description": "Root domain",
          "order": 4
        },
        "hostname": {
          "type": "string",
          "title": "Hostname",
          "description": "Domain with all subdomains",
          "order": 3
        },
        "ip": {
          "type": "string",
          "title": "IP",
          "description": "IPv4 or IPv6",
          "order": 1
        },
        "md5": {
          "type": "string",
          "title": "MD5",
          "description": "MD5 hash of a malicious binary",
          "order": 5
        },
        "sha1": {
          "type": "string",
          "title": "SHA1",
          "description": "SHA1 hash of a malicious binary",
          "order": 6
        },
        "sha256": {
          "type": "string",
          "title": "SHA256",
          "description": "SHA256 hash of a malicious binary",
          "order": 7
        },
        "ssdeep": {
          "type": "string",
          "title": "SSDEEP",
          "description": "SSDEEP hash of a malicious binary",
          "order": 8
        },
        "url": {
          "type": "string",
          "title": "URL",
          "description": "Malicious URL indicator",
          "order": 2
        }
      }
    },
    "searched_threat_report": {
      "type": "object",
      "title": "searched_threat_report",
      "properties": {
        "description": {
          "type": "string",
          "title": "Description",
          "order": 4
        },
        "feed": {
          "type": "string",
          "title": "Feed",
          "description": "The feed name",
          "order": 2
        },
        "feed_id": {
          "type": "string",
          "title": "Feed ID",
          "description": "The feed ID",
          "order": 1
        },
        "ioc": {
          "$ref": "#/definitions/report_ioc",
          "title": "IoC",
          "description": "Object with observables",
          "order": 7
        },
        "location": {
          "$ref": "#/definitions/geo_ip_location",
          "title": "Location",
          "description": "Geo IP location",
          "order": 9
        },
        "reported_by": {
          "type": "string",
          "title": "Reported By",
          "description": "The username of the person who submitted the report",
          "order": 8
        },
        "tags": {
          "type": "array",
          "title": "Tags",
          "description": "List of tags to categorize and help others find this report",
          "items": {
            "type": "string"
          },
          "order": 5
        },
        "timestamp": {
          "type": "string",
          "title": "Timestamp",
          "displayType": "date",
          "description": "An ISO8601 date string for when this IoC was observed",
          "format": "date-time",
          "order": 6
        },
        "title": {
          "type": "string",
          "title": "Title",
          "description": "Short report title",
          "order": 3
        }
      },
      "definitions": {
        "coordinates": {
          "type": "object",
          "title": "coordinates",
          "properties": {
            "lat": {
              "type": "number",
              "title": "Lat",
              "description": "Latitude",
              "order": 1
            },
            "lon": {
              "type": "number",
              "title": "Lon",
              "description": "Longitude",
              "order": 2
            }
          }
        },
        "geo_ip_location": {
          "type": "object",
          "title": "geo_ip_location",
          "properties": {
            "city": {
              "type": "string",
              "title": "City",
              "description": "City name",
              "order": 2
            },
            "country": {
              "type": "string",
              "title": "Country",
              "description": "Country code",
              "order": 1
            },
            "point": {
              "$ref": "#/definitions/coordinates",
              "title": "Point",
              "description": "Longitude and latitude coordinates",
              "order": 3
            }
          },
          "definitions": {
            "coordinates": {
              "type": "object",
              "title": "coordinates",
              "properties": {
                "lat": {
                  "type": "number",
                  "title": "Lat",
                  "description": "Latitude",
                  "order": 1
                },
                "lon": {
                  "type": "number",
                  "title": "Lon",
                  "description": "Longitude",
                  "order": 2
                }
              }
            }
          }
        },
        "report_ioc": {
          "type": "object",
          "title": "report_ioc",
          "properties": {
            "domain": {
              "type": "string",
              "title": "Domain",
              "description": "Root domain",
              "order": 4
            },
            "hostname": {
              "type": "string",
              "title": "Hostname",
              "description": "Domain with all subdomains",
              "order": 3
            },
            "ip": {
              "type": "string",
              "title": "IP",
              "description": "IPv4 or IPv6",
              "order": 1
            },
            "md5": {
              "type": "string",
              "title": "MD5",
              "description": "MD5 hash of a malicious binary",
              "order": 5
            },
            "sha1": {
              "type": "string",
              "title": "SHA1",
              "description": "SHA1 hash of a malicious binary",
              "order": 6
            },
            "sha256": {
              "type": "string",
              "title": "SHA256",
              "description": "SHA256 hash of a malicious binary",
              "order": 7
            },
            "ssdeep": {
              "type": "string",
              "title": "SSDEEP",
              "description": "SSDEEP hash of a malicious binary",
              "order": 8
            },
            "url": {
              "type": "string",
              "title": "URL",
              "description": "Malicious URL indicator",
              "order": 2
            }
          }
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
