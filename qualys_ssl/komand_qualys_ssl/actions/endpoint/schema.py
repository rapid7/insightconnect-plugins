# GENERATED BY KOMAND SDK - DO NOT EDIT
import komand
import json


class Component:
    DESCRIPTION = "Retrieve detailed endpoint info"


class Input:
    HOST = "host"
    IP = "ip"
    

class Output:
    DELEGATION = "delegation"
    DETAILS = "details"
    DURATION = "duration"
    ETA = "eta"
    GRADE = "grade"
    GRADETRUSTIGNORED = "gradeTrustIgnored"
    HASWARNINGS = "hasWarnings"
    IPADDRESS = "ipAddress"
    ISEXCEPTIONAL = "isExceptional"
    PROGRESS = "progress"
    STATUSMESSAGE = "statusMessage"
    

class EndpointInput(komand.Input):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "host": {
      "type": "string",
      "title": "Hostname",
      "description": "Server hostname",
      "order": 1
    },
    "ip": {
      "type": "string",
      "title": "IP",
      "description": "Server IP Address",
      "order": 2
    }
  },
  "required": [
    "host",
    "ip"
  ]
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)


class EndpointOutput(komand.Output):
    schema = json.loads("""
   {
  "type": "object",
  "title": "Variables",
  "properties": {
    "delegation": {
      "type": "integer",
      "title": "Delegation",
      "description": "Delegation",
      "order": 10
    },
    "details": {
      "$ref": "#/definitions/detail",
      "title": "Details",
      "description": "Details",
      "order": 11
    },
    "duration": {
      "type": "integer",
      "title": "Duration",
      "description": "Duration",
      "order": 8
    },
    "eta": {
      "type": "integer",
      "title": "ETA",
      "description": "ETA",
      "order": 9
    },
    "grade": {
      "type": "string",
      "title": "Grade",
      "description": "Grade",
      "order": 3
    },
    "gradeTrustIgnored": {
      "type": "string",
      "title": "Grade Trust Ignored",
      "description": "Grade trust ignored",
      "order": 4
    },
    "hasWarnings": {
      "type": "boolean",
      "title": "Has Warnings",
      "description": "Has warnings",
      "order": 5
    },
    "ipAddress": {
      "type": "string",
      "title": "IP Address",
      "description": "IP address",
      "order": 1
    },
    "isExceptional": {
      "type": "boolean",
      "title": "Is Exceptional",
      "description": "Is exceptional",
      "order": 6
    },
    "progress": {
      "type": "integer",
      "title": "Progress",
      "description": "Progress",
      "order": 7
    },
    "statusMessage": {
      "type": "string",
      "title": "Status Message",
      "description": "Status message",
      "order": 2
    }
  },
  "required": [
    "delegation",
    "details",
    "duration",
    "eta",
    "grade",
    "gradeTrustIgnored",
    "hasWarnings",
    "ipAddress",
    "isExceptional",
    "progress",
    "statusMessage"
  ],
  "definitions": {
    "cert": {
      "type": "object",
      "title": "cert",
      "properties": {
        "alt_names": {
          "type": "array",
          "title": "Alt Names",
          "items": {
            "type": "string"
          },
          "order": 3
        },
        "common_names": {
          "type": "array",
          "title": "Common Names",
          "items": {
            "type": "string"
          },
          "order": 2
        },
        "crl_revocation_status": {
          "type": "integer",
          "title": "Crl Revocation Status",
          "order": 13
        },
        "crl_uris": {
          "type": "array",
          "title": "Crl Uris",
          "items": {
            "type": "string"
          },
          "order": 10
        },
        "issuer_label": {
          "type": "string",
          "title": "Issuer Label",
          "order": 7
        },
        "issuer_subject": {
          "type": "string",
          "title": "Issuer Subject",
          "order": 6
        },
        "issues": {
          "type": "integer",
          "title": "Issues",
          "order": 17
        },
        "not_after": {
          "type": "integer",
          "title": "Not After",
          "order": 5
        },
        "not_before": {
          "type": "integer",
          "title": "Not Before",
          "order": 4
        },
        "ocsp_revocation_status": {
          "type": "integer",
          "title": "Ocsp Revocation Status",
          "order": 14
        },
        "ocsp_uris": {
          "type": "array",
          "title": "Ocsp Uris",
          "items": {
            "type": "string"
          },
          "order": 11
        },
        "pinSha256": {
          "type": "string",
          "title": "PinSha256",
          "order": 20
        },
        "revocation_info": {
          "type": "integer",
          "title": "Revocation Info",
          "order": 9
        },
        "revocation_status": {
          "type": "integer",
          "title": "Revocation Status",
          "order": 12
        },
        "sct": {
          "type": "boolean",
          "title": "Sct",
          "order": 18
        },
        "sgc": {
          "type": "integer",
          "title": "Sgc",
          "order": 15
        },
        "sha1Hash": {
          "type": "string",
          "title": "Sha1Hash",
          "order": 19
        },
        "sig_alg": {
          "type": "string",
          "title": "Sig Alg",
          "order": 8
        },
        "subject": {
          "type": "string",
          "title": "Subject",
          "order": 1
        },
        "validation_type": {
          "type": "string",
          "title": "Validation Type",
          "order": 16
        }
      }
    },
    "cert_two": {
      "type": "object",
      "title": "cert_two",
      "properties": {
        "crlRevocationStatus": {
          "type": "integer",
          "title": "CrlRevocationStatus",
          "order": 13
        },
        "issuerLabel": {
          "type": "string",
          "title": "IssuerLabel",
          "order": 6
        },
        "issuerSubject": {
          "type": "string",
          "title": "IssuerSubject",
          "order": 5
        },
        "issues": {
          "type": "integer",
          "title": "Issues",
          "order": 8
        },
        "keyAlg": {
          "type": "string",
          "title": "KeyAlg",
          "order": 9
        },
        "keySize": {
          "type": "integer",
          "title": "KeySize",
          "order": 10
        },
        "keyStrength": {
          "type": "integer",
          "title": "KeyStrength",
          "order": 11
        },
        "label": {
          "type": "string",
          "title": "Label",
          "order": 2
        },
        "notAfter": {
          "type": "integer",
          "title": "NotAfter",
          "order": 4
        },
        "notBefore": {
          "type": "integer",
          "title": "NotBefore",
          "order": 3
        },
        "ocspRevocationStatus": {
          "type": "integer",
          "title": "OcspRevocationStatus",
          "order": 14
        },
        "pinSha256": {
          "type": "string",
          "title": "PinSha256",
          "order": 16
        },
        "raw": {
          "type": "string",
          "title": "Raw",
          "order": 17
        },
        "revocationStatus": {
          "type": "integer",
          "title": "RevocationStatus",
          "order": 12
        },
        "sha1Hash": {
          "type": "string",
          "title": "Sha1Hash",
          "order": 15
        },
        "sigAlg": {
          "type": "string",
          "title": "SigAlg",
          "order": 7
        },
        "subject": {
          "type": "string",
          "title": "Subject",
          "order": 1
        }
      }
    },
    "detail": {
      "type": "object",
      "title": "detail",
      "properties": {
        "cert": {
          "$ref": "#/definitions/cert",
          "title": "Cert",
          "order": 3
        },
        "chain": {
          "$ref": "#/definitions/cert_two",
          "title": "Chain",
          "order": 4
        },
        "compression_methods": {
          "type": "integer",
          "title": "Compression Methods",
          "order": 16
        },
        "fallback_scsv": {
          "type": "boolean",
          "title": "Fallback Scsv",
          "order": 28
        },
        "freak": {
          "type": "boolean",
          "title": "Freak",
          "order": 29
        },
        "has_sct": {
          "type": "integer",
          "title": "Has Sct",
          "order": 30
        },
        "host_start_time": {
          "type": "integer",
          "title": "Host Start Time",
          "order": 1
        },
        "hpkp_policy": {
          "$ref": "#/definitions/hpkp",
          "title": "Hpkp Policy",
          "order": 33
        },
        "hpkp_ro_policy": {
          "$ref": "#/definitions/hpkp",
          "title": "Hpkp Ro Policy",
          "order": 34
        },
        "hsts_policy": {
          "$ref": "#/definitions/hsts",
          "title": "Hsts Policy",
          "order": 32
        },
        "http_status_code": {
          "type": "integer",
          "title": "Http Status Code",
          "order": 20
        },
        "key": {
          "$ref": "#/definitions/key",
          "title": "Key",
          "order": 2
        },
        "logjam": {
          "type": "boolean",
          "title": "Logjam",
          "order": 31
        },
        "misc_intolerance": {
          "type": "integer",
          "title": "Misc Intolerance",
          "order": 23
        },
        "non_prefix_delegation": {
          "type": "boolean",
          "title": "Non Prefix Delegation",
          "order": 9
        },
        "open_ssl_ccs": {
          "type": "integer",
          "title": "Open Ssl Ccs",
          "order": 25
        },
        "openssl_lucky_minus20": {
          "type": "integer",
          "title": "Openssl Lucky Minus20",
          "order": 26
        },
        "poodle_tls": {
          "type": "integer",
          "title": "Poodle Tls",
          "order": 27
        },
        "prefix_delegation": {
          "type": "boolean",
          "title": "Prefix Delegation",
          "order": 8
        },
        "protocol_intolerance": {
          "type": "integer",
          "title": "Protocol Intolerance",
          "order": 22
        },
        "protocols": {
          "type": "array",
          "title": "Protocols",
          "items": {
            "$ref": "#/definitions/protocol"
          },
          "order": 5
        },
        "rc4_with_modern": {
          "type": "boolean",
          "title": "Rc4 With Modern",
          "order": 21
        },
        "reneg_support": {
          "type": "integer",
          "title": "Reneg Support",
          "order": 10
        },
        "server_signature": {
          "type": "string",
          "title": "Server Signature",
          "order": 7
        },
        "session_resumption": {
          "type": "integer",
          "title": "Session Resumption",
          "order": 15
        },
        "session_tickets": {
          "type": "integer",
          "title": "Session Tickets",
          "order": 18
        },
        "sims": {
          "$ref": "#/definitions/sims_results",
          "title": "Sims",
          "order": 24
        },
        "sni_required": {
          "type": "boolean",
          "title": "Sni Required",
          "order": 19
        },
        "sts_preload": {
          "type": "boolean",
          "title": "Sts Preload",
          "order": 14
        },
        "sts_response_header": {
          "type": "string",
          "title": "Sts Response Header",
          "order": 12
        },
        "sts_status": {
          "type": "string",
          "title": "Sts Status",
          "order": 11
        },
        "sts_subdomains": {
          "type": "boolean",
          "title": "Sts Subdomains",
          "order": 13
        },
        "suites": {
          "type": "object",
          "title": "Suites",
          "order": 6
        },
        "supports_npn": {
          "type": "boolean",
          "title": "Supports Npn",
          "order": 17
        }
      },
      "definitions": {
        "cert": {
          "type": "object",
          "title": "cert",
          "properties": {
            "alt_names": {
              "type": "array",
              "title": "Alt Names",
              "items": {
                "type": "string"
              },
              "order": 3
            },
            "common_names": {
              "type": "array",
              "title": "Common Names",
              "items": {
                "type": "string"
              },
              "order": 2
            },
            "crl_revocation_status": {
              "type": "integer",
              "title": "Crl Revocation Status",
              "order": 13
            },
            "crl_uris": {
              "type": "array",
              "title": "Crl Uris",
              "items": {
                "type": "string"
              },
              "order": 10
            },
            "issuer_label": {
              "type": "string",
              "title": "Issuer Label",
              "order": 7
            },
            "issuer_subject": {
              "type": "string",
              "title": "Issuer Subject",
              "order": 6
            },
            "issues": {
              "type": "integer",
              "title": "Issues",
              "order": 17
            },
            "not_after": {
              "type": "integer",
              "title": "Not After",
              "order": 5
            },
            "not_before": {
              "type": "integer",
              "title": "Not Before",
              "order": 4
            },
            "ocsp_revocation_status": {
              "type": "integer",
              "title": "Ocsp Revocation Status",
              "order": 14
            },
            "ocsp_uris": {
              "type": "array",
              "title": "Ocsp Uris",
              "items": {
                "type": "string"
              },
              "order": 11
            },
            "pinSha256": {
              "type": "string",
              "title": "PinSha256",
              "order": 20
            },
            "revocation_info": {
              "type": "integer",
              "title": "Revocation Info",
              "order": 9
            },
            "revocation_status": {
              "type": "integer",
              "title": "Revocation Status",
              "order": 12
            },
            "sct": {
              "type": "boolean",
              "title": "Sct",
              "order": 18
            },
            "sgc": {
              "type": "integer",
              "title": "Sgc",
              "order": 15
            },
            "sha1Hash": {
              "type": "string",
              "title": "Sha1Hash",
              "order": 19
            },
            "sig_alg": {
              "type": "string",
              "title": "Sig Alg",
              "order": 8
            },
            "subject": {
              "type": "string",
              "title": "Subject",
              "order": 1
            },
            "validation_type": {
              "type": "string",
              "title": "Validation Type",
              "order": 16
            }
          }
        },
        "cert_two": {
          "type": "object",
          "title": "cert_two",
          "properties": {
            "crlRevocationStatus": {
              "type": "integer",
              "title": "CrlRevocationStatus",
              "order": 13
            },
            "issuerLabel": {
              "type": "string",
              "title": "IssuerLabel",
              "order": 6
            },
            "issuerSubject": {
              "type": "string",
              "title": "IssuerSubject",
              "order": 5
            },
            "issues": {
              "type": "integer",
              "title": "Issues",
              "order": 8
            },
            "keyAlg": {
              "type": "string",
              "title": "KeyAlg",
              "order": 9
            },
            "keySize": {
              "type": "integer",
              "title": "KeySize",
              "order": 10
            },
            "keyStrength": {
              "type": "integer",
              "title": "KeyStrength",
              "order": 11
            },
            "label": {
              "type": "string",
              "title": "Label",
              "order": 2
            },
            "notAfter": {
              "type": "integer",
              "title": "NotAfter",
              "order": 4
            },
            "notBefore": {
              "type": "integer",
              "title": "NotBefore",
              "order": 3
            },
            "ocspRevocationStatus": {
              "type": "integer",
              "title": "OcspRevocationStatus",
              "order": 14
            },
            "pinSha256": {
              "type": "string",
              "title": "PinSha256",
              "order": 16
            },
            "raw": {
              "type": "string",
              "title": "Raw",
              "order": 17
            },
            "revocationStatus": {
              "type": "integer",
              "title": "RevocationStatus",
              "order": 12
            },
            "sha1Hash": {
              "type": "string",
              "title": "Sha1Hash",
              "order": 15
            },
            "sigAlg": {
              "type": "string",
              "title": "SigAlg",
              "order": 7
            },
            "subject": {
              "type": "string",
              "title": "Subject",
              "order": 1
            }
          }
        },
        "hpkp": {
          "type": "object",
          "title": "hpkp",
          "properties": {
            "directives": {
              "type": "array",
              "title": "Directives",
              "items": {
                "type": "string"
              },
              "order": 4
            },
            "matchedPins": {
              "type": "array",
              "title": "MatchedPins",
              "items": {
                "type": "string"
              },
              "order": 3
            },
            "pins": {
              "type": "array",
              "title": "Pins",
              "items": {
                "type": "string"
              },
              "order": 2
            },
            "status": {
              "type": "string",
              "title": "Status",
              "order": 1
            }
          }
        },
        "hsts": {
          "type": "object",
          "title": "hsts",
          "properties": {
            "directives": {
              "type": "object",
              "title": "Directives",
              "order": 3
            },
            "long_max_age": {
              "type": "integer",
              "title": "Long Max Age",
              "order": 1
            },
            "status": {
              "type": "string",
              "title": "Status",
              "order": 2
            }
          }
        },
        "key": {
          "type": "object",
          "title": "key",
          "properties": {
            "alg": {
              "type": "string",
              "title": "Alg",
              "order": 2
            },
            "debian_flaw": {
              "type": "boolean",
              "title": "Debian Flaw",
              "order": 3
            },
            "size": {
              "type": "integer",
              "title": "Size",
              "order": 1
            },
            "strength": {
              "type": "integer",
              "title": "Strength",
              "order": 4
            }
          }
        },
        "protocol": {
          "type": "object",
          "title": "protocol",
          "properties": {
            "id": {
              "type": "integer",
              "title": "Id",
              "order": 1
            },
            "name": {
              "type": "string",
              "title": "Name",
              "order": 2
            },
            "version": {
              "type": "string",
              "title": "Version",
              "order": 3
            }
          }
        },
        "sims_results": {
          "type": "object",
          "title": "sims_results",
          "properties": {
            "results": {
              "type": "array",
              "title": "Results",
              "items": {
                "type": "object"
              },
              "order": 1
            }
          }
        }
      }
    },
    "hpkp": {
      "type": "object",
      "title": "hpkp",
      "properties": {
        "directives": {
          "type": "array",
          "title": "Directives",
          "items": {
            "type": "string"
          },
          "order": 4
        },
        "matchedPins": {
          "type": "array",
          "title": "MatchedPins",
          "items": {
            "type": "string"
          },
          "order": 3
        },
        "pins": {
          "type": "array",
          "title": "Pins",
          "items": {
            "type": "string"
          },
          "order": 2
        },
        "status": {
          "type": "string",
          "title": "Status",
          "order": 1
        }
      }
    },
    "hsts": {
      "type": "object",
      "title": "hsts",
      "properties": {
        "directives": {
          "type": "object",
          "title": "Directives",
          "order": 3
        },
        "long_max_age": {
          "type": "integer",
          "title": "Long Max Age",
          "order": 1
        },
        "status": {
          "type": "string",
          "title": "Status",
          "order": 2
        }
      }
    },
    "key": {
      "type": "object",
      "title": "key",
      "properties": {
        "alg": {
          "type": "string",
          "title": "Alg",
          "order": 2
        },
        "debian_flaw": {
          "type": "boolean",
          "title": "Debian Flaw",
          "order": 3
        },
        "size": {
          "type": "integer",
          "title": "Size",
          "order": 1
        },
        "strength": {
          "type": "integer",
          "title": "Strength",
          "order": 4
        }
      }
    },
    "protocol": {
      "type": "object",
      "title": "protocol",
      "properties": {
        "id": {
          "type": "integer",
          "title": "Id",
          "order": 1
        },
        "name": {
          "type": "string",
          "title": "Name",
          "order": 2
        },
        "version": {
          "type": "string",
          "title": "Version",
          "order": 3
        }
      }
    },
    "sims_results": {
      "type": "object",
      "title": "sims_results",
      "properties": {
        "results": {
          "type": "array",
          "title": "Results",
          "items": {
            "type": "object"
          },
          "order": 1
        }
      }
    }
  }
}
    """)

    def __init__(self):
        super(self.__class__, self).__init__(self.schema)
