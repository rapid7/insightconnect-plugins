plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: sentinelone
title: SentinelOne
version: 4.2.0
description: The SentinelOne plugin allows you to manage and mitigate all your security operations through SentinelOne
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/sentinelone
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.sentinelone.com/
tags:
- sentinelone
- endpoint
- detection
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [sentinelone, endpoint, detection]
  features: []
types:
  activities_types:
    id:
      title: Type ID
      description: Activity type ID
      type: float
      required: false
    descriptionTemplate:
      title: Description Template
      description: Activity description template as seen in activity page
      type: string
      required: false
    action:
      title: Action
      description: Action descripted in the activity
      type: string
      required: false
  activities_list:
    comments:
      title: Comments
      type: string
      description: Comments
      required: false
    userId:
      title: UserId
      type: string
      description: The user who invoked the activity (If applicable)
      required: false
    accountId:
      title: Account ID
      type: string
      description: Related account (If applicable)
      required: false
    createdAt:
      title: Created At
      type: string
      description: Activity creation time (UTC)
      required: false
    data:
      title: Data
      type: object
      description: Extra activity specific data
      required: false
    agentUpdatedVersion:
      title: Agent Updated Version
      type: string
      description: Agent's new version (If applicable)
      required: false
    siteId:
      title: Site ID
      type: string
      description: Related site (If applicable)
      required: false
    id:
      title: ID
      type: string
      description: Activity ID
      required: false
    updatedAt:
      title: Updated At
      type: string
      description: Activity last updated time (UTC)
      required: false
    description:
      title: Description
      type: string
      description: Extra activity information
      required: false
    primaryDescription:
      title: Primary Description
      type: string
      description: Primary description
      required: false
    agentId:
      title: Agent ID
      type: string
      description: Related agent (If applicable)
      required: false
    hash:
      title: Hash
      type: string
      description: Threat file hash (If applicable)
      required: false
    activityType:
      title: Activity Type
      type: integer
      description: Activity type
      required: false
    osFamily:
      title: OS Family
      type: string
      description: Agent's OS type (if applicable)
      required: false
    threatId:
      title: Threat ID
      type: string
      description: Related threat (If applicable)
      required: false
    groupId:
      title: Group ID
      type: string
      description: Related group (If applicable)
      required: false
    secondaryDescription:
      title: Secondary Description
      type: string
      description: Secondary description
      required: false
  agent_applications:
    installedDate:
      title: Installed Date
      description: Date when application installed
      type: string
      required: false
    version:
      title: Version
      description: Version of installed application
      type: string
      required: false
    publisher:
      title: Publisher
      description: Publisher of installed application
      type: string
      required: false
    size:
      title: Size
      description: Size of installed application
      type: integer
      required: false
    name:
      title: Name
      description: Name of installed application
      type: string
      required: false
  agents_processes:
    startTime:
      title: Start time
      description: Start time
      type: string
      required: false
    processName:
      title: Process name
      description: Process name
      type: string
      required: false
    memoryUsage:
      title: Memory usage
      description: Memory usage (MB)
      type: integer
      required: false
    cpuUsage:
      title: CPU Usage
      description: CPU Usage (%)
      type: integer
      required: false
    executablePath:
      title: Executable path
      description: Executable path
      type: string
      required: false
    pid:
      title: PID
      description: Process ID
      type: integer
      required: false
  blacklist_data:
    affected:
      title: Affected
      type: integer
      description: Affected
      required: false
  pagination:
    totalItems:
      title: Total Items
      type: integer
      description: Total items
      required: false
    nextCursor:
      title: Next Cursor
      type: string
      description: Next cursor
      required: false
  agentDetectionInfo:
    accountId:
      title: "Accountid"
      type: string
      description: "Accountid"
      required: false
    accountName:
      title: "Accountname"
      type: string
      description: "Accountname"
      required: false
    agentDomain:
      title: "Agentdomain"
      type: string
      description: "Agentdomain"
      required: false
    agentIpV4:
      title: "Agentipv4"
      type: string
      description: "Agentipv4"
      required: false
    agentIpV6:
      title: "Agentipv6"
      type: string
      description: "Agentipv6"
      required: false
    agentLastLoggedInUserName:
      title: "Agentlastloggedinusername"
      type: string
      description: "Agentlastloggedinusername"
      required: false
    agentMitigationMode:
      title: "Agentmitigationmode"
      type: string
      description: "Agentmitigationmode"
      required: false
    agentOsName:
      title: "Agentosname"
      type: string
      description: "Agentosname"
      required: false
    agentOsRevision:
      title: "Agentosrevision"
      type: string
      description: "Agentosrevision"
      required: false
    agentRegisteredAt:
      title: "Agentregisteredat"
      type: string
      description: "Agentregisteredat"
      required: false
    agentUuid:
      title: "Agentuuid"
      type: string
      description: "Agentuuid"
      required: false
    agentVersion:
      title: "Agentversion"
      type: string
      description: "Agentversion"
      required: false
    externalIp:
      title: "Externalip"
      type: string
      description: "Externalip"
      required: false
    groupId:
      title: "Groupid"
      type: string
      description: "Groupid"
      required: false
    groupName:
      title: "Groupname"
      type: string
      description: "Groupname"
      required: false
    siteId:
      title: "Siteid"
      type: string
      description: "Siteid"
      required: false
    siteName:
      title: "Sitename"
      type: string
      description: "Sitename"
      required: false
  networkInterfaces:
    id:
      title: "Id"
      type: string
      description: "Id"
      required: false
    inet:
      title: "Inet"
      type: "[]string"
      description: "Inet"
      required: false
    inet6:
      title: "Inet6"
      type: "[]string"
      description: "Inet6"
      required: false
    name:
      title: "Name"
      type: string
      description: "Name"
      required: false
    physical:
      title: "Physical"
      type: string
      description: "Physical"
      required: false
  agentRealtimeInfo:
    accountId:
      title: "Accountid"
      type: string
      description: "Accountid"
      required: false
    accountName:
      title: "Accountname"
      type: string
      description: "Accountname"
      required: false
    activeThreats:
      title: "Activethreats"
      type: integer
      description: "Activethreats"
      required: false
    agentComputerName:
      title: "Agentcomputername"
      type: string
      description: "Agentcomputername"
      required: false
    agentDecommissionedAt:
      title: "Agentdecommissionedat"
      type: boolean
      description: "Agentdecommissionedat"
      required: false
    agentDomain:
      title: "Agentdomain"
      type: string
      description: "Agentdomain"
      required: false
    agentId:
      title: "Agentid"
      type: string
      description: "Agentid"
      required: false
    agentInfected:
      title: "Agentinfected"
      type: boolean
      description: "Agentinfected"
      required: false
    agentIsActive:
      title: "Agentisactive"
      type: boolean
      description: "Agentisactive"
      required: false
    agentIsDecommissioned:
      title: "Agentisdecommissioned"
      type: boolean
      description: "Agentisdecommissioned"
      required: false
    agentMachineType:
      title: "Agentmachinetype"
      type: string
      description: "Agentmachinetype"
      required: false
    agentMitigationMode:
      title: "Agentmitigationmode"
      type: string
      description: "Agentmitigationmode"
      required: false
    agentNetworkStatus:
      title: "Agentnetworkstatus"
      type: string
      description: "Agentnetworkstatus"
      required: false
    agentOsName:
      title: "Agentosname"
      type: string
      description: "Agentosname"
      required: false
    agentOsRevision:
      title: "Agentosrevision"
      type: string
      description: "Agentosrevision"
      required: false
    agentOsType:
      title: "Agentostype"
      type: string
      description: "Agentostype"
      required: false
    agentUuid:
      title: "Agentuuid"
      type: string
      description: "Agentuuid"
      required: false
    agentVersion:
      title: "Agentversion"
      type: string
      description: "Agentversion"
      required: false
    groupId:
      title: "Groupid"
      type: string
      description: "Groupid"
      required: false
    groupName:
      title: "Groupname"
      type: string
      description: "Groupname"
      required: false
    networkInterfaces:
      title: "Networkinterfaces"
      type: "[]networkInterfaces"
      description: "Networkinterfaces"
      required: false
    operationalState:
      title: "Operationalstate"
      type: string
      description: "Operationalstate"
      required: false
    rebootRequired:
      title: "Rebootrequired"
      type: boolean
      description: "Rebootrequired"
      required: false
    scanAbortedAt:
      title: "Scanabortedat"
      type: string
      description: "Scanabortedat"
      required: false
    scanFinishedAt:
      title: "Scanfinishedat"
      type: string
      description: "Scanfinishedat"
      required: false
    scanStartedAt:
      title: "Scanstartedat"
      type: string
      description: "Scanstartedat"
      required: false
    scanStatus:
      title: "Scanstatus"
      type: string
      description: "Scanstatus"
      required: false
    siteId:
      title: "Siteid"
      type: string
      description: "Siteid"
      required: false
    siteName:
      title: "Sitename"
      type: string
      description: "Sitename"
      required: false
    userActionsNeeded:
      title: "Useractionsneeded"
      type: "[]object"
      description: "Useractionsneeded"
      required: false
  containerInfo:
    id:
      title: "Id"
      type: string
      description: "Id"
      required: false
    image:
      title: "Image"
      type: string
      description: "Image"
      required: false
    labels:
      title: "Labels"
      type: "[]object"
      description: "Labels"
      required: false
    name:
      title: "Name"
      type: string
      description: "Name"
      required: false
  kubernetesInfo:
    cluster:
      title: "Cluster"
      type: string
      description: "Cluster"
      required: false
    controllerKind:
      title: "Controllerkind"
      type: string
      description: "Controllerkind"
      required: false
    controllerLabels:
      title: "Controllerlabels"
      type: "[]object"
      description: "Controllerlabels"
      required: false
    controllerName:
      title: "Controllername"
      type: string
      description: "Controllername"
      required: false
    namespace:
      title: "Namespace"
      type: string
      description: "Namespace"
      required: false
    namespaceLabels:
      title: "Namespacelabels"
      type: "[]object"
      description: "Namespacelabels"
      required: false
    node:
      title: "Node"
      type: string
      description: "Node"
      required: false
    pod:
      title: "Pod"
      type: string
      description: "Pod"
      required: false
    podLabels:
      title: "Podlabels"
      type: "[]object"
      description: "Podlabels"
      required: false
  actionsCounters:
    failed:
      title: "Failed"
      type: integer
      description: "Failed"
      required: false
    pendingReboot:
      title: "Pendingreboot"
      type: integer
      description: "Pendingreboot"
      required: false
    success:
      title: "Success"
      type: integer
      description: "Success"
      required: false
    total:
      title: "Total"
      type: integer
      description: "Total"
      required: false
  mitigationStatus:
    action:
      title: "Action"
      type: string
      description: "Action"
      required: false
    actionsCounters:
      title: "Actionscounters"
      type: actionsCounters
      description: "Actionscounters"
      required: false
    agentSupportsReport:
      title: "Agentsupportsreport"
      type: boolean
      description: "Agentsupportsreport"
      required: false
    groupNotFound:
      title: "Groupnotfound"
      type: boolean
      description: "Groupnotfound"
      required: false
    lastUpdate:
      title: "Lastupdate"
      type: string
      description: "Lastupdate"
      required: false
    latestReport:
      title: "Latestreport"
      type: string
      description: "Latestreport"
      required: false
    status:
      title: "Status"
      type: string
      description: "Status"
      required: false
  threatInfo:
    analystVerdict:
      title: "Analystverdict"
      type: string
      description: "Analystverdict"
      required: false
    analystVerdictDescription:
      title: "Analystverdictdescription"
      type: string
      description: "Analystverdictdescription"
      required: false
    automaticallyResolved:
      title: "Automaticallyresolved"
      type: boolean
      description: "Automaticallyresolved"
      required: false
    browserType:
      title: "Browsertype"
      type: string
      description: "Browsertype"
      required: false
    certificateId:
      title: "Certificateid"
      type: string
      description: "Certificateid"
      required: false
    classification:
      title: "Classification"
      type: string
      description: "Classification"
      required: false
    classificationSource:
      title: "Classificationsource"
      type: string
      description: "Classificationsource"
      required: false
    cloudFilesHashVerdict:
      title: "Cloudfileshashverdict"
      type: string
      description: "Cloudfileshashverdict"
      required: false
    collectionId:
      title: "Collectionid"
      type: string
      description: "Collectionid"
      required: false
    confidenceLevel:
      title: "Confidencelevel"
      type: string
      description: "Confidencelevel"
      required: false
    createdAt:
      title: "Createdat"
      type: string
      description: "Createdat"
      required: false
    detectionType:
      title: "Detectiontype"
      type: string
      description: "Detectiontype"
      required: false
    engines:
      title: "Engines"
      type: "[]string"
      description: "Engines"
      required: false
    externalTicketExists:
      title: "Externalticketexists"
      type: boolean
      description: "Externalticketexists"
      required: false
    externalTicketId:
      title: "Externalticketid"
      type: string
      description: "Externalticketid"
      required: false
    failedActions:
      title: "Failedactions"
      type: boolean
      description: "Failedactions"
      required: false
    fileExtension:
      title: "Fileextension"
      type: string
      description: "Fileextension"
      required: false
    fileExtensionType:
      title: "Fileextensiontype"
      type: string
      description: "Fileextensiontype"
      required: false
    filePath:
      title: "Filepath"
      type: string
      description: "Filepath"
      required: false
    fileSize:
      title: "Filesize"
      type: integer
      description: "Filesize"
      required: false
    fileVerificationType:
      title: "Fileverificationtype"
      type: string
      description: "Fileverificationtype"
      required: false
    identifiedAt:
      title: "Identifiedat"
      type: string
      description: "Identifiedat"
      required: false
    incidentStatus:
      title: "Incidentstatus"
      type: string
      description: "Incidentstatus"
      required: false
    incidentStatusDescription:
      title: "Incidentstatusdescription"
      type: string
      description: "Incidentstatusdescription"
      required: false
    initiatedBy:
      title: "Initiatedby"
      type: string
      description: "Initiatedby"
      required: false
    initiatedByDescription:
      title: "Initiatedbydescription"
      type: string
      description: "Initiatedbydescription"
      required: false
    initiatingUserId:
      title: "Initiatinguserid"
      type: string
      description: "Initiatinguserid"
      required: false
    initiatingUsername:
      title: "Initiatingusername"
      type: string
      description: "Initiatingusername"
      required: false
    isFileless:
      title: "Isfileless"
      type: boolean
      description: "Isfileless"
      required: false
    isValidCertificate:
      title: "Isvalidcertificate"
      type: boolean
      description: "Isvalidcertificate"
      required: false
    maliciousProcessArguments:
      title: "Maliciousprocessarguments"
      type: string
      description: "Maliciousprocessarguments"
      required: false
    md5:
      title: "Md5"
      type: string
      description: "Md5"
      required: false
    mitigatedPreemptively:
      title: "Mitigatedpreemptively"
      type: boolean
      description: "Mitigatedpreemptively"
      required: false
    mitigationStatus:
      title: "Mitigationstatus"
      type: string
      description: "Mitigationstatus"
      required: false
    mitigationStatusDescription:
      title: "Mitigationstatusdescription"
      type: string
      description: "Mitigationstatusdescription"
      required: false
    originatorProcess:
      title: "Originatorprocess"
      type: string
      description: "Originatorprocess"
      required: false
    pendingActions:
      title: "Pendingactions"
      type: boolean
      description: "Pendingactions"
      required: false
    processUser:
      title: "Processuser"
      type: string
      description: "Processuser"
      required: false
    publisherName:
      title: "Publishername"
      type: string
      description: "Publishername"
      required: false
    reachedEventsLimit:
      title: "Reachedeventslimit"
      type: boolean
      description: "Reachedeventslimit"
      required: false
    rebootRequired:
      title: "Rebootrequired"
      type: boolean
      description: "Rebootrequired"
      required: false
    sha1:
      title: "Sha1"
      type: string
      description: "Sha1"
      required: false
    sha256:
      title: "Sha256"
      type: string
      description: "Sha256"
      required: false
    storyline:
      title: "Storyline"
      type: string
      description: "Storyline"
      required: false
    threatId:
      title: "Threatid"
      type: string
      description: "Threatid"
      required: false
    threatName:
      title: "Threatname"
      type: string
      description: "Threatname"
      required: false
    updatedAt:
      title: "Updatedat"
      type: string
      description: "Updatedat"
      required: false
  data:
    agentDetectionInfo:
      title: "Agentdetectioninfo"
      type: agentDetectionInfo
      description: "Agentdetectioninfo"
      required: false
    agentRealtimeInfo:
      title: "Agentrealtimeinfo"
      type: agentRealtimeInfo
      description: "Agentrealtimeinfo"
      required: false
    containerInfo:
      title: "Containerinfo"
      type: containerInfo
      description: "Containerinfo"
      required: false
    id:
      title: "Id"
      type: string
      description: "Id"
      required: false
    indicators:
      title: "Indicators"
      type: "[]object"
      description: "Indicators"
      required: false
    kubernetesInfo:
      title: "Kubernetesinfo"
      type: kubernetesInfo
      description: "Kubernetesinfo"
      required: false
    mitigationStatus:
      title: "Mitigationstatus"
      type: "[]mitigationStatus"
      description: "Mitigationstatus"
      required: false
    threatInfo:
      title: "Threatinfo"
      type: threatInfo
      description: "Threatinfo"
      required: false
    whiteningOptions:
      title: "Whiteningoptions"
      type: "[]string"
      description: "Whiteningoptions"
      required: false
  agent_data:
    scanFinishedAt:
      title: Scan Finished At
      description: Finish time of last scan
      type: string
      required: false
    inRemoteShellSession:
      title: In Remote Shell Session
      description: Is the Agent in a remote shell session
      type: boolean
      required: false
    externalIp:
      title: External IP
      description: External IPv4 address
      type: string
      required: false
    mitigationMode:
      title: Mitigation Mode
      description: Agent mitigation mode policy
      type: string
      required: false
    isUpToDate:
      title: Is Up to Date
      description: Indicates if the agent version is up to date
      type: boolean
      required: false
    scanAbortedAt:
      title: Scan Aborted At
      description: Abort time of last scan
      type: string
      required: false
    appsVulnerabilityStatus:
      title: Apps Vulnerability Status
      description: Apps vulnerability status
      type: string
      required: false
    rangerVersion:
      title: Ranger Version
      description: The version of Ranger
      type: string
      required: false
    createdAt:
      title: Created At
      description: Created at date
      type: string
      required: false
    userActionsNeeded:
      title: User Actions Needed
      description: A list of pending user actions
      type: "[]string"
      required: false
    groupId:
      title: Group ID
      description: A reference to the containing network group
      type: string
      required: false
    isPendingUninstall:
      title: Is Pending Uninstall
      description: Agent with a pending uninstall request
      type: boolean
      required: false
    accountName:
      title: Account Name
      description: Name of the containing account
      type: string
      required: false
    siteId:
      title: Site ID
      description: A reference to the containing site
      type: string
      required: false
    siteName:
      title: Site Name
      description: Name of the containing site
      type: string
      required: false
    osStartTime:
      title: OS Start Time
      description: Last boot time
      type: string
      required: false
    activeDirectory:
      title: Active Directory
      description: Active Directory data
      type: object
      required: false
    networkInterfaces:
      title: Network Interfaces
      description: Device's network interfaces
      type: "[]object"
      required: false
    rangerStatus:
      title: Ranger Status
      description: Is Agent disabled as a Ranger
      type: string
      required: false
    accountId:
      title: Account ID
      description: A reference to the containing account
      type: string
      required: false
    threatRebootRequired:
      title: Threat Reboot Required
      description: Has at least one threat with at least one mitigation action that is pending reboot to succeed
      type: boolean
      required: false
    osArch:
      title: OS Arch
      description: OS Arch
      type: string
      required: false
    activeThreats:
      title: Active Threats
      description: Current number of active threats
      type: integer
      required: false
    installerType:
      title: Installer Type
      description: Installer package type (file extension)
      type: string
      required: false
    scanStatus:
      title: Scan Status
      description: Last scan status
      type: string
      required: false
    groupName:
      title: Group Name
      description: Name of the containing network group
      type: string
      required: false
    consoleMigrationStatus:
      title: Console Migration Status
      description: What step the agent is at in the process of migrating to another console, if any
      type: string
      required: false
    infected:
      title: Infected
      description: Indicates if the Agent has active threats
      type: boolean
      required: false
    id:
      title: ID
      description: Agent ID
      type: string
      required: false
    updatedAt:
      title: Updated at
      description: Last updated date
      type: string
      required: false
    machineType:
      title: Machine Type
      description: Machine type
      type: string
      required: false
    isDecommissioned:
      title: Is Decommissioned
      description: Is Agent decommissioned
      type: boolean
      required: false
    osRevision:
      title: OS Revision
      description: OS revision
      type: string
      required: false
    scanStartedAt:
      title: Scan Started At
      description: Start time of last scan
      type: string
      required: false
    policyUpdatedAt:
      title: Policy Updated At
      description: Date of when the policy was last updated
      type: string
      required: false
    encryptedApplications:
      title: Encrypted Applications
      description: Disk encryption status
      type: boolean
      required: false
    locations:
      title: Locations
      description: A list of locations reported by the Agent
      type: "[]object"
      required: false
    domain:
      title: Domain
      description: Network domain
      type: string
      required: false
    locationType:
      title: Location Type
      description: Reported location type
      type: string
      required: false
    registeredAt:
      title: Registered At
      description: Time of first registration to management console (similar to createdAt)
      type: string
      required: false
    totalMemory:
      title: Total Memory
      description: Memory size (MB)
      type: integer
      required: false
    groupUpdatedAt:
      title: Group Updated At
      description: Date of when the group was last updated
      type: string
      required: false
    computerName:
      title: Computer Name
      description: Computer name
      type: string
      required: false
    isUninstalled:
      title: Is Uninstalled
      description: Indicates if Agent was removed from the device
      type: boolean
      required: false
    uuid:
      title: UUID
      description: Agent's universally unique identifier
      type: string
      required: false
    licenseKey:
      title: License Key
      description: License key
      type: string
      required: false
    isActive:
      title: Is Active
      description: Indicates if the agent was recently active
      type: boolean
      required: false
    cpuCount:
      title: CPU Count
      description: Number of CPUs
      type: integer
      required: false
    modelName:
      title: Model Name
      description: Model name
      type: string
      required: false
    externalId:
      title: External ID
      description: External id set by customer
      type: string
      required: false
    coreCount:
      title: Core Count
      description: Number of CPU cores
      type: integer
      required: false
    allowRemoteShell:
      title: Allow Remote Shell
      description: Agent is capable and policy enabled for remote shell
      type: boolean
      required: false
    agentVersion:
      title: Agent Version
      description: Agent version
      type: string
      required: false
    groupIp:
      title: Group IP
      description: IP Address subnet
      type: string
      required: false
    osName:
      title: OS Name
      description: Os name
      type: string
      required: false
    mitigationModeSuspicious:
      title: Mitigation Mode Suspicious
      description: Mitigation mode policy for suspicious activity
      type: string
      required: false
    osUsername:
      title: OS Username
      description: Os username
      type: string
      required: false
    lastLoggedInUserName:
      title: Last Logged In User Name
      description: Last logged in user name
      type: string
      required: false
    cpuId:
      title: CPU ID
      description: CPU model
      type: string
      required: false
    lastActiveDate:
      title: Last Active Date
      description: Last active date
      type: string
      required: false
    osType:
      title: OS Type
      description: OS type
      type: string
      required: false
    networkStatus:
      title: Network Status
      description: Agent's network connectivity status
      type: string
      required: false
  quarantine_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    data:
      title: Data
      description: Response data
      type: object
      required: false
connection:
  credentials:
    type: credential_username_password
    title: Credentials
    description: Username and password
    required: true
    example: '{"username": "user@example.com", "password": "mypassword"}'
  url:
    title: URL
    description: SentinelOne Console URL
    type: string
    required: true
    example: https://example.sentinelone.com
actions:
  get_threat_summary:
    title: Get Threat Summary
    description: Gets summary of all threats
    output:
      pagination:
        title: Pagination
        type: pagination
        description: Pagination
        required: false
      errors:
        title: Errors
        type: '[]object'
        description: Errors
        required: false
      data:
        title: Data
        type: '[]data'
        description: Data
        required: false
  blacklist_by_content_hash:
    title: Blacklist by Content Hash
    description: Add hashed content to global blacklist. The input makes use of contentHash
      from the threat summary
    input:
      hash:
        title: Hash
        description: Content hash to add to blacklist
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
    output:
      result:
        title: Result
        type: blacklist_data
        description: Result of hashing operation
        required: true
  blacklist_by_ioc_hash:
    title: Blacklist by IOC Hash
    description: This action is obsolete, please use the other blacklist actions.
    input:
      hash:
        title: IOC Hash
        description: Indicator of compromise hash to add to blacklist
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
      agent_id:
        title: Agent ID
        description: Agent ID
        type: string
        required: true
    output:
      result:
        title: Result
        type: blacklist_data
        description: Result of hashing operation
        required: true
  create_ioc_threat:
    title: Create IOC Threat
    description: Create a threat from an IOC event
    input:
      hash:
        title: Hash
        description: SHA1 hash
        type: string
        required: true
      agentId:
        title: Agent ID
        description: Agent ID for the slim threat
        type: string
        required: true
      note:
        title: Note
        description: Note
        type: string
        required: false
      group_id:
        title: Group ID
        description: Group ID
        type: string
        required: false
      path:
        title: Path
        description: Path
        type: string
        required: false
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  mitigate_threat:
    title: Mitigate Threat
    description: Apply a mitigation action to a threat
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
        example: 1000000000000000000
      action:
        title: Action
        description: Mitigation action
        type: string
        required: true
        enum:
        - rollback-remediation
        - quarantine
        - kill
        - remediate
        - un-quarantine
        example: quarantine
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  mark_as_benign:
    title: Mark as Benign
    description: Mark a threat as resolved
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
        example: "1000000000000000000"
      target_scope:
        title: Target Scope
        description: Scope to be used for exclusions
        type: string
        required: true
        enum:
        - group
        - site
        - tenant
        example: site
      whitening_option:
        title: Whitening Option
        description: Selected whitening option
        type: string
        required: false
        enum:
        - ''
        - browser-type
        - certificate
        - file-type
        - file_hash
        - path
        example: path
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  mark_as_threat:
    title: Mark as Threat
    description: Mark a suspicious threat as a threat
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
        example: 1000000000000000000
      target_scope:
        title: Target Scope
        description: Scope to be used for exclusions
        type: string
        required: true
        enum:
        - group
        - site
        - tenant
        example: site
      whitening_option:
        title: Whitening Option
        description: Selected whitening option
        type: string
        required: false
        enum:
        - ''
        - browser-type
        - certificate
        - file-type
        - file_hash
        - path
        example: path
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  activities_list:
    title: Get Activities
    description: Get a list of activities
    input:
      group_ids:
        title: Group IDS
        description: List of Group IDs
        type: '[]string'
        required: false
        example: ["500000000000000000"]
      include_hidden:
        title: Include Hidden
        description: Include internal activities hidden from display
        type: boolean
        required: false
        example: true
      skip:
        title: Skip First N Items
        description: Skip first number of items (0-1000). For iterating over more than a 1000 items please use cursor instead
        type: integer
        required: false
        example: 0
      site_ids:
        title: Site IDS
        description: List of Site IDs to filter by
        type: '[]string'
        required: false
        example: ["5000000000000001"]
      agent_ids:
        title: Agent IDS
        description: Return activities related to specified agent ids
        type: '[]string'
        required: false
        example: ["9000000000000000"]
      skip_count:
        title: Skip Count
        description: If true, total number of items will not be calculated, which speeds up execution time
        type: boolean
        required: false
        example: false
      ids:
        title: Activity IDS
        description: List of Activity IDs
        type: '[]string'
        required: false
        example: ["800000000000000008"]
      created_at_lt:
        title: Less Then Date
        description: Return activities created before this date in ISO-8601
        type: string
        required: false
        example: "2020-12-20T18:49:26.257525Z"
      created_at_lte:
        title: Less or Equal Date
        description: Return activities created before or at this date in ISO-8601, example 2020-12-18T18:49:26.257525Z
        type: string
        required: false
      created_at_gt:
        title: Greater Then Date
        description: Return activities created after or at this date in ISO-8601, example 2020-12-18T18:49:26.257525Z
        type: string
        required: false
        example: "2020-12-18T18:49:26.257525Z"
      created_at_gte:
        title: Greater or Equal Date
        description: Return activities created after or at this date in ISO-8601, example 2020-12-18T18:49:26.257525Z
        type: string
        required: false
      created_at_between:
        title: Between Dates
        description: Return activities created within this range (inclusive), example 1514978764288-1514978999999
        type: string
        required: false
      cursor:
        title: Cursor Position
        description: Cursor position returned by the last request. Should be used for iterating over more than 1000 items.
        type: string
        required: false
        example: "YWdlbnRfaWQ6NTgwMjkzODE="
      count_only:
        title: Count Only
        description: If true, only total number of items will be returned, without any of the actual objects
        type: boolean
        required: false
        example: false
      account_ids:
        title: Account IDS
        description: List of Account IDs to filter by
        type: '[]string'
        required: false
        example: ["400000000000000000"]
      limit:
        title: Limit
        description: Limit number of returned items (1-100)
        type: integer
        required: false
        example: 10
        default: 10
      sort_by:
        title: Sort By
        description: The column to sort the results by
        type: string
        required: false
        enum:
          - id
          - activityType
          - createdAt
        example: "createdAt"
        default: "createdAt"
      activity_types:
        title: Activity Types
        description: Return only these activity codes
        type: '[]string'
        required: false
        example: ["22", "23"]
      threat_ids:
        title: Threat IDS
        description: Return only these activity codes
        type: '[]string'
        required: false
        example: ["1"]
      sort_order:
        title: Sort Order
        description: Sort direction
        type: string
        enum:
          - asc
          - desc
        required: false
        default: "asc"
        example: "asc"
      user_emails:
        title: User Emails
        description: Email of the user who invoked the activity (If applicable)
        type: '[]string'
        required: false
        example: ["example@domain.com"]
      user_ids:
        title: User IDS
        description: The user who invoked the activity (If applicable)
        type: '[]string'
        required: false
        example: ["500000000000000003"]
    output:
      data:
        title: Data
        description: Result of activities list
        type: '[]activities_list'
        required: true
  activities_types:
    title: Get Activity Types
    description: Get a list of activity types
    output:
      activity_types:
        title: Activity Types
        description: Result of activities types
        type: '[]activities_types'
        required: true
  apps_by_agent_ids:
    title: Agents Applications
    description: Retrieve running applications for a specific agent
    input:
      ids:
        title: Agent IDS
        description: Agent ID list
        type: '[]string'
        required: true
        example: ["1000000000000000000"]
    output:
      data:
        title: Agent Applications
        description: List of installed applications
        type: '[]agent_applications'
        required: true
  agents_summary:
    title: Count Summary
    description: Summary of agents by numbers
    input:
      site_ids:
        title: Site IDS
        description: List of Site IDs to filter by
        type: '[]string'
        required: false
        example: ["500000000000000000"]
      account_ids:
        title: Account IDS
        description: List of Account IDs to filter by
        type: '[]string'
        required: false
        example: ["4000000000000000000"]
    output:
      up_to_date:
        title: Up to Date Number
        description: Number of agents with the most up-to-date software version
        type: integer
        required: false
        example: 2
      out_of_date:
        title: Out of Date Number
        description: Number of agents running an older software version
        type: integer
        required: false
        example: 1
      total:
        title: Total
        description: Number of installed active agents
        type: integer
        required: false
        example: 2
      online:
        title: Online
        description: Number of online agents
        type: integer
        required: false
        example: 2
      decommissioned:
        title: Decommissioned
        description: Number of decommissioned agents
        type: integer
        required: false
        example: 0
      infected:
        title: Infected
        description: Number of agents with at least one active threat
        type: integer
        required: false
        example: 1
  name_available:
    title: Available Name
    description: Is the account name available for this account
    input:
      name:
        title: Name
        description: Account Name to validate
        type: string
        required: true
        example: test
    output:
      available:
        title: Available
        description: Account Name to validate
        type: boolean
        required: true
  agents_decommission:
    title: Agent Decommission
    description: Decommissions all agents matching the input filter, agents must be inactive before decommisioning
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - one of the following filter arguments must be supplied - ids, groupIds, filterId (filter parameters can be found at https://yoururl.sentinelone.net/api-doc/api-details?category=agent-actions&api=decommission)
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_disconnect:
    title: Disconnect Agents
    description: Disconnects agents associated to marked threats from network
    input:
      filter:
        title: Filter JSON
        description: Use any of the filtering options to control the list of affected threats. You can also leave this field empty to apply to all available threats (filter parameters can be found at https://yoururl.sentinelone.net/api-doc/api-details?category=agent-actions&api=disconnect-from-network)
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_processes:
    title: Agents Processes
    description: The endpoint for this action is obsolete. Please use the 'Agents Applications' action instead.
    input:
      ids:
        title: IDS
        description: Agent ID list
        type: '[]string'
        required: true
    output:
      agents_processes:
        title: Agents Processes
        description: Agents processes entities
        type: '[]agents_processes'
        required: false
  agents_initiate:
    title: Initiate Scan
    description: Sends a scan command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_uninstall:
    title: Uninstall
    description: Sends an uninstall command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - one of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_shutdown:
    title: Agents Shutdown
    description: Sends a shutdown command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - one of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_restart:
    title: Agents Restart
    description: Sends a restart command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - One of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_reload:
    title: Agents Reload
    description: Reload an agent module (applies to Windows agents only)
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
      module:
        title: Data Module
        description: Agent module to reload
        type: string
        required: true
        enum:
          - monitor
          - static
          - agent
          - log
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_fetch_logs:
    title: Agents Fetch Logs
    description: Sends a fetch logs command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents (filter parameters can be found at https://yoururl.sentinelone.net/api-doc/api-details?category=agent-actions&api=fetch-logs)
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_abort_scan:
    title: Agents Abort Scan
    description: Aborts running scan on all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents (filter parameters can be found at https://yoururl.sentinelone.net/api-doc/api-details?category=agent-actions&api=abort-scan)
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_connect:
    title: Connect to Network
    description: Sends a connect to network command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents (filter parameters can be found at https://yoururl.sentinelone.net/api-doc/api-details?category=agent-actions&api=connect-to-network)
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
        example: 1
  search_agents:
    title: Search Agents
    description: Search for agents
    input:
      agent:
        title: Agent
        description: Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID. If empty, this action will return all active or inactive agents depending on the value of the Agent Active input
        type: string
        example: hostname123
        required: false
      agent_active:
        title: Agent Active
        description: Return a list of all active or inactive agents when Agent input is not specified. Note that setting this to true for Active agents can return a very large amount of data
        type: boolean
        example: true
        default: true
        required: false
      case_sensitive:
        title: Case Sensitive
        description: Looks up agents in a case-sensitive manner. Setting this value to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      agents:
        title: Agents
        description: Detailed information about agents found
        type: "[]agent_data"
        required: false
  get_agent_details:
    title: Get Agent Details
    description: Retrieve agent details
    input:
      agent:
        title: Agent
        description: Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID
        type: string
        example: hostname123
        required: true
      case_sensitive:
        title: Case Sensitive
        description: Looks up the specified Agent in a case-sensitive manner. Setting this to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      agent:
        title: Agent
        description: Detailed information about agent found
        type: agent_data
        required: false
  quarantine:
    title: Quarantine
    description: Isolate (quarantine) endpoint from the network
    input:
      agent:
        title: Agent
        description: Agent to perform quarantine action on. Accepts IP address, MAC address, hostname, UUID or agent ID
        type: string
        example: hostname123
        required: true
      quarantine_state:
        title: Quarantine State
        description: True to quarantine host, false to unquarantine host
        type: boolean
        example: true
        required: true
      whitelist:
        title: Whitelist
        description: This list contains a set of devices that should not be blocked. This can include IPs, hostnames, UUIDs and agent IDs
        type: "[]string"
        example: ["198.51.100.100", "hostname123", "901345720792880606", "28db47168fa54f89aeed99769ac8d4dc"]
        required: false
      case_sensitive:
        title: Case Sensitive
        description: Looks up the specified Agent in a case-sensitive manner. Setting this value to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: quarantine_response
        required: false
  blacklist:
    title: Blacklist
    description: Blacklist and unblacklist a SHA1 hash
    input:
      hash:
        title: Hash
        description: Create a blacklist item from a SHA1 hash
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
      description:
        title: Description
        description: Description for why the hash is blacklisted
        type: string
        default: "Hash Blacklisted from InsightConnect"
        required: false
        example: "Hash Blacklisted from InsightConnect"
      blacklist_state:
        title: Blacklist State
        description: True to create blacklist hash, false to unblacklist hash
        type: boolean
        required: true
        default: true
        example: true
    output:
      success:
        title: Success
        description: Return true if blacklist item was created or deleted
        type: boolean
        required: true
  threats_fetch_file:
    title: Fetch Threats File
    description: Fetch a file associated with the threat that matches the filter. Your user role must have permissions to Fetch Threat File - Admin, IR Team, SOC
    input:
      id:
        title: ID
        description: Threat ID
        type: string
        required: true
        example: "939039647215561624"
      password:
        title: Password
        description: File encryption password, min. length 10 characters and cannot contain whitespace
        type: password
        required: true
        example: "Rapid7 Insightconnect"
    output:
      file:
        title: File
        description: Base64 encoded threat file
        type: file
        required: true

triggers:
  get_threats:
    title: Get Threats
    description: Get threats
    input:
      resolved:
        title: Resolved
        description: Include resolved threats
        type: boolean
        required: false
      classifications:
        title: Classifications
        description: List of classifications to search
        type: '[]string'
        required: false
      agent_is_active:
        title: Agent is Active
        description: Include agents currently connected to the management console
        type: boolean
        default: true
        required: false
      engines:
        title: Engines
        description: Included engines
        type: '[]string'
        required: false
      frequency:
        title: Frequency
        description: Poll frequency in seconds
        type: integer
        required: false
        default: 5
    output:
      threat:
        title: Threat
        description: Threat
        type: data
        required: false
