plugin_spec_version: v2
extension: plugin
products: [insightconnect]
name: sentinelone
title: SentinelOne
version: 4.1.0
description: The SentinelOne plugin allows you to manage and mitigate all your security operations through SentinelOne
vendor: rapid7
support: rapid7
status: []
resources:
  source_url: https://github.com/rapid7/insightconnect-plugins/tree/master/sentinelone
  license_url: https://github.com/rapid7/insightconnect-plugins/blob/master/LICENSE
  vendor_url: https://www.sentinelone.com/
tags:
- sentinelone
- endpoint
- detection
hub_tags:
  use_cases: [threat_detection_and_response]
  keywords: [sentinelone, endpoint, detection]
  features: []
types:
  activities_types:
    id:
      title: Type ID
      description: Activity type ID
      type: float
      required: false
    descriptionTemplate:
      title: Description Template
      description: Activity description template as seen in activity page
      type: string
      required: false
    action:
      title: Action
      description: Action descripted in the activity
      type: string
      required: false
  activities_list:
    comments:
      title: Comments
      type: string
      description: Comments
      required: false
    userId:
      title: UserId
      type: string
      description: The user who invoked the activity (If applicable)
      required: false
    accountId:
      title: Account ID
      type: string
      description: Related account (If applicable)
      required: false
    createdAt:
      title: Created At
      type: string
      description: Activity creation time (UTC)
      required: false
    data:
      title: Data
      type: object
      description: Extra activity specific data
      required: false
    agentUpdatedVersion:
      title: Agent Updated Version
      type: string
      description: Agent's new version (If applicable)
      required: false
    siteId:
      title: Site ID
      type: string
      description: Related site (If applicable)
      required: false
    id:
      title: ID
      type: string
      description: Activity ID
      required: false
    updatedAt:
      title: Updated At
      type: string
      description: Activity last updated time (UTC)
      required: false
    description:
      title: Description
      type: string
      description: Extra activity information
      required: false
    primaryDescription:
      title: Primary Description
      type: string
      description: Primary description
      required: false
    agentId:
      title: Agent ID
      type: string
      description: Related agent (If applicable)
      required: false
    hash:
      title: Hash
      type: string
      description: Threat file hash (If applicable)
      required: false
    activityType:
      title: Activity Type
      type: integer
      description: Activity type
      required: false
    osFamily:
      title: OS Family
      type: string
      description: Agent's OS type (if applicable)
      required: false
    threatId:
      title: Threat ID
      type: string
      description: Related threat (If applicable)
      required: false
    groupId:
      title: Group ID
      type: string
      description: Related group (If applicable)
      required: false
    secondaryDescription:
      title: Secondary Description
      type: string
      description: Secondary description
      required: false
  agent_applications:
    installedDate:
      title: Installed Date
      description: Date when application installed
      type: string
      required: false
    version:
      title: Version
      description: Version of installed application
      type: string
      required: false
    publisher:
      title: Publisher
      description: Publisher of installed application
      type: string
      required: false
    size:
      title: Size
      description: Size of installed application
      type: string
      required: false
    name:
      title: Name
      description: Name of installed application
      type: string
      required: false
  agents_processes:
    startTime:
      title: Start time
      description: Start time
      type: string
      required: false
    processName:
      title: Process name
      description: Process name
      type: string
      required: false
    memoryUsage:
      title: Memory usage
      description: Memory usage (MB)
      type: integer
      required: false
    cpuUsage:
      title: CPU Usage
      description: CPU Usage (%)
      type: integer
      required: false
    executablePath:
      title: Executable path
      description: Executable path
      type: string
      required: false
    pid:
      title: PID
      description: Process ID
      type: integer
      required: false
  blacklist_data:
    affected:
      title: Affected
      type: integer
      description: Affected
      required: false
  pagination:
    totalItems:
      title: Total Items
      type: integer
      description: Total items
      required: false
    nextCursor:
      title: Next Cursor
      type: string
      description: Next cursor
      required: false
  data:
    username:
      title: Username
      type: string
      description: Username
      required: false
    classification:
      title: Classification
      type: string
      description: Classification
      required: false
    siteName:
      title: Site Name
      type: string
      description: Site name
      required: false
    fileObjectId:
      title: File Object ID
      type: string
      description: File object ID
      required: false
    mitigationActions:
      title: Mitigation Actions
      type: '[]string'
      description: Mitigation actions
      required: false
    fileCreatedDate:
      title: File Created Date
      type: string
      description: File created date
      required: false
    fileIsExecutable:
      title: File is Executable
      type: boolean
      description: File is executable
      required: false
    agentIp:
      title: Agent IP
      type: string
      description: Agent IP
      required: false
    agentNetworkStatus:
      title: Agent Network Status
      type: string
      description: Agent network status
      required: false
    isInteractiveSession:
      title: Is Interactive Session
      type: boolean
      description: Is interactive session
      required: false
    agentVersion:
      title: Agent Version
      type: string
      description: Agent version
      required: false
    mitigationReport:
      title: Mitigation Report
      type: object
      description: Mitigation report
      required: false
    id:
      title: ID
      type: string
      description: ID
      required: false
    fileData:
      title: File Data
      type: object
      description: File data
      required: false
    agentId:
      title: Agent ID
      type: string
      description: Agent ID
      required: false
    fileExtensionType:
      title: File Extension Type
      type: string
      description: File extension type
      required: false
    fileDisplayName:
      title: File Display Name
      type: string
      description: File display name
      required: false
    createdAt:
      title: Created At
      type: string
      description: Created At
      required: false
    whiteningOptions:
      title: Whitening Options
      type: '[]string'
      description: Whitening options
      required: false
    maliciousProcessArguments:
      title: Malicious Process Arguments
      type: string
      description: Malicious process arguments
      required: false
    certId:
      title: Cert ID
      type: string
      description: Cert ID
      required: false
    engines:
      title: Engines
      type: '[]string'
      description: Engines
      required: false
    collectionId:
      title: Collection ID
      type: string
      description: Collection ID
      required: false
    inQuarantine:
      title: In Quarantine
      type: boolean
      description: In quarantine
      required: false
    browserType:
      title: Browser Type
      type: string
      description: Browser type
      required: false
    fileIsSystem:
      title: File is System
      type: boolean
      description: File is system
      required: false
    markedAsBenign:
      title: Marked as Benign
      type: boolean
      description: Marked as Benign
      required: false
    cloudVerdict:
      title: Cloud Verdict
      type: string
      description: Cloud verdict
      required: false
    indicators:
      title: Indicators
      type: '[]integer'
      description: Indicators
      required: false
    classificationSource:
      title: Classification Source
      type: string
      description: Classification source
      required: false
    agentComputerName:
      title: Agent Computer Name
      type: string
      description: Agent computer name
      required: false
    mitigationStatus:
      title: Mitigation Status
      type: string
      description: Mitigation status
      required: false
    resolved:
      title: Resolved
      type: boolean
      description: Resolved
      required: false
    fileSha256:
      title: File SHA 256
      type: string
      description: File SHA 256
      required: false
    description:
      title: Description
      type: string
      description: Description
      required: false
    filePath:
      title: File Path
      type: string
      description: File path
      required: false
    fromScan:
      title: From Scan
      type: boolean
      description: From scan
      required: false
    classifierName:
      title: Classifiername
      type: string
      description: Classifiername
      required: false
    agentMachineType:
      title: Agent Machine Type
      type: string
      description: Agent machine type
      required: false
    isCertValid:
      title: Is Cert Valid
      type: boolean
      description: Is cert valid
      required: false
    fileIsDotNet:
      title: File is Dotnet
      type: boolean
      description: File is dotnet
      required: false
    fileContentHash:
      title: File Content Hash
      type: string
      description: File content hash
      required: false
    siteId:
      title: Site ID
      type: string
      description: Site ID
      required: false
    rank:
      title: Rank
      type: integer
      description: Rank
      required: false
    createdDate:
      title: Created Date
      type: string
      description: Created date
      required: false
    updatedAt:
      title: Updated At
      type: string
      description: Updated at
      required: false
    agentOsType:
      title: Agent OS Type
      type: string
      description: Agent OS type
      required: false
    agentIsDecommissioned:
      title: Agent is Decommissioned
      type: boolean
      description: Agent is Decommissioned
      required: false
    isPartialStory:
      title: Is Partial Story
      type: boolean
      description: Is partial story
      required: false
    annotation:
      title: Annotation
      type: string
      description: Annotation
      required: false
    fileVerificationType:
      title: File Verification Type
      type: string
      description: File verification type
      required: false
    publisher:
      title: Publisher
      type: string
      description: Publisher
      required: false
    threatName:
      title: Threat Name
      type: string
      description: Threat name
      required: false
    maliciousGroupId:
      title: Malicious Group ID
      type: string
      description: Malicious group ID
      required: false
    annotationUrl:
      title: Annotation URL
      type: string
      description: Annotation URL
      required: false
    agentIsActive:
      title: Agent is Active
      type: boolean
      description: Agent is Active
      required: false
    fromCloud:
      title: From Cloud
      type: boolean
      description: From cloud
      required: false
    mitigationMode:
      title: Mitigation Mode
      type: string
      description: Mitigation mode
      required: false
    agentDomain:
      title: Agent Domain
      type: string
      description: Agent domain
      required: false
    agentInfected:
      title: Agent Infected
      type: boolean
      description: Agent infected
      required: false
    threatAgentVersion:
      title: Threat Agent Version
      type: string
      description: Threat agent version
      required: false
    fileMaliciousContent:
      title: File Malicious Content
      type: boolean
      description: File malicious content
      required: false
  agent_data:
    scanFinishedAt:
      title: Scan Finished At
      description: Finish time of last scan
      type: string
      required: false
    inRemoteShellSession:
      title: In Remote Shell Session
      description: Is the Agent in a remote shell session
      type: boolean
      required: false
    externalIp:
      title: External IP
      description: External IPv4 address
      type: string
      required: false
    mitigationMode:
      title: Mitigation Mode
      description: Agent mitigation mode policy
      type: string
      required: false
    isUpToDate:
      title: Is Up to Date
      description: Indicates if the agent version is up to date
      type: boolean
      required: false
    scanAbortedAt:
      title: Scan Aborted At
      description: Abort time of last scan
      type: string
      required: false
    appsVulnerabilityStatus:
      title: Apps Vulnerability Status
      description: Apps vulnerability status
      type: string
      required: false
    rangerVersion:
      title: Ranger Version
      description: The version of Ranger
      type: string
      required: false
    createdAt:
      title: Created At
      description: Created at date
      type: string
      required: false
    userActionsNeeded:
      title: User Actions Needed
      description: A list of pending user actions
      type: "[]string"
      required: false
    groupId:
      title: Group ID
      description: A reference to the containing network group
      type: string
      required: false
    isPendingUninstall:
      title: Is Pending Uninstall
      description: Agent with a pending uninstall request
      type: boolean
      required: false
    accountName:
      title: Account Name
      description: Name of the containing account
      type: string
      required: false
    siteId:
      title: Site ID
      description: A reference to the containing site
      type: string
      required: false
    siteName:
      title: Site Name
      description: Name of the containing site
      type: string
      required: false
    osStartTime:
      title: OS Start Time
      description: Last boot time
      type: string
      required: false
    activeDirectory:
      title: Active Directory
      description: Active Directory data
      type: object
      required: false
    networkInterfaces:
      title: Network Interfaces
      description: Device's network interfaces
      type: "[]object"
      required: false
    rangerStatus:
      title: Ranger Status
      description: Is Agent disabled as a Ranger
      type: string
      required: false
    accountId:
      title: Account ID
      description: A reference to the containing account
      type: string
      required: false
    threatRebootRequired:
      title: Threat Reboot Required
      description: Has at least one threat with at least one mitigation action that is pending reboot to succeed
      type: boolean
      required: false
    osArch:
      title: OS Arch
      description: OS Arch
      type: string
      required: false
    activeThreats:
      title: Active Threats
      description: Current number of active threats
      type: integer
      required: false
    installerType:
      title: Installer Type
      description: Installer package type (file extension)
      type: string
      required: false
    scanStatus:
      title: Scan Status
      description: Last scan status
      type: string
      required: false
    groupName:
      title: Group Name
      description: Name of the containing network group
      type: string
      required: false
    consoleMigrationStatus:
      title: Console Migration Status
      description: What step the agent is at in the process of migrating to another console, if any
      type: string
      required: false
    infected:
      title: Infected
      description: Indicates if the Agent has active threats
      type: boolean
      required: false
    id:
      title: ID
      description: Agent ID
      type: string
      required: false
    updatedAt:
      title: Updated at
      description: Last updated date
      type: string
      required: false
    machineType:
      title: Machine Type
      description: Machine type
      type: string
      required: false
    isDecommissioned:
      title: Is Decommissioned
      description: Is Agent decommissioned
      type: boolean
      required: false
    osRevision:
      title: OS Revision
      description: OS revision
      type: string
      required: false
    scanStartedAt:
      title: Scan Started At
      description: Start time of last scan
      type: string
      required: false
    policyUpdatedAt:
      title: Policy Updated At
      description: Date of when the policy was last updated
      type: string
      required: false
    encryptedApplications:
      title: Encrypted Applications
      description: Disk encryption status
      type: boolean
      required: false
    locations:
      title: Locations
      description: A list of locations reported by the Agent
      type: "[]object"
      required: false
    domain:
      title: Domain
      description: Network domain
      type: string
      required: false
    locationType:
      title: Location Type
      description: Reported location type
      type: string
      required: false
    registeredAt:
      title: Registered At
      description: Time of first registration to management console (similar to createdAt)
      type: string
      required: false
    totalMemory:
      title: Total Memory
      description: Memory size (MB)
      type: integer
      required: false
    groupUpdatedAt:
      title: Group Updated At
      description: Date of when the group was last updated
      type: string
      required: false
    computerName:
      title: Computer Name
      description: Computer name
      type: string
      required: false
    isUninstalled:
      title: Is Uninstalled
      description: Indicates if Agent was removed from the device
      type: boolean
      required: false
    uuid:
      title: UUID
      description: Agent's universally unique identifier
      type: string
      required: false
    licenseKey:
      title: License Key
      description: License key
      type: string
      required: false
    isActive:
      title: Is Active
      description: Indicates if the agent was recently active
      type: boolean
      required: false
    cpuCount:
      title: CPU Count
      description: Number of CPUs
      type: integer
      required: false
    modelName:
      title: Model Name
      description: Model name
      type: string
      required: false
    externalId:
      title: External ID
      description: External id set by customer
      type: string
      required: false
    coreCount:
      title: Core Count
      description: Number of CPU cores
      type: integer
      required: false
    allowRemoteShell:
      title: Allow Remote Shell
      description: Agent is capable and policy enabled for remote shell
      type: boolean
      required: false
    agentVersion:
      title: Agent Version
      description: Agent version
      type: string
      required: false
    groupIp:
      title: Group IP
      description: IP Address subnet
      type: string
      required: false
    osName:
      title: OS Name
      description: Os name
      type: string
      required: false
    mitigationModeSuspicious:
      title: Mitigation Mode Suspicious
      description: Mitigation mode policy for suspicious activity
      type: string
      required: false
    osUsername:
      title: OS Username
      description: Os username
      type: string
      required: false
    lastLoggedInUserName:
      title: Last Logged In User Name
      description: Last logged in user name
      type: string
      required: false
    cpuId:
      title: CPU ID
      description: CPU model
      type: string
      required: false
    lastActiveDate:
      title: Last Active Date
      description: Last active date
      type: string
      required: false
    osType:
      title: OS Type
      description: OS type
      type: string
      required: false
    networkStatus:
      title: Network Status
      description: Agent's network connectivity status
      type: string
      required: false
  quarantine_response:
    errors:
      title: Errors
      description: Errors
      type: "[]object"
      required: false
    data:
      title: Data
      description: Response data
      type: object
      required: false
connection:
  credentials:
    type: credential_username_password
    title: Credentials
    description: Username and password
    required: true
    example: '{"username": "user@example.com", "password": "mypassword"}'
  url:
    title: URL
    description: SentinelOne Console URL
    type: string
    required: true
    example: https://example.sentinelone.com
actions:
  get_threat_summary:
    title: Get Threat Summary
    description: Gets summary of all threats
    output:
      pagination:
        title: Pagination
        type: pagination
        description: Pagination
        required: false
      errors:
        title: Errors
        type: '[]object'
        description: Errors
        required: false
      data:
        title: Data
        type: '[]data'
        description: Data
        required: false
  blacklist_by_content_hash:
    title: Blacklist by Content Hash
    description: Add hashed content to global blacklist. The input makes use of contentHash
      from the threat summary
    input:
      hash:
        title: Hash
        description: Content hash to add to blacklist
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
    output:
      result:
        title: Result
        type: blacklist_data
        description: Result of hashing operation
        required: true
  blacklist_by_ioc_hash:
    title: Blacklist by IOC Hash
    description: Add hashed indicator of compromise to global blacklist
    input:
      hash:
        title: IOC Hash
        description: Indicator of compromise hash to add to blacklist
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
      agent_id:
        title: Agent ID
        description: Agent ID
        type: string
        required: true
    output:
      result:
        title: Result
        type: blacklist_data
        description: Result of hashing operation
        required: true
  create_ioc_threat:
    title: Create IOC Threat
    description: Create a threat from an IOC event
    input:
      hash:
        title: Hash
        description: SHA1 hash
        type: string
        required: true
      agent_id:
        title: Agent ID
        description: Agent ID for the slim threat
        type: string
        required: true
      annotation:
        title: Annotation
        description: Vigilance annotation
        type: string
        required: true
      annotation_url:
        title: Annotation URL
        description: Vigilance annotation URL
        type: string
        required: true
      group_id:
        title: Group ID
        description: Group ID
        type: string
        required: false
      path:
        title: Path
        description: Path
        type: string
        required: false
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  mitigate_threat:
    title: Mitigate Threat
    description: Apply a mitigation action to a threat
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
      action:
        title: Action
        description: Mitigation action
        type: string
        required: true
        enum:
        - rollback-remediation
        - quarantine
        - kill
        - remediate
        - un-quarantine
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  mark_as_benign:
    title: Mark as Benign
    description: Mark a threat as resolved
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
      target_scope:
        title: Target Scope
        description: Scope to be used for exclusions
        type: string
        required: true
        enum:
        - group
        - site
        - tenant
      whitening_option:
        title: Whitening Option
        description: Selected whitening option
        type: string
        required: false
        enum:
        - ''
        - browser-type
        - certificate
        - file-type
        - file_hash
        - path
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  mark_as_threat:
    title: Mark as Threat
    description: Mark a suspicious threat as a threat
    input:
      threat_id:
        title: Threat ID
        description: ID of a threat
        type: string
        required: true
      target_scope:
        title: Target Scope
        description: Scope to be used for exclusions
        type: string
        required: true
        enum:
        - group
        - site
        - tenant
      whitening_option:
        title: Whitening Option
        description: Selected whitening option
        type: string
        required: false
        enum:
        - ''
        - browser-type
        - certificate
        - file-type
        - file_hash
        - path
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  activities_list:
    title: Get Activities
    description: Get a list of activities
    input:
      group_ids:
        title: Group IDS
        description: Get a list of activities
        type: '[]string'
        required: false
      include_hidden:
        title: Include Hidden
        description: Include internal activities hidden from display
        type: boolean
        required: false
      skip:
        title: Skip First N Items
        description: Skip first number of items (0-1000). For iterating over more than a 1000 items please use cursor instead
        type: integer
        required: false
      site_ids:
        title: Site IDS
        description: List of Site IDs to filter by
        type: '[]string'
        required: false
      agent_ids:
        title: Agent IDS
        description: Return activities related to specified agent ids
        type: '[]string'
        required: false
      skip_count:
        title: Skip Count
        description: If true, total number of items will not be calculated, which speeds up execution time
        type: boolean
        required: false
      ids:
        title: Activity IDS
        description: If true, total number of items will not be calculated, which speeds up execution time
        type: '[]string'
        required: false
      created_at_lt:
        title: Less Then Date
        description: Return activities created before this date in ISO-8601, example 2018-02-27T04:49:26.257525Z
        type: string
        required: false
      created_at_lte:
        title: Less or Equal Date
        description: Return activities created before or at this date in ISO-8601, example 2018-02-27T04:49:26.257525Z
        type: string
        required: false
      created_at_gt:
        title: Greater Then Date
        description: Return activities created after or at this date in ISO-8601, example 2018-02-27T04:49:26.257525Z
        type: string
        required: false
      created_at_gte:
        title: Greater or Equal Date
        description: Return activities created after or at this date in ISO-8601, example 2018-02-27T04:49:26.257525Z
        type: string
        required: false
      created_at_between:
        title: Between Dates
        description: Return activities created within this range (inclusive), example 1514978764288-1514978999999
        type: string
        required: false
      cursor:
        title: Cursor Position
        description: Cursor position returned by the last request. Should be used for iterating over more than 1000 items, example YWdlbnRfaWQ6NTgwMjkzODE=
        type: string
        required: false
      count_only:
        title: Count Only
        description: If true, only total number of items will be returned, without any of the actual objects
        type: boolean
        required: false
      account_ids:
        title: Account IDS
        description: List of Account IDs to filter by
        type: '[]string'
        required: false
      limit:
        title: Limit
        description: Limit number of returned items (1-100)
        type: integer
        required: false
      sort_by:
        title: Sort By
        description: The column to sort the results by
        type: string
        required: false
        enum:
          - id
          - activityType
          - createdAt
      activity_types:
        title: Activity Types
        description: Return only these activity codes
        type: '[]string'
        required: false
      threat_ids:
        title: Threat IDS
        description: Return only these activity codes
        type: '[]string'
        required: false
      sort_order:
        title: Sort Order
        description: Sort direction
        type: string
        enum:
          - asc
          - desc
        required: false
      user_emails:
        title: User Emails
        description: Email of the user who invoked the activity (If applicable)
        type: '[]string'
        required: false
      user_ids:
        title: User IDS
        description: The user who invoked the activity (If applicable)
        type: '[]string'
        required: false
    output:
      data:
        title: Data
        description: Result of activities list
        type: '[]activities_list'
        required: true
      pagination:
        title: Pagination
        description: Pagination object
        type: pagination
        required: true
  activities_types:
    title: Get Activity Types
    description: Get a list of activity types
    output:
      activity_types:
        title: Activity Types
        description: Result of activities types
        type: '[]activities_types'
        required: true
  apps_by_agent_ids:
    title: Agents Applications
    description: Retrieve running applications for a specific agent
    input:
      ids:
        title: Agent IDS
        description: Agent ID list
        type: '[]string'
        required: true
    output:
      data:
        title: Agent Applications
        description: List of installed applications
        type: '[]agent_applications'
        required: true
  agents_summary:
    title: Count Summary
    description: Summary of agents by numbers
    input:
      site_ids:
        title: Site IDS
        description: List of Site IDs to filter by
        type: '[]string'
        required: false
      account_ids:
        title: Account IDS
        description: List of Account IDs to filter by
        type: '[]string'
        required: false
    output:
      up_to_date:
        title: Up to Date Number
        description: Number of agents with the most up-to-date software version
        type: integer
        required: false
      out_of_date:
        title: Out of Date Number
        description: Number of agents running an older software version
        type: integer
        required: false
      total:
        title: Total
        description: Number of installed active agents
        type: integer
        required: false
      online:
        title: Online
        description: Number of online agents
        type: integer
        required: false
      decommissioned:
        title: Decommissioned
        description: Number of decommissioned agents
        type: integer
        required: false
      infected:
        title: Infected
        description: Number of agents with at least one active threat
        type: integer
        required: false
  name_available:
    title: Available Name
    description: Is the account name available for this account
    input:
      name:
        title: Name
        description: Account Name to validate
        type: string
        required: true
    output:
      available:
        title: Available
        description: Account Name to validate
        type: boolean
        required: true
  agents_decommission:
    title: Agent Decommission
    description: Decommissions all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - one of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_disconnect:
    title: Disconnect Agents
    description: Disconnects agents associated to marked threats from network
    input:
      filter:
        title: Filter JSON
        description: Use any of the filtering options to control the list of affected threats. You can also leave this field empty to apply to all available threats
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_processes:
    title: Agents Processes
    description: Retrieve running processes for a specific agent
    input:
      ids:
        title: IDS
        description: Agent ID list
        type: '[]string'
        required: true
    output:
      agents_processes:
        title: Agents Processes
        description: Agents processes entities
        type: '[]agents_processes'
        required: false
  agents_initiate:
    title: Initiate Scan
    description: Sends a scan command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_uninstall:
    title: Uninstall
    description: Sends an uninstall command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - one of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_shutdown:
    title: Agents Shutdown
    description: Sends a shutdown command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - one of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_restart:
    title: Agents Restart
    description: Sends a restart command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Note - One of the following filter arguments must be supplied - ids, groupIds, filterId
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_reload:
    title: Agents Reload
    description: Reload an agent module (applies to Windows agents only)
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
      module:
        title: Data Module
        description: Agent module to reload
        type: string
        required: true
        enum:
          - monitor
          - static
          - agent
          - log
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_fetch_logs:
    title: Agents Fetch Logs
    description: Sends a fetch logs command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_abort_scan:
    title: Agents Abort Scan
    description: Aborts running scan on all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  agents_connect:
    title: Connect to Network
    description: Sends a connect to network command to all agents matching the input filter
    input:
      filter:
        title: Filter JSON
        description: Applied filter - only matched agents will be affected by the requested action. Leave empty to apply the action on all applicable agents
        type: object
        required: true
    output:
      affected:
        title: Affected
        description: Number of entities affected by the requested operation
        type: integer
        required: false
  search_agents:
    title: Search Agents
    description: Search for agents
    input:
      agent:
        title: Agent
        description: Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID. If empty, this action will return all active or inactive agents depending on the value of the Agent Active input
        type: string
        example: hostname123
        required: false
      agent_active:
        title: Agent Active
        description: Return a list of all active or inactive agents when Agent input is not specified. Note that setting this to true for Active agents can return a very large amount of data
        type: boolean
        example: true
        default: true
        required: false
      case_sensitive:
        title: Case Sensitive
        description: Looks up agents in a case-sensitive manner. Setting this value to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      agents:
        title: Agents
        description: Detailed information about agents found
        type: "[]agent_data"
        required: false
  get_agent_details:
    title: Get Agent Details
    description: Retrieve agent details
    input:
      agent:
        title: Agent
        description: Agent to retrieve device information from. Accepts IP address, MAC address, hostname, UUID or agent ID
        type: string
        example: hostname123
        required: true
      case_sensitive:
        title: Case Sensitive
        description: Looks up the specified Agent in a case-sensitive manner. Setting this to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      agent:
        title: Agent
        description: Detailed information about agent found
        type: agent_data
        required: false
  quarantine:
    title: Quarantine
    description: Isolate (quarantine) endpoint from the network
    input:
      agent:
        title: Agent
        description: Agent to perform quarantine action on. Accepts IP address, MAC address, hostname, UUID or agent ID
        type: string
        example: hostname123
        required: true
      quarantine_state:
        title: Quarantine State
        description: True to quarantine host, false to unquarantine host
        type: boolean
        example: true
        required: true
      whitelist:
        title: Whitelist
        description: This list contains a set of devices that should not be blocked. This can include IPs, hostnames, UUIDs and agent IDs
        type: "[]string"
        example: ["198.51.100.100", "hostname123", "901345720792880606", "28db47168fa54f89aeed99769ac8d4dc"]
        required: false
      case_sensitive:
        title: Case Sensitive
        description: Looks up the specified Agent in a case-sensitive manner. Setting this value to false may result in longer run times and unintended results
        type: boolean
        example: true
        default: true
        required: true
    output:
      response:
        title: Response
        description: SentinelOne API call response data
        type: quarantine_response
        required: false
  blacklist:
    title: Blacklist
    description: Blacklist and unblacklist a SHA1 hash
    input:
      hash:
        title: Hash
        description: Create a blacklist item from a SHA1 hash
        type: string
        required: true
        example: "3395856ce81f2b7382dee72602f798b642f14140"
      description:
        title: Description
        description: Description for why the hash is blacklisted
        type: string
        default: "Hash Blacklisted from InsightConnect"
        required: false
        example: "Hash Blacklisted from InsightConnect"
      blacklist_state:
        title: Blacklist State
        description: True to create blacklist hash, false to unblacklist hash
        type: boolean
        required: true
        default: true
        example: true
    output:
      success:
        title: Success
        description: Return true if blacklist item was created or deleted
        type: boolean
        required: true
  threats_fetch_file:
    title: Fetch Threats File
    description: Fetch a file associated with the threat that matches the filter. Your user role must have permissions to Fetch Threat File - Admin, IR Team, SOC
    input:
      id:
        title: ID
        description: Threat ID
        type: string
        required: true
        example: "939039647215561624"
      password:
        title: Password
        description: File encryption password, min. length 10 characters and cannot contain whitespace
        type: password
        required: true
        example: "Rapid7 Insightconnect"
    output:
      file:
        title: File
        description: Base64 encoded threat file
        type: file
        required: true

triggers:
  get_threats:
    title: Get Threats
    description: Get threats
    input:
      resolved:
        title: Resolved
        description: Include resolved threats
        type: boolean
        required: false
      classifications:
        title: Classifications
        description: List of classifications to search
        type: '[]string'
        required: false
      agent_is_active:
        title: Agent is Active
        description: Include agents currently connected to the management console
        type: boolean
        default: true
        required: false
      engines:
        title: Engines
        description: Included engines
        type: '[]string'
        required: false
      frequency:
        title: Frequency
        description: Poll frequency in seconds
        type: integer
        required: false
        default: 5
    output:
      threat:
        title: Threat
        description: Threat
        type: data
        required: false
